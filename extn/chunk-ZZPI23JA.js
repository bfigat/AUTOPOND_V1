import{p as Gd}from"./chunk-ZSQU2ZM6.js";import{e as Hc}from"./chunk-2THQDEWP.js";import{v as Kd}from"./chunk-O5D25TI4.js";import{q as Vd,w as Hd}from"./chunk-PKAXVJFX.js";import{a as kd}from"./chunk-YOIJCLV6.js";import{A as gd,Ac as eo,B as $i,Bb as Nd,Bc as Ne,Cc as Qd,D as yd,Da as Ad,Dc as to,Ea as Td,Eb as Bd,Ga as vd,Ia as Ed,Ja as xd,Ka as zi,La as Wi,Lc as _d,Mc as Od,Qc as H,Rc as qd,Sc as yt,Tb as Yi,Tc as Jt,Ub as Ld,Wc as Xi,Xb as Bt,Yb as Je,_b as Ud,_c as Ut,ac as qn,bd as zc,cb as Id,d as pd,e as Nt,eb as ji,g as ud,gc as Lt,gd as Ji,h as ld,ha as Sd,hb as Fd,i as md,ib as Vo,j as dd,jb as Cd,kb as Pd,pa as wd,qa as hd,va as $c,wa as bd,wb as De,wc as Md,xb as gt,yb as Dd,z as fd,zc as Zr}from"./chunk-R5HJQXZQ.js";import{d as Rd,h as vr}from"./chunk-PPMPQKRK.js";import{b as Ge}from"./chunk-UDFQ3C42.js";import{M as id,S as sd,ea as cd,j as nd,o as Ee}from"./chunk-P4LRI3S3.js";import{c as _i,h as Oi,j as Kc,k as _n}from"./chunk-GBKSQA4Y.js";import{a as DA}from"./chunk-IBEI3NGL.js";import{f as Wc,m as jc}from"./chunk-UFPGJN5T.js";import{w as Er}from"./chunk-BFV33OZC.js";import{Aa as Ym,Ac as Ve,Bc as Tr,Bd as qo,C as Bm,Db as ut,Dd as Vi,De as xe,Gb as _o,Hb as Oo,Hc as rd,Id as Gi,L as Un,Md as Ki,Ob as ed,S as j,Sb as td,V as ne,Vc as On,Xa as Qn,Xd as ad,Zc as od,de as ue,fb as Xm,gb as I,gd as te,hb as Yt,ia as jr,ib as Z,jb as Ar,jd as qi,ke as Hi,mb as Xt,md as He,nb as Yr,ob as J,pb as Xr,sb as Jm,vb as Zm,y as Lo,ze as Jr}from"./chunk-S6KJ2BHO.js";import{N as ot,p as Bo,w as Nm}from"./chunk-7ZZNCPHU.js";import{a as L,m as pt,n as qe}from"./chunk-MNQ7RLHG.js";import{D as he,F as _e,G as Lm,H as Ye,Ja as jm,Ra as fe,_ as ve,aa as Um,ba as Mm,ca as Uo,da as Li,ea as Qm,f as kA,fa as _m,ha as W,ja as me,ka as kt,la as Om,ma as $,p as Bi,q as jt,ra as re,u as Mn,w as qc,wa as br,xa as Q}from"./chunk-NMZ7IVPZ.js";import{$ as ct,T as Mo,U as Gm,W as Km,X as Qo,Y as RA,Z as Hm,_ as Dt,a as d,b as z,ba as Gc,c as K,ca as $m,da as se,ea as zm,fa as Wm,ga as Xe,ha as Qi,o as qm,p as Vm,q as Ui,t as Vc,v as Mi,w as Rt,x as Y}from"./chunk-H6ILHDLW.js";import{a as M}from"./chunk-7X4NV6OJ.js";import{c as je,f as N,h as s,i as m,l as PA,m as Buffer,n as a}from"./chunk-3KENBVE7.js";var Yd=je((Zt,jd)=>{s();a();var Wd=typeof self<"u"?self:Zt,es=function(){function t(){this.fetch=!1,this.DOMException=Wd.DOMException}return t.prototype=Wd,new t}();(function(t){var e=function(r){var o={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};function n(v){return v&&DataView.prototype.isPrototypeOf(v)}if(o.arrayBuffer)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(v){return v&&i.indexOf(Object.prototype.toString.call(v))>-1};function p(v){if(typeof v!="string"&&(v=String(v)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(v))throw new TypeError("Invalid character in header field name");return v.toLowerCase()}function u(v){return typeof v!="string"&&(v=String(v)),v}function l(v){var E={next:function(){var C=v.shift();return{done:C===void 0,value:C}}};return o.iterable&&(E[Symbol.iterator]=function(){return E}),E}function g(v){this.map={},v instanceof g?v.forEach(function(E,C){this.append(C,E)},this):Array.isArray(v)?v.forEach(function(E){this.append(E[0],E[1])},this):v&&Object.getOwnPropertyNames(v).forEach(function(E){this.append(E,v[E])},this)}g.prototype.append=function(v,E){v=p(v),E=u(E);var C=this.map[v];this.map[v]=C?C+", "+E:E},g.prototype.delete=function(v){delete this.map[p(v)]},g.prototype.get=function(v){return v=p(v),this.has(v)?this.map[v]:null},g.prototype.has=function(v){return this.map.hasOwnProperty(p(v))},g.prototype.set=function(v,E){this.map[p(v)]=u(E)},g.prototype.forEach=function(v,E){for(var C in this.map)this.map.hasOwnProperty(C)&&v.call(E,this.map[C],C,this)},g.prototype.keys=function(){var v=[];return this.forEach(function(E,C){v.push(C)}),l(v)},g.prototype.values=function(){var v=[];return this.forEach(function(E){v.push(E)}),l(v)},g.prototype.entries=function(){var v=[];return this.forEach(function(E,C){v.push([C,E])}),l(v)},o.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function f(v){if(v.bodyUsed)return Promise.reject(new TypeError("Already read"));v.bodyUsed=!0}function y(v){return new Promise(function(E,C){v.onload=function(){E(v.result)},v.onerror=function(){C(v.error)}})}function h(v){var E=new FileReader,C=y(E);return E.readAsArrayBuffer(v),C}function S(v){var E=new FileReader,C=y(E);return E.readAsText(v),C}function w(v){for(var E=new Uint8Array(v),C=new Array(E.length),U=0;U<E.length;U++)C[U]=String.fromCharCode(E[U]);return C.join("")}function b(v){if(v.slice)return v.slice(0);var E=new Uint8Array(v.byteLength);return E.set(new Uint8Array(v)),E.buffer}function x(){return this.bodyUsed=!1,this._initBody=function(v){this._bodyInit=v,v?typeof v=="string"?this._bodyText=v:o.blob&&Blob.prototype.isPrototypeOf(v)?this._bodyBlob=v:o.formData&&FormData.prototype.isPrototypeOf(v)?this._bodyFormData=v:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)?this._bodyText=v.toString():o.arrayBuffer&&o.blob&&n(v)?(this._bodyArrayBuffer=b(v.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(v)||c(v))?this._bodyArrayBuffer=b(v):this._bodyText=v=Object.prototype.toString.call(v):this._bodyText="",this.headers.get("content-type")||(typeof v=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var v=f(this);if(v)return v;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}),this.text=function(){var v=f(this);if(v)return v;if(this._bodyBlob)return S(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(w(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(B)}),this.json=function(){return this.text().then(JSON.parse)},this}var T=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function F(v){var E=v.toUpperCase();return T.indexOf(E)>-1?E:v}function P(v,E){E=E||{};var C=E.body;if(v instanceof P){if(v.bodyUsed)throw new TypeError("Already read");this.url=v.url,this.credentials=v.credentials,E.headers||(this.headers=new g(v.headers)),this.method=v.method,this.mode=v.mode,this.signal=v.signal,!C&&v._bodyInit!=null&&(C=v._bodyInit,v.bodyUsed=!0)}else this.url=String(v);if(this.credentials=E.credentials||this.credentials||"same-origin",(E.headers||!this.headers)&&(this.headers=new g(E.headers)),this.method=F(E.method||this.method||"GET"),this.mode=E.mode||this.mode||null,this.signal=E.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&C)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(C)}P.prototype.clone=function(){return new P(this,{body:this._bodyInit})};function B(v){var E=new FormData;return v.trim().split("&").forEach(function(C){if(C){var U=C.split("="),_=U.shift().replace(/\+/g," "),k=U.join("=").replace(/\+/g," ");E.append(decodeURIComponent(_),decodeURIComponent(k))}}),E}function R(v){var E=new g,C=v.replace(/\r?\n[\t ]+/g," ");return C.split(/\r?\n/).forEach(function(U){var _=U.split(":"),k=_.shift().trim();if(k){var O=_.join(":").trim();E.append(k,O)}}),E}x.call(P.prototype);function q(v,E){E||(E={}),this.type="default",this.status=E.status===void 0?200:E.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in E?E.statusText:"OK",this.headers=new g(E.headers),this.url=E.url||"",this._initBody(v)}x.call(q.prototype),q.prototype.clone=function(){return new q(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},q.error=function(){var v=new q(null,{status:0,statusText:""});return v.type="error",v};var G=[301,302,303,307,308];q.redirect=function(v,E){if(G.indexOf(E)===-1)throw new RangeError("Invalid status code");return new q(null,{status:E,headers:{location:v}})},r.DOMException=t.DOMException;try{new r.DOMException}catch{r.DOMException=function(E,C){this.message=E,this.name=C;var U=Error(E);this.stack=U.stack},r.DOMException.prototype=Object.create(Error.prototype),r.DOMException.prototype.constructor=r.DOMException}function X(v,E){return new Promise(function(C,U){var _=new P(v,E);if(_.signal&&_.signal.aborted)return U(new r.DOMException("Aborted","AbortError"));var k=new XMLHttpRequest;function O(){k.abort()}k.onload=function(){var V={status:k.status,statusText:k.statusText,headers:R(k.getAllResponseHeaders()||"")};V.url="responseURL"in k?k.responseURL:V.headers.get("X-Request-URL");var D="response"in k?k.response:k.responseText;C(new q(D,V))},k.onerror=function(){U(new TypeError("Network request failed"))},k.ontimeout=function(){U(new TypeError("Network request failed"))},k.onabort=function(){U(new r.DOMException("Aborted","AbortError"))},k.open(_.method,_.url,!0),_.credentials==="include"?k.withCredentials=!0:_.credentials==="omit"&&(k.withCredentials=!1),"responseType"in k&&o.blob&&(k.responseType="blob"),_.headers.forEach(function(V,D){k.setRequestHeader(D,V)}),_.signal&&(_.signal.addEventListener("abort",O),k.onreadystatechange=function(){k.readyState===4&&_.signal.removeEventListener("abort",O)}),k.send(typeof _._bodyInit>"u"?null:_._bodyInit)})}return X.polyfill=!0,t.fetch||(t.fetch=X,t.Headers=g,t.Request=P,t.Response=q),r.Headers=g,r.Request=P,r.Response=q,r.fetch=X,Object.defineProperty(r,"__esModule",{value:!0}),r}({})})(es);es.fetch.ponyfill=!0;delete es.fetch.polyfill;var Go=es;Zt=Go.fetch;Zt.default=Go.fetch;Zt.fetch=Go.fetch;Zt.Headers=Go.Headers;Zt.Request=Go.Request;Zt.Response=Go.Response;jd.exports=Zt});var Jd=je((wN,Xd)=>{s();a();(function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e={rotl:function(r,o){return r<<o|r>>>32-o},rotr:function(r,o){return r<<32-o|r>>>o},endian:function(r){if(r.constructor==Number)return e.rotl(r,8)&16711935|e.rotl(r,24)&4278255360;for(var o=0;o<r.length;o++)r[o]=e.endian(r[o]);return r},randomBytes:function(r){for(var o=[];r>0;r--)o.push(Math.floor(Math.random()*256));return o},bytesToWords:function(r){for(var o=[],n=0,i=0;n<r.length;n++,i+=8)o[i>>>5]|=r[n]<<24-i%32;return o},wordsToBytes:function(r){for(var o=[],n=0;n<r.length*32;n+=8)o.push(r[n>>>5]>>>24-n%32&255);return o},bytesToHex:function(r){for(var o=[],n=0;n<r.length;n++)o.push((r[n]>>>4).toString(16)),o.push((r[n]&15).toString(16));return o.join("")},hexToBytes:function(r){for(var o=[],n=0;n<r.length;n+=2)o.push(parseInt(r.substr(n,2),16));return o},bytesToBase64:function(r){for(var o=[],n=0;n<r.length;n+=3)for(var i=r[n]<<16|r[n+1]<<8|r[n+2],c=0;c<4;c++)n*8+c*6<=r.length*8?o.push(t.charAt(i>>>6*(3-c)&63)):o.push("=");return o.join("")},base64ToBytes:function(r){r=r.replace(/[^A-Z0-9+\/]/ig,"");for(var o=[],n=0,i=0;n<r.length;i=++n%4)i!=0&&o.push((t.indexOf(r.charAt(n-1))&Math.pow(2,-2*i+8)-1)<<i*2|t.indexOf(r.charAt(n))>>>6-i*2);return o}};Xd.exports=e})()});var Zc=je((AN,Zd)=>{s();a();var Jc={utf8:{stringToBytes:function(t){return Jc.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(Jc.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],r=0;r<t.length;r++)e.push(t.charCodeAt(r)&255);return e},bytesToString:function(t){for(var e=[],r=0;r<t.length;r++)e.push(String.fromCharCode(t[r]));return e.join("")}}};Zd.exports=Jc});var tf=je((EN,ef)=>{s();a();(function(){var t=Jd(),e=Zc().utf8,r=Zc().bin,o=function(i){i.constructor==String?i=e.stringToBytes(i):typeof Buffer<"u"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(i)?i=Array.prototype.slice.call(i,0):Array.isArray(i)||(i=i.toString());var c=t.bytesToWords(i),p=i.length*8,u=[],l=1732584193,g=-271733879,f=-1732584194,y=271733878,h=-1009589776;c[p>>5]|=128<<24-p%32,c[(p+64>>>9<<4)+15]=p;for(var S=0;S<c.length;S+=16){for(var w=l,b=g,x=f,T=y,F=h,P=0;P<80;P++){if(P<16)u[P]=c[S+P];else{var B=u[P-3]^u[P-8]^u[P-14]^u[P-16];u[P]=B<<1|B>>>31}var R=(l<<5|l>>>27)+h+(u[P]>>>0)+(P<20?(g&f|~g&y)+1518500249:P<40?(g^f^y)+1859775393:P<60?(g&f|g&y|f&y)-1894007588:(g^f^y)-899497514);h=y,y=f,f=g<<30|g>>>2,g=l,l=R}l+=w,g+=b,f+=x,y+=T,h+=F}return[l,g,f,y,h]},n=function(i,c){var p=t.wordsToBytes(o(i));return c&&c.asBytes?p:c&&c.asString?r.bytesToString(p):t.bytesToHex(p)};n._blocksize=16,n._digestsize=20,ef.exports=n})()});var nf=je((RN,UA)=>{UA.exports={name:"@phantom-labs/blocklist",version:"0.13.0",main:"index.js",types:"index.d.ts",repository:"git@github.com:phantom-labs/blocklist.git",author:"Jordan Leigh <AlwaysBCoding@gmail.com>",license:"MIT",scripts:{build:"node build.js"},dependencies:{"js-yaml":"^4.1.0",sha3:"^2.1.4"}}});var sf=je((DN,MA)=>{MA.exports={blocklist:["phantomweb.app","aurory.app","solvision.io","staratlas.art","starsatlas.com","sollet.cc","raydlum.io","aurorynft.com","sneks.gg","solletweb.io","i-sollet.com","fancyfrenchienft.art","solanawebwallet.online","phahtom.com","server-syncwallet.com","staratias.app","raydium.network","grapesnetwork.me","staratias.art","soistarter.org","audius-nft.top","aurory.me","degenapes.app","phantom-app.online","phantomwallet.net","dapps-node.com","phantom-app.link","solanaoutage.com","walletconnectdapps.net","staratlas.cx","web-phantom.app","0120tt.com"],whitelist:[],fuzzylist:[],contentHash:"830ea1c9a833213eabc17990adf053081f503b1203ca9a2c711db7199e657293"}});var af=je(rp=>{s();a();var{version:QA}=nf(),_A=sf(),OA=()=>QA,qA=()=>_A;rp.getVersion=OA;rp.getBlocklist=qA});var pf=je(Ho=>{"use strict";s();a();Ho.__esModule=!0;Ho.distance=Ho.closest=void 0;var er=new Uint32Array(65536),VA=function(t,e){for(var r=t.length,o=e.length,n=1<<r-1,i=-1,c=0,p=r,u=r;u--;)er[t.charCodeAt(u)]|=1<<u;for(u=0;u<o;u++){var l=er[e.charCodeAt(u)],g=l|c;l|=(l&i)+i^i,c|=~(l|i),i&=l,c&n&&p++,i&n&&p--,c=c<<1|1,i=i<<1|~(g|c),c&=g}for(u=r;u--;)er[t.charCodeAt(u)]=0;return p},GA=function(t,e){for(var r=e.length,o=t.length,n=[],i=[],c=Math.ceil(r/32),p=Math.ceil(o/32),u=0;u<c;u++)i[u]=-1,n[u]=0;for(var l=0;l<p-1;l++){for(var g=0,f=-1,y=l*32,h=Math.min(32,o)+y,S=y;S<h;S++)er[t.charCodeAt(S)]|=1<<S;for(var u=0;u<r;u++){var w=er[e.charCodeAt(u)],b=i[u/32|0]>>>u&1,x=n[u/32|0]>>>u&1,T=w|g,F=((w|x)&f)+f^f|w|x,P=g|~(F|f),B=f&F;P>>>31^b&&(i[u/32|0]^=1<<u),B>>>31^x&&(n[u/32|0]^=1<<u),P=P<<1|b,B=B<<1|x,f=B|~(T|P),g=P&T}for(var S=y;S<h;S++)er[t.charCodeAt(S)]=0}for(var R=0,q=-1,G=l*32,X=Math.min(32,o-G)+G,S=G;S<X;S++)er[t.charCodeAt(S)]|=1<<S;for(var v=o,u=0;u<r;u++){var w=er[e.charCodeAt(u)],b=i[u/32|0]>>>u&1,x=n[u/32|0]>>>u&1,T=w|R,F=((w|x)&q)+q^q|w|x,P=R|~(F|q),B=q&F;v+=P>>>o-1&1,v-=B>>>o-1&1,P>>>31^b&&(i[u/32|0]^=1<<u),B>>>31^x&&(n[u/32|0]^=1<<u),P=P<<1|b,B=B<<1|x,q=B|~(T|P),R=P&T}for(var S=G;S<X;S++)er[t.charCodeAt(S)]=0;return v},cf=function(t,e){if(t.length<e.length){var r=e;e=t,t=r}return e.length===0?t.length:t.length<=32?VA(t,e):GA(t,e)};Ho.distance=cf;var KA=function(t,e){for(var r=1/0,o=0,n=0;n<e.length;n++){var i=cf(t,e[n]);i<r&&(r=i,o=n)}return e[o]};Ho.closest=KA});var uf=je((op,Vn)=>{s();a();(function(){"use strict";var t;try{t=typeof Intl<"u"&&typeof Intl.Collator<"u"?Intl.Collator("generic",{sensitivity:"base"}):null}catch{console.log("Collator could not be initialized and wouldn't be used")}var e=pf(),r=[],o=[],n={get:function(i,c,p){var u=p&&t&&p.useCollator;if(u){var l=i.length,g=c.length;if(l===0)return g;if(g===0)return l;var f,y,h,S,w;for(h=0;h<g;++h)r[h]=h,o[h]=c.charCodeAt(h);r[g]=g;var b;for(h=0;h<l;++h){for(y=h+1,S=0;S<g;++S)f=y,b=t.compare(i.charAt(h),String.fromCharCode(o[S]))===0,y=r[S]+(b?0:1),w=f+1,y>w&&(y=w),w=r[S+1]+1,y>w&&(y=w),r[S]=f;r[S]=y}return y}return e.distance(i,c)}};typeof define<"u"&&define!==null&&define.amd?define(function(){return n}):typeof Vn<"u"&&Vn!==null&&typeof op<"u"&&Vn.exports===op?Vn.exports=n:(typeof self<"u"&&typeof self.postMessage=="function"&&typeof self.importScripts=="function"||typeof self<"u"&&self!==null)&&(self.Levenshtein=n)})()});var jg=je((Wn,Yo)=>{s();a();var xg=200,FT="Expected a function",tu="__lodash_hash_undefined__",Ss=1,Jo=2,ru=1/0,Ig=9007199254740991,ms="[object Arguments]",Wp="[object Array]",Fg="[object Boolean]",Cg="[object Date]",Pg="[object Error]",kg="[object Function]",CT="[object GeneratorFunction]",ds="[object Map]",Rg="[object Number]",jo="[object Object]",yg="[object Promise]",Dg="[object RegExp]",fs="[object Set]",Ng="[object String]",Bg="[object Symbol]",jp="[object WeakMap]",Lg="[object ArrayBuffer]",gs="[object DataView]",PT="[object Float32Array]",kT="[object Float64Array]",RT="[object Int8Array]",DT="[object Int16Array]",NT="[object Int32Array]",BT="[object Uint8Array]",LT="[object Uint8ClampedArray]",UT="[object Uint16Array]",MT="[object Uint32Array]",QT=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,_T=/^\w*$/,OT=/^\./,qT=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,VT=/[\\^$.*+?()[\]{}|]/g,GT=/\\(\\)?/g,KT=/^\[object .+?Constructor\]$/,HT=/^(?:0|[1-9]\d*)$/,ge={};ge[PT]=ge[kT]=ge[RT]=ge[DT]=ge[NT]=ge[BT]=ge[LT]=ge[UT]=ge[MT]=!0;ge[ms]=ge[Wp]=ge[Lg]=ge[Fg]=ge[gs]=ge[Cg]=ge[Pg]=ge[kg]=ge[ds]=ge[Rg]=ge[jo]=ge[Dg]=ge[fs]=ge[Ng]=ge[jp]=!1;var Ug=typeof self=="object"&&self&&self.Object===Object&&self,$T=typeof self=="object"&&self&&self.Object===Object&&self,Fr=Ug||$T||Function("return this")(),Mg=typeof Wn=="object"&&Wn&&!Wn.nodeType&&Wn,Sg=Mg&&typeof Yo=="object"&&Yo&&!Yo.nodeType&&Yo,zT=Sg&&Sg.exports===Mg,wg=zT&&Ug.process,hg=function(){try{return wg&&wg.binding("util")}catch{}}(),bg=hg&&hg.isTypedArray;function WT(t,e){var r=t?t.length:0;return!!r&&JT(t,e,0)>-1}function jT(t,e,r){for(var o=-1,n=t?t.length:0;++o<n;)if(r(e,t[o]))return!0;return!1}function YT(t,e){for(var r=-1,o=t?t.length:0;++r<o;)if(e(t[r],r,t))return!0;return!1}function XT(t,e,r,o){for(var n=t.length,i=r+(o?1:-1);o?i--:++i<n;)if(e(t[i],i,t))return i;return-1}function JT(t,e,r){if(e!==e)return XT(t,ZT,r);for(var o=r-1,n=t.length;++o<n;)if(t[o]===e)return o;return-1}function ZT(t){return t!==t}function ev(t){return function(e){return e?.[t]}}function tv(t,e){for(var r=-1,o=Array(t);++r<t;)o[r]=e(r);return o}function rv(t){return function(e){return t(e)}}function ov(t,e){return t.has(e)}function nv(t,e){return t?.[e]}function Yp(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function iv(t){var e=-1,r=Array(t.size);return t.forEach(function(o,n){r[++e]=[n,o]}),r}function sv(t,e){return function(r){return t(e(r))}}function ou(t){var e=-1,r=Array(t.size);return t.forEach(function(o){r[++e]=o}),r}var av=Array.prototype,cv=Function.prototype,ws=Object.prototype,$p=Fr["__core-js_shared__"],Ag=function(){var t=/[^.]+$/.exec($p&&$p.keys&&$p.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Qg=cv.toString,or=ws.hasOwnProperty,Zo=ws.toString,pv=RegExp("^"+Qg.call(or).replace(VT,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Tg=Fr.Symbol,vg=Fr.Uint8Array,uv=ws.propertyIsEnumerable,lv=av.splice,mv=sv(Object.keys,Object),Xp=en(Fr,"DataView"),jn=en(Fr,"Map"),Jp=en(Fr,"Promise"),Xo=en(Fr,"Set"),Zp=en(Fr,"WeakMap"),Yn=en(Object,"create"),dv=io(Xp),fv=io(jn),gv=io(Jp),yv=io(Xo),Sv=io(Zp),ys=Tg?Tg.prototype:void 0,zp=ys?ys.valueOf:void 0,Eg=ys?ys.toString:void 0;function oo(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}function wv(){this.__data__=Yn?Yn(null):{}}function hv(t){return this.has(t)&&delete this.__data__[t]}function bv(t){var e=this.__data__;if(Yn){var r=e[t];return r===tu?void 0:r}return or.call(e,t)?e[t]:void 0}function Av(t){var e=this.__data__;return Yn?e[t]!==void 0:or.call(e,t)}function Tv(t,e){var r=this.__data__;return r[t]=Yn&&e===void 0?tu:e,this}oo.prototype.clear=wv;oo.prototype.delete=hv;oo.prototype.get=bv;oo.prototype.has=Av;oo.prototype.set=Tv;function nr(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}function vv(){this.__data__=[]}function Ev(t){var e=this.__data__,r=hs(e,t);if(r<0)return!1;var o=e.length-1;return r==o?e.pop():lv.call(e,r,1),!0}function xv(t){var e=this.__data__,r=hs(e,t);return r<0?void 0:e[r][1]}function Iv(t){return hs(this.__data__,t)>-1}function Fv(t,e){var r=this.__data__,o=hs(r,t);return o<0?r.push([t,e]):r[o][1]=e,this}nr.prototype.clear=vv;nr.prototype.delete=Ev;nr.prototype.get=xv;nr.prototype.has=Iv;nr.prototype.set=Fv;function ir(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}function Cv(){this.__data__={hash:new oo,map:new(jn||nr),string:new oo}}function Pv(t){return bs(this,t).delete(t)}function kv(t){return bs(this,t).get(t)}function Rv(t){return bs(this,t).has(t)}function Dv(t,e){return bs(this,t).set(t,e),this}ir.prototype.clear=Cv;ir.prototype.delete=Pv;ir.prototype.get=kv;ir.prototype.has=Rv;ir.prototype.set=Dv;function Xn(t){var e=-1,r=t?t.length:0;for(this.__data__=new ir;++e<r;)this.add(t[e])}function Nv(t){return this.__data__.set(t,tu),this}function Bv(t){return this.__data__.has(t)}Xn.prototype.add=Xn.prototype.push=Nv;Xn.prototype.has=Bv;function rr(t){this.__data__=new nr(t)}function Lv(){this.__data__=new nr}function Uv(t){return this.__data__.delete(t)}function Mv(t){return this.__data__.get(t)}function Qv(t){return this.__data__.has(t)}function _v(t,e){var r=this.__data__;if(r instanceof nr){var o=r.__data__;if(!jn||o.length<xg-1)return o.push([t,e]),this;r=this.__data__=new ir(o)}return r.set(t,e),this}rr.prototype.clear=Lv;rr.prototype.delete=Uv;rr.prototype.get=Mv;rr.prototype.has=Qv;rr.prototype.set=_v;function Ov(t,e){var r=no(t)||$g(t)?tv(t.length,String):[],o=r.length,n=!!o;for(var i in t)(e||or.call(t,i))&&!(n&&(i=="length"||Vg(i,o)))&&r.push(i);return r}function hs(t,e){for(var r=t.length;r--;)if(Hg(t[r][0],e))return r;return-1}function _g(t,e){e=As(e,t)?[e]:Og(e);for(var r=0,o=e.length;t!=null&&r<o;)t=t[Ts(e[r++])];return r&&r==o?t:void 0}function qv(t){return Zo.call(t)}function Vv(t,e){return t!=null&&e in Object(t)}function nu(t,e,r,o,n){return t===e?!0:t==null||e==null||!vs(t)&&!Es(e)?t!==t&&e!==e:Gv(t,e,nu,r,o,n)}function Gv(t,e,r,o,n,i){var c=no(t),p=no(e),u=Wp,l=Wp;c||(u=Ir(t),u=u==ms?jo:u),p||(l=Ir(e),l=l==ms?jo:l);var g=u==jo&&!Yp(t),f=l==jo&&!Yp(e),y=u==l;if(y&&!g)return i||(i=new rr),c||lE(t)?qg(t,e,r,o,n,i):tE(t,e,u,r,o,n,i);if(!(n&Jo)){var h=g&&or.call(t,"__wrapped__"),S=f&&or.call(e,"__wrapped__");if(h||S){var w=h?t.value():t,b=S?e.value():e;return i||(i=new rr),r(w,b,o,n,i)}}return y?(i||(i=new rr),rE(t,e,r,o,n,i)):!1}function Kv(t,e,r,o){var n=r.length,i=n,c=!o;if(t==null)return!i;for(t=Object(t);n--;){var p=r[n];if(c&&p[2]?p[1]!==t[p[0]]:!(p[0]in t))return!1}for(;++n<i;){p=r[n];var u=p[0],l=t[u],g=p[1];if(c&&p[2]){if(l===void 0&&!(u in t))return!1}else{var f=new rr;if(o)var y=o(l,g,u,t,e,f);if(!(y===void 0?nu(g,l,o,Ss|Jo,f):y))return!1}}return!0}function Hv(t){if(!vs(t)||sE(t))return!1;var e=Wg(t)||Yp(t)?pv:KT;return e.test(io(t))}function $v(t){return Es(t)&&su(t.length)&&!!ge[Zo.call(t)]}function zv(t){return typeof t=="function"?t:t==null?gE:typeof t=="object"?no(t)?Yv(t[0],t[1]):jv(t):SE(t)}function Wv(t){if(!aE(t))return mv(t);var e=[];for(var r in Object(t))or.call(t,r)&&r!="constructor"&&e.push(r);return e}function jv(t){var e=oE(t);return e.length==1&&e[0][2]?Kg(e[0][0],e[0][1]):function(r){return r===t||Kv(r,t,e)}}function Yv(t,e){return As(t)&&Gg(e)?Kg(Ts(t),e):function(r){var o=dE(r,t);return o===void 0&&o===e?fE(r,t):nu(e,o,void 0,Ss|Jo)}}function Xv(t){return function(e){return _g(e,t)}}function Jv(t){if(typeof t=="string")return t;if(au(t))return Eg?Eg.call(t):"";var e=t+"";return e=="0"&&1/t==-ru?"-0":e}function Zv(t,e,r){var o=-1,n=WT,i=t.length,c=!0,p=[],u=p;if(r)c=!1,n=jT;else if(i>=xg){var l=e?null:eE(t);if(l)return ou(l);c=!1,n=ov,u=new Xn}else u=e?[]:p;e:for(;++o<i;){var g=t[o],f=e?e(g):g;if(g=r||g!==0?g:0,c&&f===f){for(var y=u.length;y--;)if(u[y]===f)continue e;e&&u.push(f),p.push(g)}else n(u,f,r)||(u!==p&&u.push(f),p.push(g))}return p}function Og(t){return no(t)?t:cE(t)}var eE=Xo&&1/ou(new Xo([,-0]))[1]==ru?function(t){return new Xo(t)}:yE;function qg(t,e,r,o,n,i){var c=n&Jo,p=t.length,u=e.length;if(p!=u&&!(c&&u>p))return!1;var l=i.get(t);if(l&&i.get(e))return l==e;var g=-1,f=!0,y=n&Ss?new Xn:void 0;for(i.set(t,e),i.set(e,t);++g<p;){var h=t[g],S=e[g];if(o)var w=c?o(S,h,g,e,t,i):o(h,S,g,t,e,i);if(w!==void 0){if(w)continue;f=!1;break}if(y){if(!YT(e,function(b,x){if(!y.has(x)&&(h===b||r(h,b,o,n,i)))return y.add(x)})){f=!1;break}}else if(!(h===S||r(h,S,o,n,i))){f=!1;break}}return i.delete(t),i.delete(e),f}function tE(t,e,r,o,n,i,c){switch(r){case gs:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Lg:return!(t.byteLength!=e.byteLength||!o(new vg(t),new vg(e)));case Fg:case Cg:case Rg:return Hg(+t,+e);case Pg:return t.name==e.name&&t.message==e.message;case Dg:case Ng:return t==e+"";case ds:var p=iv;case fs:var u=i&Jo;if(p||(p=ou),t.size!=e.size&&!u)return!1;var l=c.get(t);if(l)return l==e;i|=Ss,c.set(t,e);var g=qg(p(t),p(e),o,n,i,c);return c.delete(t),g;case Bg:if(zp)return zp.call(t)==zp.call(e)}return!1}function rE(t,e,r,o,n,i){var c=n&Jo,p=eu(t),u=p.length,l=eu(e),g=l.length;if(u!=g&&!c)return!1;for(var f=u;f--;){var y=p[f];if(!(c?y in e:or.call(e,y)))return!1}var h=i.get(t);if(h&&i.get(e))return h==e;var S=!0;i.set(t,e),i.set(e,t);for(var w=c;++f<u;){y=p[f];var b=t[y],x=e[y];if(o)var T=c?o(x,b,y,e,t,i):o(b,x,y,t,e,i);if(!(T===void 0?b===x||r(b,x,o,n,i):T)){S=!1;break}w||(w=y=="constructor")}if(S&&!w){var F=t.constructor,P=e.constructor;F!=P&&"constructor"in t&&"constructor"in e&&!(typeof F=="function"&&F instanceof F&&typeof P=="function"&&P instanceof P)&&(S=!1)}return i.delete(t),i.delete(e),S}function bs(t,e){var r=t.__data__;return iE(e)?r[typeof e=="string"?"string":"hash"]:r.map}function oE(t){for(var e=eu(t),r=e.length;r--;){var o=e[r],n=t[o];e[r]=[o,n,Gg(n)]}return e}function en(t,e){var r=nv(t,e);return Hv(r)?r:void 0}var Ir=qv;(Xp&&Ir(new Xp(new ArrayBuffer(1)))!=gs||jn&&Ir(new jn)!=ds||Jp&&Ir(Jp.resolve())!=yg||Xo&&Ir(new Xo)!=fs||Zp&&Ir(new Zp)!=jp)&&(Ir=function(t){var e=Zo.call(t),r=e==jo?t.constructor:void 0,o=r?io(r):void 0;if(o)switch(o){case dv:return gs;case fv:return ds;case gv:return yg;case yv:return fs;case Sv:return jp}return e});function nE(t,e,r){e=As(e,t)?[e]:Og(e);for(var o,n=-1,c=e.length;++n<c;){var i=Ts(e[n]);if(!(o=t!=null&&r(t,i)))break;t=t[i]}if(o)return o;var c=t?t.length:0;return!!c&&su(c)&&Vg(i,c)&&(no(t)||$g(t))}function Vg(t,e){return e=e??Ig,!!e&&(typeof t=="number"||HT.test(t))&&t>-1&&t%1==0&&t<e}function As(t,e){if(no(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||au(t)?!0:_T.test(t)||!QT.test(t)||e!=null&&t in Object(e)}function iE(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function sE(t){return!!Ag&&Ag in t}function aE(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||ws;return t===r}function Gg(t){return t===t&&!vs(t)}function Kg(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var cE=iu(function(t){t=mE(t);var e=[];return OT.test(t)&&e.push(""),t.replace(qT,function(r,o,n,i){e.push(n?i.replace(GT,"$1"):o||r)}),e});function Ts(t){if(typeof t=="string"||au(t))return t;var e=t+"";return e=="0"&&1/t==-ru?"-0":e}function io(t){if(t!=null){try{return Qg.call(t)}catch{}try{return t+""}catch{}}return""}function pE(t,e){return t&&t.length?Zv(t,zv(e,2)):[]}function iu(t,e){if(typeof t!="function"||e&&typeof e!="function")throw new TypeError(FT);var r=function(){var o=arguments,n=e?e.apply(this,o):o[0],i=r.cache;if(i.has(n))return i.get(n);var c=t.apply(this,o);return r.cache=i.set(n,c),c};return r.cache=new(iu.Cache||ir),r}iu.Cache=ir;function Hg(t,e){return t===e||t!==t&&e!==e}function $g(t){return uE(t)&&or.call(t,"callee")&&(!uv.call(t,"callee")||Zo.call(t)==ms)}var no=Array.isArray;function zg(t){return t!=null&&su(t.length)&&!Wg(t)}function uE(t){return Es(t)&&zg(t)}function Wg(t){var e=vs(t)?Zo.call(t):"";return e==kg||e==CT}function su(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Ig}function vs(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Es(t){return!!t&&typeof t=="object"}function au(t){return typeof t=="symbol"||Es(t)&&Zo.call(t)==Bg}var lE=bg?rv(bg):$v;function mE(t){return t==null?"":Jv(t)}function dE(t,e,r){var o=t==null?void 0:_g(t,e);return o===void 0?r:o}function fE(t,e){return t!=null&&nE(t,e,Vv)}function eu(t){return zg(t)?Ov(t):Wv(t)}function gE(t){return t}function yE(){}function SE(t){return As(t)?ev(Ts(t)):Xv(t)}Yo.exports=pE});var yy=je((CG,gy)=>{"use strict";s();a();gy.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var Ty=je((by,Ay)=>{"use strict";s();a();var Rs=yy(),{hasOwnProperty:wy}=Object.prototype,{propertyIsEnumerable:hx}=Object,nn=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),bx=by,Sy={concatArrays:!1,ignoreUndefined:!1},Ds=t=>{let e=[];for(let r in t)wy.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let o of r)hx.call(t,o)&&e.push(o)}return e};function sn(t){return Array.isArray(t)?Ax(t):Rs(t)?Tx(t):t}function Ax(t){let e=t.slice(0,0);return Ds(t).forEach(r=>{nn(e,r,sn(t[r]))}),e}function Tx(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return Ds(t).forEach(r=>{nn(e,r,sn(t[r]))}),e}var hy=(t,e,r,o)=>(r.forEach(n=>{typeof e[n]>"u"&&o.ignoreUndefined||(n in t&&t[n]!==Object.getPrototypeOf(t)?nn(t,n,bu(t[n],e[n],o)):nn(t,n,sn(e[n])))}),t),vx=(t,e,r)=>{let o=t.slice(0,0),n=0;return[t,e].forEach(i=>{let c=[];for(let p=0;p<i.length;p++)wy.call(i,p)&&(c.push(String(p)),i===t?nn(o,n++,i[p]):nn(o,n++,sn(i[p])));o=hy(o,i,Ds(i).filter(p=>!c.includes(p)),r)}),o};function bu(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?vx(t,e,r):!Rs(e)||!Rs(t)?sn(e):hy(t,e,Ds(e),r)}Ay.exports=function(...t){let e=bu(sn(Sy),this!==bx&&this||{},Sy),r={_:{}};for(let o of t)if(o!==void 0){if(!Rs(o))throw new TypeError("`"+o+"` is not an Option Object");r=bu(r,{_:o},e)}return r._}});var cS=je((oi,un)=>{s();a();var Ux=200,Mx="Expected a function",Ru="__lodash_hash_undefined__",Ks=1,ln=2,_y=1/0,Oy=9007199254740991,Ms="[object Arguments]",Eu="[object Array]",qy="[object Boolean]",Vy="[object Date]",Gy="[object Error]",Ky="[object Function]",Qx="[object GeneratorFunction]",Qs="[object Map]",Hy="[object Number]",pn="[object Object]",ky="[object Promise]",$y="[object RegExp]",_s="[object Set]",zy="[object String]",Wy="[object Symbol]",xu="[object WeakMap]",jy="[object ArrayBuffer]",Os="[object DataView]",_x="[object Float32Array]",Ox="[object Float64Array]",qx="[object Int8Array]",Vx="[object Int16Array]",Gx="[object Int32Array]",Kx="[object Uint8Array]",Hx="[object Uint8ClampedArray]",$x="[object Uint16Array]",zx="[object Uint32Array]",Wx=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,jx=/^\w*$/,Yx=/^\./,Xx=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Jx=/[\\^$.*+?()[\]{}|]/g,Zx=/\\(\\)?/g,eI=/^\[object .+?Constructor\]$/,tI=/^(?:0|[1-9]\d*)$/,Se={};Se[_x]=Se[Ox]=Se[qx]=Se[Vx]=Se[Gx]=Se[Kx]=Se[Hx]=Se[$x]=Se[zx]=!0;Se[Ms]=Se[Eu]=Se[jy]=Se[qy]=Se[Os]=Se[Vy]=Se[Gy]=Se[Ky]=Se[Qs]=Se[Hy]=Se[pn]=Se[$y]=Se[_s]=Se[zy]=Se[xu]=!1;var Yy=typeof self=="object"&&self&&self.Object===Object&&self,rI=typeof self=="object"&&self&&self.Object===Object&&self,Rr=Yy||rI||Function("return this")(),Xy=typeof oi=="object"&&oi&&!oi.nodeType&&oi,Ry=Xy&&typeof un=="object"&&un&&!un.nodeType&&un,oI=Ry&&Ry.exports===Xy,Dy=oI&&Yy.process,Ny=function(){try{return Dy&&Dy.binding("util")}catch{}}(),By=Ny&&Ny.isTypedArray;function nI(t,e,r,o){for(var n=-1,i=t?t.length:0;++n<i;){var c=t[n];e(o,c,r(c),t)}return o}function iI(t,e){for(var r=-1,o=t?t.length:0;++r<o;)if(e(t[r],r,t))return!0;return!1}function sI(t){return function(e){return e?.[t]}}function aI(t,e){for(var r=-1,o=Array(t);++r<t;)o[r]=e(r);return o}function cI(t){return function(e){return t(e)}}function pI(t,e){return t?.[e]}function Iu(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function uI(t){var e=-1,r=Array(t.size);return t.forEach(function(o,n){r[++e]=[n,o]}),r}function lI(t,e){return function(r){return t(e(r))}}function mI(t){var e=-1,r=Array(t.size);return t.forEach(function(o){r[++e]=o}),r}var dI=Array.prototype,fI=Function.prototype,Hs=Object.prototype,Tu=Rr["__core-js_shared__"],Ly=function(){var t=/[^.]+$/.exec(Tu&&Tu.keys&&Tu.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Jy=fI.toString,pr=Hs.hasOwnProperty,mn=Hs.toString,gI=RegExp("^"+Jy.call(pr).replace(Jx,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Uy=Rr.Symbol,My=Rr.Uint8Array,yI=Hs.propertyIsEnumerable,SI=dI.splice,wI=lI(Object.keys,Object),Fu=dn(Rr,"DataView"),ni=dn(Rr,"Map"),Cu=dn(Rr,"Promise"),Pu=dn(Rr,"Set"),ku=dn(Rr,"WeakMap"),ii=dn(Object,"create"),hI=lo(Fu),bI=lo(ni),AI=lo(Cu),TI=lo(Pu),vI=lo(ku),qs=Uy?Uy.prototype:void 0,vu=qs?qs.valueOf:void 0,Qy=qs?qs.toString:void 0;function uo(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}function EI(){this.__data__=ii?ii(null):{}}function xI(t){return this.has(t)&&delete this.__data__[t]}function II(t){var e=this.__data__;if(ii){var r=e[t];return r===Ru?void 0:r}return pr.call(e,t)?e[t]:void 0}function FI(t){var e=this.__data__;return ii?e[t]!==void 0:pr.call(e,t)}function CI(t,e){var r=this.__data__;return r[t]=ii&&e===void 0?Ru:e,this}uo.prototype.clear=EI;uo.prototype.delete=xI;uo.prototype.get=II;uo.prototype.has=FI;uo.prototype.set=CI;function ur(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}function PI(){this.__data__=[]}function kI(t){var e=this.__data__,r=$s(e,t);if(r<0)return!1;var o=e.length-1;return r==o?e.pop():SI.call(e,r,1),!0}function RI(t){var e=this.__data__,r=$s(e,t);return r<0?void 0:e[r][1]}function DI(t){return $s(this.__data__,t)>-1}function NI(t,e){var r=this.__data__,o=$s(r,t);return o<0?r.push([t,e]):r[o][1]=e,this}ur.prototype.clear=PI;ur.prototype.delete=kI;ur.prototype.get=RI;ur.prototype.has=DI;ur.prototype.set=NI;function lr(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}function BI(){this.__data__={hash:new uo,map:new(ni||ur),string:new uo}}function LI(t){return zs(this,t).delete(t)}function UI(t){return zs(this,t).get(t)}function MI(t){return zs(this,t).has(t)}function QI(t,e){return zs(this,t).set(t,e),this}lr.prototype.clear=BI;lr.prototype.delete=LI;lr.prototype.get=UI;lr.prototype.has=MI;lr.prototype.set=QI;function Vs(t){var e=-1,r=t?t.length:0;for(this.__data__=new lr;++e<r;)this.add(t[e])}function _I(t){return this.__data__.set(t,Ru),this}function OI(t){return this.__data__.has(t)}Vs.prototype.add=Vs.prototype.push=_I;Vs.prototype.has=OI;function cr(t){this.__data__=new ur(t)}function qI(){this.__data__=new ur}function VI(t){return this.__data__.delete(t)}function GI(t){return this.__data__.get(t)}function KI(t){return this.__data__.has(t)}function HI(t,e){var r=this.__data__;if(r instanceof ur){var o=r.__data__;if(!ni||o.length<Ux-1)return o.push([t,e]),this;r=this.__data__=new lr(o)}return r.set(t,e),this}cr.prototype.clear=qI;cr.prototype.delete=VI;cr.prototype.get=GI;cr.prototype.has=KI;cr.prototype.set=HI;function $I(t,e){var r=kr(t)||sS(t)?aI(t.length,String):[],o=r.length,n=!!o;for(var i in t)(e||pr.call(t,i))&&!(n&&(i=="length"||rS(i,o)))&&r.push(i);return r}function $s(t,e){for(var r=t.length;r--;)if(iS(t[r][0],e))return r;return-1}function zI(t,e,r,o){return WI(t,function(n,i,c){e(o,n,r(n),c)}),o}var WI=uF(YI),jI=lF();function YI(t,e){return t&&jI(t,e,Gs)}function Zy(t,e){e=Ws(e,t)?[e]:eS(e);for(var r=0,o=e.length;t!=null&&r<o;)t=t[js(e[r++])];return r&&r==o?t:void 0}function XI(t){return mn.call(t)}function JI(t,e){return t!=null&&e in Object(t)}function Du(t,e,r,o,n){return t===e?!0:t==null||e==null||!Ys(t)&&!Xs(e)?t!==t&&e!==e:ZI(t,e,Du,r,o,n)}function ZI(t,e,r,o,n,i){var c=kr(t),p=kr(e),u=Eu,l=Eu;c||(u=Pr(t),u=u==Ms?pn:u),p||(l=Pr(e),l=l==Ms?pn:l);var g=u==pn&&!Iu(t),f=l==pn&&!Iu(e),y=u==l;if(y&&!g)return i||(i=new cr),c||TF(t)?tS(t,e,r,o,n,i):mF(t,e,u,r,o,n,i);if(!(n&ln)){var h=g&&pr.call(t,"__wrapped__"),S=f&&pr.call(e,"__wrapped__");if(h||S){var w=h?t.value():t,b=S?e.value():e;return i||(i=new cr),r(w,b,o,n,i)}}return y?(i||(i=new cr),dF(t,e,r,o,n,i)):!1}function eF(t,e,r,o){var n=r.length,i=n,c=!o;if(t==null)return!i;for(t=Object(t);n--;){var p=r[n];if(c&&p[2]?p[1]!==t[p[0]]:!(p[0]in t))return!1}for(;++n<i;){p=r[n];var u=p[0],l=t[u],g=p[1];if(c&&p[2]){if(l===void 0&&!(u in t))return!1}else{var f=new cr;if(o)var y=o(l,g,u,t,e,f);if(!(y===void 0?Du(g,l,o,Ks|ln,f):y))return!1}}return!0}function tF(t){if(!Ys(t)||SF(t))return!1;var e=aS(t)||Iu(t)?gI:eI;return e.test(lo(t))}function rF(t){return Xs(t)&&Lu(t.length)&&!!Se[mn.call(t)]}function oF(t){return typeof t=="function"?t:t==null?IF:typeof t=="object"?kr(t)?sF(t[0],t[1]):iF(t):FF(t)}function nF(t){if(!wF(t))return wI(t);var e=[];for(var r in Object(t))pr.call(t,r)&&r!="constructor"&&e.push(r);return e}function iF(t){var e=fF(t);return e.length==1&&e[0][2]?nS(e[0][0],e[0][1]):function(r){return r===t||eF(r,t,e)}}function sF(t,e){return Ws(t)&&oS(e)?nS(js(t),e):function(r){var o=EF(r,t);return o===void 0&&o===e?xF(r,t):Du(e,o,void 0,Ks|ln)}}function aF(t){return function(e){return Zy(e,t)}}function cF(t){if(typeof t=="string")return t;if(Uu(t))return Qy?Qy.call(t):"";var e=t+"";return e=="0"&&1/t==-_y?"-0":e}function eS(t){return kr(t)?t:hF(t)}function pF(t,e){return function(r,o){var n=kr(r)?nI:zI,i=e?e():{};return n(r,t,oF(o,2),i)}}function uF(t,e){return function(r,o){if(r==null)return r;if(!Bu(r))return t(r,o);for(var n=r.length,i=e?n:-1,c=Object(r);(e?i--:++i<n)&&o(c[i],i,c)!==!1;);return r}}function lF(t){return function(e,r,o){for(var n=-1,i=Object(e),c=o(e),p=c.length;p--;){var u=c[t?p:++n];if(r(i[u],u,i)===!1)break}return e}}function tS(t,e,r,o,n,i){var c=n&ln,p=t.length,u=e.length;if(p!=u&&!(c&&u>p))return!1;var l=i.get(t);if(l&&i.get(e))return l==e;var g=-1,f=!0,y=n&Ks?new Vs:void 0;for(i.set(t,e),i.set(e,t);++g<p;){var h=t[g],S=e[g];if(o)var w=c?o(S,h,g,e,t,i):o(h,S,g,t,e,i);if(w!==void 0){if(w)continue;f=!1;break}if(y){if(!iI(e,function(b,x){if(!y.has(x)&&(h===b||r(h,b,o,n,i)))return y.add(x)})){f=!1;break}}else if(!(h===S||r(h,S,o,n,i))){f=!1;break}}return i.delete(t),i.delete(e),f}function mF(t,e,r,o,n,i,c){switch(r){case Os:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case jy:return!(t.byteLength!=e.byteLength||!o(new My(t),new My(e)));case qy:case Vy:case Hy:return iS(+t,+e);case Gy:return t.name==e.name&&t.message==e.message;case $y:case zy:return t==e+"";case Qs:var p=uI;case _s:var u=i&ln;if(p||(p=mI),t.size!=e.size&&!u)return!1;var l=c.get(t);if(l)return l==e;i|=Ks,c.set(t,e);var g=tS(p(t),p(e),o,n,i,c);return c.delete(t),g;case Wy:if(vu)return vu.call(t)==vu.call(e)}return!1}function dF(t,e,r,o,n,i){var c=n&ln,p=Gs(t),u=p.length,l=Gs(e),g=l.length;if(u!=g&&!c)return!1;for(var f=u;f--;){var y=p[f];if(!(c?y in e:pr.call(e,y)))return!1}var h=i.get(t);if(h&&i.get(e))return h==e;var S=!0;i.set(t,e),i.set(e,t);for(var w=c;++f<u;){y=p[f];var b=t[y],x=e[y];if(o)var T=c?o(x,b,y,e,t,i):o(b,x,y,t,e,i);if(!(T===void 0?b===x||r(b,x,o,n,i):T)){S=!1;break}w||(w=y=="constructor")}if(S&&!w){var F=t.constructor,P=e.constructor;F!=P&&"constructor"in t&&"constructor"in e&&!(typeof F=="function"&&F instanceof F&&typeof P=="function"&&P instanceof P)&&(S=!1)}return i.delete(t),i.delete(e),S}function zs(t,e){var r=t.__data__;return yF(e)?r[typeof e=="string"?"string":"hash"]:r.map}function fF(t){for(var e=Gs(t),r=e.length;r--;){var o=e[r],n=t[o];e[r]=[o,n,oS(n)]}return e}function dn(t,e){var r=pI(t,e);return tF(r)?r:void 0}var Pr=XI;(Fu&&Pr(new Fu(new ArrayBuffer(1)))!=Os||ni&&Pr(new ni)!=Qs||Cu&&Pr(Cu.resolve())!=ky||Pu&&Pr(new Pu)!=_s||ku&&Pr(new ku)!=xu)&&(Pr=function(t){var e=mn.call(t),r=e==pn?t.constructor:void 0,o=r?lo(r):void 0;if(o)switch(o){case hI:return Os;case bI:return Qs;case AI:return ky;case TI:return _s;case vI:return xu}return e});function gF(t,e,r){e=Ws(e,t)?[e]:eS(e);for(var o,n=-1,c=e.length;++n<c;){var i=js(e[n]);if(!(o=t!=null&&r(t,i)))break;t=t[i]}if(o)return o;var c=t?t.length:0;return!!c&&Lu(c)&&rS(i,c)&&(kr(t)||sS(t))}function rS(t,e){return e=e??Oy,!!e&&(typeof t=="number"||tI.test(t))&&t>-1&&t%1==0&&t<e}function Ws(t,e){if(kr(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Uu(t)?!0:jx.test(t)||!Wx.test(t)||e!=null&&t in Object(e)}function yF(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function SF(t){return!!Ly&&Ly in t}function wF(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Hs;return t===r}function oS(t){return t===t&&!Ys(t)}function nS(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var hF=Nu(function(t){t=vF(t);var e=[];return Yx.test(t)&&e.push(""),t.replace(Xx,function(r,o,n,i){e.push(n?i.replace(Zx,"$1"):o||r)}),e});function js(t){if(typeof t=="string"||Uu(t))return t;var e=t+"";return e=="0"&&1/t==-_y?"-0":e}function lo(t){if(t!=null){try{return Jy.call(t)}catch{}try{return t+""}catch{}}return""}var bF=pF(function(t,e,r){t[r]=e});function Nu(t,e){if(typeof t!="function"||e&&typeof e!="function")throw new TypeError(Mx);var r=function(){var o=arguments,n=e?e.apply(this,o):o[0],i=r.cache;if(i.has(n))return i.get(n);var c=t.apply(this,o);return r.cache=i.set(n,c),c};return r.cache=new(Nu.Cache||lr),r}Nu.Cache=lr;function iS(t,e){return t===e||t!==t&&e!==e}function sS(t){return AF(t)&&pr.call(t,"callee")&&(!yI.call(t,"callee")||mn.call(t)==Ms)}var kr=Array.isArray;function Bu(t){return t!=null&&Lu(t.length)&&!aS(t)}function AF(t){return Xs(t)&&Bu(t)}function aS(t){var e=Ys(t)?mn.call(t):"";return e==Ky||e==Qx}function Lu(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Oy}function Ys(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Xs(t){return!!t&&typeof t=="object"}function Uu(t){return typeof t=="symbol"||Xs(t)&&mn.call(t)==Wy}var TF=By?cI(By):rF;function vF(t){return t==null?"":cF(t)}function EF(t,e,r){var o=t==null?void 0:Zy(t,e);return o===void 0?r:o}function xF(t,e){return t!=null&&gF(t,e,JI)}function Gs(t){return Bu(t)?$I(t):nF(t)}function IF(t){return t}function FF(t){return Ws(t)?sI(js(t)):aF(t)}un.exports=bF});var ha=je(Pl=>{"use strict";s();a();Object.defineProperty(Pl,"__esModule",{value:!0});var Hw=M();function SP(t){var e=Hw.useRef();return Hw.useEffect(function(){e.current=t}),e.current}Pl.default=SP});s();a();s();a();s();a();var NA=d.object({balance:d.boolean(),history:d.boolean()}),oN=d.record(d.string(),NA),Zi=class extends Error{constructor(e){super(e),this.name="SetTermsAcknowledgementError"}};var $d=async(t,e)=>{try{return await t.set("termsHaveBeenAcknowledged2",e)}catch{throw new Zi("Error Setting Terms Acknowledgement")}};async function BA(t){return(await t.get("onboardedAt"))?.onboardedAt}async function zd(t,e=Date.now()){e&&!await BA(t)?await t.set("onboardedAt",{onboardedAt:e}):e||await t.remove("onboardedAt")}s();a();s();a();var rf=N(Yd(),1),of=N(tf(),1),ep=N(PA(),1),Ko=(t=>(t.BLOCK="BLOCK",t.NONE="NONE",t))(Ko||{});function LA(t,e){for(let r=0;r<t.k;r++){let o=(0,of.default)(`${t.salt}_${e}_${r}`,{asBytes:!0}),i=ep.Buffer.from(o).subarray(0,4).readUInt32BE(0)%t.bits,c=Math.floor(i/24),p=ep.Buffer.from(t.bitVector.slice(c*4,c*4+4),"base64"),u=i%24,l=Math.floor(u/8),g=u%8;if(!(p[l]&1<<7-g))return!1}return!0}var FN=typeof self<"u"&&self.fetch?self.fetch:rf.default;function tp(t,e,r,o){let i=new URL(o).hostname.toLowerCase().split(".");for(let c=0;c<i.length-1;c++){let p=i.slice(c).join(".");if(e.includes(p)||LA(t,p)&&!r.includes(p))return"BLOCK"}return"NONE"}var ts=N(af());var gf=N(uf());s();a();var lf="https://blocklist.phantom.app/multichain.json",np="https://blowfish-blocklist-proxy.phantom.app",HA="https://github.com/phantom-labs/blocklist",ip=(t=3)=>({retry:t,retryDelay:e=>Math.min(1e3*2**e,3e4)}),Mt={SLIPPAGE_EXCEEDED:"SLIPPAGE_EXCEEDED",INSUFFICIENT_FUNDS:"INSUFFICIENT_FUNDS",INSUFFICIENT_GAS:"INSUFFICIENT_GAS",UNKNOWN_ERROR:"UNKNOWN_ERROR",SIMULATION_FAILED:"SIMULATION_FAILED",TRANSACTION_EXPIRED:"TRANSACTION_EXPIRED",ACCOUNT_FROZEN:"ACCOUNT_FROZEN",SIMULATION_TIMEOUT:"SIMULATION_TIMEOUT",STALE_QUOTE:"STALE_QUOTE"};function $A(t){return{1:"1-critical-alert",2:"2-alert",3:"3-critical-error",4:"4-error",5:"5-information"}[t]}var WA=3,pp=6e5,jA=6e4,XN=d.object({type:d.union([d.literal("all"),d.literal("blocklist"),d.literal("whitelist"),d.literal("error"),d.literal("fuzzy"),d.literal("blowfishBloomFilter")]),result:d.boolean(),source:d.optional(d.string()),match:d.string().optional(),isSubdomainDomainWhitelisted:d.boolean().optional()}),JN=d.object({localHash:d.any(),cursor:d.any()}),up=d.object({bitVector:d.string(),k:d.number(),hash:d.string(),bits:d.number(),salt:d.string()}),yf=d.union([d.object({bloomFilter:up,bloomFilterHash:d.string(),recentlyAdded:d.array(d.string()),recentlyRemoved:d.array(d.string()),nextCursor:d.string()}),d.object({bloomFilter:up.optional(),bloomFilterHash:d.optional(d.string()),recentlyAdded:d.array(d.string()),recentlyRemoved:d.array(d.string()),nextCursor:d.string()})]),Sf=d.object({bloomFilter:up,lastUpdated:d.number()}).nullish(),wf=d.object({recentlyAdded:d.array(d.string()),recentlyRemoved:d.array(d.string()),lastUpdated:d.number().optional()}).nullish(),Gn=class{blocklist;whitelist;fuzzylist;tolerance;constructor(e,r,o,n){this.blocklist=sp(e),this.whitelist=sp(r),this.fuzzylist=sp(o),this.tolerance=n||WA}check(e,r){if(!e)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=rs(e),n=lp(o);if(XA(n,this.whitelist)){let u=new URL(e).hostname;if(ap(lp(u),this.blocklist)){let g={type:"blocklist",result:!0,source:u,isSubdomainDomainWhitelisted:!0};return r.capture("blockedDomain",{data:g}),g}else return{type:"whitelist",result:!1,source:u,isSubdomainDomainWhitelisted:!0}}if(ap(n,this.whitelist))return{type:"whitelist",result:!1,source:o,isSubdomainDomainWhitelisted:!1};if(ap(n,this.blocklist)){let u={type:"blocklist",result:!0,source:o,isSubdomainDomainWhitelisted:!1};return r.capture("blockedDomain",{data:u}),u}if(this.tolerance>0){let u=mf(n);u=u.replace("www.","");let l=this.fuzzylist.find(g=>{let f=mf(g);return gf.default.get(u,f)<=this.tolerance});if(l)return{type:"fuzzy",result:!0,match:YA(l),source:o,isSubdomainDomainWhitelisted:!1}}return{type:"all",result:!1,source:o,isSubdomainDomainWhitelisted:!1}}},rs=t=>{let e=new URL(t).hostname.split(".");return e.slice(0).slice(-(e.length===4?3:2)).join(".")},sp=t=>t.map(lp),lp=t=>t.split(".").reverse(),YA=t=>t.slice().reverse().join("."),mf=t=>t.slice(1).reverse().join("."),ap=(t,e)=>e.some(r=>r.length>t.length?!1:r.every((o,n)=>t[n]===o)),XA=(t,e)=>e.some(r=>r[0]===t[0]&&r[1]===t[1]&&r[2]==="*"),JA=async t=>{let e=(0,ts.getBlocklist)(),r=await t.get("cachedBlocklistDiff"),o=null;try{o=JSON.parse(`${r}`)}catch(n){Q.captureError(new Error(`Error parsing blocklist diff: ${n?.message}`),"generic")}if(o&&o.expiresAt&&o.expiresAt>Date.now())return new Gn(e.blocklist.concat(o.blocklist),e.whitelist.concat(o.whitelist),e.fuzzylist.concat(o.fuzzylist));{let n={},i=(0,ts.getVersion)();o&&(n.lastContentHash=`${o.contentHash}`),i&&(n.localBlocklistVersion=`${i}`);let c=await j.headers(n).get(lf);if(c.status===200){let p=c.data;return p.expiresAt=Date.now()+pp,t.set("cachedBlocklistDiff",JSON.stringify(p)),new Gn(e.blocklist.concat(p.blocklist),e.whitelist.concat(p.whitelist),e.fuzzylist.concat(p.fuzzylist))}else{if(c.status===304)return o.expiresAt=Date.now()+pp,t.set("cachedBlocklistDiff",JSON.stringify(o)),new Gn(e.blocklist.concat(o.blocklist),e.whitelist.concat(o.whitelist),e.fuzzylist.concat(o.fuzzylist));throw new Error("Invalid response from blocklist")}}},mp=async(t,e,r)=>{let o,n;try{let c=await Ui(e.getFeatureFlags(),1e3);o=!!c["kill-blowfish-blocklist-cursor"],n=!!c["kill-previous-blocklist"]}catch{o=!1,n=!1}let i;try{if(n)return o?ff(r,t,e):df(r,t,e);{i=await JA(t);let c=i.check(r,e);return c.type==="all"?o?ff(r,t,e):df(r,t,e):c}}catch{return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}}},df=async(t,e,r)=>{if(!t)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=rs(t),n=await e.getAll(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents","cachedScanDataCursor"]),i=n.cachedBloomFilter??null,c=n.cachedBloomFilterHash??null,p=n.cachedScanDataCursor??null,u=n.cachedScanDataRecents??null,l=null,g={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0},f=null;if(i){let h=Sf.safeParse(i);h.success?l=h.data:await cp(e)}if(u){let h=wf.safeParse(u);h.success?g=h.data:await cp(e)}if(p){let S=d.string().safeParse(p);S.success?f=S.data:await cp(e)}if(!g||g.lastUpdated==null||Date.now()>g.lastUpdated+jA){let h={localHash:c,cursor:f},S=await j.post(np,h);if(S.status!==200)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let w=S.data,b,x=yf.safeParse(w);if(x.success)b=x.data;else return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let T=[],F=[],P=typeof c=="string"&&b.bloomFilterHash?c!==b.bloomFilterHash:!1;g!=null&&!P&&(T=g.recentlyAdded,F=g.recentlyRemoved),T=T.concat(b.recentlyAdded),F=F.concat(b.recentlyRemoved),T=T.filter(R=>b.recentlyRemoved.indexOf(R)<0),F=F.filter(R=>b.recentlyAdded.indexOf(R)<0);let B={recentlyAdded:T,recentlyRemoved:F,lastUpdated:Date.now()};if(await e.set("cachedScanDataRecents",B),g=B,b.nextCursor!==f&&await e.set("cachedScanDataCursor",b.nextCursor),b.bloomFilter!=null){let R={bloomFilter:b.bloomFilter,lastUpdated:Date.now()};await Promise.all([e.set("cachedBloomFilter",R),e.set("cachedBloomFilterHash",b.bloomFilterHash)]),l=R}}if(!l)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let y=tp(l.bloomFilter,g.recentlyAdded,g.recentlyRemoved,t);if(y===Ko.BLOCK){let h={result:!0,source:o,type:"blowfishBloomFilter"};return r.capture("blockedDomain",{data:h}),h}else if(y===Ko.NONE)return{result:!1,type:"all",isSubdomainDomainWhitelisted:!1};return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}};async function cp(t){await t.remove(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents","cachedScanDataCursor"])}var ff=async(t,e,r)=>{if(!t)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=rs(t),n=await e.getAll(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents"]),i=n.cachedBloomFilter??null,c=n.cachedBloomFilterHash??null,p=n.cachedScanDataRecents??null,u=null,l={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0};if(i){let f=Sf.safeParse(i);f.success?u=f.data:await e.remove(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents"])}if(p){let f=wf.safeParse(p);f.success?l=f.data:await e.remove(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents"])}if(!l||l.lastUpdated==null||Date.now()>l.lastUpdated+pp){let f={localHash:c},y=await j.post(np,f);if(y.status!==200)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let h=y.data,S,w=yf.safeParse(h);if(w.success)S=w.data;else return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let b={recentlyAdded:S.recentlyAdded,recentlyRemoved:S.recentlyRemoved,lastUpdated:Date.now()};if(await e.set("cachedScanDataRecents",b),l=b,S.bloomFilter!=null){let x={bloomFilter:S.bloomFilter,lastUpdated:Date.now()};await Promise.all([e.set("cachedBloomFilter",x),e.set("cachedBloomFilterHash",S.bloomFilterHash)]),u=x}}if(!u)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let g=tp(u.bloomFilter,l.recentlyAdded,l.recentlyRemoved,t);if(g===Ko.BLOCK){let f={result:!0,source:o,type:"blowfishBloomFilter"};return r.capture("blockedDomain",{data:f}),f}else if(g===Ko.NONE)return{result:!1,type:"all",isSubdomainDomainWhitelisted:!1};return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}};s();a();s();a();var ZA=t=>t/1e8;s();a();s();a();var os={GREEN:"accentSuccess",RED:"accentAlert",WHITE:"textPrimary"};function tT(t){switch(t){case"PLUS":return os.GREEN;case"MINUS":return os.RED;case"EQUAL":return os.WHITE;default:return os.WHITE}}function rT(t){let e=t?.advancedDetails&&"safeguard"in t.advancedDetails?t?.advancedDetails?.safeguard:void 0;if(e?.recommended&&!e?.shouldBundle&&!e.error&&!e.verifyError&&e?.transactions&&e.transactions.length>0)return e.transactions}function hf(t,e){if(t.params&&"safeguard"in t.params&&t.params.safeguard&&e?.advancedDetails&&"safeguard"in e.advancedDetails&&e.advancedDetails.safeguard?.transactions){let r=e.advancedDetails.safeguard;if(r.error)return r.error;let o=t.params.transactions,n=r.transactions;if(n){let i;try{Pd(o,n)}catch(c){c instanceof Vo?i=c:c instanceof Error?i=Vo.createUnknownError(c.message):i=Vo.createUnknownError("Non error type",c)}if(i)return e.advancedDetails.safeguard.verifyError=i,i}}}function bf(t){if(t.advancedDetails&&"requestId"in t.advancedDetails)return t.advancedDetails.requestId}s();a();s();a();var dp=async(t,e,r)=>{let o=`/simulation/v1?language=${t}`,n=await j.api().post(o,{...r,chainId:r.networkID,appVersion:he,platform:_e,deviceId:e});if(!ne(n))throw new Error("Failed to scan message");return n.data},Kn=async(t,e,r)=>{let o=`/simulation/v1?language=${t}`,n={...r.params,...r.params&&"safeguard"in r.params?{safeguard:{...r.params.safeguard,lighthouseProgramId:Cd}}:{}},i=await j.api().post(o,{...r,chainId:r.networkID,params:n,metadata:r.metadata,appVersion:he,platform:_e,deviceId:e});if(!ne(i))throw new Error("Failed to scan transaction");let c=i.data,p=hf(r,c);if(p instanceof Vo){let u=bf(c);Q.captureMessage(`Verify error ${u??""}: ${p.message}`,"safeguard")}return c};var kB=d.union([d.literal("signTransaction"),d.literal("signAllTransactions"),d.literal("signAndSendTransaction"),d.literal("signAndSendAllTransactions")]);s();a();var oT=0;function nt(t,e){let r=`atom${++oT}`,o={toString(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&this.debugLabel?r+":"+this.debugLabel:r}};return typeof t=="function"?o.read=t:(o.init=t,o.read=nT,o.write=iT),e&&(o.write=e),o}function nT(t){return t(this)}function iT(t,e,r){return e(this,typeof r=="function"?r(t(this)):r)}var Af=(t,e)=>t.unstable_is?t.unstable_is(e):e===t,gp=t=>"init"in t,fp=t=>!!t.write,is=new WeakMap,yp=t=>{var e;return Sp(t)&&!((e=is.get(t))!=null&&e[1])},sT=(t,e)=>{let r=is.get(t);if(r)r[1]=!0,r[0].forEach(o=>o(e));else if((import.meta.env?import.meta.env.MODE:void 0)!=="production")throw new Error("[Bug] cancelable promise not found")},aT=t=>{if(is.has(t))return;let e=[new Set,!1];is.set(t,e);let r=()=>{e[1]=!0};t.then(r,r),t.onCancel=o=>{e[0].add(o)}},Sp=t=>typeof t?.then=="function",Tf=t=>"v"in t||"e"in t,ns=t=>{if("e"in t)throw t.e;if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("v"in t))throw new Error("[Bug] atom state is not initialized");return t.v},vf=(t,e,r)=>{r.p.has(t)||(r.p.add(t),e.then(()=>{r.p.delete(t)},()=>{r.p.delete(t)}))},cT=(t,e,r,o)=>{var n;if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&r===t)throw new Error("[Bug] atom cannot depend on itself");e.d.set(r,o.n),yp(e.v)&&vf(t,e.v,o),(n=o.m)==null||n.t.add(t)},pT=Symbol.for("JOTAI.EXPERIMENTAL.FLUSHSTOREHOOK"),Ef=(...t)=>{let[e,r,o,n,i,c]=t,p=E=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!E)throw new Error("Atom is undefined or null");let C=e(E);return C||(C={d:new Map,p:new Set,n:0},r(E,C),i?.(E,v)),C},u=new WeakMap,l=new Map,g=new Set,f=new Set,y=()=>{var E;let C=[],U=_=>{try{_()}catch(k){C.push(k)}};do{(E=v[pT])==null||E.call(v);let _=new Set,k=_.add.bind(_);l.forEach(O=>{var V;return(V=O.m)==null?void 0:V.l.forEach(k)}),l.clear(),g.forEach(k),g.clear(),f.forEach(k),f.clear(),_.forEach(U),l.size&&T()}while(l.size||g.size||f.size);if(C.length)throw C[0]},h=(E,C,U)=>{let _="v"in C,k=C.v,O=yp(C.v)?C.v:null;if(Sp(U)){aT(U);for(let V of C.d.keys())vf(E,U,p(V));C.v=U}else C.v=U;delete C.e,(!_||!Object.is(k,C.v))&&(++C.n,O&&sT(O,U))},S=E=>{var C;let U=p(E);if(Tf(U)&&(U.m&&u.get(E)!==U.n||Array.from(U.d).every(([pe,Qe])=>S(pe).n===Qe)))return U;U.d.clear();let _=!0,k=()=>{U.m&&(B(E,U),T(),y())},O=pe=>{if(Af(E,pe)){let Ct=p(pe);if(!Tf(Ct))if(gp(pe))h(pe,Ct,pe.init);else throw new Error("no atom init");return ns(Ct)}let Qe=S(pe);try{return ns(Qe)}finally{cT(E,U,pe,Qe),_||k()}},V,D,ce={get signal(){return V||(V=new AbortController),V.signal},get setSelf(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!fp(E)&&console.warn("setSelf function cannot be used with read-only atom"),!D&&fp(E)&&(D=(...pe)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&_&&console.warn("setSelf function cannot be called in sync"),!_)return P(E,...pe)}),D}};try{let pe=o(E,O,ce);return h(E,U,pe),Sp(pe)&&((C=pe.onCancel)==null||C.call(pe,()=>V?.abort()),pe.then(k,k)),U}catch(pe){return delete U.v,U.e=pe,++U.n,U}finally{_=!1}},w=E=>ns(S(E)),b=E=>{var C;let U=new Map;for(let _ of((C=E.m)==null?void 0:C.t)||[]){let k=p(_);k.m&&U.set(_,k)}for(let _ of E.p)U.set(_,p(_));return U},x=E=>{let C=[E];for(;C.length;){let U=C.pop();for(let[_,k]of b(U))u.has(_)||(u.set(_,k.n),C.push(k))}},T=()=>{var E;let C=[],U=new WeakSet,_=new WeakSet,k=Array.from(l);for(;k.length;){let[O,V]=k[k.length-1];if(_.has(O)){k.pop();continue}if(U.has(O)){u.get(O)===V.n?C.push([O,V,V.n]):(u.delete(O),l.set(O,V)),_.add(O),k.pop();continue}U.add(O);for(let[D,ce]of b(V))U.has(D)||k.push([D,ce])}for(let O=C.length-1;O>=0;--O){let[V,D,ce]=C[O],pe=!1;for(let Qe of D.d.keys())if(Qe!==V&&l.has(Qe)){pe=!0;break}pe&&(S(V),B(V,D),ce!==D.n&&(l.set(V,D),(E=D.u)==null||E.call(D))),u.delete(V)}},F=(E,...C)=>{let U=!0,_=O=>ns(S(O)),k=(O,...V)=>{var D;let ce=p(O);try{if(Af(E,O)){if(!gp(O))throw new Error("atom not writable");let pe=ce.n,Qe=V[0];h(O,ce,Qe),B(O,ce),pe!==ce.n&&(l.set(O,ce),(D=ce.u)==null||D.call(ce),x(ce));return}else return F(O,...V)}finally{U||(T(),y())}};try{return n(E,_,k,...C)}finally{U=!1}},P=(E,...C)=>{try{return F(E,...C)}finally{T(),y()}},B=(E,C)=>{var U;if(C.m&&!yp(C.v)){for(let[_,k]of C.d)if(!C.m.d.has(_)){let O=p(_);R(_,O).t.add(E),C.m.d.add(_),k!==O.n&&(l.set(_,O),(U=O.u)==null||U.call(O),x(O))}for(let _ of C.m.d||[])if(!C.d.has(_)){C.m.d.delete(_);let k=q(_,p(_));k?.t.delete(E)}}},R=(E,C)=>{var U;if(!C.m){S(E);for(let _ of C.d.keys())R(_,p(_)).t.add(E);if(C.m={l:new Set,d:new Set(C.d.keys()),t:new Set},(U=C.h)==null||U.call(C),fp(E)){let _=C.m,k=()=>{let O=!0,V=(...D)=>{try{return F(E,...D)}finally{O||(T(),y())}};try{let D=c(E,V);D&&(_.u=()=>{O=!0;try{D()}finally{O=!1}})}finally{O=!1}};f.add(k)}}return C.m},q=(E,C)=>{var U;if(C.m&&!C.m.l.size&&!Array.from(C.m.t).some(_=>{var k;return(k=p(_).m)==null?void 0:k.d.has(E)})){let _=C.m.u;_&&g.add(_),delete C.m,(U=C.h)==null||U.call(C);for(let k of C.d.keys()){let O=q(k,p(k));O?.t.delete(E)}return}return C.m},v={get:w,set:P,sub:(E,C)=>{let U=p(E),k=R(E,U).l;return k.add(C),y(),()=>{k.delete(C),q(E,U),y()}},unstable_derive:E=>Ef(...E(...t))};return v},uT=t=>{let e=new Set,r,o=0,n=t.unstable_derive((...p)=>{let[u,l,,g]=p;return r=u,p[1]=function(y,h){l(y,h);let S=h.h;h.h=()=>{S?.(),h.m?e.add(y):e.delete(y)}},p[3]=function(y,h,S,...w){return o?S(y,...w):g(y,h,S,...w)},p}),i=n.set;return Object.assign(n,{dev4_get_internal_weak_map:()=>({get:p=>{let u=r(p);if(!(!u||u.n===0))return u}}),dev4_get_mounted_atoms:()=>e,dev4_restore_atoms:p=>{i({read:()=>null,write:(l,g)=>{++o;try{for(let[f,y]of p)gp(f)&&g(f,y)}finally{--o}}})}})},wp=()=>{let t=new WeakMap,e=Ef(r=>t.get(r),(r,o)=>t.set(r,o).get(r),(r,...o)=>r.read(...o),(r,...o)=>r.write(...o),(r,...o)=>{var n;return(n=r.unstable_onInit)==null?void 0:n.call(r,...o)},(r,...o)=>{var n;return(n=r.onMount)==null?void 0:n.call(r,...o)});return(import.meta.env?import.meta.env.MODE:void 0)!=="production"?uT(e):e},Hn,xf=()=>(Hn||(Hn=wp(),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=Hn),globalThis.__JOTAI_DEFAULT_STORE__!==Hn&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),Hn);s();a();var Be=N(M(),1);var Ff=(0,Be.createContext)(void 0),ss=t=>{let e=(0,Be.useContext)(Ff);return t?.store||e||xf()},Cf=({children:t,store:e})=>{let r=(0,Be.useRef)(void 0);return!e&&!r.current&&(r.current=wp()),(0,Be.createElement)(Ff.Provider,{value:e||r.current},t)},bp=t=>typeof t?.then=="function",Pf=t=>{t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e})},lT=Be.default.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(Pf(t),t)}),hp=new WeakMap,If=t=>{let e=hp.get(t);return e||(e=new Promise((r,o)=>{let n=t,i=u=>l=>{n===u&&r(l)},c=u=>l=>{n===u&&o(l)},p=u=>{"onCancel"in u&&typeof u.onCancel=="function"&&u.onCancel(l=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&l===u)throw new Error("[Bug] p is not updated even after cancelation");bp(l)?(hp.set(l,e),n=l,l.then(i(l),c(l)),p(l)):r(l)})};t.then(i(t),c(t)),p(t)}),hp.set(t,e)),e};function mT(t,e){let r=ss(e),[[o,n,i],c]=(0,Be.useReducer)(l=>{let g=r.get(t);return Object.is(l[0],g)&&l[1]===r&&l[2]===t?l:[g,r,t]},void 0,()=>[r.get(t),r,t]),p=o;(n!==r||i!==t)&&(c(),p=r.get(t));let u=e?.delay;if((0,Be.useEffect)(()=>{let l=r.sub(t,()=>{if(typeof u=="number"){let g=r.get(t);bp(g)&&Pf(If(g)),setTimeout(c,u);return}c()});return c(),l},[r,t,u]),(0,Be.useDebugValue)(p),bp(p)){let l=If(p);return lT(l)}return p}function kf(t,e){let r=ss(e);return(0,Be.useCallback)((...n)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return r.set(t,...n)},[r,t])}function dT(t,e){return[mT(t,e),kf(t,e)]}s();a();var Rf=d.enum(["Native","Fungible","SemiFungible","NonFungible","Unknown"]),tr=d.object({id:d.string(),displayName:d.string().optional(),logoURI:d.union([d.string(),d.null()]).optional(),tokenType:Rf,decimals:d.number().optional(),symbol:d.string().optional(),isSpam:d.boolean().optional()}),Df=d.object({id:Yt,displayName:d.string(),logoURI:d.union([d.string(),d.null()]).optional()}),as=d.object({token:tr,amount:d.string(),to:Yt,from:Yt}),Ap=d.literal("UNCLASSIFIED_APP_INTERACTION"),Tp=d.literal("TOKEN_SEND"),vp=d.literal("TOKEN_BURN"),Ep=d.literal("TOKEN_SWAP"),xp=d.literal("TOKEN_UNWRAP"),Ip=d.literal("WITHDRAW_STAKE"),Fp=d.literal("DEACTIVATE_STAKE"),Cp=d.literal("STAKE"),Pp=d.literal("COLLECTIBLE_LIST"),kp=d.literal("COLLECTIBLE_BUY_ITEM"),Rp=d.literal("COLLECTIBLE_CANCEL_BID"),Dp=d.literal("COLLECTIBLE_BID_ITEM"),Np=d.literal("COLLECTIBLE_UNLIST"),Bp=d.literal("COLLECTIBLE_SELL_ITEM"),Lp=d.literal("CANCEL_TX"),Up=d.literal("TOKEN_APPROVAL"),Mp=d.literal("CANCEL_ORDER"),Qp=d.literal("COLLECTION_APPROVAL"),_p=d.literal("BRIDGE_INIT"),fT=d.union([Ap,Tp,vp,Ep,xp,Ip,Fp,Cp,Pp,kp,Rp,Dp,Np,Bp,Lp,Up,Mp,Qp,_p]),Nf=d.object({transactionType:Ap,balanceChanges:d.array(as),dapp:d.union([Nt,d.null()]).optional()}),Bf=d.object({transactionType:Tp,balanceChanges:d.array(as).nonempty(),dapp:d.union([Nt,d.null()]).optional()}),Lf=d.object({transactionType:vp,dapp:d.union([Nt,d.null()]).optional(),token:tr,amount:d.string()}),Uf=d.object({transactionType:Ep,dapp:d.union([Nt,d.null()]).optional(),receiveToken:tr,sendToken:tr,receiveAmount:d.string(),sendAmount:d.string()}),Mf=d.object({transactionType:xp,token:tr,amount:d.string()}),Qf=d.object({transactionType:Ip,stakeAccount:Yt,amount:d.string()}),_f=d.object({transactionType:Fp,stakeAccount:Yt,amount:d.string()}),Of=d.object({transactionType:Cp,stakeAccount:Yt,amount:d.string(),validatorName:d.string().optional(),validatorWebsite:d.string().optional(),keybaseUsername:d.string().optional()}),qf=d.object({transactionType:Lp}),$o=d.object({dapp:d.union([Nt,d.null()]),itemAmount:d.string().optional(),item:tr,forAmount:d.string(),forAsset:tr,listingUrl:d.string().optional()}),Vf=$o.merge(d.object({transactionType:Pp})),Gf=$o.merge(d.object({transactionType:kp})),Kf=$o.merge(d.object({transactionType:Rp})),Hf=$o.merge(d.object({transactionType:Dp})),$f=$o.merge(d.object({transactionType:Np})),zf=$o.merge(d.object({transactionType:Bp})),Wf=d.object({transactionType:Up,dapp:d.union([Nt,d.null()]).optional(),token:tr,value:d.string().optional(),isApproved:d.boolean()}),jf=d.object({transactionType:Mp,dapp:d.union([Nt,d.null()]).optional(),orderId:d.string()}),Yf=d.object({transactionType:Qp,collection:Df,dapp:d.union([Nt,d.null()]).optional(),isApproved:d.boolean()}),Xf=d.object({transactionType:_p,dapp:d.union([Nt,d.null()]).optional(),balanceChanges:d.array(as).nonempty(),explorerUrl:d.string().optional()}),Jf=d.enum(["success","failed"]),Zf=d.object({networkFee:d.string().optional(),networkFeePayer:d.string().optional(),status:Jf,errorMessage:d.union([d.string(),d.null()]),blockNumber:d.string(),chainId:Ar,transactionId:d.string()}),cs=d.object({timestamp:d.number(),owner:Yt,id:Yt,interactionData:d.union([Nf,Bf,Lf,Uf,Mf,Qf,_f,Of,Vf,Gf,Kf,Hf,$f,zf,qf,Wf,jf,Yf,Xf]),chainMeta:Zf}),$e=t=>{let o=t.split("/")[1]?.split(":");return o&&o[1]};s();a();var qp=N(M());s();a();var eg=({interactionData:t,isError:e,selectedAccountAddresses:r,getKnownAddressLabel:o,start:n,networkID:i})=>{let p=t.balanceChanges[0],{token:{symbol:u,displayName:l,tokenType:g,decimals:f},amount:y}=p,h=Op(p,r),S=zo(g),b=gT({isCollectible:S,sign:h?"+":"-",amount:y,decimals:f,tokenSymbol:u,tokenType:g,isError:e});if(h){let F=$e(p.from),P=Kc(F,void 0,o(F,i));return{topLeft:{text:`${L.t("transactionsReceived")} ${S?l||L.t("richTransactionDetailUnknownNFT"):""}`},topRight:{text:`${b}`,color:"accentSuccess"},bottomLeft:{text:L.t("transactionsFromParagraphInterpolated",{from:P,defaultValue:`From ${P}`})},start:n}}let x=$e(p.to),T=Kc(x,void 0,o(x,i));return{topLeft:{text:e?L.t("transactionsSendFailed"):`${L.t("transactionsSent")} ${S?l||L.t("richTransactionDetailUnknownNFT"):""}`},topRight:{text:`${b}`,color:"textPrimary"},bottomLeft:{text:L.t("transactionsToParagraphInterpolated",{to:T,defaultValue:`To ${T}`})},start:n}};function gT({isCollectible:t,sign:e,amount:r,decimals:o,tokenSymbol:n,tokenType:i,isError:c}){return c||o===void 0||i==="NonFungible"?"":t?`${e}${Xe(r,o)}`:`${e}${Xe(r,o)}${n?` ${Rt(n,6)}`:""}`}var yT=["So11111111111111111111111111111111111111112","501"],ST=(t,e,r,o,n)=>{let{interactionData:i,chainMeta:c}=t,{transactionType:p}=i,u=c.status==="failed",l=c.chainId,g=I.getTokenSymbol(l),f=I.getTokenDecimals(l),y=e("historyUnknownDappName"),h=qp.default.createElement(r,{activityItem:t,size:"small",isDetailViewOrSvg:!1});switch(p){case"TOKEN_SEND":return eg({interactionData:i,isError:u,selectedAccountAddresses:n,getKnownAddressLabel:o,start:h,networkID:l});case"TOKEN_BURN":{let{amount:S,token:w}=i,b="";return w.displayName?S==="1"?b=w.displayName:b=`${w.displayName} (${S})`:b=e("richTransactionDetailUnknownNFT"),{topLeft:{text:u?`${e("transactionsFailedBurn")}`:`${e("transactionsBurned")}`},bottomLeft:{text:b},start:h}}case"TOKEN_UNWRAP":{let{amount:S,token:w}=i;return{topLeft:{text:u?`${e("transactionsUnwrappedFailed")}`:`${e("transactionsUnwrapped")}`},topRight:{text:u?"":`${Xe(S,w.decimals??0)} ${w.symbol}`,color:"textPrimary"},start:h}}case"TOKEN_SWAP":{let{receiveAmount:S,receiveToken:w,sendAmount:b,sendToken:x,dapp:T}=i,F=T?T.displayName:e("historyUnknownDappName"),P=_n($e(x.id)||""),B=_n($e(w.id)||""),R="";!u&&w.decimals!==void 0&&(R=`+${Xe(S,w.decimals)} ${Rt(w.symbol||B,6)}`);let q="";return!u&&x.decimals!==void 0&&(q=`-${Xe(b,x.decimals)} ${Rt(x.symbol||P,6)}`),{topLeft:{text:e(u?"transactionsFailedSwap":"transactionsSwapped")},topRight:{text:R,color:"accentSuccess"},bottomLeft:{text:F},bottomRight:{text:q,color:"textPrimary"},start:h}}case"BRIDGE_INIT":{let S=i.dapp?i.dapp.displayName:y,b=i.balanceChanges[0],{token:{symbol:x,decimals:T},amount:F}=b,P=x?` ${Rt(x,6)}`:"";if(!u&&T!==void 0){let B=`-${Xe(F,T)}${P}`;return{topLeft:{text:u?e("transactionBridgeInitiatedFailed"):`${e("transactionBridgeInitiated")}`},bottomLeft:{text:S},topRight:{text:`${B}`,color:"textPrimary"},start:h}}return{topLeft:{text:u?e("transactionBridgeInitiatedFailed"):`${e("transactionBridgeInitiated")}`},bottomLeft:{text:S},start:h}}case"WITHDRAW_STAKE":{let{amount:S,stakeAccount:w}=i,b=$e(w),x=I.getTokenSymbol(l);return{topLeft:{text:e(u?"transactionsWithdrawStakeFailed":"transactionsWithdrawStake")},topRight:{text:u?"":`${Xe(S,f)} ${Rt(x,6)}`,color:"textPrimary"},bottomLeft:{text:Oi(b,4)},start:h}}case"DEACTIVATE_STAKE":{let{stakeAccount:S}=i,w=$e(S);return{topLeft:{text:e(u?"transactionsDeactivateStakeFailed":"transactionsDeactivateStake")},bottomLeft:{text:Oi(w,4)},start:h}}case"STAKE":{let{amount:S,stakeAccount:w,validatorName:b}=i,x=$e(w);return{topLeft:{text:e(u?"transactionsStakedFailed":"transactionsStaked")},topRight:{text:u?"":`${Xe(S,f)} ${Rt(g,6)}`,color:"textPrimary"},bottomLeft:{text:b||Oi(x,4)},start:h}}case"COLLECTIBLE_LIST":{let{dapp:S,item:w}=i,b=S?S.displayName:e("historyUnknownDappName"),x=w.displayName||e("richTransactionDetailUnknownNFT");return{topLeft:{text:u?e("transactionsListedFailed"):e("transactionsListedInterpolated",{name:x})},bottomLeft:{text:b},start:h}}case"COLLECTIBLE_BUY_ITEM":{let{dapp:S,itemAmount:w,item:b,forAsset:x,forAmount:T}=i,F=S?S.displayName:e("historyUnknownDappName"),P=tg(T,x.decimals,Rt(x.symbol||"",6)),B=b.symbol||_n($e(b.id)),R=w&&b.tokenType==="SemiFungible"?`+${w} ${B}`:`+${B}`;return{topLeft:{text:e(u?"transactionsBuyFailed":"transactionsBoughtCollectible")},topRight:{text:u?"":R,color:"accentSuccess"},bottomRight:{text:u?"":`${P}`,color:"textPrimary"},bottomLeft:{text:F},start:h}}case"COLLECTIBLE_CANCEL_BID":{let{dapp:S,item:w}=i,b=S?S.displayName:e("historyUnknownDappName"),x=w.displayName||e("richTransactionDetailUnknownNFT");return{topLeft:{text:u?e("transactionsCancelBidOnFailed"):e("transactionsCancelBidOnInterpolated",{name:x})},bottomLeft:{text:b},start:h}}case"COLLECTIBLE_BID_ITEM":{let{dapp:S,item:w}=i,b=S?S.displayName:e("historyUnknownDappName"),x=w.displayName||e("richTransactionDetailUnknownNFT");return{topLeft:{text:u?e("transactionsBidFailed"):e("transactionsBidOnInterpolated",{name:x})},bottomLeft:{text:b},start:h}}case"COLLECTIBLE_UNLIST":{let{dapp:S,item:w}=i,b=S?S.displayName:e("historyUnknownDappName"),x=w.displayName||e("richTransactionDetailUnknownNFT");return{topLeft:{text:u?e("transactionsUnlistedFailed"):e("transactionsUnlistedInterpolated",{name:x})},bottomLeft:{text:b},start:h}}case"COLLECTIBLE_SELL_ITEM":{let{dapp:S,itemAmount:w,item:b,forAsset:x,forAmount:T}=i,F=S?S.displayName:e("historyUnknownDappName"),P=x.decimals!==void 0?`+${Xe(T,x.decimals)} ${Rt(x.symbol||"",6)}`:e("transactionsUnknownAmount"),B=b.symbol||_n($e(b.id)),R=w&&b.tokenType==="SemiFungible"?`-${w} ${B}`:`-${B}`;return{topLeft:{text:e(u?"transactionsSoldFailed":"transactionsSoldCollectible")},topRight:{text:u?"":`${P}`,color:"accentSuccess"},bottomRight:{text:u?"":R,color:"textPrimary"},bottomLeft:{text:F},start:h}}case"CANCEL_TX":return{topLeft:{text:e(u?"transactionCancelledFailed":"transactionCancelled")},start:h};case"TOKEN_APPROVAL":{let{dapp:S,token:w,isApproved:b}=i,x=zo(w.tokenType)?w.displayName:w.symbol,T;return u?b?zo(w.tokenType)?T=e("transactionApproveTokenFailed",{tokenSymbol:x}):T=e("transactionApprovalFailed"):zo(w.tokenType)?T=e("transactionRevokeApproveTokenFailed",{tokenSymbol:x}):T=e("transactionRevokeFailed"):b?T=e("transactionApproveToken",{tokenSymbol:x}):T=e("transactionRevokeApproveToken",{tokenSymbol:x}),{topLeft:{text:T},bottomLeft:{text:S?S.displayName:y,color:"textTertiary"},start:h}}case"COLLECTION_APPROVAL":{let{collection:S,isApproved:w,dapp:b}=i,x=S.displayName,T;return u?w?T=e("transactionApproveTokenFailed",{tokenSymbol:x}):T=e("transactionRevokeApproveTokenFailed",{tokenSymbol:x}):w?T=e("transactionApproveToken",{tokenSymbol:x}):T=e("transactionRevokeApproveToken",{tokenSymbol:x}),{topLeft:{text:T},bottomLeft:{text:b?b.displayName:y,color:"textTertiary"},start:h}}case"CANCEL_ORDER":{let{dapp:S}=i;return{topLeft:{text:e(u?"transactionCancelOrderFailed":"transactionCancelOrder")},bottomLeft:{text:S?.displayName||e("historyUnknownDappName"),color:"textTertiary"},start:h}}case"UNCLASSIFIED_APP_INTERACTION":{let{dapp:S}=i,w=S?S.displayName:y;return{topLeft:{text:e(u?"transactionsFailedAppInteraction":"transactionsAppInteraction")},bottomLeft:{text:w},start:h}}}},wT=(t,e)=>{let{display:r,type:o}=t,{topLeft:n,topRight:i,bottomLeft:c,bottomRight:p}=r.summary,u=qp.default.createElement(e,{logoUri:r.summary.logoUri,pendingTransactionType:o,size:"small"});return{topLeft:n,topRight:i,bottomLeft:c,bottomRight:p,start:u}},Vp=(t,e,r)=>{let o=(t??[]).map(bd);if(e){let n=o.find(i=>i.chainId===e)?.address;if(n){let i={chainId:e,address:n};r&&(i.filters=[{type:"token",value:r}]),o=[i]}}return o},zo=t=>{switch(t){case"SemiFungible":case"NonFungible":return!0;default:return!1}},Op=(t,e)=>{let r=$e(t.to),o=$e(t.from),n=e.some(c=>c.address.toLowerCase()===r.toLowerCase()),i=e.some(c=>c.address.toLowerCase()===o.toLowerCase());return n&&!i},Gp=t=>{if(!t)return;let e=H(t);if(e.resourceType!=="nativeToken")return t.type==="SPL"?t.data.splTokenAccountPubkey:e.address},hT=(t,e)=>{let r=$e(t.id);return yT.includes(r)&&(t.tokenType="Native"),t.tokenType==="Native"?{chainId:e,slip44:I.getSlip44(e),resourceType:"nativeToken"}:{chainId:e,address:r,resourceType:"address"}},tg=(t,e,r)=>{if(!t||!e)return L.t("transactionsUnknownAmount");let o=se(t,e),n=o.abs(),i=o.isZero()?"":o.isPositive()?"-":"+",c=Ut(n);return`${i}${c} ${r}`};s();a();s();a();s();a();var xr={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!0};var rg={...xr};s();a();var og={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};s();a();var ng={...xr,showTimeToMineRowInPendingTransactionDetail:!0};s();a();var ig={...xr};s();a();var sg={...xr};s();a();var ag={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};s();a();var cg={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};var bT=new Oo({solana:ag,ethereum:ng,polygon:sg,monad:ig,base:rg,bitcoin:og,sui:cg}),pg=_o(bT);s();a();s();a();s();a();var gg=N(M());s();a();var dg=N(M());s();a();var AT=10,TT="/history/v2",Wo=class extends Error{message="406: Cache bust!"},$n=class extends Error{message="Server response malformed."},ps=class extends Error{},us=class extends Error{},Kp=d.object({next:d.union([d.null(),d.string()]),results:d.array(cs)}),ug=async t=>{let e=await j.api().retry(3,2e3).post(`${TT}`,t);if(e.status===406)throw new Wo;if(e.status>=400&&e.status<500)throw new us(`FetchActivityItem: Status code: ${e.status}`);if(e.status>=500)throw new ps(`FetchActivityItem: Status code: ${e.status}`);return e.data},lg=t=>!Array.isArray(t.results)||typeof t.next!="string"&&t.next!==null,ls=async t=>{let e=await ug(t);if(lg(e))throw new $n;for(;e.results?.length<AT&&e.next;){if(lg(e))throw new $n;let r=await ug({next:e.next,isSpam:t.isSpam});e.next=r.next,e.results=[...e.results,...r.results]}try{return Kp.parse(e)}catch(r){let o=r,n=[],i=o.issues;for(let u=0;u<i.length;++u){let l=i[u].path;if(l[0]!=="results")throw Q.captureError(o,"history"),o;let g=l[1];if(typeof g!="number")throw Q.captureError(o,"history"),o;n.push(g)}n.sort(function(u,l){return l-u});let c=n.map(u=>e.results[u]).map(u=>u.interactionData?.transactionType||""),p=[];for(let u=0;u<n.length;++u){let l=n[u],g=e.results[l],f={timestamp:g?.timestamp,owner:g?.owner,id:g?.id,chainMeta:g?.chainMeta,interactionData:{transactionType:"UNCLASSIFIED_APP_INTERACTION",balanceChanges:[]}};try{cs.parse(f),e.results[l]=f,p.push(l)}catch{}}for(let u=0;u<n.length;++u){let l=n[u];p.indexOf(l)===-1&&e.results.splice(l,1)}n.length&&console.error(`Removed history items, ${c.join(",")}`);try{return Kp.parse(e)}catch(u){let l=u;throw Q.captureError(l,"history"),l}}};var vT=3e5,zn="fetch-infinite-activity-items",fg=({accounts:t,isSpam:e})=>[zn,t,e],ET=(t,e)=>{t.removeQueries({queryKey:e})},Hp=({accounts:t,isSpam:e})=>{let r=W();(0,dg.useEffect)(()=>()=>{r.cancelQueries({queryKey:[zn],exact:!1})},[r]);let o=fg({accounts:t,isSpam:e});return kt({queryKey:o,queryFn:async({pageParam:c})=>{try{let p;c&&c!==""?p=await ls({next:c,isSpam:e}):p=await ls({accounts:t||[],isSpam:e});let u=p.results.map(l=>(l.interactionData.transactionType==="TOKEN_SEND"&&l.interactionData.balanceChanges.sort(xT(t)),l));return{...p,results:u}}catch(p){p instanceof Wo&&ET(r,o),Q.captureError(p,"history")}},getNextPageParam:c=>c?.next,staleTime:vT,retry:!1,enabled:!!t?.length&&t.every(c=>!I.isLocalNetworkID(c.chainId)),initialPageParam:""})};function xT(t){return(e,r)=>{let o=mg(e,t),n=mg(r,t);return o?-1:n?1:0}}function mg(t,e){let r=t.to.split("/address:")[1],o=t.from.split("/address:")[1];return e.some(n=>n.address.toLowerCase()===r.toLowerCase()||n.address.toLowerCase()===o.toLowerCase())}var IT=({fungible:t,isSpam:e=!1})=>{let{data:r=td,status:o}=ad(),n=r.isDeveloperMode,i=Gp(t),{data:c}=Jr({address:t?.data.walletAddress,networkID:t?.data.chain.id}),p=(0,gg.useMemo)(()=>Vp(c?[c]:[],t?.data.chain.id,i),[c,t?.data.chain.id,i]),u=Hp({accounts:p,isSpam:e}),l=u.isPending||o==="pending";return{activityItemsData:u,isLoadingHistory:l,isDeveloperMode:n}};s();a();var xs=N(M());s();a();var ry=N(DA()),oy=N(jg());var wE=d.object({domain:d.string(),url:d.string(),name:d.string(),category:d.string(),imageUrl:d.string()}),ny=d.object({uuid:d.string(),data:d.array(wE)}),hE=d.object({chainId:Ar,address:d.string(),name:d.string(),symbol:d.string(),logoUrl:d.string(),marketCap:d.number(),price:d.number(),priceChange:d.number(),volume:d.number(),volumeChange:d.number()}),iy=d.object({items:d.array(hE)}),bE=d.object({paymentTokenId:d.string(),name:d.string(),symbol:d.string(),decimals:d.number()}),AE=d.object({verified:d.boolean(),collectionUrl:d.string(),marketplaceId:d.string(),marketplaceName:d.string(),marketplaceCollectionId:d.string()}),TE=d.object({marketplaceId:d.string(),paymentToken:bE,value:d.string()}),vE=d.object({id:d.string(),name:d.string(),volume:d.string().optional(),volumePercentChange:d.number(),marketplacePages:d.array(AE),floorPrices:d.array(TE),imageUrl:d.string()}),sy=d.object({uuid:d.string(),data:d.array(vE)}),EE=["tokens","sites","collections","learn","suggested-users-to-follow"],so=d.enum(["shortcuts","carousel",...EE]),xE=d.object({type:d.literal(so.enum.shortcuts)}),IE=d.object({type:d.literal(so.enum.carousel)}),FE=d.object({type:d.literal(so.enum["suggested-users-to-follow"]),limit:d.number()}),Jn="all_networks",tn=d.union([Ar,d.literal(Jn)]),CE=["asc","desc"],PE=d.enum(CE),kE=["rank","volume","price","price-change","market-cap"],Yg=d.enum(kE),RE=["1h","24h","7d","30d"],Xg=d.enum(RE),DE=d.object({type:d.literal(so.enum.tokens),sortBy:d.array(Yg).refine(t=>new Set(t).size===t.length),sortByDefault:Yg,sortDirectionDefault:PE,network:d.array(tn).refine(t=>new Set(t).size===t.length),networkDefault:tn,timeFrame:d.array(Xg).refine(t=>new Set(t).size===t.length),timeFrameDefault:Xg,rankAlgo:d.string(),limit:d.number(),listLimit:d.number()}),NE=["top","rank"],Jg=d.enum(NE),BE=["24h","7d","30d"],Zg=d.enum(BE),LE=d.object({type:d.literal(so.enum.sites),sortBy:d.array(Jg).refine(t=>new Set(t).size===t.length),sortByDefault:Jg,network:d.array(tn).refine(t=>new Set(t).size===t.length),networkDefault:tn,timeFrame:d.array(Zg).refine(t=>new Set(t).size===t.length),timeFrameDefault:Zg,rankAlgo:d.string(),limit:d.number(),listLimit:d.number()}),UE=["top","rank"],ey=d.enum(UE),ME=["24h","7d","30d"],ty=d.enum(ME),QE=d.object({type:d.literal(so.enum.collections),sortBy:d.array(ey).refine(t=>new Set(t).size===t.length),sortByDefault:ey,network:d.array(tn).refine(t=>new Set(t).size===t.length),networkDefault:tn,timeFrame:d.array(ty).refine(t=>new Set(t).size===t.length),timeFrameDefault:ty,rankAlgo:d.string(),limit:d.number(),listLimit:d.number()}),_E=d.object({type:d.literal(so.enum.learn),limit:d.number()}),OE=d.discriminatedUnion("type",[xE,IE,FE,DE,LE,QE,_E]),cu=d.object({sections:d.array(OE).refine(t=>(0,ry.default)(t,(0,oy.default)(t,"type")))}),$U=d.object({uuid:d.string(),data:d.array(Nm)});var qE=cu.parse({sections:[{type:"shortcuts"},{type:"carousel"},{type:"tokens",sortBy:["rank","volume","price","price-change","market-cap"],sortByDefault:"rank",sortDirectionDefault:"asc",network:["solana:101","eip155:1","eip155:137","eip155:8453","bip122:000000000019d6689c085ae165831e93","all_networks"],networkDefault:"solana:101",timeFrame:["1h","24h","7d","30d"],timeFrameDefault:"24h",rankAlgo:"default",limit:3,listLimit:100},{type:"suggested-users-to-follow",limit:3,listLimit:100},{type:"sites",sortBy:["rank","top"],sortByDefault:"rank",network:["solana:101","eip155:1","eip155:137","eip155:8453","bip122:000000000019d6689c085ae165831e93","all_networks"],networkDefault:"solana:101",timeFrame:["24h","7d","30d"],timeFrameDefault:"24h",rankAlgo:"default",limit:3,listLimit:50},{type:"collections",sortBy:["rank","top"],sortByDefault:"rank",network:["solana:101","eip155:1","eip155:137","bip122:000000000019d6689c085ae165831e93","all_networks"],networkDefault:"solana:101",timeFrame:["24h","7d","30d"],timeFrameDefault:"24h",rankAlgo:"default",limit:3,listLimit:50},{type:"learn",limit:3}]}),pu=()=>{let t=ve.getMultivariateAssignment("explore-config"),e=Ye;return(0,xs.useMemo)(()=>{let r;try{r=cu.parse(JSON.parse(t??""))}catch{r=qE}return e||(r={...r,sections:r.sections.filter(o=>o.type!=="suggested-users-to-follow")}),r},[t,e])},uu=()=>{let t=pu();return(0,xs.useMemo)(()=>{let e=[];for(let r of t.sections)(r.type==="collections"||r.type==="tokens"||r.type==="sites"||r.type==="learn"||r.type==="suggested-users-to-follow")&&e.push(r);return e},[t.sections])},lu=t=>{let e=pu();return(0,xs.useMemo)(()=>e.sections.find(o=>o.type===t)??null,[e.sections,t])};s();a();s();a();s();a();s();a();s();a();var VE=d.object({type:d.literal("fungible"),data:Nd}),ay=d.object({results:d.array(d.any()).transform(t=>t.reduce((e,r)=>{let o=VE.safeParse(r);return o.success&&e.push(o.data),e},[])),prevCursor:d.string().nullish().default(null),nextCursor:d.string().nullish().default(null),hasMore:d.boolean()});async function Is(t){let{query:e,networkIds:r,searchContext:o,supportedNetworkIds:n,pageSize:i=50}=t,c=await j.api().headers({"Content-Type":"application/json"}).get("/search/v1",{params:{query:e.trim(),chainIds:r.join(","),platform:_e,pageSize:i.toString(),searchTypes:"fungible",searchContext:o,...n&&{supportedNetworkIds:n.join(",")}}});if(!ne(c))throw new qe({key:"UnknownError"});let p=ay.safeParse(c.data);if(p.success)return p.data;throw new qe({key:"UnknownError"})}s();a();var Zn=t=>{let e=t.data,r=zc(e)??void 0;return{type:e.type,data:{...e.data,tokenAddress:zc(e)??void 0,key:r}}};s();a();var GE="search",cy={searchResults:(t,e,r,o)=>[GE,{query:t,networkIds:e,supportedNetworkIds:o,chainAddresses:r}]};s();a();var mu=(i=>(i[i.Always=1/0]="Always",i[i.Short=Y({minutes:5})]="Short",i[i.Medium=Y({minutes:30})]="Medium",i[i.Long=Y({hours:1})]="Long",i[i.Never=0]="Never",i))(mu||{}),du=(n=>(n[n.Immediate=0]="Immediate",n[n.Short=Y({minutes:5})]="Short",n[n.Medium=Y({minutes:30})]="Medium",n[n.Long=Y({hours:1})]="Long",n))(du||{});var KE=async t=>(await Is(t)).results.map(r=>Zn(r)),ao=({query:t,networkIds:e,enableQuery:r=!0,keepPreviousData:o=!1,searchContext:n,supportedNetworkIds:i,chainAddresses:c,pageSize:p})=>{let u=cy.searchResults(t,e,c,i);return $({queryKey:u,gcTime:mu.Short,staleTime:du.Short,enabled:r,placeholderData:o?Mm:void 0,queryFn:()=>KE({query:t,networkIds:e,searchContext:n,supportedNetworkIds:i,pageSize:p})})};s();a();s();a();s();a();var mt=Y({days:1}),St=Y({seconds:5});s();a();s();a();var Ie=({name:t,response:e,current:r,target:o})=>`Failed to ${t}: 
Current: ${r} | Target: ${o} 
${e.status} ${e.statusText} 
${JSON.stringify(e.data)}`,sr=({name:t,error:e,current:r,target:o})=>`Failed to parse ${t}: 
Current: ${r} | Target: ${o} 
${JSON.stringify(e)}`;async function py(t){let e=await j.api().bearer(!0).headers({Accept:"application/activity+json"}).get(`/v1/actors/${t}`);if(!ne(e)){let o=new Error(Ie({name:"getActor",response:e,target:t}));throw Q.captureError(o,"network"),o}let r=Tr.safeParse(e.data);if(r.success)return r.data;{let o=new Error(sr({name:"getActor",error:r.error,target:t}));throw Q.captureError(o,"network"),o}}s();a();var Ze="@phantom/social",we={actor(t){return["actor",`${Ze}:actor`,{profileId:t}]},actorAndFollowers(t){return["user",`${Ze}:actor-and-followers`,{profileId:t}]},actorAndFollowing(t){return["user",`${Ze}:actor-and-following`,{profileId:t}]},userProfileByUsernameOrUserProfileId(t){return["user",`${Ze}:user-profile-by-username-or-user-profile-id`,{usernameOrUserProfileId:t}]},followUser(t,e){return["user",`${Ze}:follow-user`,{currentId:t,targetId:e}]},inbox(t,e){return["user",`${Ze}:inbox`,{profileId:t,viewFeedAsUsername:e}]},searchForActorBase(){return["actor",`${Ze}:search`]},searchForActor(t){return["actor",`${Ze}:search`,{query:t}]},followRequests(t){return["user",`${Ze}:follow-requests`,{profileId:t}]},suggestedActors(t,e){return["user",`${Ze}:suggested-follows`,{profileId:e,source:t}]},blocking(t){return["user",`${Ze}:blocking`,{profileId:t}]},pendingFollowRequests(t,e){return["user",`${Ze}:pending-follow-requests`,{profileId:t,targetId:e}]},reaction(t){return t?["reaction",`${Ze}:reaction`,{targetId:t}]:["reaction",`${Ze}:reaction`]}};function fu(t){let e=async()=>{if(!t)throw new Error("No profile ID or access token");return py(t)};return od({queryKey:we.actor(t),queryFn:e,enabled:!!t,gcTime:mt,staleTime:St})}s();a();s();a();s();a();function Cr(t){let e=t.match(/\/v1\/actors\/([^/]+)/)?.[1];return e?Ve.parse(e):void 0}s();a();function ye(t){return Cr(t)??Ve.parse(t)}var co=(t,e)=>{let r=ye(e.id);r&&t.setQueryData(we.actor(r),e)};function HE({usernameOrUserProfileId:t}){let e=t?.startsWith("@")?t.slice(1):t,r=qi(),o=we.userProfileByUsernameOrUserProfileId(t);return $({enabled:!!e,queryKey:o,queryFn:async()=>{if(!e)throw new Error("No sanitized username or user profile id");let i=await r.getUserProfileByUsernameOrUserProfileId(e);if(!i)throw new Error("No user profile");return i},gcTime:mt,staleTime:St})}function gu({query:t}){let e=W(),{data:r}=On(),{data:o}=He(),n=r?.accessToken,i=t?.startsWith("@")?t.slice(1).trim():t.trim(),c=qi(),p=we.searchForActor(i),u=async()=>{if(!i||!n||!o?.id)return{actors:[]};let{actors:f}=await c.searchForActor(i,n,o.id);for(let y of f)co(e,y);return f.sort((y,h)=>y.isFollowing?-1:h.isFollowing?1:0),{actors:f}},l=!!n;return{...$({enabled:l,queryKey:p,queryFn:u,gcTime:mt,staleTime:St}),enabled:l}}s();a();s();a();s();a();s();a();function ly(t){let{attachment:e,...r}=t,o,n;if(e){let i=Array.isArray(e)?e:[e];for(let c of i)!c.name||!c.value||(c.name==="usd_value"&&(o=c.value),c.name==="amount"&&(n=c.value))}return{...r,usdValue:o,amount:n}}function Fs(t){return{...t,published:typeof t.published=="string"?new Date(t.published):t.published}}var uy=d.object({type:d.string(),value:d.string().optional(),name:d.string().optional()}),Cs=d.object({type:d.string(),id:d.string(),summary:d.string().optional(),published:d.union([d.date(),d.string()]).optional(),actor:d.string(),object:d.string(),attachment:d.union([uy,d.array(uy)]).optional()}),$E=Cs.extend({type:d.literal("EmojiReact"),actor:d.string(),to:d.string(),content:d.string(),object:d.string()}),zE=$E.transform((t,e)=>{let r=t.content;return ti.includes(r)?{...t,content:r}:(e.addIssue({code:d.ZodIssueCode.custom,message:"Not a supported reaction"}),d.NEVER)}).transform(Fs),WE=Cs.extend({type:d.literal("Buy")}),Ps=WE.transform(ly).transform(Fs),jE=Cs.extend({type:d.literal("Sell")}),ks=jE.transform(ly).transform(Fs),YE=Cs.extend({type:d.literal("TrendingToken")}),ei=YE.transform(Fs),XE=d.union([zE,Ps,ks,ei]);var JE=d.object({orderedItems:Tr.array().default([]),next:d.string().optional()}),ZE=d.object({orderedItems:Tr.array().default([]),next:d.string().optional()}),ex=d.object({orderedItems:Tr.array().default([]),next:d.string().optional()});var my=d.object({orderedItems:Tr.array().default([]),next:d.string().optional()}),tx=d.object({orderedItems:Tr.array().default([]),next:d.string().optional()}),rx=d.object({targetId:d.string(),actorId:d.string(),type:d.string(),content:d.string()}),ox=d.object({targetId:d.string(),content:d.string(),type:d.string(),count:d.number({coerce:!0})});function nx(t,e){return t==="emoji"&&ti.includes(e)}var dy=d.object({reaction:rx.transform(t=>({...t,content:ti.includes(t.content)?t.content:"\u{1F440}"})).optional(),counts:d.array(ox).transform(t=>t.filter(e=>nx(e.type,e.content))).optional()});var ti=["\u{1F402}","\u{1F49C}","\u{1F440}","\u{1F43B}","\u{1F4A9}"];var yu={"@context":["https://www.w3.org/ns/activitystreams"],type:"Buy",id:"https://api.phantom.app/v1/actors/b4019d7d-b0fd-4573-a724-20e01de8f439/activities/3",published:new Date(Date.now()-1e3*60),actor:"https://api.phantom.app/v1/actors/e6d46df9-4ae7-4291-a25c-706eda5adb57",object:"https://api.phantom.app/v1/tokens/solana-101/So11111111111111111111111111111111111111112",summary:"Bought 100 SOL",attachment:[{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"usd_value",type:"PropertyValue",value:"1040.23"},{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"amount",type:"PropertyValue",value:"6"}]},ix=Ps.parse(yu),Su={"@context":["https://www.w3.org/ns/activitystreams"],type:"Sell",id:"https://api.phantom.app/v1/actors/b4019d7d-b0fd-4573-a724-20e01de8f439/activities/4",published:new Date(Date.now()-1e3*60),actor:"https://api.phantom.app/v1/actors/312f11a1-3ea4-4152-b002-ab095b65f34f",object:"https://api.phantom.app/v1/tokens/solana-101/6AJcP7wuLwmRYLBNbi825wgguaPsWzPBEHcHndpRpump",summary:"Sold 100 SOL",attachment:[{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"usd_value",type:"PropertyValue",value:"10.23"},{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"amount",type:"PropertyValue",value:"30.53"}]},sx=ks.parse(Su),ax={...yu,id:`https://api.phantom.app/v1/buys/${yu.id.split("/").pop()}`,actor:"https://api.phantom.app/v1/services/whale-alert",attachment:[{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"usd_value",type:"PropertyValue",value:"142412142214"},{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"amount",type:"PropertyValue",value:"5424121422"}]},cx=Ps.parse(ax),px={...Su,id:`https://api.phantom.app/v1/sells/${Su.id.split("/").pop()}`,actor:"https://api.phantom.app/v1/services/whale-alert",attachment:[{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"usd_value",type:"PropertyValue",value:"4466612142214"},{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"amount",type:"PropertyValue",value:"2166612142200"}]},ux=ks.parse(px),wu=t=>({type:"TrendingToken",id:`https://api.phantom.app/v1/trending-token/${t}/`,published:new Date(Date.now()-1e3*60),actor:"https://api.phantom.app/v1/services/trending-token-alert",object:`${t}`,summary:"Trending Token"}),lx=ei.parse(wu(0)),mx=ei.parse(wu(1)),dx=ei.parse(wu(2));var oQ=Y({minutes:10}),nQ=Y({seconds:60});s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();var O_=Y({minutes:5});s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();var po=Qo(te,t=>new hu(t)),hu=class{#e;constructor(e){this.#e=e}profileFollowRequestAcceptedByUser({targetId:e,actorId:r}){let o=ye(e),n=ye(r);this.#e.capture("profileFollowRequestAcceptedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"followRequestAccepted"}})}profileFollowRequestDeniedByUser({targetId:e,actorId:r}){let o=ye(e),n=ye(r);this.#e.capture("profileFollowRequestDeniedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"followRequestDenied"}})}profileUnfollowedByUser({targetId:e,actorId:r}){let o=ye(e),n=ye(r);this.#e.capture("profileUnfollowedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"unfollow"}})}profileFollowedByUser({targetId:e,actorId:r,isRequest:o}){let n=ye(e),i=ye(r);this.#e.capture("profileFollowedByUser",{data:{targetId:e,targetProfileId:n,actorId:r,actorProfileId:i,type:o?"followRequest":"follow"}})}profileReportedByUser({targetId:e,actorId:r,additionalData:o}){let n=ye(e),i=ye(r);this.#e.capture("profileReportedByUser",{data:{targetId:e,targetProfileId:n,actorId:r,actorProfileId:i,type:"report",...o}})}profileUnblockedByUser({targetId:e,actorId:r}){let o=ye(e),n=ye(r);this.#e.capture("profileUnblockedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"unblock"}})}profileBlockedByUser({targetId:e,actorId:r}){let o=ye(e),n=ye(r);this.#e.capture("profileBlockedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"block"}})}profileViewedByUser({targetId:e,actorId:r,isFollowing:o}){let n=ye(e),i=ye(r);this.#e.capture("profileViewedByUser",{data:{targetId:e,targetProfileId:n,actorId:r,actorProfileId:i,isFollowing:o,type:"view"}})}profileFollowersViewedByUser({targetId:e,actorId:r}){let o=ye(e),n=ye(r);this.#e.capture("profileFollowersViewedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"viewFollowers"}})}profileFollowingViewedByUser({targetId:e,actorId:r}){let o=ye(e),n=ye(r);this.#e.capture("profileFollowingViewedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"viewFollowing"}})}profileSharedByUser({targetId:e,actorId:r}){let o=ye(e),n=ye(r);this.#e.capture("profileSharedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"share"}})}};s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();var vy=N(Ty(),1),Ey=vy.default;var Ex=Ey.bind({concatArrays:!0,ignoreUndefined:!0});function xx(t,e){let r=self.localStorage.getItem(t);if(r){let o=JSON.parse(r),n=JSON.parse(e),i=JSON.stringify(Ex(o,n));self.localStorage.setItem(t,i)}else self.localStorage.setItem(t,e)}function an(t,e){return new Promise((r,o)=>{try{let n=t();e?.(null,n),r(n)}catch(n){e?.(n),o(n)}})}function Ns(t,e,r){return Promise.all(t).then(o=>{let n=r?.(o)??null;return e?.(null,n),Promise.resolve(n)},o=>(e?.(o),Promise.reject(o)))}var ri={getItem:(t,e)=>an(()=>self.localStorage.getItem(t),e),setItem:(t,e,r)=>an(()=>self.localStorage.setItem(t,e),r),removeItem:(t,e)=>an(()=>self.localStorage.removeItem(t),e),mergeItem:(t,e,r)=>an(()=>xx(t,e),r),clear:t=>an(()=>self.localStorage.clear(),t),getAllKeys:t=>an(()=>{let e=self.localStorage.length,r=[];for(let o=0;o<e;o+=1){let n=self.localStorage.key(o)||"";r.push(n)}return r},t),flushGetRequests:()=>{},multiGet:(t,e)=>{let r=t.map(n=>ri.getItem(n));return Ns(r,e,n=>n.map((i,c)=>[t[c],i]))},multiSet:(t,e)=>{let r=t.map(o=>ri.setItem(o[0],o[1]));return Ns(r,e)},multiRemove:(t,e)=>{let r=t.map(o=>ri.removeItem(o));return Ns(r,e)},multiMerge:(t,e)=>{let r=t.map(o=>ri.mergeItem(o[0],o[1]));return Ns(r,e)}},Au=ri;s();a();var xy=Au;s();a();var Ix=Object.defineProperty,Iy=Object.getOwnPropertySymbols,Fx=Object.prototype.hasOwnProperty,Cx=Object.prototype.propertyIsEnumerable,Fy=(t,e,r)=>e in t?Ix(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,cn=(t,e)=>{for(var r in e||(e={}))Fx.call(e,r)&&Fy(t,r,e[r]);if(Iy)for(var r of Iy(e))Cx.call(e,r)&&Fy(t,r,e[r]);return t},Bs=t=>e=>{try{let r=t(e);return r instanceof Promise?r:{then(o){return Bs(o)(r)},catch(o){return this}}}catch(r){return{then(o){return this},catch(o){return Bs(o)(r)}}}},Cy=(t,e)=>(r,o,n)=>{let i=cn({getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:b=>b,version:0,merge:(b,x)=>cn(cn({},x),b)},e);(i.blacklist||i.whitelist)&&console.warn(`The ${i.blacklist?"blacklist":"whitelist"} option is deprecated and will be removed in the next version. Please use the 'partialize' option instead.`);let c=!1,p=new Set,u=new Set,l;try{l=i.getStorage()}catch{}if(l)l.removeItem||console.warn(`[zustand persist middleware] The given storage for item '${i.name}' does not contain a 'removeItem' method, which will be required in v4.`);else return t((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...b)},o,n);let g=Bs(i.serialize),f=()=>{let b=i.partialize(cn({},o()));i.whitelist&&Object.keys(b).forEach(F=>{var P;!((P=i.whitelist)!=null&&P.includes(F))&&delete b[F]}),i.blacklist&&i.blacklist.forEach(F=>delete b[F]);let x,T=g({state:b,version:i.version}).then(F=>l.setItem(i.name,F)).catch(F=>{x=F});if(x)throw x;return T},y=n.setState;n.setState=(b,x)=>{y(b,x),f()};let h=t((...b)=>{r(...b),f()},o,n),S,w=()=>{var b;if(!l)return;c=!1,p.forEach(T=>T(o()));let x=((b=i.onRehydrateStorage)==null?void 0:b.call(i,o()))||void 0;return Bs(l.getItem.bind(l))(i.name).then(T=>{if(T)return i.deserialize(T)}).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==i.version){if(i.migrate)return i.migrate(T.state,T.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return T.state}).then(T=>{var F;return S=i.merge(T,(F=o())!=null?F:h),r(S,!0),f()}).then(()=>{x?.(S,void 0),c=!0,u.forEach(T=>T(S))}).catch(T=>{x?.(void 0,T)})};return n.persist={setOptions:b=>{i=cn(cn({},i),b),b.getStorage&&(l=b.getStorage())},clearStorage:()=>{var b;(b=l?.removeItem)==null||b.call(l,i.name)},rehydrate:()=>w(),hasHydrated:()=>c,onHydrate:b=>(p.add(b),()=>{p.delete(b)}),onFinishHydration:b=>(u.add(b),()=>{u.delete(b)})},w(),S||h};var Px=xe(Cy((t,e)=>({username:void 0,setUsername:r=>t({username:r})}),{name:"view-feed-as",getStorage:()=>xy}));s();a();s();a();var Ls="en-US",kx=new Intl.NumberFormat(Ls,{maximumFractionDigits:0}),Rx=new Intl.NumberFormat(Ls,{notation:"compact",compactDisplay:"short",maximumFractionDigits:1,minimumFractionDigits:1}),Dx=new Intl.NumberFormat(Ls,{notation:"compact",compactDisplay:"short",maximumFractionDigits:0,minimumFractionDigits:0}),Nx=new Intl.NumberFormat(Ls,{notation:"compact",compactDisplay:"short",maximumFractionDigits:1,minimumFractionDigits:1}),Us=t=>{if(t<1e3)return kx.format(t);if(t<1e5){let r=Math.floor(t/100)*100;return Rx.format(r).replace(".0K","K")}if(t<1e6){let r=Math.floor(t/1e3)*1e3;return Dx.format(r)}let e=Math.floor(t/1e5)*1e5;return Nx.format(e).replace(".0M","M")};s();a();s();a();s();a();var Bx=t=>{let{data:e}=fu(t);return Py(e)},Py=t=>{let e={followers:t?.followers&&typeof t.followers=="object"&&t?.followers?.totalItems||0,following:t?.following&&typeof t.following=="object"&&t?.following?.totalItems||0};return{...e,formattedFollowers:Us(e.followers||0),formattedFollowing:Us(e.following||0)}};s();a();s();a();var Gu=N(cS()),Pe=N(M());s();a();s();a();s();a();var pS={tokenSearchEnabled:()=>!0,trendingTokensEnabled:()=>!0};s();a();var uS={tokenSearchEnabled:()=>!0,trendingTokensEnabled:()=>!1};s();a();var lS={tokenSearchEnabled:()=>!0,trendingTokensEnabled:()=>!0};s();a();var mS={tokenSearchEnabled:()=>ve.isFeatureEnabled("enable-monad-explore-search"),trendingTokensEnabled:()=>!1};s();a();var dS={tokenSearchEnabled:()=>!0,trendingTokensEnabled:()=>!0};s();a();var fS={tokenSearchEnabled:()=>!0,trendingTokensEnabled:()=>!0};s();a();var gS={tokenSearchEnabled:()=>ve.isFeatureEnabled("enable-sui-explore-search"),trendingTokensEnabled:()=>!1};var CF=new Oo({solana:fS,ethereum:lS,polygon:dS,base:pS,bitcoin:uS,monad:mS,sui:gS}),Mu=_o(CF);s();a();var yS={fields:["domain","name","category","tags"],storeFields:["domain","name","category","tags","imageUrl"],searchOptions:{boost:{name:2},prefix:!0,fuzzy:t=>t.length>3?.2:!1}};s();a();var Js=t=>["explore-dapp",t];var Qu=t=>t.addresses.map(e=>I.getMainnetNetworkID(e.networkID))??[];function SS(t){try{return Zr.get(t).nonNativeFungibleTokenType}catch{return"SolanaNative"}}s();a();s();a();var Qt="@phantom/explore",Le={RecentlyViewedSearchItems:[Qt,"RecentlyViewedSearchItems"],sitesV2({sortBy:t,timeFrame:e,networkIDs:r,limit:o,locale:n,rankAlgo:i}){return[Qt,"sitesV2",he,n,{sortBy:t,timeFrame:e,networkIDs:r,rankAlgo:i,limit:o}]},recommendedSites(t,e){return[Qt,"sites","recommended",he,e,t]},tokensV2({sortBy:t,sortDirection:e,timeFrame:r,networkIDs:o,limit:n,rankAlgo:i}){return[Qt,"tokensV2",{sortBy:t,sortDirection:e,timeFrame:r,networkIDs:o,rankAlgo:i,limit:n}]},collectionsV2({sortBy:t,timeFrame:e,networkIDs:r,limit:o,locale:n,rankAlgo:i}){return[Qt,"collectionsV2",he,n,{sortBy:t,timeFrame:e,networkIDs:r,rankAlgo:i,limit:o}]},featuredTransactions(t,e){return[Qt,"transactions","featured",he,e,t]},learn(t,e){return[Qt,"learn",he,e,t]}};var PF=10,hS="RecentlyViewedSearchItems";async function kF(t){return await t.get(hS)??[]}async function bS(t,e){await t.set(hS,e)}function _u(t){return $({queryKey:Le.RecentlyViewedSearchItems,queryFn:async()=>kF(t),staleTime:0,enabled:!0})}function RF(t){let e=W();return me({mutationFn:async o=>{let n=wS(o),c=(e.getQueryData(Le.RecentlyViewedSearchItems)??[]).filter(p=>wS(p)!==n);c.unshift(o),c=c.slice(0,PF),await bS(t,c),e.setQueryData(Le.RecentlyViewedSearchItems,c),await e.refetchQueries({queryKey:Le.RecentlyViewedSearchItems})}})}function DF(t){let e=W();return me({mutationFn:async()=>{await bS(t,[]),e.setQueryData(Le.RecentlyViewedSearchItems,[]),await e.refetchQueries({queryKey:Le.RecentlyViewedSearchItems})}})}function wS(t){return t.type==="token"?J(H(t.data)):t.data.id}s();a();var NF=t=>{let e={isRecommended:"true"};return t.networkIds&&(e.chainIds=t.networkIds.join(",")),`/dapps/v1?${new URLSearchParams(e).toString()}`},BF=async t=>{let e=await j.api().get(NF(t));if(e.status===500)throw new Error("Error fetching recommended dapps from registry");return(await e.data).data},Ou=t=>{let e=W();return $({queryKey:["dapps","recommended",t],queryFn:async()=>{try{let o=await BF(t);return Uo.batch(()=>{for(let n of o??[]){let i=Js(n.domain),c=e.getQueryState(i);e.setQueryData(i,()=>n??c?.data??null)}}),o}catch(o){throw Q.captureError(o,"dappRegistry"),o}},gcTime:Y({days:1}),staleTime:Y({days:1})})};s();a();s();a();var AS=async({sortBy:t,sortDirection:e,timeFrame:r,networkIDs:o,limit:n,rankAlgo:i})=>{let c=new URLSearchParams({timeFrame:r,sortBy:t,sortDirection:e,limit:n.toString(),rankAlgo:i});o.forEach(l=>{c.append("chainIds[]",l)});let p=await j.api().get("/explore/v2/trending-tokens",{params:c});if(!ne(p))throw new Error("Failed to fetch tokens");let u=iy.safeParse(p.data);if(!u.success)throw new Error("Failed to parse tokens");return u.data};s();a();var fn=(t,e)=>{let r=Gi(),n=uu().find(c=>c.type===e),i=[];return n&&"network"in n?n.network.forEach(c=>{c!==Jn&&r.includes(c)&&i.push(c)}):i=r,t!==Jn&&!i.includes(t)?[]:t===Jn?i:[t]};var LF=Y({minutes:1}),UF=Y({minutes:1}),MF=100,qu=({sortBy:t,sortDirection:e,timeFrame:r,network:o,limit:n,rankAlgo:i,enableQuery:c=!0})=>{let{data:p}=ue(),u=fn(o,"tokens"),l=MF,g=Ee(L.language)??"en";return $({queryKey:Le.tokensV2({sortBy:t,sortDirection:e,timeFrame:r,networkIDs:u,limit:l,rankAlgo:i}),enabled:!!p&&c,async queryFn(){if(!p)throw new Error("No account found");return AS({sortBy:t,sortDirection:e,timeFrame:r,networkIDs:u,locale:g,limit:l,rankAlgo:i})},gcTime:UF,staleTime:LF,retry:3,select:f=>n>=l?f:{...f,items:f.items.slice(0,n)}})};var si=3,QF=15,Vu=50,TS={VERIFIED:1,NOT_VERIFIED:2,POSSIBLE_SPAM:3,SPAM:4},_F=(t,e=100)=>{let[r,o]=(0,Pe.useState)(!1);return(0,Pe.useEffect)(()=>{let n;return t?n=setTimeout(()=>o(!0),e):o(!1),()=>clearTimeout(n)},[t,e]),r},OF=t=>{let e=SS(t.chainId),r=I.getChainDefinition(t.chainId),o={name:t.name,symbol:t.symbol,logoUri:t.logoUrl,chain:{id:t.chainId,symbol:r.tokenSymbol,name:r.name,imageUrl:r.iconUrl}};switch(e){case"SPL":return{type:e,data:{...o,mintAddress:t.address}};case"ERC20":return{type:e,data:{...o,contractAddress:t.address}};case"BRC20":return{type:e,data:{...o,firstCreatedInscriptionId:t.address}};default:return null}},qF=t=>t.reduce((e,r)=>{let o=OF(r);return o&&e.push(o),e},[]),VF=({searchQuery:t,networkIds:e,minSearchResults:r,excludePlaceholderTokens:o=!1,extraDapps:n=[]})=>{let[i,c]=(0,Pe.useState)(!1),[p,u]=(0,Pe.useState)(!1),[l,g]=(0,Pe.useState)(!1),f=(0,Pe.useMemo)(()=>e.filter(We=>Mu.get(We).tokenSearchEnabled()),[e]);(0,Pe.useEffect)(()=>{c(!1),u(!1),g(!1)},[t]);let{data:y=[],isPending:h}=ao({query:t,networkIds:f,searchContext:"explore",enableQuery:!!t}),S=lu("tokens"),{data:w}=qu({sortBy:S?.sortByDefault??"rank",sortDirection:S?.sortDirectionDefault??"asc",timeFrame:S?.timeFrameDefault??"24h",network:S?.networkDefault??"solana:101",limit:10,rankAlgo:S?.rankAlgo??"default",enableQuery:!t&&!o}),b=(0,Pe.useMemo)(()=>y.sort((We,Ln)=>TS[We.data.spamStatus??"NOT_VERIFIED"]-TS[Ln.data.spamStatus??"NOT_VERIFIED"]),[y]),x=(0,Pe.useMemo)(()=>w?.items?qF(w.items):[],[w?.items]),T=r??(t.length===0?QF:si),F=(0,Pe.useMemo)(()=>b.slice(0,p?Vu:T),[p,b,T]),P=(0,Pe.useMemo)(()=>[...b.map(We=>J(H(We))),...x.map(We=>J(H(We)))],[b,x]),{data:B={},isPending:R}=Bt({query:{data:P},enabled:P.length>0}),{data:q=[],isPending:G}=Ou({networkIds:f}),X=(0,Pe.useMemo)(()=>{let We=[...q,...n],Ln=(0,Gu.default)(We,CA=>Mi(CA.domain));return Object.values(Ln)},[q,n]),v=Mi(t),E=Km(X,v,yS),C=(0,Gu.default)(E,We=>Mi(We.domain)),U=Object.values(C),_=U.slice(0,i?Vu:si),{data:k,isPending:O,enabled:V}=gu({query:t}),D=V&&O,ce=!!t,pe=G||h||D,Qe=ce&&!pe,Ct=re(),{data:No}=_u(Ct),{actorsAll:Re,actors:ie}=(0,Pe.useMemo)(()=>{let We=k?.actors??[],Ln=We.slice(0,l?Vu:si);return{actorsAll:We,actors:Ln}},[l,k?.actors]),Ke=(0,Pe.useMemo)(()=>({actors:ie,dapps:q,searchedDapps:_,renderShowMoreDappsButton:ce&&U.length>si,isLoading:pe,tokens:F,trendingTokens:x,renderShowMoreTokensButton:ce&&b.length>T,renderShowMoreUsersButton:ce&&Re.length>si,priceMap:B,isPriceMapLoading:R,showSearchResults:Qe,showMoreTokens:p,setShowMoreTokens:u,showMoreDapps:i,setShowMoreDapps:c,showMoreUsers:l,setShowMoreUsers:g,recentlyViewedSearchItems:No}),[ie,q,_,ce,U.length,pe,F,x,b.length,T,Re.length,B,R,Qe,p,i,l,No]),[Pt,Wr]=(0,Pe.useState)(null),FA=_F(pe);return(0,Pe.useEffect)(()=>{Ke.isLoading||Wr(t?Ke:null)},[Ke.isLoading,t]),{...Ke.isLoading&&Pt?Pt:Ke,showSpinner:FA&&ce}};s();a();s();a();var GF=t=>`/dapps/v1?domains=${t.join(",")}`,KF=async t=>{let e=await j.api().get(GF(t));if(e.status===500)throw new Error("Error fetching recommended dapps from registry");return e.data.data},HF=t=>{let e=W(),r=t!=null&&Array.isArray(t)&&t.length>0&&t.filter(n=>n!=null&&n!="").length>0;return $({queryKey:["dapps",t],enabled:r,queryFn:async()=>{try{let n=await KF(t);return Uo.batch(()=>{for(let i of n??[]){let c=Js(i.domain),p=e.getQueryState(c);e.setQueryData(c,()=>i??p?.data??null)}}),n}catch(n){throw Q.captureError(n,"dappRegistry"),n}},gcTime:Y({days:1}),staleTime:Y({days:1})})};s();a();var xS=N(M());s();a();var ES=async(t,e)=>{let r=new URLSearchParams({appVersion:he,limit:"6",locale:e,platform:_e,timeframe:"24h"});t.forEach(i=>{r.append("chainIds[]",i)});let o=await j.api().get("/explore/v1/featured-dapps",{params:r});if(!ne(o))throw new Error("Failed to fetch sites");return await o.data};var $F=Y({minutes:10}),zF=Y({minutes:10}),WF=()=>{let{data:t}=ue(),e=(0,xS.useMemo)(()=>t?Qu(t):[],[t]),r=Ee(L.language)??"en",o=async()=>{if(!t)throw new Error("No account found");return ES(e,r)};return $({queryKey:Le.recommendedSites(e,r),enabled:!!t,queryFn:o,gcTime:$F,staleTime:zF})};s();a();var jF=N(M());s();a();var R$=Y({minutes:10}),D$=Y({minutes:10});s();a();s();a();var YF={rank:"trending",top:"top"},IS=async({sortBy:t,timeFrame:e,networkIDs:r,limit:o,locale:n,rankAlgo:i})=>{let c=new URLSearchParams({appVersion:he,limit:o.toString(),locale:n,platform:_e,rankAlgo:i,rankBy:YF[t],timeframe:e});r.forEach(l=>{c.append("chainIds[]",l)});let p=await j.api().get("/explore/v1/trending-dapps",{params:c});if(!ne(p))throw new Error("Failed to fetch sites");let u=ny.safeParse(p.data);if(!u.success)throw new Error("Failed to parse sites");return u.data};var XF=Y({minutes:10}),JF=Y({minutes:10}),ZF=({sortBy:t,timeFrame:e,network:r,limit:o,rankAlgo:n})=>{let{data:i}=ue(),c=fn(r,"sites"),p=Ee(L.language)??"en";return $({queryKey:Le.sitesV2({sortBy:t,timeFrame:e,networkIDs:c,locale:p,limit:o,rankAlgo:n}),enabled:!!i,async queryFn(){if(!i)throw new Error("No account found");return IS({sortBy:t,timeFrame:e,networkIDs:c,locale:p,limit:o,rankAlgo:n})},gcTime:JF,staleTime:XF,retry:3})};s();a();s();a();var eC={rank:"trending",top:"volume"},tC=t=>t.floorPrices.length>0&&t.marketplacePages.length>0,FS=async({sortBy:t,timeFrame:e,networkIDs:r,limit:o,locale:n,rankAlgo:i})=>{let c=new URLSearchParams({appVersion:he,limit:o.toString(),locale:n,platform:_e,rankAlgo:i,rankBy:eC[t],timeframe:e});r.forEach(l=>{c.append("chainIds[]",l.toString())});let p=await j.api().get("/explore/v1/trending-collections",{params:c});if(!ne(p))throw new Error("Failed to fetch collections");let u=sy.safeParse(p.data);if(!u.success)throw new Error("Failed to parse collections");return{...u.data,data:u.data.data.filter(tC)}};var rC=Y({minutes:10}),oC=Y({minutes:10}),nC=({sortBy:t,timeFrame:e,network:r,limit:o,rankAlgo:n})=>{let{data:i}=ue(),c=fn(r,"collections"),p=Ee(L.language)??"en";return $({queryKey:Le.collectionsV2({sortBy:t,timeFrame:e,networkIDs:c,locale:p,limit:o,rankAlgo:n}),enabled:!!i,async queryFn(){if(!i)throw new Error("No account found");return FS({sortBy:t,timeFrame:e,networkIDs:c,locale:p,limit:o,rankAlgo:n})},gcTime:oC,staleTime:rC,retry:3})};s();a();s();a();var CS=async(t,e)=>{let r=new URLSearchParams({appVersion:he,locale:e,platform:_e});t.forEach(i=>{r.append("chainIds[]",i)});let o=await j.api().get("/explore/v1/learn-grid",{params:r});if(!ne(o))throw new Error("Failed to fetch learn grid");return o.data};var iC=Y({minutes:10}),sC=Y({minutes:10}),aC=()=>{let t=Gi(),e=Ee(L.language)??"en";return $({queryKey:Le.learn(t,e),enabled:t.length>0,async queryFn(){return CS(t,e)},gcTime:sC,staleTime:iC})};s();a();s();a();s();a();s();a();var tt=N(M());var pC=tt.default.lazy(()=>import("./FiatRampFlow-RJPQM42R.js").then(t=>({default:t.FiatRampFlow}))),uC=tt.default.lazy(()=>import("./FiatRampPaymentMethodsPage-PENQWU37.js").then(t=>({default:t.FiatRampPaymentMethodsPage}))),PS=tt.default.lazy(()=>import("./FiatRampProvidersPage-D3GSQHOK.js").then(t=>({default:t.FiatRampProvidersPage}))),lC=tt.default.lazy(()=>import("./FiatRampFlowPreselectedToken-LBEHLNYA.js").then(t=>({default:t.FiatRampFlowPreselectedToken}))),mC=tt.default.lazy(()=>import("./FiatRampFlowPreselectedToken-LBEHLNYA.js").then(t=>({default:t.WrappedFiatRampFormPage}))),dC=tt.default.lazy(()=>import("./FiatRampWaitingOnRamp-I57VOMGX.js").then(t=>({default:t.FiatRampWaitingOnRamp}))),kS=jc({id:"fiat-ramp-detail",initialViewId:"fiat-ramp-detail-providers",views:[{id:"fiat-ramp-detail-providers",element:tt.default.createElement(PS,null)},{id:"fiat-ramp-detail-payment-methods",element:tt.default.createElement(uC,null)}],display:"modal",stacks:[]}),fC=jc({id:"fiat-ramp",initialViewId:"fiat-ramp-fungible-selection",views:[{id:"fiat-ramp-fungible-selection",element:tt.default.createElement(pC,null)},{id:"fiat-ramp-fungible-selected",element:tt.default.createElement(lC,null),params:{buy:d.string(),amount:d.number().optional(),redirectURL:d.string().url().optional()}},{id:"fiat-ramp-form",element:tt.default.createElement(mC,null)},{id:"fiat-ramp-providers",element:tt.default.createElement(PS,null)},{id:"fiat-ramp-waiting-on-ramp",element:tt.default.createElement(dC,null),params:{sessionId:d.string(),caip19:d.string()}}],display:"modal",stacks:[kS]});s();a();s();a();s();a();s();a();var Zs=t=>{let e=[];for(let r in t.errors)Array.isArray(t.errors[r])&&e.push(t.errors[r].join(", "));return e.join(", ")};var DS=async({locale:t})=>{let e;try{let r=JSON.stringify({platform:_e,appVersion:he,locale:t}),o=await j.api().headers({"Content-Type":"application/json"}).post(({apiEnv:i})=>`/banners/force_upgrade/${i}/v1`,r);if(o.status===400){let i=await o.data,c=Zs(i);throw new Error(c)}else if(o.status<200||o.status>299)throw new Error(`status code: ${o.status}, body: ${o.statusText}`);let n=o.data;return n?{...n}:RS}catch(r){return e===400&&r instanceof Error&&Q.captureError(r,"actionBanner"),RS}},RS={forceUpgradeStatus:"noop"};var NS=async({locale:t})=>({...await DS({locale:t})});s();a();var gn="@phantom/interstitials",Dr=`${gn}:action-banners`,BS=`${gn}:force-upgrade`,Oe={actionBanners:(t,e)=>[Dr,{accountIdentifier:t,accessToken:e}],hasSeenInterstitial:t=>[`${gn}:has-seen-interstitial`,{feature:t}],interstitialViewHistory:t=>[`${gn}:interstitial-view-history`,{feature:t}],appLaunchTimes:()=>[`${gn}:app-launch-times`],lastOnboardedAt:()=>[`${gn}:last-onboarded-at`]};var gC=()=>$({queryKey:[BS],queryFn:async()=>{let e=Ee(L.language)??"en";return NS({locale:e})},enabled:!!he,staleTime:Y({minutes:5})});s();a();s();a();s();a();s();a();var ea=(w=>(w.Buy="Buy",w.Collectibles="Collectibles",w.ConnectHardwareWallet="Connect Hardware Wallet",w.ConvertToJito="Convert to Jito",w.Explore="Explore",w.MintCollectible="Mint Collectible",w.SocialLogin="Social Login",w.SettingsClaimUsername="Settings: Claim Username",w.SettingsCurrency="Settings: Currency",w.SettingsImportSeedPhrase="Settings: Import Seed Phrase",w.SettingsNotificationPreferences="Settings: Notification Preferences",w.SettingsSecurityAndPrivacy="Settings: Security & Privacy",w.Swapper="Swapper",w.ExternalLink="External Link",w.Token="Token",w))(ea||{}),ci=class extends Error{message="Failed to set dismissed action banners to storage"};var yC={Multichain:2,MultichainSwapper:1,InvalidChecksum:1,SuiWelcome:1,MonadWelcome:1,ClaimUsernameNudge:1,QuickClaimUsername:1,SeedlessPinVerification:1,AdditionalPermissions:1},SC={Multichain:3,MultichainSwapper:1,InvalidChecksum:1,SuiWelcome:1,MonadWelcome:1,ClaimUsernameNudge:1,QuickClaimUsername:1,AdditionalPermissions:1,SeedlessPinVerification:1},Ku=t=>Ye?yC[t]:Lm?SC[t]:-1;var Hu=1,mr=".phantom-labs.settings.interstitials",Nr=class{static async getViewHistory(e,r){let o=await r.get(mr);return o?o.interstitialsViewHistory[e]??[]:[]}static async hasSeen(e,r){let o=await r.get(mr);if(!o)return!1;let n=Ku(e);return(o.interstitialsSeen[e]??0)>=n}static async setHasSeen(e,r){let o=await r.get(mr),n=Ku(e);await r.set(mr,{version:Hu,interstitialsSeen:{...!!o&&o.interstitialsSeen,[e]:n},interstitialsViewHistory:{...!!o&&o.interstitialsViewHistory,[e]:[...o?.interstitialsViewHistory?.[e]??[],Date.now()]}})}static async resetHasSeen(e,r){let o=await r.get(mr);if(o)return r.set(mr,{version:Hu,interstitialsSeen:{...o.interstitialsSeen,[e]:void 0},interstitialsViewHistory:{...o.interstitialsViewHistory,[e]:void 0}})}static async resetAllHasSeen(e){if(await e.get(mr))return e.set(mr,{version:Hu,interstitialsSeen:{},interstitialsViewHistory:{}})}};var $u=t=>{let e=re(),r=Oe.hasSeenInterstitial(t);return $({queryKey:r,queryFn:async()=>await Nr.hasSeen(t,e)})};s();a();s();a();var LS=async t=>{await t.invalidateQueries({queryKey:[Dr]})};ed(LS);var US=async(t,e,r)=>{await t.setQueryData(Oe.hasSeenInterstitial(e),r)};var pi=t=>{let e=re(),r=W();return me({mutationFn:async()=>{await Nr.setHasSeen(t,e),await US(r,t,!0)},onSuccess:()=>r.invalidateQueries({queryKey:Oe.interstitialViewHistory(t)})})};s();a();var _t=N(M());s();a();var ra=N(M());s();a();s();a();s();a();var zu=async t=>await t.get("dismissedActionBanners")??[],MS=async(t,e)=>{try{let r=await zu(t);return r.includes(e)?void 0:t.set("dismissedActionBanners",[...r,e])}catch{throw new ci}};var ju=()=>{let t=re(),{data:e}=$({queryKey:Oe.appLaunchTimes(),queryFn:async()=>await t.get("appLaunchTimes")??[]});return e??[]};s();a();var Yu=()=>{let t=re(),{data:e}=$({queryKey:Oe.lastOnboardedAt(),queryFn:async()=>await t.get("lastOnboardedAt")??-1});return e};var QS=()=>{let t=Yu(),e=ju();if(e.length<2)return!0;if(t!==void 0){let[r,o]=e;if(t<r&&t<o)return!1}return!0};function ui(t,e,r){let{data:o,isSuccess:n}=$u(t),{data:i}=fe(e?[e]:[]),c=i?.length===1?i[0]:!0,p=QS(),u=(0,ra.useCallback)(()=>r(),[r]);return(0,ra.useMemo)(()=>c&&n&&!o&&!p&&u(),[c,o,p,u,n])}var Xu={data:{feature:"sui"}},wC=({onPrimaryAction:t,onSecondaryAction:e,image:r,condition:o=()=>!0})=>{let{t:n}=pt(),{mutateAsync:i}=Vi(),[c]=Ki(["sui"]),{mutate:p}=pi("SuiWelcome"),u=ui("SuiWelcome",void 0,()=>o()&&!c&&!Mn()),l=(0,_t.useCallback)(async()=>{await i({chainIDs:["sui"]}),t(),p()},[i,t,p]),g=(0,_t.useCallback)(()=>{e(),p()},[e,p]),f=(0,_t.useMemo)(()=>({title:n("interstitialSuiWelcomeTitle"),items:[{key:"suiValueProp1",title:n("interstitialSuiWelcomeItemTitle_1"),icon:_t.default.createElement(Er,{icon:"Send",color:"bgWallet",backgroundColor:"accentPrimary",shape:"square"}),description:n("interstitialSuiWelcomeItemDescription_1")},{key:"suiValueProp2",title:n("interstitialSuiWelcomeItemTitle_2"),icon:_t.default.createElement(Er,{icon:"Compass",color:"bgWallet",backgroundColor:"accentPrimary",shape:"square"}),description:n("interstitialSuiWelcomeItemDescription_2")},{key:"suiValueProp3",title:n("interstitialSuiWelcomeItemTitle_3"),icon:_t.default.createElement(Er,{icon:"Smile",color:"bgWallet",backgroundColor:"accentPrimary",shape:"square"}),description:n("interstitialSuiWelcomeItemDescription_3")}],primaryButton:{children:n("interstitialSuiWelcomePrimaryButtonText"),onAction:l,analyticsEvent:{event:"welcomeInterstitialPrimaryButtonClickedByUser",payload:Xu}},secondaryButton:{children:n("commandNotNow"),onAction:g,analyticsEvent:{event:"welcomeInterstitialSecondaryButtonClickedByUser",payload:Xu}},onDismiss:p,image:r,displayEvent:{event:"welcomeInterstitialSeen",payload:Xu}}),[n,l,g,r,p]);return(0,_t.useMemo)(()=>({interstitial:f,shouldShow:u}),[f,u])};s();a();var Ot=N(M());var Ju={data:{feature:"monad"}},hC=({onPrimaryAction:t,onSecondaryAction:e,image:r,condition:o=()=>!0})=>{let{t:n}=pt(),{mutateAsync:i}=Vi(),[c]=Ki(["monad"]),{mutate:p}=pi("MonadWelcome"),u=ui("MonadWelcome","enable-monad",()=>o()&&!c&&!Mn()),l=(0,Ot.useCallback)(async()=>{await i({chainIDs:["monad"]}),t(),p()},[i,t,p]),g=(0,Ot.useCallback)(()=>{e(),p()},[e,p]),f=(0,Ot.useMemo)(()=>({title:n("interstitialMonadWelcomeTitle"),items:[{key:"monadValueProp1",title:n("interstitialMonadWelcomeItemTitle_1"),icon:Ot.default.createElement(Er,{icon:"InfoCircle",color:"accentPrimary",backgroundColor:"brandMidnight",shape:"square"}),description:n("interstitialMonadWelcomeItemDescription_1")},{key:"monadValueProp2",title:n("interstitialMonadWelcomeItemTitle_2"),icon:Ot.default.createElement(Er,{icon:"InfoCircle",color:"accentPrimary",backgroundColor:"brandMidnight",shape:"square"}),description:n("interstitialMonadWelcomeItemDescription_2")},{key:"monadValueProp3",title:n("interstitialMonadWelcomeItemTitle_3"),icon:Ot.default.createElement(Er,{icon:"InfoCircle",color:"accentPrimary",backgroundColor:"brandMidnight",shape:"square"}),description:n("interstitialMonadWelcomeItemDescription_3")}],primaryButton:{children:n("interstitialMonadWelcomePrimaryButtonText"),onAction:l,analyticsEvent:{event:"welcomeInterstitialPrimaryButtonClickedByUser",payload:Ju}},secondaryButton:{children:n("commandNotNow"),onAction:g,analyticsEvent:{event:"welcomeInterstitialSecondaryButtonClickedByUser",payload:Ju}},onDismiss:p,image:r,displayEvent:{event:"welcomeInterstitialSeen",payload:Ju}}),[n,l,g,r,p]);return(0,Ot.useMemo)(()=>({interstitial:f,shouldShow:u}),[f,u])};s();a();s();a();s();a();s();a();var OS=async({accountID:t,deviceId:e,locale:r,rootId:o,selectedAccountAddresses:n,accessToken:i})=>{let c;try{let p={accountID:t,deviceId:e,locale:r,platform:_e,rootId:o,selectedAccountAddresses:n,version:he},u=await j.api().headers({"Content-Type":"application/json"}).bearer(i).post(({apiEnv:g})=>`/banners/get_banners/${g}/v2`,p);if(u.status===400){let g=await u.data,f=Zs(g);throw new Error(f)}else if(u.status<200||u.status>299)throw new Error(`status code: ${u.status}, body: ${await u.statusText}`);let l=u.data;return l?{...l,banners:l.banners??[]}:_S}catch(p){return c===400&&p instanceof Error&&Q.captureError(p,"actionBanner"),_S}},_S={id:void 0,banners:[]};s();a();s();a();var Zu=t=>t?Object.values(ea).includes(t):!1;s();a();var qS=t=>{switch(t){case"Bottom Sheet":return Ye;case"Modal":return!0;default:return!1}};var VS=t=>{let{bannerType:e,destinationType:r}=t;switch(e){case"Deep Link":return Zu(r);case"Bottom Sheet":case"Modal":return qS(e)&&Zu(r);default:return!1}};var GS=async({accountID:t,deviceId:e,dismissedBanners:r,locale:o,rootId:n,selectedAccountAddresses:i,accessToken:c})=>{let p=await OS({accountID:t,deviceId:e,locale:o,rootId:n,selectedAccountAddresses:i,accessToken:c});return{...p,banners:p.banners.filter(u=>VS(u)&&!r.includes(u.id))}};var bC=Y({minutes:1}),AC=()=>{let t=te(),e=re(),{data:r,isLoading:o}=On(),{data:n}=ue(),i=async()=>{let c=n?.type!=="readOnly"?n?.addresses.map(Zm)??[]:[],p=n?.type==="seed"?n.seedIdentifier:null,u=await zu(e),l=Ee(L.language)??"en",g=await t.getDeviceId();return GS({accountID:n?.identifier??"",deviceId:g,dismissedBanners:u,locale:l,rootId:p,selectedAccountAddresses:c,accessToken:r?.accessToken})};return $({queryKey:Oe.actionBanners(n?.identifier,r?.accessToken),queryFn:i,enabled:!o&&!!n?.identifier,staleTime:bC})};s();a();var TC=()=>{let t=re(),e=W();return me({mutationFn:async({actionBannerId:o})=>{MS(t,o),e.setQueriesData({queryKey:[Dr]},n=>{if(!n)return;let i=n.banners.filter(c=>c.id!==o);return{...n,banners:i}})}})};s();a();s();a();var vC=()=>{let t=re(),e=W();return me({mutationFn:async()=>{let r=Date.now(),n=[...(await t.get("appLaunchTimes")||[]).slice(-1),r];return t.set("appLaunchTimes",n)},onSuccess:()=>{e.invalidateQueries({queryKey:Oe.appLaunchTimes()})}})};s();a();var EC=()=>{let t=re(),e=W();return me({mutationFn:()=>{let r=Date.now();return t.set("lastOnboardedAt",r)},onSuccess:()=>{e.invalidateQueries({queryKey:Oe.lastOnboardedAt()})}})};s();a();s();a();var Ae={buyFungible:void 0,buyUsdValue:void 0,sellFungible:void 0,sellUsdValue:void 0,sellAmount:"",uiSellAmountCryptoInput:"",amountType:"sell",quoteResponse:void 0,selectedProviderIndex:0,gasEstimation:{isFetching:!1,estimate:void 0,estimateWithBuffer:void 0},hasNoRoutes:!1,isFetchingQuote:!1,error:null,searchQuery:"",numSearchResults:0,primaryCurrency:"crypto",uiSellAmountLocalFiatInput:"",uiBuyAmountCryptoInput:"",uiBuyAmountLocalFiatInput:"",canInputFiatSellAmount:!1,swapFilter:void 0},A=xe(t=>({...Ae,resetQuote:()=>t({quoteResponse:Ae.quoteResponse,isFetchingQuote:Ae.isFetchingQuote,hasNoRoutes:Ae.hasNoRoutes,selectedProviderIndex:Ae.selectedProviderIndex,error:Ae.error,uiSellAmountLocalFiatInput:Ae.uiSellAmountLocalFiatInput}),resetSwapper:()=>t({quoteResponse:Ae.quoteResponse,gasEstimation:Ae.gasEstimation,error:Ae.error,sellAmount:"",uiSellAmountCryptoInput:"",uiBuyAmountCryptoInput:Ae.uiBuyAmountCryptoInput,swapFilter:Ae.swapFilter}),setBuyFungible:e=>t({buyFungible:e}),setBuyUsdValue:e=>t({buyUsdValue:e}),setHasNoRoutes:e=>t({hasNoRoutes:e}),setIsFetchingQuote:e=>t({isFetchingQuote:e}),setQuoteResponse:e=>t({quoteResponse:e,hasNoRoutes:!1}),setSelectedProviderIndex:e=>t({selectedProviderIndex:e}),setGasEstimation:({estimate:e,estimateWithBuffer:r,isFetching:o})=>t(n=>({gasEstimation:{...n.gasEstimation,...e!==void 0&&{estimate:e},...r!==void 0&&{estimateWithBuffer:r},...o!==void 0&&{isFetching:o}}})),setSellAmount:e=>t({sellAmount:e}),setAmountType:e=>t({amountType:e}),setSellUsdValue:e=>t({sellUsdValue:e}),setSellFungible:e=>t({sellFungible:e}),setUiSellAmountCryptoInput:e=>t({uiSellAmountCryptoInput:e}),setError:e=>t({error:e}),setSearchQuery:e=>t({searchQuery:e}),setNumSearchResults:e=>t({numSearchResults:e}),setPrimaryCurrency:e=>t({primaryCurrency:e}),setUiSellAmountLocalFiatInput:e=>t({uiSellAmountLocalFiatInput:e}),setUiBuyAmountCryptoInput:e=>t({uiBuyAmountCryptoInput:e}),setUiBuyAmountLocalFiatInput:e=>t({uiBuyAmountLocalFiatInput:e}),setCanInputFiatSellAmount:e=>t({canInputFiatSellAmount:e}),setSwapFilter:e=>t({swapFilter:e}),switchTokensForSell:()=>{t(e=>{let r=e.sellFungible??e.buyFungible,o=e.buyFungible??e.sellFungible,n=e.uiBuyAmountCryptoInput,i=e.uiBuyAmountLocalFiatInput;return{sellFungible:o,buyFungible:r,uiSellAmountCryptoInput:n,uiSellAmountLocalFiatInput:i,uiBuyAmountCryptoInput:Ae.uiBuyAmountCryptoInput,uiBuyAmountLocalFiatInput:Ae.uiBuyAmountLocalFiatInput,sellAmount:n,swapFilter:void 0}})},switchTokensForBuy:()=>{t(e=>{let r=e.sellFungible??e.buyFungible,o=e.buyFungible??e.sellFungible,n=e.uiSellAmountCryptoInput,i=e.uiSellAmountLocalFiatInput;return{sellFungible:o,buyFungible:r,uiSellAmountCryptoInput:Ae.uiSellAmountCryptoInput,uiSellAmountLocalFiatInput:Ae.uiSellAmountLocalFiatInput,uiBuyAmountCryptoInput:n,uiBuyAmountLocalFiatInput:i,sellAmount:n,swapFilter:void 0}})},resetUiAmounts:()=>t({uiSellAmountCryptoInput:Ae.uiSellAmountCryptoInput,uiSellAmountLocalFiatInput:Ae.uiSellAmountLocalFiatInput,uiBuyAmountCryptoInput:Ae.uiBuyAmountCryptoInput,uiBuyAmountLocalFiatInput:Ae.uiBuyAmountLocalFiatInput,sellAmount:Ae.sellAmount}),setPairAndAmount:({sell:e,buy:r,swapAmount:o})=>t(n=>{let i="uiSellAmountCryptoInput";return o.perspective==="sell"?n.primaryCurrency==="crypto"?i="uiSellAmountCryptoInput":i="uiSellAmountLocalFiatInput":n.primaryCurrency==="crypto"?i="uiBuyAmountCryptoInput":i="uiBuyAmountLocalFiatInput",{...n,sellFungible:e,buyFungible:r,[i]:o.amount,sellAmount:o.amount}})}));s();a();var HS=N(M());function ee(){let t=A(p=>p.quoteResponse),e=A(p=>p.hasNoRoutes),r=A(p=>p.selectedProviderIndex),o=A(p=>p.isFetchingQuote),n=(0,HS.useMemo)(()=>t?t.quotes:[],[t]),i=n.length>0?n[r]:void 0;return{bestBuyAmount:n[0]?.buyAmount??"",currentQuote:i,hasNoRoutes:e,quoteResponse:t,quotes:n,selectedProviderIndex:r,isFetchingQuote:o}}s();a();var pw=N(M());s();a();var cw=N(M());s();a();var aw=N(M());s();a();s();a();s();a();s();a();var tl=5,rl=5,$S={id:I.solana.mainnetID,imageUrl:I.solana.iconUrl,name:I.solana.name,symbol:I.solana.tokenSymbol},oa={type:"SolanaNative",data:{amount:"0",balance:new K(0),chain:$S,decimals:9,key:"SolanaNative",logoUri:"https://cdn.jsdelivr.net/gh/solana-labs/token-list@main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png",name:"Solana",symbol:"SOL",tokenAddress:void 0,walletAddress:"",spamStatus:"VERIFIED"}},ol={type:"SPL",data:{amount:"0",balance:new K(0),chain:$S,decimals:6,key:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v/logo.png",mintAddress:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",name:"USD Coin",splTokenAccountPubkey:"EAF7dH8Jy43Xgp68PhyybKhfKxk46NFRkWN4PMCLqMfS",symbol:"USDC",tokenAddress:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",walletAddress:"",programId:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",spamStatus:"VERIFIED"}},zS={type:"SuiNative",data:{chain:{id:I.sui.mainnetID,name:I.sui.name,symbol:I.sui.tokenSymbol,imageUrl:I.sui.iconUrl},walletAddress:"",decimals:18,amount:"0",logoUri:"https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/sui/info/logo.png",name:"Sui",symbol:"SUI",balance:new K(0),key:"SuiNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:"VERIFIED"}},WS={type:"SuiCoin",data:{chain:{id:I.sui.mainnetID,name:I.sui.name,symbol:I.sui.tokenSymbol,imageUrl:I.sui.iconUrl},walletAddress:"",contractAddress:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",decimals:6,amount:"0",logoUri:"https://assets.coingecko.com/coins/images/6319/large/USD_Coin_icon.png?1547042389",name:"USD Coin",symbol:"USDC",balance:new K(0),key:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",tokenAddress:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",usd:1.8807026139560001,price:.999793,usd_24h_change:-.0005475429199477411,spamStatus:"VERIFIED"}},jS={type:"PolygonNative",data:{chain:{id:I.polygon.mainnetID,name:I.polygon.name,symbol:I.polygon.tokenSymbol,imageUrl:I.polygon.iconUrl},walletAddress:"",decimals:18,amount:"72172806352057410682",logoUri:"https://wallet-asset.matic.network/img/tokens/matic.svg",name:"Polygon",symbol:I.polygon.tokenSymbol,balance:new K(0),key:"PolygonNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:"VERIFIED"}},YS={type:"BaseNative",data:{chain:{id:I.base.mainnetID,name:I.base.name,symbol:I.base.tokenSymbol,imageUrl:I.base.iconUrl},walletAddress:"",decimals:18,amount:"72172806352057410682",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Base",symbol:I.base.tokenSymbol,balance:new K(0),key:"BaseNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:"VERIFIED"}},XS={type:"ERC20",data:{amount:"0",balance:new K(0),decimals:6,key:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",walletAddress:"",chain:{id:I.polygon.mainnetID,imageUrl:I.polygon.iconUrl,name:I.polygon.name,symbol:I.polygon.tokenSymbol},contractAddress:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",spamStatus:"VERIFIED"}},JS={type:"ERC20",data:{amount:"0",balance:new K(0),decimals:6,key:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",walletAddress:"",chain:{id:I.base.mainnetID,imageUrl:I.base.iconUrl,name:I.base.name,symbol:I.base.tokenSymbol},contractAddress:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",spamStatus:"VERIFIED"}},ZS={type:"EthereumNative",data:{chain:{id:I.ethereum.mainnetID,name:I.ethereum.name,symbol:I.ethereum.tokenSymbol,imageUrl:I.ethereum.iconUrl},walletAddress:"",decimals:18,amount:"45824381294194610",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Ethereum",symbol:"ETH",balance:new K(0),key:"EthereumNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:"VERIFIED"}},ew={type:"ERC20",data:{chain:{id:I.ethereum.mainnetID,name:I.ethereum.name,symbol:I.ethereum.tokenSymbol,imageUrl:I.ethereum.iconUrl},walletAddress:"",contractAddress:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",decimals:6,amount:"1881092",logoUri:"https://assets.coingecko.com/coins/images/6319/large/USD_Coin_icon.png?1547042389",name:"USD Coin",symbol:"USDC",balance:new K(0),key:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",tokenAddress:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",usd:1.8807026139560001,price:.999793,usd_24h_change:-.0005475429199477411,spamStatus:"VERIFIED"}},li=ol,nl=oa;var na="https://help.phantom.com/hc/en-us/articles/5985106844435",tw="https://help.phantom.com/hc/en-us/articles/29763090277139";var mo=18;var yn=500,Br={amount:new K(0),amountUsd:null,pct:0};s();a();var Sn={};var rw={...Sn,bridgeMinimumUsdAmounts:0,swapDefaultFee:new K(15e-5*10**18),bridgeDefaultFee:new K(.025*10**18),averageNetworkFee:new K(15e-5*10**18),nativeFungible:YS,usdcFungible:JS};s();a();var ow={...Sn,bridgeMinimumUsdAmounts:20,swapDefaultFee:new K(2.5*10**16),bridgeDefaultFee:new K(3.75*10**16),averageNetworkFee:new K(0),nativeFungible:ZS,usdcFungible:ew};s();a();var nw={...Sn,bridgeMinimumUsdAmounts:2,swapDefaultFee:new K(6*10**16),bridgeDefaultFee:new K(6*10**16),averageNetworkFee:new K(.0015*10**18),nativeFungible:jS,usdcFungible:XS};s();a();var iw={bridgeMinimumUsdAmounts:1,swapDefaultFee:new K(3*10**6),bridgeDefaultFee:new K(30*10**6),averageNetworkFee:new K(15e3),nativeFungible:oa,usdcFungible:ol};s();a();var sw={bridgeMinimumUsdAmounts:1,swapDefaultFee:new K(50*10**6),bridgeDefaultFee:new K(50*10**6),averageNetworkFee:new K(50*10**6),nativeFungible:zS,usdcFungible:WS};var N5=["solana","ethereum","polygon","base","sui"],IC=new Oo({solana:iw,ethereum:ow,polygon:nw,base:rw,sui:sw}),Te=_o(IC);function Lr(){let t=ve.isFeatureEnabled("enable-sui-swapper");return(0,aw.useMemo)(()=>Te.supportedChains.filter(e=>e==="sui"?t:!0),[t])}var fo=()=>{let{data:t}=ue(),e=Lr().map(r=>I.getMainnetNetworkID(r));return(0,cw.useMemo)(()=>FC(t,e),[t,e])},FC=(t,e)=>[...new Set((t?.addresses??[]).map(r=>r.networkID).filter(r=>e.includes(r)))];var il=()=>{let t=fo();return(0,pw.useCallback)(e=>!!e&&t.includes(e),[t])};s();a();var lw=N(M());s();a();s();a();var sl=(n=>(n[n.Always=1/0]="Always",n[n.Short=Y({days:1})]="Short",n[n.Medium=Y({days:3})]="Medium",n[n.Long=Y({days:7})]="Long",n))(sl||{}),uw=(i=>(i[i.Immediate=0]="Immediate",i[i.Short=Y({minutes:1})]="Short",i[i.Medium=Y({minutes:2.5})]="Medium",i[i.Long=Y({minutes:60})]="Long",i[i.Never=1/0]="Never",i))(uw||{}),mi=(o=>(o[o.Short=Y({seconds:20})]="Short",o[o.Medium=Y({minutes:2.5})]="Medium",o[o.Long=Y({minutes:5})]="Long",o))(mi||{});var CC=d.object({swapper:d.number(),review:d.number().nullish().default(null)}),ia={swapper:mi.Short,review:null},Ur=()=>{let t=ve.getMultivariateAssignment("swapper-poll-interval-json");if(!t)return ia;try{let e=JSON.parse(t);return CC.parse(e)}catch{return ia}};var wt=()=>{let t=di(n=>n.intervalMs),e=di(n=>n.state),r=di(n=>n.setState),o=(0,lw.useCallback)(n=>{r("resumed",n??mw())},[r]);return{state:e,pause:()=>r("paused"),resume:o,intervalMs:t}},dr=t=>{di.getState().setState("resumed",t??mw())},go=()=>{di.getState().setState("paused")},mw=()=>Ur().swapper,di=xe(t=>({state:"resumed",intervalMs:ia.swapper,setState(e,r){t(r?{state:e,intervalMs:r}:{state:e})}}));s();a();var Rw=N(M());s();a();s();a();s();a();s();a();var PC=t=>{let e=re(),r=te(),{data:o,isPending:n}=$({gcTime:0,queryKey:["originIsBlocklisted",t],queryFn:async()=>{let{result:i}=await mp(e,r,t);return i}});return t===void 0?{isLoading:!1,originIsBlocklisted:!1}:{isLoading:n,originIsBlocklisted:o??!1}};s();a();var al=N(M());s();a();var yo=class{#e;constructor(e){this.#e=e}onScannedMessageByUser=e=>{this.#e.capture("simulation",{data:{simulation:{...e,type:"message",status:"success"}}})};onFailedScannedMessageByUser=e=>{this.#e.capture("simulation",{data:{simulation:{...e,type:"message",status:"error"}}})};onScannedTransactionByUser=e=>{this.#e.capture("simulation",{data:{simulation:{...e,type:"transaction",status:"success"}}})};onFailedScannedTransactionByUser=e=>{this.#e.capture("simulation",{data:{simulation:{...e,type:"transaction",status:"error"}}})}};function kC(t,e){let{data:r}=ue(),{params:o,networkID:n}=t,[i,c]=(0,al.useState)(null),p=["scan-message",{url:t.url,message:o.message}],u=r?.addresses.find(S=>S.networkID===n)?.address,l=Ee(L.language)??"en",g=te(),f=new yo(g),y=fw(),h=$({queryKey:p,queryFn:async()=>{try{let S=await dp(l,await g.getDeviceId(),{...t,userAccount:u});return c(null),f.onScannedMessageByUser({networkId:n,warnings:S.warnings.map(w=>w.severity),shouldBlock:!!S.block,errorCode:S.error??""}),S}catch(S){c(S),f.onFailedScannedMessageByUser({networkId:n,url:t.url}),Q.addBreadcrumb("simulation",`networkID: ${n}, url: ${t.url}, type: message`,"info"),Q.captureError(h.error,"simulation")}},enabled:!!u&&!!t.url&&!!o.message&&!e?.disabled,refetchInterval:e?.disableRefetch?!1:y,staleTime:1e3*10,...ip()});return{isFetched:h.isFetched,isFetching:h.isFetching,data:h.data,isLoading:h.isPending&&!e?.disabled,isError:h.isError||!!i,error:h.error||i}}function fi(t,e){let{params:r}=t,[o,n]=(0,al.useState)(null),i=te(),c=["scan-transaction",t.networkID,t.url,r?r.transactions??r.transaction:""],p=fw(),u=!1;I.isEVMNetworkID(t.networkID)||I.isSolanaNetworkID(t.networkID)?u=!!r&&r.transactions.length>0&&!!t.userAccount:I.isBitcoinNetworkID(t.networkID)?u=!!r&&!!r.transaction&&!!r.userAddresses&&r.userAddresses.length>0:I.isSuiNetworkID(t.networkID)&&(u=!!r&&!!t.userAccount);let l=Ee(L.language)??"en",g=new yo(i),f=$({queryKey:c,queryFn:async()=>{try{let y=await Kn(l,await i.getDeviceId(),t);return g.onScannedTransactionByUser({networkId:t.networkID,warnings:y.warnings.map(h=>h.severity),shouldBlock:!!y.block,errorCode:y.error??""}),n(null),e?.onSettled?.(y,void 0),y}catch(y){g.onFailedScannedTransactionByUser({networkId:t.networkID,url:t.url}),Q.addBreadcrumb("simulation",`networkID: ${t.networkID}, url: ${t.url}, type: transaction`,"info"),n(y),e?.onSettled?.(void 0,y),Q.captureError(y,"simulation")}},enabled:u&&!e?.disabled,refetchInterval:e?.disableRefetch?!1:p,staleTime:1e3*10,...ip()});return{isFetched:f.isFetched,isFetching:f.isFetching,data:f.data,isLoading:f.isPending&&!e?.disabled,isError:f.isError||!!o,error:f.error||o}}var dw=5e3;function fw(){let t=ve.getMultivariateAssignment("transactions-simulation-interval-ms");if(!t)return dw;let e=parseInt(t,10);return Number.isNaN(e)?dw:e}var Si=N(M());s();a();s();a();s();a();var Sw=d.object({name:d.string(),message:d.string()}),ww=d.object({chainId:Ar,name:d.string(),symbol:d.string(),decimals:d.number(),logoURI:d.optional(d.string()),includesBridge:d.optional(d.boolean())}),RC=ww.extend({address:d.string(),resourceType:d.literal("address")}),DC=ww.extend({slip44:d.string(),resourceType:d.literal("nativeToken")}),NC=d.union([RC,DC]),BC=d.enum(["network","phantom"]),LC=d.object({name:d.string(),percentage:d.number(),amount:d.number(),type:BC}),UC=d.object({name:d.string(),proportion:d.string()}),hw=d.object({sellAmount:d.string(),buyAmount:d.string()}),cl=hw.extend({priceImpact:d.number(),sources:d.array(UC),fees:d.array(LC),slippageTolerance:d.optional(d.number())}),pl=cl.extend({transactionData:d.array(d.string())}),ul=cl.extend({allowanceTarget:d.string(),exchangeAddress:d.string(),gas:d.number(),value:d.string(),transactionData:d.string()}),ll=cl.extend({transactionData:d.array(d.string())}),gw=d.object({name:d.string(),amount:d.string(),token:Xt,percentage:d.string(),included:d.boolean(),amountUSD:d.optional(d.string())}),MC=d.object({name:d.string(),key:d.string(),logoURI:d.string()}),bw=d.object({name:d.string(),symbol:d.string()}),QC=d.object({transactionData:d.string(),buyToken:Xt,sellToken:Xt,nonIncludedNonGasFees:d.string(),feeCosts:d.array(gw),chainId:Ar,tool:MC,value:d.optional(d.string()),allowanceTarget:d.optional(d.string()),approvalMetadata:d.optional(bw),approvalExactAmount:d.optional(d.string()),exchangeAddress:d.optional(d.string()),gasCosts:d.optional(d.array(d.number())),includedFeeCosts:d.optional(d.array(gw))}),ml=hw.extend({executionDuration:d.number(),tags:d.array(d.string()),steps:d.array(QC)}),_C=d.union([pl,ul,ll,ml]),dl=d.enum(["solana","eip155","sui","xchain"]),fl=d.object({type:dl,taker:Xt,buyToken:Xt,sellToken:Xt,slippageTolerance:d.number(),simulationTolerance:d.optional(d.number()),gasBuffer:d.optional(d.number()),quotes:d.array(_C),tradeFee:d.optional(d.array(d.number())),estimateGasFee:d.optional(d.array(d.number())),analyticsContext:d.optional(d.string())}),OC=d.enum(["swap-approval","swap","bridge-approval","bridge"]),qC=d.enum(["swap","bridge"]),VC=d.enum(["swap","bridge"]),gl=d.object({sellToken:Xt,buyToken:Xt,approvalMetadata:d.optional(bw)}),GC=d.object({type:d.literal("solana"),transactions:d.array(d.string()),transactionTypes:d.array(qC),transactionPairs:d.optional(d.array(gl))}),KC=d.object({type:d.literal("evm"),transactions:d.array(Bo),transactionTypes:d.array(OC),transactionPairs:d.optional(d.array(gl))}),HC=d.object({type:d.literal("sui"),transactions:d.array(d.string()),transactionTypes:d.array(VC),transactionPairs:d.optional(d.array(gl))}),e7=d.union([GC,KC,HC]);var yl=d.object({name:d.string(),amount:d.string()}).strict(),sa=d.object({name:d.string(),feeUsd:d.number().nullish(),amount:d.string(),time:d.object({text:d.string(),isFast:d.boolean()}),logoURI:d.string()}),t7=d.union([yl,sa]);var yw=d.object({token:NC,owner:d.string()}),Aw=d.object({sell:yw,buy:yw});function ae(t){return ml.safeParse(t).success}function So(t){return pl.safeParse(t).success}function bt(t){return ul.safeParse(t).success}function wo(t){return ll.safeParse(t).success}function qt(t){return So(t)||bt(t)||wo(t)}s();a();var At="swapper";var Tw=[At,"quotes"],le={quotesScope:()=>Tw,quotes:({sellTokenCaip19:t,buyTokenCaip19:e,taker:r,amountValue:o,amountType:n,slippageTolerance:i,priorityFee:c,takerDestination:p,enableAutoSlippage:u})=>[...Tw,{sellToken:t,buyToken:e,taker:r,takerDestination:p,amountValue:o,amountType:n,slippageTolerance:i,priorityFee:c,enableAutoSlippage:u}],transactions:t=>[At,"transactions",t],slippageTolerance:()=>[At,"slippageTolerance"],priorityFee:()=>[At,"priorityFee"],lastSubmittedPairs:()=>[At,"lastSubmittedPairs"],lastSelectedTokens:()=>[At,"lastSelectedTokens"],slippageSettings:()=>[At,"slippageSettings"],priorityFeeSettings:()=>[At,"priorityFeeSettings"],hasViewedAutoSlippageOptIn:()=>[At,"hasViewedAutoSlippageOptIn"],optimisticUpdates:()=>[At,"optimisticUpdates"],autoSlippageMigrationVersion:()=>[At,"autoSlippageMigrationVersion"]};var vw=async({callerAddress:t,contractAddress:e,networkId:r,sellAmount:o,allowanceTarget:n,approvalExactAmount:i,exchangeAddress:c,value:p,transactionData:u,type:l})=>{let g=[],f=[];if(e&&(await Ad({callerAddress:t,spender:n,networkId:r,contractAddress:e})).lt(i??o.toString())){let S=await Td({callerAddress:t,spender:n,networkId:r,contractAddress:e,exactAmount:i});g.push(S),f.push(`${l}-approval`)}let y=Bo.parse({type:"0x2",from:t,data:u,chainId:I.getEVMNetworkIDValue(r),to:c,...p==="0"?{}:{value:`0x${new K(p).toString(16)}`}});return g.push(y),f.push(l),{transactions:g,transactionTypes:f}},Sl=async({networkId:t,callerAddress:e,quote:r})=>{let{sellAmount:o,steps:n}=r,i=[],c=[],p=[];for(let u of n){let{allowanceTarget:l,exchangeAddress:g,value:f,transactionData:y,sellToken:h,buyToken:S,approvalMetadata:w}=u,b=h.resourceType==="address"?h.address:null,x=I.compareNetworkID(h.chainId,S.chainId)===0?"swap":"bridge";if(!l||!g||!y||!f)throw new Error("Missing bridge step data for EVM bridge quote.");let T=await vw({callerAddress:e,contractAddress:b,networkId:t,sellAmount:o,allowanceTarget:l,approvalExactAmount:u.approvalExactAmount,exchangeAddress:g,value:f,transactionData:y,type:x});i.push(...T.transactions),c.push(...T.transactionTypes),p.push({sellToken:h,buyToken:S,approvalMetadata:w}),T.transactionTypes.length==2&&T.transactionTypes.find(F=>F.includes("approval"))&&p.push({sellToken:h,buyToken:S,approvalMetadata:w})}return{type:"evm",transactions:i,transactionTypes:c,transactionPairs:p}},wl=async({quote:t,connection:e})=>{let r=[],o=[],n=[];for(let i of t.steps){let{transactionData:c,sellToken:p,buyToken:u}=i,l=I.compareNetworkID(p.chainId,u.chainId)===0?"swap":"bridge",g=await Ew(c,e);r.push($c.serialize(g).transaction),o.push(l),n.push({sellToken:p,buyToken:u})}return{type:"solana",transactions:r,transactionTypes:o,transactionPairs:n}},hl=async({networkId:t,callerAddress:e,quote:r,sellFungible:o})=>{let n=o?.data.tokenAddress??"",{allowanceTarget:i,exchangeAddress:c,sellAmount:p,value:u}=r;return{type:"evm",...await vw({callerAddress:e,contractAddress:n,networkId:t,sellAmount:p,allowanceTarget:i,exchangeAddress:c,value:u,transactionData:r.transactionData,type:"swap"})}},Ew=async(t,e)=>{let r=Lo(t,"bs58");return await hd(r,{connection:e,transactionType:"Swap"})},bl=async({quote:t,connection:e})=>{let r=t.transactionData.map(c=>Ew(c,e)),n=(await Promise.all(r)).map(c=>$c.serialize(c).transaction);return{type:"solana",transactionTypes:n.map(()=>"swap"),transactions:n}},Al=async({quote:t})=>({type:"sui",transactionTypes:Array(t.transactionData.length).fill("swap"),transactions:t.transactionData}),Vt=({callerAddress:t,sellFungible:e,quote:r})=>{let{connection:o}=Lt(),n=le.transactions(r);return $({queryKey:n,enabled:!!r&&!!e,gcTime:0,staleTime:0,refetchInterval:mi.Short,async queryFn(){try{if(!r)throw new Error("Missing quote");if(!e)throw new Error("Missing sell token");let i=e.data.chain.id;if(qt(r)){if(I.isEVMNetworkID(i)&&bt(r))return await hl({networkId:i,callerAddress:t,quote:r,sellFungible:e});if(I.isSolanaNetworkID(i)&&So(r))return bl({quote:r,connection:o});if(I.isSuiNetworkID(i)&&wo(r))return Al({quote:r});throw new Error(`Single network swap quote not supported for network ID ${i}`)}if(ae(r)){if(I.isEVMNetworkID(i))return await Sl({networkId:i,callerAddress:t,quote:r});if(I.isSolanaNetworkID(i))return await wl({quote:r,connection:o});throw new Error(`Bridge quote not supported for network ID ${i}`)}throw new Error("Swap quote type not supported")}catch(i){throw i instanceof Error&&Q.captureError(i,"swapper"),i}}})};s();a();s();a();s();a();s();a();s();a();s();a();s();a();var wn=t=>t.steps.map(e=>e.tool);var Ue=t=>t?ae(t)?wn(t):t?.sources??[]:[];s();a();function be(t){let e=t.reduce((r,o)=>r.add(o.name),new Set);return Array.from(e).join(" + ")}var zC=10,WC=xe(t=>({transitions:[],addTransition:(e,r)=>t(o=>{let n=jC(r,e);return n?{transitions:[n,...o.transitions].slice(0,zC)}:o})}));function ca(t,e){WC.getState().addTransition(t,e)}function jC(t,e){switch(e.type){case"idle":return;case"fetchingQuote":return;case"quote":return{sell:Gt(e.response,e.sell,"sell"),buy:Gt(e.response,e.buy,"buy"),sellAmount:e.quote.sellAmount,buyAmount:e.quote.buyAmount,provider:gi(e.quote),slippage:e.response.slippageTolerance,stateType:e.type,eventType:t.type,timestamp:Date.now()};case"simulationRequestErrored":return{sell:Gt(e.response,e.sell,"sell"),buy:Gt(e.response,e.buy,"buy"),sellAmount:e.quote.sellAmount,buyAmount:e.quote.buyAmount,provider:gi(e.quote),slippage:e.response.slippageTolerance,stateType:e.type,eventType:t.type,error:e.error,quoteTransactionData:aa(e.quote),timestamp:Date.now()};case"simulated":return;case"simulationFailed":return{sell:Gt(e.response,e.sell,"sell"),buy:Gt(e.response,e.buy,"buy"),sellAmount:e.quote.sellAmount,buyAmount:e.quote.buyAmount,provider:gi(e.quote),slippage:e.response.slippageTolerance,simulationError:e.simulationError,stateType:e.type,eventType:t.type,simulationWarning:e.scannedTransactionResult?.warnings,quoteTransactionData:aa(e.quote),simulationHumanReadableError:e.scannedTransactionResult?.simulationError?.humanReadableError,timestamp:Date.now()};case"transactionSubmissionFailed":return{sell:Gt(e.response,e.sell,"sell"),buy:Gt(e.response,e.buy,"buy"),sellAmount:e.quote.sellAmount,buyAmount:e.quote.buyAmount,provider:gi(e.quote),slippage:e.response.slippageTolerance,error:e.error,stateType:e.type,eventType:t.type,quoteTransactionData:aa(e.quote),timestamp:Date.now()};case"transactionNotConfirmed":return{sell:Gt(e.response,e.sell,"sell"),buy:Gt(e.response,e.buy,"buy"),sellAmount:e.quote.sellAmount,buyAmount:e.quote.buyAmount,provider:gi(e.quote),slippage:e.response.slippageTolerance,stateType:e.type,eventType:t.type,quoteTransactionData:aa(e.quote),timestamp:Date.now(),error:e.error};default:return}}var gi=t=>{let e=Ue(t);return be(e)},Gt=(t,e,r)=>{switch(r){case"sell":return{caip19:t.sellToken,symbol:e.data.symbol??void 0};case"buy":return{caip19:t.buyToken,symbol:e.data.symbol??void 0}}},aa=t=>{if(!ae(t))return t.transactionData};var pa=class{onStateChange(e,r,o){ca(o,e)}};s();a();var ua=class{constructor(e){this.listeners=e}transition(e,r){try{let o=this.detectNextState(e,r);return this.listeners.forEach(n=>n.onStateChange(r,e,o)),o}catch{return e}}detectNextState(e,r){switch(r.type){case"quoteRequestStarted":return{type:"fetchingQuote",buy:r.buy,sell:r.sell,amount:r.amount};case"quoteResponseReceived":switch(e.type){case"fetchingQuote":case"quote":case"simulated":case"simulationRequestErrored":case"transactionSubmissionFailed":case"transactionNotConfirmed":let o=r.response.quotes[r.quoteIndex];if(!o)throw new Error("Quote index out of bounds");return{type:"quote",response:r.response,buy:e.buy,sell:e.sell,quote:o};default:throw new Error("Can't transition from this state")}case"quoteSelected":switch(e.type){case"quote":let o=e.response.quotes[r.quoteIndex];if(!o)throw new Error("Quote index out of bounds");return{type:"quote",quote:o,buy:e.buy,sell:e.sell,response:e.response};default:throw new Error("Can only transition to QuoteChanged from Quote")}case"simulationResponseReceived":switch(e.type){case"quote":return r.scannedTransactionResult.error?{type:"simulationFailed",quote:e.quote,buy:e.buy,sell:e.sell,response:e.response,scannedTransactionResult:r.scannedTransactionResult,simulationError:r.scannedTransactionResult.error}:{type:"simulated",quote:e.quote,buy:e.buy,sell:e.sell,response:e.response,scannedTransactionResult:r.scannedTransactionResult};default:throw new Error("Can only transition to Simulated from Simulating")}case"simulationRequestError":switch(e.type){case"quote":return{type:"simulationRequestErrored",buy:e.buy,sell:e.sell,quote:e.quote,response:e.response,error:r.error};default:throw new Error("Can only transition to SimulationRequestErrored from Simulating")}case"transactionSubmissionFailed":switch(e.type){case"simulated":case"simulationFailed":return{type:"transactionSubmissionFailed",quote:e.quote,buy:e.buy,sell:e.sell,response:e.response,scannedTransactionResult:e.scannedTransactionResult,error:r.error};default:throw new Error("Can only transition to SwapSubmitFailed from SubmittingSwap")}case"transactionConfirmationFailed":switch(e.type){case"simulated":return{type:"transactionNotConfirmed",quote:e.quote,buy:e.buy,sell:e.sell,txReceipt:r.txReceipt,response:e.response,scannedTransactionResult:e.scannedTransactionResult,error:r.error};default:throw new Error("Can only transition to TransactionNotConfirmed from ConfirmingTransaction")}}}};var YC=new ua(new Set([new pa])),xw=xe(t=>({state:{type:"idle"},transition:e=>{t(r=>{let o=r.state;return{state:YC.transition(o,e)}})}}));var fr=()=>{let t=xw(r=>r.state),e=xw(r=>r.transition);return{state:t,transition:e}};s();a();var XC="swap-priority-fee",JC=async(t,e,r)=>{let o=Lo(t,"bs58");return await Bm(o,r),{networkFeeEstimation:await Id(e,[o.message])}};function Iw({swapTransactions:t,chainId:e,solanaConnection:r,enabled:o=!0}){return $({queryKey:[XC,t],queryFn:async()=>{if(!t)throw new Error("No swap transactions");if(t.type!=="solana")throw new Error("Trying to estimate network fee for non-solana txs");if(!e)throw new Error("Trying to execute swap with no chain id.");try{let n=t.transactions.map(p=>JC(p,e,r));return(await Promise.all(n)).map(p=>p.networkFeeEstimation.value)}catch{return[0]}},enabled:o&&!!t&&t.transactions.length>0&&t.type==="solana"&&!!e})}s();a();var ZC="swap-priority-fee";function Fw({swapTransactions:t,chainId:e,estimatedFee:r,enabled:o=!0}){return $({queryKey:[ZC,t],queryFn:async()=>{if(!t)throw new Error("No swap transactions");if(t.type!=="sui")throw new Error("Trying to estimate network fee for non-sui txs");if(!e)throw new Error("Trying to execute swap with no chain id.");if(r&&r.length===t.transactions.length)return r;try{return(await Promise.all(t.transactions.map(i=>Ed({networkID:e,transaction:zi.deserializeTransactionString(i)})))).map(i=>i.gasBudget.toNumber())}catch{return[0]}},enabled:o&&!!t&&t.transactions.length>0&&t.type==="sui"&&!!e})}s();a();var eP=1.3,tP=t=>{switch(t){case Z.Ethereum.Mainnet:case Z.Ethereum.Sepolia:return 8e5;case Z.Polygon.Mainnet:case Z.Polygon.Amoy:return 5e5;case Z.Base.Mainnet:case Z.Base.Sepolia:return 5e5;default:return 0}},rP=t=>{switch(t){case Z.Ethereum.Mainnet:case Z.Ethereum.Sepolia:return 6e4;case Z.Polygon.Mainnet:case Z.Polygon.Amoy:return 6e4;case Z.Base.Mainnet:case Z.Base.Sepolia:return 6e4;default:return 0}},oP=(t,e)=>t.steps.flatMap(o=>o.gasCosts??[tP(e)]),nP=(t,e,r)=>{let o=bt(e)?[e.gas]:oP(e,r);return t?t.transactionTypes.map(n=>n.includes("approval")?rP(r):o.shift()??0):o},la={estimateGas:({swapTransactions:t,evmGasEstimation:e,currentQuote:r,scanResult:o,networkID:n,includeGasBuffer:i,gasBuffer:c})=>{let{maxFeePerGas:p,maxPriorityFeePerGas:u}=e,l=nP(t,r,n),g=o?.advancedDetails?.gas;return o?.advancedDetails?.gasLimit>0&&(l=g),l.map(y=>({maxFeePerGas:p,maxPriorityFeePerGas:u,networkID:n,gasLimit:new z(y).multipliedBy(i?c??eP:1).integerValue(z.ROUND_CEIL)}))}};s();a();var Cw={estimateGas:({solanaNetworkFees:t,networkID:e})=>t.map(r=>({networkID:e,value:r}))};s();a();var Pw={estimateGas:({suiGasBudget:t,networkID:e})=>t.map(r=>({networkID:e,gasBudget:new z(r)}))};var iP=2e4,Tl=({includeGasBuffer:t=!1}={})=>{let{currentQuote:e,quoteResponse:r}=ee(),o=A(v=>v.sellFungible),n=o?.data.chain.id??Z.Solana.Mainnet,{data:i}=Jr(o?{address:o.data.walletAddress,networkID:o.data.chain.id}:void 0),c=i?.address??"",p=I.isEVMNetworkID(n),u=I.isSolanaNetworkID(n),l=I.isSuiNetworkID(n),g=A(v=>v.isFetchingQuote),{data:f,isFetching:y}=Vt({callerAddress:c,sellFungible:o,quote:e}),h={type:"transaction",userAccount:c,params:void 0,url:"https://phantom.com",networkID:n};f?.type==="evm"&&p&&(h.params={transactions:f.transactions});let{transition:S}=fr(),w=(0,Si.useCallback)((v,E)=>{E&&S({type:"simulationRequestError",error:E}),v&&S({type:"simulationResponseReceived",scannedTransactionResult:v})},[S]),{data:b,isFetching:x}=fi(h,{disabled:u,onSettled:w}),{connection:T}=Lt(),{data:F}=Ld({networkID:p?n:Z.Ethereum.Mainnet,transactionSpeed:"standard",gasLimit:new K(1),refetchInterval:iP,enabled:p}),{data:P,isFetching:B}=Iw({swapTransactions:f,chainId:u?n:Z.Solana.Mainnet,solanaConnection:T,enabled:u}),{data:R,isFetching:q}=Fw({swapTransactions:f,chainId:l?n:Z.Sui.Mainnet,estimatedFee:r?.estimateGasFee,enabled:l}),G=(0,Si.useMemo)(()=>{if(!(g||!e)){if(p&&(bt(e)||ae(e))&&F&&f)return la.estimateGas({swapTransactions:f,evmGasEstimation:F,currentQuote:e,scanResult:b,includeGasBuffer:t,networkID:n,gasBuffer:r?.gasBuffer});if(u&&P!==void 0)return Cw.estimateGas({solanaNetworkFees:P,networkID:n});if(l&&R!==void 0)return Pw.estimateGas({suiGasBudget:R,networkID:n})}},[g,e,F,n,P,b,t,r?.gasBuffer,p,u,l,R,f]),X=B||q||y||x;return(0,Si.useMemo)(()=>({gasEstimation:G,isFetching:X,isError:F===void 0}),[G,X,F])};function sP(){let t=A(i=>i.setGasEstimation),{state:e}=wt(),{gasEstimation:r}=Tl(),{gasEstimation:o,isFetching:n}=Tl({includeGasBuffer:!0});(0,Rw.useEffect)(()=>{if(e==="paused"){t({isFetching:!1});return}t({isFetching:n,estimate:r,estimateWithBuffer:o})},[e,t,r,o,n])}s();a();var Uw=N(M());s();a();var aP="swap",Dw=t=>new Rd(t,aP),ho=Qo(te,t=>Dw(t));s();a();s();a();var Nw=N(M());s();a();function ze({key:t,queryKey:e,defaultValue:r=null}){let o=re();return $({enabled:!0,queryKey:e,gcTime:sl.Long,staleTime:1/0,async queryFn(){try{return await o.get(t)}catch(n){return n instanceof Error&&Q.captureError(n,"swapper"),r}}})}function rt({key:t,queryKey:e}){let r=re(),o=W();return me({async mutationFn(n){try{return await r.set(t,n)}catch(i){i instanceof Error&&Q.captureError(i,"swapper");return}},async onMutate(n){await o.cancelQueries({queryKey:e});let i=o.getQueryData(e);return o.setQueryData(e,n),{previousValue:i}},onError(n,i,c){o.setQueryData(e,c?.previousValue)}})}var cP={type:"fixed"},pP={type:"auto"},Fe=()=>{let{data:[t]}=fe(["enable-swapper-default-auto"]),{slippageSetting:e,isFetched:r,save:o}=uP();return{isFetched:r,selectedSetting:e??(t?pP:cP),setSlippageSetting:o}},uP=()=>{let{data:t,isFetched:e}=ze({key:"slippageSettings",queryKey:le.slippageSettings()}),{mutateAsync:r}=rt({key:"slippageSettings",queryKey:le.slippageSettings()}),o=(0,Nw.useCallback)(async n=>{await r(n)},[r]);return{isFetched:e,slippageSetting:t,save:o}};function Mr(t,e,r){if(!r)return;if(e==="fixed")return r.slippageTolerance;let o=r.quotes[t];if(o)return ae(o)?r.slippageTolerance:qt(o)?o.slippageTolerance:r.slippageTolerance}s();a();var ma=(t,e,r)=>{if(r)return se(t,e).times(z(r)).toNumber()},Bw=(t,e)=>e&&t?e>t?e:t:e??t;function Lw({buyAssetUsdValue:t,buyToken:e,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:i,phantomFeeUiAmount:c,priceImpact:p,provider:u,slippageTolerance:l,slippageType:g,sellSwapFilter:f,isRetry:y,analyticsContext:h}){if(e&&o){let S=ma(n,e.data.decimals,t),w=ma(i,o.data.decimals,r),b=Bw(S,w);return{networkId:o.data.chain.id,chainId:I.getChainID(o.data.chain.id),toNetworkId:e.data.chain.id,toChainId:I.getChainID(e.data.chain.id),isBridge:o.data.chain.id!==e.data.chain.id,marketName:`${o.data.symbol}/${e.data.symbol}`,tradeDirection:"sell",swapSource:u,priceImpact:p,fromAssetSymbol:o.data.symbol??"",fromAssetAddress:o.data.tokenAddress,fromAssetAmount:se(i,o.data.decimals),fromAssetUsdPrice:r,fromAssetUsdVolume:w,toAssetSymbol:e.data.symbol??"",toAssetAddress:e.data.tokenAddress,toAssetAmount:se(n,e.data.decimals),toAssetUsdPrice:t,toAssetUsdVolume:S,totalUsdVolume:b,feeUsd:c,slippageTolerance:l,slippageType:g,sellSwapFilter:f,isRetry:y,analyticsContext:h}}return null}function wi({buyAssetUsdValue:t,buyToken:e,sellAssetUsdValue:r,sellToken:o,quote:n,slippageTolerance:i,slippageType:c,sellSwapFilter:p,isRetry:u,analyticsContext:l}){if(e&&o){let{buyAmount:g,sellAmount:f}=n,y="priceImpact"in n?n.priceImpact:0,h="sources"in n?be(n.sources):"",S=("fees"in n?n.fees.find(T=>T.type==="phantom")?.amount.toString():"")??"",w=ma(g,e.data.decimals,t),b=ma(f,o.data.decimals,r),x=Bw(w,b);return{chainId:o.data.chain.id??e.data.chain.id,swap:{marketName:`${o.data.symbol}/${e.data.symbol}`,tradeDirection:"sell",swapSource:h,priceImpact:y,fromAssetSymbol:o.data.symbol??"",fromAssetAddress:o.data.tokenAddress??"",fromAssetAmount:se(f,o.data.decimals),fromAssetUsdPrice:r??0,fromAssetUsdVolume:b??0,toAssetSymbol:e.data.symbol??"",toAssetAddress:e.data.tokenAddress??"",toAssetAmount:se(g,e.data.decimals),toAssetUsdPrice:t,toAssetUsdVolume:w,totalUsdVolume:x??0,feeUsd:Number(S),slippageTolerance:i,slippageType:c,sellSwapFilter:p,isRetry:u,analyticsContext:l}}}return null}s();a();var da=N(M());s();a();var vl=t=>{let r={chainId:t.data.chain.id,name:t.data.name??"",symbol:t.data.symbol??"",decimals:t.data.decimals,logoURI:t.data.logoUri??""};return Ne(t.type)?{resourceType:"nativeToken",slip44:t.data.key,...r}:{resourceType:"address",address:t.data.key,...r}};s();a();function lP(t){let{mainnetID:e,iconUrl:r,name:o,tokenSymbol:n}=I[t];return{id:e,imageUrl:r,name:o,symbol:n}}var El=t=>t.resourceType==="address"?t.address:t.slip44,xl=(t,e)=>{let r={amount:"0",balance:new K(0),decimals:t.decimals,key:El(t),logoUri:t.logoURI,mintAddress:El(t),name:t.name,splTokenAccountPubkey:"",symbol:t.symbol,tokenAddress:El(t),walletAddress:e,spamStatus:"NOT_VERIFIED"},o=lP(I.getChainID(t.chainId)),{nativeFungibleTokenType:n,nonNativeFungibleTokenType:i}=Zr.get(t.chainId),c=t.resourceType==="nativeToken"?n:i,p=mP(t);return{type:c,data:{chain:o,...r,...p}}};function mP(t){if(t.resourceType==="address"){if(I.isEVMNetworkID(t.chainId)||I.isSuiNetworkID(t.chainId))return{contractAddress:t.address};if(I.isSolanaNetworkID(t.chainId))return{mintAddress:t.address}}return{}}function dP(t){let e=Aw.safeParse(JSON.parse(t));if(!e.success)return null;let{sell:r,buy:o}=e.data,n=xl(r.token,r.owner),i=xl(o.token,o.owner);return!n||!i?null:{sellFungible:n,buyFungible:i}}function fP(t,e){let r=vl(t),o=vl(e);return!r||!o?"":JSON.stringify({sell:{token:r,owner:t.data.walletAddress},buy:{token:o,owner:e.data.walletAddress}})}var Kt=()=>{let{data:t,isFetching:e}=ze({key:"lastSubmittedPairs",queryKey:le.lastSubmittedPairs()}),r=(0,da.useMemo)(()=>t?dP(t):null,[t]),{mutateAsync:o}=rt({key:"lastSubmittedPairs",queryKey:le.lastSubmittedPairs()}),n=(0,da.useCallback)(async(i,c)=>{await o(fP(i,c))},[o]);return{pairs:r,isLoading:e,storePairs:n}};var hi=({goToConfirmation:t})=>{let e=A(w=>w.selectedProviderIndex),r=A(w=>w.sellUsdValue),o=A(w=>w.buyUsdValue),{currentQuote:n,quoteResponse:i}=ee(),c=A(w=>w.sellFungible),p=A(w=>w.buyFungible),u=A(w=>w.swapFilter),{selectedSetting:l}=Fe(),{storePairs:g}=Kt(),f=te(),y=ho(),{pause:h}=wt();return(0,Uw.useCallback)(()=>{if(!n||!c||!p)return;let w=Mr(e,l.type,i);f.capture("swapperSwap");let b=wi({buyToken:p,sellToken:c,sellAssetUsdValue:r,buyAssetUsdValue:o,quote:n,slippageTolerance:w,slippageType:l.type,sellSwapFilter:u});b&&(Q.addBreadcrumb("swapper","approved","info",br(b.swap)),y.approved(b)),h(),t(),I.compareNetworkID(c.data.chain.id,p.data.chain.id)===0&&g(c,p)},[n,c,p,e,l.type,i,f,r,o,h,t,y,g,u])};s();a();var Il=N(M());s();a();var fa=(t,e)=>{if(e===void 0)return;let r=H(t),o=J(r);return e[o]};s();a();var Mw=N(RA()),ga=(t,e)=>{let r=(0,Mw.default)(t),o=r.value();return Math.abs(o)>0&&Math.abs(o)<1e-5?`< ${o<0?"-":""}0.00001`:e>=12?r.format("0,0.[0]"):e>=9?r.format("0,0.[000]"):r.format("0,0.[00000]")};var ya={network:{id:I.solana.mainnetID,name:I.solana.name,symbol:I.solana.tokenSymbol,imageUrl:I.solana.iconUrl},tokenType:"SolanaNative",symbol:"",logoUri:"",tokenAddress:"",amount:"",amountUsd:0};function gP({goToConfirmation:t}){let e=A(g=>g.buyFungible),r=A(g=>g.sellFungible),o=A(g=>g.setBuyUsdValue),n=A(g=>g.setSellUsdValue),i=(0,Il.useMemo)(()=>{let g=[];return e&&r&&(g.push(H(e)),g.push(H(r))),{query:{data:g}}},[e,r]),{data:c}=Bt(i),{currentQuote:p,quoteResponse:u}=ee(),l=hi({goToConfirmation:t});return(0,Il.useMemo)(()=>{if(!u||!p||!e||!r)return{buyToken:ya,sellToken:ya,onSwap:l};let g=e?.data,f=r?.data;if(!g||!f)return{buyToken:ya,sellToken:ya,onSwap:l};let y="",h=null,S="",w=null,{sellAmount:b,buyAmount:x}=p,T=se(x,g.decimals),F=se(b,f.decimals),P=K(F),B=String(T).split(".")[0].length,R=F.toString().split(".")[0].length,q=g.symbol?.length,G=f.symbol?.length,X=B&&q?B+q:0,v=R&&G?R+G:0;S=`${ga(P,v)} ${f.symbol}`,y=`${ga(T,X)} ${g.symbol}`;let E=fa(e,c),C=fa(r,c);return E?.usd&&(h=T.multipliedBy(E.usd).toNumber(),o(E.usd)),C?.usd&&(w=P.multipliedBy(C.usd).toNumber(),n(C.usd)),{buyToken:{network:g.chain,tokenType:e.type,symbol:g.symbol,logoUri:g.logoUri,tokenAddress:g.tokenAddress,amount:y,amountUsd:h},sellToken:{network:f.chain,tokenType:r.type,symbol:f.symbol,logoUri:f.logoUri,tokenAddress:f.tokenAddress,amount:S,amountUsd:w},onSwap:l}},[u,p,e,r,c,l,o,n])}s();a();var dt=N(M());s();a();s();a();function Qw(t,e){if(!t||e.length===0)return null;let r=new Set(e),o=1/0,n=null;for(let i of t){let c=new z(i.data.amount??0).gt(0);if(!r.has(i.data.chain.id)||!c)continue;let p=e.indexOf(i.data.chain.id);if(p<o&&(o=p,n=i.data.chain.id,p===0))break}return n}var _w=(t,e,r)=>{let o=e.length?Qw(t,e):null;return!o||!r.includes(o)?nl:Te.get(o).nativeFungible},Ow=t=>t?Te.get(t).usdcFungible:li,bi=(t,e)=>{let r=eo(e);return t.find(o=>{if(Ne(r)&&r===o.type)return!0;if(e.resourceType==="address"){let n=Qd(o);return Xr(e)?Vc(e.address,n):e.address===n}})},Sa=(t,e,r)=>{let o=bi(r,t);if(!o){if(Ne(eo(t)))o=Te.get(t.chainId).nativeFungible;else if(e&&e.chainId===t.chainId){let n=Ne(eo(e)),{usdcFungible:i,nativeFungible:c}=Te.get(e.chainId);o=n?i:c}}return o},Fl=(t,e=!1)=>{let{usdcFungible:r,nativeFungible:o}=Te.get(t.chainId),n=J(t),i=J(H(r));return Ne(eo(t))?r:Vc(n,i)?o:e?r:o};s();a();var qw=N(M());s();a();var Cl=N(M());s();a();function Ao(t,e){return t.data.key===e.data.key}function To({enablePrices:t,enableSorting:e}){let{fungibles:r,isLoadingTokens:o,tokensError:n,refetch:i}=yt({enablePrices:t,enableSorting:e}),c=il(),p=r.filter(g=>c(g.data.chain.id)&&g.type!=="CompressedSPL"),u=A(g=>g.sellFungible),l=(0,Cl.useMemo)(()=>{if(u){let g=p.findIndex(y=>Ao(y,u)),f=p[g];f&&f.data.amount!==u.data.amount&&(p[g]=u)}return p.filter(g=>g.data.amount!=="0")},[p,u]);return(0,Cl.useMemo)(()=>({assets:l,isLoading:o,error:n,refetchTokens:i}),[l,o,n,i])}var wa=()=>{let t=Hi(),e=A(n=>n.sellFungible),{pairs:r}=Kt(),{assets:o}=To({enablePrices:!1,enableSorting:!1});return(0,qw.useMemo)(()=>{let n=Ow(e?.data.chain.id),p=((r?t.includes(r.buyFungible.data.chain.id):!1)?r?.buyFungible:void 0)??n;return p?bi(o,H(p))??p:void 0},[e,r,t,o])};s();a();var Vw=N(M());var Qr=()=>{let t=Hi(),e=fo(),{pairs:r}=Kt(),{assets:o}=To({enablePrices:!1,enableSorting:!1}),{fungibles:n}=yt();return(0,Vw.useMemo)(()=>{let i=_w(n,t,e),c=r?H(r?.sellFungible):void 0,p=r?H(r?.buyFungible):void 0;return((c?t.includes(c.chainId):!1)&&c&&p?Sa(c,p,o):void 0)??i},[t,r,o,e,n])};var Gw=t=>{if(t)try{return Yr(t)}catch{return}},Kw=t=>to(t)??[];function yP({paramsSellFungible:t,paramsSellAmount:e,paramsBuyFungible:r,navRef:o}){let{data:[n]}=fe(["enable-swapper-default-usdc"]),{isLoading:i}=Kt(),c=(0,dt.useMemo)(()=>Gw(t),[t]),p=(0,dt.useMemo)(()=>Gw(r),[r]),u=e,[l,g]=(0,dt.useState)(!1),[f,y]=(0,dt.useState)(!1),{data:h}=ue(),{assets:S,isLoading:w}=To({enablePrices:!1,enableSorting:!1}),{data:b,isPending:x}=ao({query:p?.resourceType==="address"?p.address:p?.slip44??"",enableQuery:!!p,networkIds:[p?.chainId??I.solana.mainnetID],searchContext:"swapper"}),T=(0,dt.useMemo)(()=>{let k=[];return c&&k.push(...Kw(c)),p&&k.push(...Kw(p)),k},[c,p]),{fungibles:F,isLoadingTokens:P,isRefetchingTokens:B,tokensError:R}=yt({keys:T,enablePrices:!1,enableSorting:!1}),q=Qr(),G=wa(),X=A(k=>k.setBuyFungible),v=A(k=>k.setSellFungible),E=A(k=>k.setUiSellAmountCryptoInput),C=A(k=>k.setSellAmount),U=A(k=>k.setSwapFilter);return(0,dt.useEffect)(()=>{v(void 0),g(!1),X(void 0),y(!1)},[c,p,v,X,h?.identifier,i,o]),(0,dt.useEffect)(()=>{if(l)return;let k;if(c){if(w)return;k=Sa(c,p,S)}else!c&&p?k=Fl(p):k=q;g(!0),v(k)},[c,p,q,S,v,w,l]),(0,dt.useEffect)(()=>{if(f)return;let k;if(p){if(x)return;if(k=bi(b??[],p),!k){let{usdcFungible:O,nativeFungible:V}=Te.get(p.chainId);k=Ne(eo(p))?V:O}}else!p&&c?k=Fl(c,n):k=G;if(!P&&!B&&!R&&F&&k){let O=J(H(k)),V=F.find(D=>J(H(D))===O);V&&(k=V)}y(!0),X(k)},[p,c,b,x,X,f,G,F,P,B,R,n]),(0,dt.useEffect)(()=>{u?(C(u),E(u)):(C(""),E("")),U(void 0)},[u,o,E,C,U]),{isLoading:(!!c||!!p)&&(!f||!l)||i}}s();a();var Ht=N(M()),Ww=N(ha());s();a();var $w=({sellToken:t,buyToken:e,taker:r,takerDestination:o,amount:n,slippageTolerance:i,pollInterval:c,pollerState:p,enableAutoSlippage:u,priorityFee:l,getSwapQuotesStrategy:g})=>{let f=te(),y=t?H(t):void 0,h=e?H(e):void 0,S=t?_d(t,n.value).toString():n.value,w=!!n.value&&!!e&&!!t&&!!r&&p==="resumed";w||g.stopFetching();let b=le.quotes({sellTokenCaip19:y,buyTokenCaip19:h,taker:r,amountValue:S,amountType:n.type,takerDestination:o,slippageTolerance:i,enableAutoSlippage:u,priorityFee:l});return $({queryKey:b,enabled:w,gcTime:0,staleTime:0,refetchInterval:c,async queryFn({signal:x}){if(!n||!h||!y||!e||!t||!r)throw new Error("missing necessary args");let T=await g.fetch({sellTokenCaip19:y,buyTokenCaip19:h,taker:r,takerDestination:o,sellAmount:S,exactOut:n.type==="buy",slippageTolerance:i,signal:x,enableAutoSlippage:u,priorityFee:l,sell:t,buy:e,amount:{value:S,type:n.type}},b);return f.capture("swapperQuotesResult",{data:{numQuotes:T.quotes.length,sellToken:t,fromNetworkId:y.chainId,toNetworkId:h.chainId}}),T}})};s();a();var Ce=(t,e)=>!!t&&!!e&&I.compareNetworkID(t,e)!==0;s();a();var ba=()=>{let t=A(f=>f.sellFungible),e=A(f=>f.buyFungible),r=A(f=>f.sellAmount),o=t?H(t):null,{data:n}=Je({query:o?{data:o}:void 0}),i=t?.data.chain.id,c=e?.data.chain.id,p=n?.usd;if(!i||!c||!r||!p||I.compareNetworkID(i,c)===0)return!0;let u=De(Number(r),p),l=Te.get(i).bridgeMinimumUsdAmounts,g=Te.get(c).bridgeMinimumUsdAmounts;return l<=u&&g<=u};s();a();var _r=()=>ze({key:"priorityFee",queryKey:le.priorityFee()}),zw=()=>rt({key:"priorityFee",queryKey:le.priorityFee()});s();a();var vo=()=>ze({key:"slippageTolerance",queryKey:le.slippageTolerance()}),Aa=()=>rt({key:"slippageTolerance",queryKey:le.slippageTolerance()});function wP({skipInitialBuyFungible:t,getSwapQuotesStrategy:e}){let r=A(D=>D.sellAmount),o=A(D=>D.amountType),i=A(D=>D.buyFungible)??(t?void 0:li),c=A(D=>D.sellFungible),{data:p}=_r(),{state:u,intervalMs:l}=wt(),g=A(D=>D.resetQuote),f=A(D=>D.setHasNoRoutes),y=A(D=>D.setError),h=A(D=>D.setIsFetchingQuote),S=A(D=>D.setQuoteResponse),w=A(D=>D.setSelectedProviderIndex),{data:[b]}=fe(["enable-auto-slippage"]),{data:x}=vo(),{mutateAsync:T}=Aa(),{selectedSetting:F}=Fe(),P=b&&F.type==="auto",B=ba(),R=(0,Ww.default)(B),q=(0,Ht.useMemo)(()=>{let D=o==="sell"?{amount:r,fungible:c}:{amount:r,fungible:i};return new K(D.amount).isGreaterThan(0)&&D.fungible?$m(D.amount,D.fungible.data.decimals).toString():(g(),"")},[o,i,g,r,c]),G=Ce(c?.data?.chain.id,i?.data.chain.id),{data:X}=Jr(c?.data?.chain.id),{data:v}=Jr(i?.data.chain.id),E=(0,Ht.useMemo)(()=>{if(X)return{chainId:X.networkID,address:X.address,resourceType:"address"}},[X]),C=(0,Ht.useMemo)(()=>{if(G)return{chainId:v?.networkID,address:v?.address,resourceType:"address"}},[G,v?.address,v?.networkID]),{data:U,error:_,isLoading:k}=$w({sellToken:c,buyToken:i,taker:E,takerDestination:C,amount:{value:B?q:"",type:o},slippageTolerance:P?void 0:x??void 0,enableAutoSlippage:P,priorityFee:p??void 0,pollInterval:l,pollerState:u,getSwapQuotesStrategy:e}),O=(0,Ht.useCallback)(D=>{y(null),w(0),h(!1),f(!1),S(D);let ce=Mr(0,F.type,D);ce&&x!==ce&&T(ce)},[y,f,h,S,w,T,x,F.type]),V=(0,Ht.useCallback)(D=>{g(),h(!1),f(!0),y(D)},[g,y,f,h]);(0,Ht.useEffect)(()=>{u!=="paused"&&(k?h(!0):U?O(U):_&&V(_))},[_,U,k,O,V,h,u,B]),(0,Ht.useEffect)(()=>{B?R===!1&&B&&(y(null),f(!1)):(y(new qe({key:"InsufficientSellAmount"})),f(!0))},[B,R,y,f])}s();a();var va=N(M());s();a();s();a();var Eo=t=>{let e=Math.floor(t/3600),r=Math.floor((t-e*3600)/60),o=t%60;if(e>0)return L.t("swapProviderEstimatedTimeHM",{hours:e,minutes:r});if(r>0){let n=o>0?r+1:r;return L.t("swapProviderEstimatedTimeM",{minutes:n})}return L.t("swapProviderEstimatedTimeS",{seconds:o})};s();a();var Ta=t=>t.steps.reduce((e,r)=>e.plus(new K(r.nonIncludedNonGasFees)),new K(0));s();a();function vt(t,e,r){if(e.lte(0))return null;let o=J({chainId:t,resourceType:"nativeToken",slip44:I.getSlip44(t)}),n=I.getTokenDecimals(t),i=I.getTokenSymbol(t);if(!o||!n||!i)return null;let c=e.div(Gc(n)),p=r[o];return p?.usd?c.times(p.usd).toNumber():null}var hP=5*60,jw=t=>{if(ae(t))return be(wn(t));let{sources:e}=t;return be(e)},Yw=({quotes:t,buyTokenNetworkId:e,buyTokenDecimals:r,buyTokenSymbol:o})=>t.map(n=>{let{buyAmount:i}=n,c=Zr.get(e).formDisplayPrecision;return{name:jw(n),amount:`${Ut(se(i,r),c)} ${o}`}}),Xw=({quotes:t,buyTokenNetworkId:e,buyTokenDecimals:r,buyTokenSymbol:o,networkIDForFees:n,networkFee:i,priceMap:c})=>t.filter(ae).map(p=>{let{buyAmount:u,executionDuration:l,steps:g}=p,y=Ta(p).plus(i),h=g.find(w=>!!w.tool.logoURI),S=Zr.get(e).formDisplayPrecision;return{name:jw(p),feeUsd:n&&c?vt(n,y,c):null,amount:`${Ut(se(u,r),S)} ${o}`,time:{text:Eo(l),isFast:l<=hP},logoURI:h?.tool.logoURI??""}});s();a();var bP={aggregate(t){return t.reduce((e,r)=>({...e,gasLimit:e.gasLimit.plus(r.gasLimit)}),{networkID:I.ethereum.mainnetID,gasLimit:new K(0),maxFeePerGas:t[0].maxFeePerGas,maxPriorityFeePerGas:t[0].maxPriorityFeePerGas})}},AP={aggregate(t){return t.reduce((e,r)=>({...e,value:e.value+r.value}),{networkID:I.solana.mainnetID,value:0})}},TP={aggregate(t){return t.reduce((e,r)=>({...e,gasBudget:e.gasBudget.plus(r.gasBudget)}),{networkID:I.sui.mainnetID,gasBudget:new K(0)})}},Ai=t=>{if(!(!t||t.length===0)){if($i(t[0]))return bP.aggregate(t);if(fd(t[0]))return AP.aggregate(t);if(gd(t[0]))return TP.aggregate(t)}};function vP({selectQuote:t}){let{quoteResponse:e,isFetchingQuote:r,quotes:o,selectedProviderIndex:n}=ee(),i=A(F=>F.setSelectedProviderIndex),c=A(F=>F.gasEstimation.estimateWithBuffer),p=A(F=>F.sellFungible),u=A(F=>F.buyFungible),l=p?.data.chain.id,{data:g}=qn(l,Ai(c)),y=Lr().map(F=>ut(F)),{data:h={}}=Bt({query:{data:y}}),S=e?.type==="xchain",w=(0,va.useMemo)(()=>u?S?Xw({quotes:o,buyTokenNetworkId:u.data.chain.id,buyTokenDecimals:u.data.decimals,buyTokenSymbol:u.data.symbol,networkIDForFees:l,networkFee:g?.gasEstimationAmount??new K(0),priceMap:h}):Yw({quotes:o,buyTokenNetworkId:u.data.chain.id,buyTokenDecimals:u.data.decimals,buyTokenSymbol:u.data.symbol}):[],[u,S,o,l,g?.gasEstimationAmount,h]),b=te(),{transition:x}=fr(),T=(0,va.useCallback)(F=>{let P=w[F];b.capture("swapperProviderSelected",{data:{provider:P.name}}),i(F),t(o,F),x({type:"quoteSelected",quoteIndex:F})},[i,w,b,x,o,t]);return{rows:w,selectedProviderIndex:n,isLoadingProviders:r,setSelectedProviderIndex:T}}s();a();var Jw=N(M());var gr=()=>{let{resume:t}=wt(),e=A(r=>r.resetSwapper);return(0,Jw.useCallback)(()=>{t(),e()},[e,t])};s();a();var Ia=N(M());s();a();var eh=N(M());s();a();var Zw=N(M());var Ea=()=>{let t=W();return{cancelQuotes:(0,Zw.useCallback)(async()=>{await t.cancelQueries({queryKey:le.quotesScope()}),await qm(1)},[t])}};s();a();function xa(t){return{chain:"solana",type:"fungible",address:t.type==="SPL"?t.data.mintAddress:void 0,symbol:t.data.symbol??""}}function kl(){let t=te(),e=A(n=>n.setBuyFungible),r=A(n=>n.buyFungible),{cancelQuotes:o}=Ea();return(0,eh.useCallback)(async n=>{if(r&&Ao(n,r))return;await o();let i=xa(n);t.capture("swapperUpdateToAsset",{data:i}),e(n)},[t,r,o,e])}s();a();s();a();var EP=d.enum(["pumpFun","moonshot"]),xP=d.object({type:EP,programId:d.string(),name:d.string(),iconUrl:d.string()}),IP=d.object({programs:d.array(xP)}),th=t=>{try{return IP.parse(t)}catch{return}};var Rl=[],yr=()=>{try{let t=ve.getMultivariateAssignment("enabled-ugc-programs");if(!t)return Rl;let e=JSON.parse(t);return th(e)?.programs??Rl}catch{return Rl}};s();a();var rh=t=>{Dl.getState().setAsset(t)},Dl=xe(t=>({asset:void 0,setAsset(e){t({asset:e})}}));var FP=({onClose:t})=>{let e=kl(),r=Dl(i=>i.asset),o=(0,Ia.useMemo)(()=>yr().find(c=>c.programId===r?.data?.ugcTokenMeta?.programId),[r]),n=(0,Ia.useCallback)(async()=>{r&&(await e(r),t())},[e,r,t]);return{asset:r,program:o,handleConfirmPress:n}};s();a();var CP=()=>{let{review:t}=Ur();t?dr(t):go()};s();a();s();a();var Nl=()=>{let t=W(),e=A();return{clearQuotes:async()=>{e.resetQuote(),await t.invalidateQueries({queryKey:le.quotesScope()})}}};s();a();s();a();var PP=({networkID:t,unsignedTransaction:e,pendingActivityRows:r,accountIdentifier:o,accountSigner:n,storage:i,includeCallPayload:c})=>({accountSigner:n,accountIdentifier:o,networkID:t,unsignedTransaction:e,...c&&{callPayload:{from:e.from,to:e.to,data:e.data,value:e.value}},pendingTransactionInput:{ownerAddress:e.from,networkID:t,data:{nonce:"",unsignedTransaction:e,hash:""},type:"swap",display:{summary:r}},storage:i}),Fa=async({transactions:t,transactionTypes:e,networkID:r,gasEstimation:o,pendingApprovalActivityRows:n,pendingSwapActivityRows:i,accountIdentifier:c,accountSigner:p,storage:u})=>{let l=!0,g="";for(let[f,y]of t.entries()){let h=o[f],S={gas:`0x${h.gasLimit.toString(16)}`,maxFeePerGas:`0x${h.maxFeePerGas.toString(16)}`,maxPriorityFeePerGas:`0x${h.maxPriorityFeePerGas.toString(16)}`},w=Bo.parse({...y,...S}),x=e[f].includes("approval")?n:i,T=PP({networkID:r,accountIdentifier:c,pendingActivityRows:x.shift(),accountSigner:p,storage:u,unsignedTransaction:w,includeCallPayload:l});try{g="",g=await vd(T)}catch(F){return{signature:g,error:F instanceof Error?F:new Error("Failed to process EVM swap transaction")}}l&&(l=!1)}return{signature:g}};s();a();var kP=({networkID:t,transaction:e,feePayer:r,connection:o,pendingActivityRows:n,accountIdentifier:i,accountSigner:c,storage:p})=>({accountSigner:c,accountIdentifier:i,transaction:e,feePayer:r,connection:o,opts:{skipPreflight:!0},pendingTransactionInput:{ownerAddress:r.toBase58(),networkID:t,data:{signature:""},type:"swap",display:{summary:n}},storage:p}),Ca=async({callerAddress:t,connection:e,networkID:r,transactions:o,pendingSwapActivityRows:n,accountIdentifier:i,accountSigner:c,storage:p})=>{let u=new Un.PublicKey(t),l="";for(let[g,f]of o.entries()){let y=Lo(f,"bs58"),h=kP({networkID:r,transaction:y,feePayer:u,connection:e,pendingActivityRows:n[g],accountIdentifier:i,accountSigner:c,storage:p});try{l="",l=await Fd(h),g!==o.length-1&&await ji({connection:e,signature:l})}catch(S){return{signature:l??"",error:S instanceof Error?S:new Error("Failed to process solana swap transaction")}}}return{signature:l??""}};s();a();var RP=({networkID:t,transaction:e,feePayer:r,pendingActivityRows:o,accountIdentifier:n,accountSigner:i,storage:c})=>({accountSigner:i,accountIdentifier:n,transaction:e,pendingTransactionInput:{ownerAddress:r,networkID:t,data:{digest:""},type:"swap",display:{summary:o}},storage:c}),Pa=async({callerAddress:t,networkID:e,transactions:r,pendingSwapActivityRows:o,accountIdentifier:n,accountSigner:i,storage:c})=>{let p="";for(let[u,l]of r.entries()){let g=RP({networkID:e,transaction:zi.deserializeTransactionString(l),feePayer:t,pendingActivityRows:o[u],accountIdentifier:n,accountSigner:i,storage:c});try{p=(await xd(g)).digest,u!==r.length-1&&await Wi(e,p)}catch(f){return{signature:p??"",error:f instanceof Error?f:new Error("Failed to process sui swap transaction")}}}return{signature:p??""}};var Bl=({accountIdentifier:t,networkID:e})=>{let r=re(),o=qo();return me({mutationFn:async i=>{let{swapTransactions:c,type:p}=i;if(c.type==="evm"&&p==="eip155"){let{gasEstimation:u,pendingApprovalActivityRows:l,pendingSwapActivityRows:g}=i,{signature:f,error:y}=await Q.startSpan({name:"Process EVM Swap Txns"},()=>Fa({transactions:c.transactions,transactionTypes:c.transactionTypes,networkID:e,gasEstimation:u,pendingSwapActivityRows:g,pendingApprovalActivityRows:l,accountIdentifier:t,accountSigner:o,storage:r}));return{networkID:e,chainType:p,id:f,error:y}}else if(c.type==="solana"&&p==="solana"){let{callerAddress:u,connection:l,pendingSwapActivityRows:g}=i;if(!l)throw new Error("missing connection");let{signature:f,error:y}=await Q.startSpan({name:"Process Solana Swap Txns"},()=>Ca({callerAddress:u,connection:l,networkID:e,transactions:c.transactions,pendingSwapActivityRows:g,accountIdentifier:t,accountSigner:o,storage:r}));return{networkID:e,chainType:p,id:f,error:y}}else if(c.type==="sui"&&p==="sui"){let{callerAddress:u,pendingSwapActivityRows:l}=i,{signature:g,error:f}=await Q.startSpan({name:"Process Sui Swap Txns"},()=>Pa({callerAddress:u,networkID:e,transactions:c.transactions,pendingSwapActivityRows:l,accountIdentifier:t,accountSigner:o,storage:r}));return{networkID:e,chainType:p,id:g,error:f}}throw new Error("unsupported")}})};s();a();s();a();var bn=N(M());s();a();var nh=N(M());function ih(){let t=A(n=>n.setUiBuyAmountCryptoInput),e=A(n=>n.setUiBuyAmountLocalFiatInput),r=A(n=>n.primaryCurrency),{fromUsd:o}=Ge();return(0,nh.useCallback)(({amount:n,decimals:i,usdPrice:c})=>{if(r==="crypto")if(n===void 0)t("");else{let p=se(n,i).toString(),u=ct(p);t(u)}else if(r==="fiat"&&c)if(n===void 0)e("");else{let p=se(n,i).toString(),u=De(Number(p),c),l=o(u);e(l.toString())}},[o,r,e,t])}s();a();var sh=N(M());function ah(){let t=A(p=>p.setAmountType),e=A(p=>p.setSellAmount),r=A(p=>p.sellAmount),o=A(p=>p.setUiBuyAmountCryptoInput),n=te(),[i,c]=Mo(r,e,yn);return(0,sh.useCallback)(async({fungibleValue:p,shouldUpdateQuote:u,decimals:l})=>{let g=Dt(p.substring(0,mo)),f=ct(g,l);t("buy"),o(f),await n.capture("swapperChangeReceiveCryptoAmount",{data:{amount:f}}),u&&c(f)},[n,t,o,c])}s();a();var ch=N(M());function Ra(t){return(0,ch.useMemo)(()=>t===void 0?void 0:H(t),[t])}s();a();var xo=N(M());var ph=()=>{let t=te(),e=A(T=>T.primaryCurrency),r=A(T=>T.sellFungible),o=A(T=>T.buyFungible),n=A(T=>T.uiSellAmountLocalFiatInput),i=A(T=>T.uiBuyAmountLocalFiatInput),c=A(T=>T.amountType),p=A(T=>T.setUiSellAmountCryptoInput),u=A(T=>T.setUiBuyAmountCryptoInput),l=A(T=>T.switchTokensForBuy),g=A(T=>T.switchTokensForSell),{data:f}=Je({query:r?{data:H(r)}:void 0}),{data:y}=Je({query:o?{data:H(o)}:void 0}),{toUsd:h}=Ge(),S=(0,xo.useMemo)(()=>({localFiatValue:n,decimals:r?.data.decimals??0,usdPrice:f?.usd}),[r?.data.decimals,n,f?.usd]),w=(0,xo.useMemo)(()=>({localFiatValue:i,decimals:o?.data.decimals??0,usdPrice:y?.usd}),[o?.data.decimals,y?.usd,i]),b=(0,xo.useCallback)(({localFiatValue:T,decimals:F,usdPrice:P})=>{let B=T?"":Ut(0,F);if(P&&T){let R=h(T);B=gt(Number(R),P,F).toString()}return B},[h]),x=(0,xo.useCallback)(()=>{t.capture("swapperSwitchTokensClicked",{data:{sell:r?J(H(r)):"",buy:o?J(H(o)):""}})},[t,r,o]);return(0,xo.useCallback)(()=>{if(e==="fiat"){let T=b(S);p(T);let F=b(w);u(F)}c==="sell"?g():l(),x()},[c,w,e,S,u,p,l,g,b,x])};var NP={chainId:Z.Solana.Mainnet,slip44:"501",resourceType:"nativeToken"};function Ll(){let t=A(B=>B.buyFungible),e=Ra(t),r=A(B=>B.sellFungible),o=A(B=>B.primaryCurrency),n=A(B=>B.uiBuyAmountCryptoInput),i=A(B=>B.uiBuyAmountLocalFiatInput),c=A(B=>B.amountType),p=A(B=>B.setAmountType),u=A(B=>B.setSellAmount),l=A(B=>B.uiSellAmountCryptoInput),g=A(B=>B.uiSellAmountLocalFiatInput),f=t?.data.decimals??0,{currentQuote:y}=ee(),h=t?H(t):NP,{data:S}=Je({query:{data:h}}),w=ph(),b=ih(),x=ah(),{toUsd:T}=Ge();(0,bn.useEffect)(()=>{c==="sell"&&e&&b({amount:y?.buyAmount,decimals:f,usdPrice:S?.usd})},[c,e,y?.buyAmount,f,S?.usd,b]),(0,bn.useEffect)(()=>{if(Ce(r?.data.chain.id,t?.data.chain.id)&&c==="buy"){if(p("sell"),o==="crypto")u(l);else if(S?.usd){let B=T(g),R=gt(B,S.usd,f);u(R.toString())}}},[c,t,f,S,o,r,p,u,T,l,g]);let F=(0,bn.useCallback)(B=>{x({fungibleValue:B,decimals:f,shouldUpdateQuote:!0})},[f,x]),P=(0,bn.useCallback)(()=>{w()},[w]);return{cryptoAmountInputValue:n,handleCryptoAmountInputChange:F,localFiatAmountInputValue:i,handleSwitchTokensClick:P}}s();a();var xt=N(M());s();a();var BP=3,LP=new K(356190),UP=t=>Te.get(t).averageNetworkFee.times(BP);function Da({sellFungible:t,totalFees:e,transactionSpeedsToUnitCost:r,minRequiredBalance:o,customPriorityFee:n,isBridge:i=!1}){let{decimals:c,amount:p,chain:u}=t.data,l=new K(p),g=Ne(t.type),{source:f,destination:y}=o,S=MP({isNativeToken:g,network:u,totalFees:e,isBridge:i,transactionSpeedsToUnitCost:r,customPriorityFee:n}).plus(y),w=g?QP(l,S,f):l.toString();return zm(w,c)}function MP({isNativeToken:t,network:e,totalFees:r,isBridge:o,transactionSpeedsToUnitCost:n,customPriorityFee:i}){if(!t)return r;let c=Te.get(e.id),p=o?c.bridgeDefaultFee:c.swapDefaultFee,u=n?.standard;return yd(u)&&(p=LP.multipliedBy(u.maxFeePerGas.plus(u.maxPriorityFeePerGas))),I.isSolanaNetworkID(e.id)&&i&&(p=p.plus(i)),p.plus(UP(e.id))}function QP(t,e,r){let o=r.plus(e);return t.gt(o)?t.minus(o).toString():t.toString()}s();a();var uh=N(M());function lh(){let t=A(l=>l.primaryCurrency),e=A(l=>l.setUiSellAmountLocalFiatInput),r=A(l=>l.setUiBuyAmountLocalFiatInput),o=A(l=>l.setAmountType),n=A(l=>l.setPrimaryCurrency),i=A(l=>l.setUiSellAmountCryptoInput),c=A(l=>l.setSellAmount),p=A(l=>l.setUiBuyAmountCryptoInput),{fromUsd:u}=Ge();return(0,uh.useCallback)(({buyAmountFromQuote:l,buyFungibleDecimals:g,buyFungibleUsdPrice:f,sellAmountFromQuote:y,sellFungibleUsdPrice:h})=>{if(t==="crypto"){if(o("sell"),h&&y){let S=De(Number(y),h),w=u(S);e(w.toString()),c(y.toString())}if(f&&l){let S=se(l,g).toString(),w=De(Number(S),f),b=u(w);r(b.toString())}n("fiat")}if(t==="fiat"){if(y&&i(y),f&&l){let S=se(l,g).toString();p(S)}n("crypto")}},[u,t,c,o,p,r,n,i,e])}s();a();var mh=N(M());function dh(){let t=A(n=>n.primaryCurrency),e=A(n=>n.setUiSellAmountCryptoInput),r=A(n=>n.setUiSellAmountLocalFiatInput),{fromUsd:o}=Ge();return(0,mh.useCallback)(({amount:n,decimals:i,usdPrice:c})=>{if(t==="crypto")if(n===void 0)e("0");else{let p=se(n,i).toString();e(p)}else if(t==="fiat"&&c)if(n===void 0)r("0");else{let p=se(n,i).toString(),u=De(Number(p),c),l=o(u);r(l.toString())}},[o,t,e,r])}s();a();var fh=N(M());function gh(){let t=A(c=>c.setAmountType),e=A(c=>c.setUiSellAmountCryptoInput),r=A(c=>c.setSellAmount),o=A(c=>c.sellAmount),[n,i]=Mo(o,r,yn);return(0,fh.useCallback)(({fungibleValue:c,decimals:p,shouldUpdateQuote:u,shouldTrimLength:l=!0})=>{let g=Dt(l?c.substring(0,mo):c),f=ct(g,p);t("sell"),e(f),u&&i(f)},[t,e,i])}s();a();var yh=N(M());function Sh(){let t=A(p=>p.setAmountType),e=A(p=>p.setSellAmount),r=A(p=>p.sellAmount),o=A(p=>p.setUiSellAmountLocalFiatInput),{toUsd:n}=Ge(),[i,c]=Mo(r,e,yn);return(0,yh.useCallback)(({localFiatValue:p,shouldUpdateQuote:u,decimals:l,priceData:g})=>{let f=Dt(p.substring(0,mo)),y=ct(f,2);if(t("sell"),o(y),u&&g?.usd){let h=n(p),S=gt(h,g.usd,l);c(S.toString())}},[t,o,c,n])}s();a();var Rh=N(M());s();a();var wh=N(M());var _P={"Allbridge's fee":"destinationNetwork","Allbridge Liquidity Fee":"liquidityProvider"},hh=()=>{let{currentQuote:t}=ee(),{destinationNetworkFee:e,liquidityFee:r}=(0,wh.useMemo)(()=>{function o(i){return i?{amount:new z(i.amount??0),amountUsd:i.amountUSD?parseFloat(i.amountUSD):null,pct:parseFloat(i.percentage??"0")}:Br}let n=new Map([]);return t&&ae(t)&&(n=t.steps.flatMap(i=>i.includedFeeCosts).reduce((i,c)=>{if(!c)return i;let p=_P[c.name];return p&&i.set(p,c),i},n)),{destinationNetworkFee:o(n.get("destinationNetwork")),liquidityFee:o(n.get("liquidityProvider"))}},[t]);return{destinationNetworkFee:e,liquidityFee:r}};s();a();var bh=N(M());var OP={calculate({currentQuote:t,gasEstimationPriceData:e}){return{amount:(t&&e?.gasEstimationAmount)??new z(0),amountUsd:(t&&e?.gasEstimationPriceUSDNumber)??null,pct:0}}},qP={calculate({currentQuote:t,gasEstimationPriceData:e,priceMap:r,networkID:o}){let n=(t?.fees??[]).find(p=>p.type==="network"&&p.name!=="Token account deposits"),i=(t&&e?.gasEstimationAmount)??new z(0),c=(t&&e?.gasEstimationPriceUSDNumber)??null;if(n&&n.amount&&(i=i.plus(new z(n.amount)),c)){let p=vt(o,new z(n.amount),r);p&&(c+=p)}return{amount:i,amountUsd:c,pct:0}}},VP={calculate({currentQuote:t,gasEstimationPriceData:e,maxGasEstimationPriceData:r}){return{amount:(t&&e?.gasEstimationAmount)??new z(0),amountUsd:(t&&e?.gasEstimationPriceUSDNumber)??null,maxAmount:(t&&r?.gasEstimationAmount)??new z(0),maxAmountUsd:(t&&r?.gasEstimationPriceUSDNumber)??null,pct:0}}},Ah=({priceMap:t})=>{let{currentQuote:e}=ee(),r=A(l=>l.sellFungible),o=A(l=>l.gasEstimation),n=r?.data.chain.id??Z.Solana.Mainnet,{data:i,isFetching:c}=qn(n,Ai(o.estimate)),{data:p}=qn(n,Ai(o.estimateWithBuffer));return{networkFee:(0,bh.useMemo)(()=>I.isEVMNetworkID(n)?VP.calculate({currentQuote:e,gasEstimationPriceData:i,maxGasEstimationPriceData:p}):I.isSolanaNetworkID(n)?qP.calculate({currentQuote:e,gasEstimationPriceData:i,networkID:n,priceMap:t}):OP.calculate({currentQuote:e,gasEstimationPriceData:i}),[e,i,p,n,t]),isFetchingGasEstimationPrice:c}};s();a();var Th=N(M());var GP={calculate(){return Br}},KP={calculate({currentQuote:t,networkID:e,priceMap:r}){let o=Ta(t);return{amount:o,amountUsd:vt(e,o,r),pct:0}}},vh=({priceMap:t})=>{let{currentQuote:e}=ee(),o=A(i=>i.sellFungible)?.data.chain.id??Z.Solana.Mainnet;return{nonIncludedFees:(0,Th.useMemo)(()=>e&&ae(e)?KP.calculate({currentQuote:e,networkID:o,priceMap:t}):GP.calculate(),[o,e,t])}};s();a();var Eh=N(M());var HP={calculate(t){let e=(t?.fees??[]).find(r=>r.type==="phantom");return{amount:new z(e?.amount??0),amountUsd:null,pct:e?.percentage??0}}},$P={calculate(t){let e=t.steps.flatMap(r=>r.feeCosts).find(r=>r.name==="phantom");return{amount:new z(e?.amount??0),amountUsd:null,pct:parseFloat(e?.percentage??"0")}}},xh=()=>{let{currentQuote:t}=ee();return{phantomFee:(0,Eh.useMemo)(()=>Ul(t),[t])}};function Ul(t){return qt(t)?HP.calculate(t):ae(t)?$P.calculate(t):Br}s();a();var Ih=N(M());var zP={calculate({currentQuote:t,networkID:e,priceMap:r}){let o=(t?.fees??[]).find(n=>n.name==="Token account deposits");return{amount:new z(o?.amount??0),amountUsd:o?.amount?vt(e,new z(o.amount),r):null,pct:o?.percentage??0}}},WP={calculate(){return Br}},Fh=({priceMap:t})=>{let{currentQuote:e}=ee(),o=A(i=>i.sellFungible)?.data.chain.id??Z.Solana.Mainnet;return{tokenAccountFee:(0,Ih.useMemo)(()=>qt(e)?zP.calculate({currentQuote:e,networkID:o,priceMap:t}):WP.calculate(),[e,o,t])}};s();a();var Ch=N(M());var Ph={calculate:({tokenAccountFee:t,networkFee:e,nonIncludedFees:r,networkID:o,priceMap:n})=>{let i=t.amount.plus(e.amount).plus(r.amount);return{amount:i,amountUsd:vt(o,i,n),pct:0}}},jP={calculate:({tokenAccountFee:t,networkFee:e,nonIncludedFees:r,networkID:o,priceMap:n})=>{let i=Ph.calculate({tokenAccountFee:t,networkFee:e,nonIncludedFees:r,networkID:o,priceMap:n}),c=t.amount.plus(e.maxAmount??0).plus(r.amount);return{...i,maxAmount:c,maxAmountUsd:vt(o,c,n)}}},kh=({tokenAccountFee:t,networkFee:e,nonIncludedFees:r,priceMap:o})=>{let i=A(p=>p.sellFungible)?.data.chain.id??Z.Solana.Mainnet;return{totalFees:(0,Ch.useMemo)(()=>I.isEVMNetworkID(i)?jP.calculate({tokenAccountFee:t,networkFee:e,nonIncludedFees:r,networkID:i,priceMap:o}):Ph.calculate({tokenAccountFee:t,networkFee:e,nonIncludedFees:r,networkID:i,priceMap:o}),[e,i,r,o,t])}};var Et=()=>{let t=A(y=>y.gasEstimation.isFetching),e=Lr(),{data:r={}}=Bt({query:{data:e.map(y=>ut(y))}}),{networkFee:o,isFetchingGasEstimationPrice:n}=Ah({priceMap:r}),i=t||n,{phantomFee:c}=xh(),{tokenAccountFee:p}=Fh({priceMap:r}),{nonIncludedFees:u}=vh({priceMap:r}),{totalFees:l}=kh({tokenAccountFee:p,networkFee:o,nonIncludedFees:u,priceMap:r}),{destinationNetworkFee:g,liquidityFee:f}=hh();return(0,Rh.useMemo)(()=>({phantomFee:c,networkFee:o,tokenAccountFee:p,totalFees:l,nonIncludedFees:u,destinationNetworkFee:g,liquidityFee:f,isFetchingFees:i}),[c,o,p,l,u,g,f,i])};s();a();var YP=20;function Na(t,e){let r=le.optimisticUpdates(),o=t.getQueryData(r)??[];t.setQueryData(r,[...o.filter(n=>n.id!==e.id),e])}function Dh(t,e){let r=le.optimisticUpdates(),o=t.getQueryState(r);if(o){let n=e??Date.now(),i=o.dataUpdatedAt,c=Y({seconds:YP});return n-i>c?(t.removeQueries({queryKey:r}),[]):o?.data??[]}else return[]}function An(t){return`${t.type}-${t.data.key}`}s();a();var Ml=N(M());var XP=.05,JP=({sellNetworkId:t,buyNetworkId:e,destinationMinRequiredBalance:r,priceMap:o})=>{if(!t||!e||!o)return new z(0);let n=J(ut(I.getChainID(t))),i=J(ut(I.getChainID(e))),c=o[n]?.usd,p=o[i]?.usd;if(!c||!p)return new z(0);let u=se(r.toNumber(),I.getTokenDecimals(e)),l=De(u.toNumber(),p),g=gt(l,c,I.getTokenDecimals(t));return new z(g).times(1+XP)},Tn=()=>{let t=wa(),e=Qr(),r=A(w=>w.sellFungible)??e,o=A(w=>w.buyFungible)??t,n=r.data.chain.id,i=o?.data.chain.id,c=i??n,p=Ce(n,i),{fungible:u}=Jt({key:o?.data.key}),{data:l}=ue(),g=(0,Ml.useMemo)(()=>l?.addresses.find(w=>w.networkID===c),[l,c]),y=Lr().map(w=>ut(w)),{data:h}=Bt({query:{data:y},queryOptions:{refetchInterval:!1}}),{data:S=0}=Ji(g);return(0,Ml.useMemo)(()=>{if(u)return new z(0);let w=new z(S);return p?JP({sellNetworkId:n,buyNetworkId:i,destinationMinRequiredBalance:w,priceMap:h}):w},[u,S,p,n,i,h])};s();a();var Ql=N(M());var vn=()=>{let t=Qr(),r=(A(c=>c.sellFungible)??t).data.chain.id,{data:o}=ue(),n=(0,Ql.useMemo)(()=>o?.addresses.find(c=>c.networkID===r),[o,r]),{data:i=0}=Ji(n);return(0,Ql.useMemo)(()=>new z(i),[i])};function _l(){let t=W(),e=Qr(),r=A(ie=>ie.sellFungible)??e,o=A(ie=>ie.buyFungible),n=A(ie=>ie.primaryCurrency),i=A(ie=>ie.isFetchingQuote),c=A(ie=>ie.sellAmount),p=A(ie=>ie.uiSellAmountCryptoInput),u=A(ie=>ie.setSellFungible),l=A(ie=>ie.uiSellAmountLocalFiatInput),g=A(ie=>ie.amountType),f=A(ie=>ie.setSwapFilter),{data:y}=_r(),h=Ra(r),S=r?.data.key,{fungible:w}=Jt({key:S}),b=r?.data.chain.id,x=o?.data.chain.id,{totalFees:T}=Et(),{data:F}=Yi({networkID:b}),P=Ce(b,x),B=vn(),R=Tn(),q=r?.data.amount,G=r?r.data.decimals:0,X=(0,xt.useMemo)(()=>Da({sellFungible:r,totalFees:T.amount,transactionSpeedsToUnitCost:I.isEVMNetworkID(r.data.chain.id)?F:void 0,isBridge:P,minRequiredBalance:{source:B,destination:R},customPriorityFee:new z(y??0).multipliedBy(10**Xm.tokenDecimals)}),[r,T.amount,F,P,R,B,y]),v=(0,xt.useMemo)(()=>g==="buy"?new z(p).isLessThanOrEqualTo(new z(X)):c===""?!0:new z(c).isLessThanOrEqualTo(new z(X)),[g,X,c,p]),{currentQuote:E}=ee(),{data:C}=Je({query:{data:H(r)}}),U=C?.usd,{data:_}=Je({query:o?{data:H(o)}:void 0}),k=lh(),O=gh(),V=Sh(),D=dh(),ce=(0,xt.useCallback)(()=>{let ie=E?.sellAmount?se(E?.sellAmount,G).toString():c,Ke=E?.buyAmount,Pt=o?.data.decimals??0,Wr=_?.usd;k({buyAmountFromQuote:Ke,buyFungibleDecimals:Pt,buyFungibleUsdPrice:Wr,sellAmountFromQuote:ie,sellFungibleUsdPrice:U})},[E?.sellAmount,E?.buyAmount,G,c,o?.data.decimals,_?.usd,k,U]),pe=(0,xt.useCallback)(ie=>{O({fungibleValue:ie,decimals:G,shouldUpdateQuote:!0})},[G,O]),Qe=(0,xt.useCallback)(ie=>{V({priceData:C,localFiatValue:ie,decimals:G,shouldUpdateQuote:!0})},[G,C,V]),{fromUsd:Ct}=Ge(),No=(0,xt.useCallback)(ie=>{f(ie);let Ke=z(X).multipliedBy(ie);if(n==="crypto")O({fungibleValue:Ke.toString(),decimals:G,shouldUpdateQuote:!0,shouldTrimLength:!1});else if(U){let Pt=De(Number(Ke),U),Wr=Ct(Pt).toString();V({priceData:C,localFiatValue:Wr,decimals:G,shouldUpdateQuote:!0})}},[f,X,n,U,O,G,V,C,Ct]);(0,xt.useEffect)(()=>{let ie=Dh(t);if(w){let Ke={...w},Pt=ie.find(Wr=>Wr.id===An(w));Pt&&w.data.amount!==Pt.amount&&(Ke.data={...Ke.data,amount:Pt.amount}),Ke.data.amount!==q&&u(Ke)}},[w,q,u,t]),(0,xt.useEffect)(()=>{g==="buy"&&h&&D({amount:E?.sellAmount,decimals:G,usdPrice:U})},[g,E?.sellAmount,G,C?.usd,h,U,D]);let Re=ba();return{maxSellAmount:X,sellFungible:r,notEnoughAssets:!v,uiSellAmountCryptoInput:p,uiSellAmountLocalFiatInput:l,hasMinimumSellAmount:Re,isFetchingQuote:i,handleToggleCurrencyClick:ce,handleFiatAmountInputChange:Qe,handleCryptoAmountInputChange:pe,handleSwapFilterClick:No}}s();a();s();a();s();a();s();a();function Ol(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function ZP(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function Nh(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function ek(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ol(t.outputLen),Ol(t.blockLen)}function tk(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function rk(t,e){Nh(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var ok={number:Ol,bool:ZP,bytes:Nh,hash:ek,exists:tk,output:rk},Ba=ok;s();a();s();a();var nk={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Ua=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),It=(t,e)=>t<<32-e|t>>>e,ik=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!ik)throw new Error("Non little-endian hardware is not supported");var sk=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Bh(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=sk[t[r]];return e}function ql(t){if(typeof t!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof t}`);return new TextEncoder().encode(t)}function Vl(t){if(typeof t=="string"&&(t=ql(t)),!(t instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof t})`);return t}var La=class{clone(){return this._cloneInto()}};function Gl(t){let e=o=>t().update(Vl(o)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function ak(t,e,r,o){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,o);let n=BigInt(32),i=BigInt(4294967295),c=Number(r>>n&i),p=Number(r&i),u=o?4:0,l=o?0:4;t.setUint32(e+u,c,o),t.setUint32(e+l,p,o)}var Ma=class extends La{constructor(e,r,o,n){super(),this.blockLen=e,this.outputLen=r,this.padOffset=o,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ua(this.buffer)}update(e){Ba.exists(this);let{view:r,buffer:o,blockLen:n}=this;e=Vl(e);let i=e.length;for(let c=0;c<i;){let p=Math.min(n-this.pos,i-c);if(p===n){let u=Ua(e);for(;n<=i-c;c+=n)this.process(u,c);continue}o.set(e.subarray(c,c+p),this.pos),this.pos+=p,c+=p,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ba.exists(this),Ba.output(e,this),this.finished=!0;let{buffer:r,view:o,blockLen:n,isLE:i}=this,{pos:c}=this;r[c++]=128,this.buffer.subarray(c).fill(0),this.padOffset>n-c&&(this.process(o,0),c=0);for(let f=c;f<n;f++)r[f]=0;ak(o,n-8,BigInt(this.length*8),i),this.process(o,0);let p=Ua(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=u/4,g=this.get();if(l>g.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<l;f++)p.setUint32(4*f,g[f],i)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let o=e.slice(0,r);return this.destroy(),o}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:o,length:n,finished:i,destroyed:c,pos:p}=this;return e.length=n,e.pos=p,e.finished=i,e.destroyed=c,n%r&&e.buffer.set(o),e}};var ck=(t,e,r)=>t&e^~t&r,pk=(t,e,r)=>t&e^t&r^e&r,uk=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Or=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),qr=new Uint32Array(64),Qa=class extends Ma{constructor(){super(64,32,8,!1),this.A=Or[0]|0,this.B=Or[1]|0,this.C=Or[2]|0,this.D=Or[3]|0,this.E=Or[4]|0,this.F=Or[5]|0,this.G=Or[6]|0,this.H=Or[7]|0}get(){let{A:e,B:r,C:o,D:n,E:i,F:c,G:p,H:u}=this;return[e,r,o,n,i,c,p,u]}set(e,r,o,n,i,c,p,u){this.A=e|0,this.B=r|0,this.C=o|0,this.D=n|0,this.E=i|0,this.F=c|0,this.G=p|0,this.H=u|0}process(e,r){for(let f=0;f<16;f++,r+=4)qr[f]=e.getUint32(r,!1);for(let f=16;f<64;f++){let y=qr[f-15],h=qr[f-2],S=It(y,7)^It(y,18)^y>>>3,w=It(h,17)^It(h,19)^h>>>10;qr[f]=w+qr[f-7]+S+qr[f-16]|0}let{A:o,B:n,C:i,D:c,E:p,F:u,G:l,H:g}=this;for(let f=0;f<64;f++){let y=It(p,6)^It(p,11)^It(p,25),h=g+y+ck(p,u,l)+uk[f]+qr[f]|0,w=(It(o,2)^It(o,13)^It(o,22))+pk(o,n,i)|0;g=l,l=u,u=p,p=c+h|0,c=i,i=n,n=o,o=h+w|0}o=o+this.A|0,n=n+this.B|0,i=i+this.C|0,c=c+this.D|0,p=p+this.E|0,u=u+this.F|0,l=l+this.G|0,g=g+this.H|0,this.set(o,n,i,c,p,u,l,g)}roundClean(){qr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Kl=class extends Qa{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},Lh=Gl(()=>new Qa),lae=Gl(()=>new Kl);var ft=N(M());s();a();var lk=50,Uh=({includeOwnedAssets:t,sellAsset:e,ownedAssets:r,searchAssets:o})=>{if(!t||!e)return o;let n=f=>J(H(f)),i=n(e),c=e.data.chain.id,p=r.filter(f=>n(f)!==i&&I.compareNetworkID(c,f.data.chain.id)===0&&f.type!=="CompressedSPL").slice(0,lk-1),u=p.map(f=>[n(f),f]),l=new Map(u),g=o.filter(f=>!l.has(n(f)));return[...p,...g]};function mk({enableQuery:t=!0}={}){let{sellFungible:e,searchQuery:r,setSearchQuery:o,setNumSearchResults:n}=A(),i=Gm(r,150),{fungibles:c,isLoadingTokens:p,isRefetchingTokens:u,tokensError:l}=yt(),g=fo(),[f,y]=(0,ft.useState)(""),{data:h}=ue(),S=(0,ft.useMemo)(()=>h?.addresses??[],[h]),{data:w,isSuccess:b,isFetching:x,error:T}=ao({query:i,networkIds:[e?.data.chain.id??I.solana.mainnetID],enableQuery:t,keepPreviousData:!0,searchContext:"swapper",supportedNetworkIds:g,chainAddresses:S}),F=!b&&x,P=(0,ft.useMemo)(()=>c.filter(v=>v.type!=="CompressedSPL").map(v=>[J(H(v)),v]),[c]),B=(0,ft.useMemo)(()=>{let v=ql(P.map(([C])=>C).join("~")),E=Lh(v);return Bh(E)},[P]),R=(0,ft.useMemo)(()=>new Map(P),[B]),q=(0,ft.useMemo)(()=>{if(!w||w.length===0)return[];y(ot());let v=w.reduce((E,C)=>{let U="";if(Ne(C.type)){if(e&&Ne(e.type)&&C.data.chain.id===e.data.chain.id)return E;U=J(ut(I.getChainID(C.data.chain.id)))}else{if(e&&C.data.tokenAddress===e.data.tokenAddress)return E;U=J(H(C))}let _,k=R.get(U);return k&&k.data.balance?_=k:_=C,_&&E.push(_),E},[]);return n(v.length),v},[R,w,e,n]),G=te();(0,ft.useEffect)(()=>{b&&q.length===0&&G.capture("swapperNullSearchResult",{data:{searchQuery:i}})},[b,q,i,G]);let X=(0,ft.useMemo)(()=>Uh({includeOwnedAssets:!i,sellAsset:e,ownedAssets:c,searchAssets:q}),[i,c,q,e]);return(0,ft.useMemo)(()=>({assets:X,initialFilterKey:e?.data.chain.id,isLoading:p||F,isFetching:p||F||u,error:l??T,searchRef:f,setSearchQuery:o}),[X,p,F,u,l,T,e,f,o])}s();a();var Me=N(M()),Qh=N(ha());s();a();var _a="https://help.phantom.com/hc/en-us/articles/27085326202515";var En=[.3,.5,1],dk=En.map(t=>`${t}%`),_h=[...dk,"custom"],xn=[.5,1,2],fk=xn.map(t=>`${t}%`),gk=[...fk,"custom"],yk="enable-higher-slippage-options",Hl=_h.length-1,Sk=5,wk=2,$l=.1,zl=30,hk=2,Mh=(t,e)=>{if(!t)return;let r=parseFloat(t);if(isNaN(r))return{message:e("swapSlippageSettingsCustomInvalidValue"),severity:"critical"};if(r>zl)return{message:e("swapSlippageSettingsCustomMaxError",{maxSlippage:zl}),severity:"critical"};if(r>hk)return{message:e("swapSlippageSettingsHighSlippageWarning"),severity:"warning"};if(r<$l)return{message:e("swapSlippageSettingsCustomMinError",{minSlippage:$l}),severity:"critical"}},bk=(t,e)=>e?t&&xn.indexOf(t)!==-1?xn.indexOf(t):t?Hl:1:t&&En.indexOf(t)!==-1?En.indexOf(t):t?Hl:0,Ak=(t,e)=>e?t&&xn.indexOf(t)===-1?`${t}`:"":t&&En.indexOf(t)===-1?`${t}`:"",Tk=({onDismiss:t})=>{let{t:e}=pt(),r=te(),{data:[o]}=fe([yk]),{data:n,isFetched:i}=vo(),{mutateAsync:c}=Aa(),{selectedSetting:p,isFetched:u,setSlippageSetting:l}=Fe(),[g,f]=(0,Me.useState)(p.type),y=(0,Qh.default)(u),[h,S]=(0,Me.useState)(!1),[w,b]=(0,Me.useState)(0),[x,T]=(0,Me.useState)(),[F,P]=(0,Me.useState)(""),[B,R]=(0,Me.useState)(),q=g==="auto",G=w===Hl,X=q?!1:B?.severity==="critical"||G&&!F;(0,Me.useEffect)(()=>{y!==u&&g!==p.type&&f(p.type)},[y,u,p.type,g]);let v=(0,Me.useCallback)(O=>{if(w===O)return;R(void 0),b(O);let V=o?xn:En;V[O]?(T(V[O]),P("")):T(void 0)},[w,o]),E=(0,Me.useCallback)(O=>{let V=Dt(O.substring(0,Sk)),D=ct(V,wk),ce=parseFloat(D);if(isNaN(ce)){R(void 0),P("");return}P(D),R(Mh(D,e))},[e]),C=(0,Me.useCallback)(()=>{if(q)r.capture("slippageChanged",{data:{slippageType:"auto"}});else if(G){let O=parseFloat(F??"");c(O),r.capture("slippageChanged",{data:{slippageValue:O,slippageType:"custom"}}),T(void 0)}else x&&(c(x),r.capture("slippageChanged",{data:{slippageValue:x,slippageType:"preset"}}),P(""));l({type:g}),t()},[q,l,g,t,G,x,F,c,r]),U=(0,Me.useCallback)(()=>{let O=bk(n,o),V=Ak(n,o),D=o?xn:En;b(O),T(D[O]),P(V),R(Mh(V,e)),f(p.type)},[n,e,p.type,o]),_=(0,Me.useCallback)(()=>{f(g==="auto"?"fixed":"auto")},[g,f]),k=(0,Me.useMemo)(()=>({title:e("swapSlippageSettingsTitle"),subtitle:e("swapSlippageSettingsSubtitle",{minSlippage:$l,maxSlippage:zl}),custom:e("swapSlippageSettingsCustom"),auto:e("swapSlippageSettingsAuto"),autoSubtitle:e("swapSlippageSettingsAutoSubtitle"),learnMore:e("commandLearnMore"),button:e("commandConfirm")}),[e]);return(0,Me.useEffect)(()=>{!h&&i&&(U(),S(!0))},[i,h,U]),{options:o?gk:_h,selectedIndex:w,customSlippageValue:F,i18nStrings:k,error:B,submitDisabled:X,isAutoEnabled:q,autoLearnMoreUrl:_a,onConfirm:C,onDismiss:t,onSelectOption:v,onChangeCustomSlippage:E,onResetToDefault:U,onToggleAutoSlippage:_}};s();a();var ke=N(M()),Vh=N(ha());s();a();var Oh=N(M());var vk={type:"auto"},Wl=()=>{let{priorityFeeSetting:t,isFetched:e,save:r}=Ek();return{isFetched:e,selectedSetting:t,setPriorityFeeSetting:r}},Ek=()=>{let{data:t,isFetched:e}=ze({key:"priorityFeeSettings",queryKey:le.priorityFeeSettings()}),{mutateAsync:r}=rt({key:"priorityFeeSettings",queryKey:le.priorityFeeSettings()}),o=(0,Oh.useCallback)(async n=>{await r(n)},[r]);return{isFetched:e,priorityFeeSetting:t??vk,save:o}};var jl={input:{maxLength:10,maxDecimals:6},bounds:{min:1e-6,low:5e-6,high:1,max:5}},qh=(t,e,r)=>{let o=parseFloat(t);if(isNaN(o))return{message:e("swapPriorityFeeSettingsCustomInvalidValue"),severity:"critical"};if(o>r.max)return{message:e("swapPriorityFeeSettingsCustomMaxError",{maxPriorityFee:r.max}),severity:"critical"};if(o<r.min)return{message:e("swapPriorityFeeSettingsCustomMinError",{minPriorityFee:r.min}),severity:"critical"};if(o>r.high)return{message:e("swapPriorityFeeSettingsHighFeeWarning"),severity:"warning"};if(o<r.low)return{message:e("swapPriorityFeeSettingsLowFeeWarning"),severity:"warning"}},Ik=()=>{let[t,e]=(0,ke.useState)(jl.bounds);return(0,ke.useEffect)(()=>{(async()=>{try{let o=await wd({accounts:[],transactionType:"Swap"});e({min:o.min,low:o.low,high:o.high,max:o.max})}catch(o){Q.captureError(o instanceof Error?o:new Error("Unable to fetch priority fee bounds."),"swapper")}})()},[]),t},Fk=({onDismiss:t})=>{let{t:e}=pt(),r=te(),{data:o,isFetched:n}=_r(),{mutateAsync:i}=zw(),{selectedSetting:c,isFetched:p,setPriorityFeeSetting:u}=Wl(),[l,g]=(0,ke.useState)(c.type),f=(0,Vh.default)(p),[y,h]=(0,ke.useState)(!1),[S,w]=(0,ke.useState)(""),[b,x]=(0,ke.useState)("$0"),[T,F]=(0,ke.useState)(),P=l==="auto",B=P?!1:T?.severity==="critical"||!S,R=Ik(),q=ut("solana"),{data:G}=Je({query:{data:q}}),X=G?.usd;(0,ke.useEffect)(()=>{if(!X)return;let k=De(Number(S),X);x(`$${k.toString()}`)},[S,X]),(0,ke.useEffect)(()=>{f!==p&&l!==c.type&&g(c.type)},[f,p,c.type,l]);let v=(0,ke.useCallback)(k=>{let O=Dt(k.substring(0,jl.input.maxLength)),V=ct(O,jl.input.maxDecimals);if(isNaN(parseFloat(V))){F(void 0),w("");return}w(V),F(qh(V,e,R))},[e,R]),E=(0,ke.useCallback)(()=>{if(P)i(null),r.capture("swapperPriorityFeeChanged",{data:{priorityFeeType:"auto"}});else if(S){let k=parseFloat(S??"");i(k),r.capture("swapperPriorityFeeChanged",{data:{priorityFeeValue:k,priorityFeeType:"custom"}}),w("")}u({type:l}),t()},[P,u,l,t,S,i,r]),C=(0,ke.useCallback)(()=>{let k=o?`${o}`:"";w(k),F(qh(k,e,R)),g(c.type)},[o,e,c.type,R]),U=(0,ke.useCallback)(()=>{g(l==="auto"?"fixed":"auto"),w("")},[l,g]),_=(0,ke.useMemo)(()=>({title:e("swapPriorityFeeSettingsTitle"),custom:e("swapPriorityFeeSettingsCustom"),auto:e("swapPriorityFeeSettingsAuto"),autoSubtitle:e("swapPriorityFeeSettingsAutoSubtitle"),learnMore:e("commandLearnMore"),button:e("commandConfirm")}),[e]);return(0,ke.useEffect)(()=>{!y&&n&&(C(),h(!0))},[n,y,C]),{customPriorityFeeValue:S,customPriorityFeeValueInDollars:b,i18nStrings:_,error:T,submitDisabled:B,isAutoEnabled:P,onConfirm:E,onDismiss:t,onChangeCustomPriorityFee:v,onResetToDefault:C,onToggleAutoPriorityFee:U}};s();a();var Io=N(M());s();a();s();a();var Gh=()=>[{chainId:"solana:101",address:"2b1kV6DkPAnxd5ixfnxCpjxmKwqjjaYmCZfHsFu24GXo",resourceType:"address"}];var Kh=(t,e)=>{let r=[];if(Pk(t)&&!kk(t)&&r.push({level:"warn",titleKey:"swapAssetWarningPermanentDelegate"}),(t.data.spamStatus==="NOT_VERIFIED"||t.data.spamStatus==="SPAM"||t.data.spamStatus==="POSSIBLE_SPAM")&&r.push({level:"info",titleKey:"swapAssetWarningUnverified"}),!Ne(t.type)&&e&&Rk(e)){let o=Te.get(t.data.chain.id).nativeFungible;r.push({level:"info",titleKey:"swapAssetWarningLowTokenBalance",options:{token:o.data.symbol??"",network:o.data.chain.name}})}return r};function Pk(t){let e=t.data;return e?.mintExtensions?e.mintExtensions.some(r=>r.extension==="permanentDelegate"):!1}function kk(t){let e=H(t),r=Gh();return e.resourceType==="address"?r.some(o=>o.resourceType===e.resourceType&&o.address===e.address&&o.chainId===e.chainId):!1}function Rk(t){let e=Te.get(t.data.chain.id);return new z(t.data.amount?t.data.amount:0).lt(e.swapDefaultFee)}s();a();var $h=N(M());s();a();function Hh(){return[new Zl,new Yl,new Jl,new Xl]}var Yl=class{isEditable({sellAsset:e}){return!!e&&I.isSolanaNetworkID(e.data.chain.id)}},Xl=class{isEditable({currencyDenomination:e}){return e==="crypto"}},Jl=class{isEditable({sellAsset:e,buyAsset:r}){return!Ce(e?.data.chain.id,r?.data.chain.id)}},Zl=class{isEditable(){return ve.isFeatureEnabled("enable-swapper-exact-out")}};var em=({sellAsset:t,buyAsset:e,currencyDenomination:r})=>{let o=(0,$h.useMemo)(()=>Hh(),[]);return e?o.every(n=>n.isEditable({sellAsset:t,buyAsset:e,currencyDenomination:r})):!1};s();a();var Wh=N(M());s();a();var tm=class{isSupported(e,r,o,n,i){switch(e){case"sell":return!!(o&&i);case"buy":return!1}}},rm=class{isSupported(e){return e!=="buy"}};function zh(){return[new tm,new rm]}var Oa=(t,e,r,o,n)=>(0,Wh.useMemo)(()=>zh(),[]).every(c=>c.isSupported(t,e,r,o,n));s();a();var om=class{format(e,r){return`${Ut(e)} ${r}`}},nm=class{format(e,r){return`${Qi(e,{compact:!0})} ${r}`}},im=class{format(e){return Qi(e,{compact:!0})}};function cm(t){switch(t){case"full":return new om;case"compact":return new nm;case"compactNoSymbol":return new im}}var sm=class{format(e,r,o){return`${Ut(gt(Number(e),o,r.data?.decimals??0))} ${r.data.symbol??""}`}},qa=class{format(e,r,o){return Qi(gt(Number(e),o,r.data?.decimals??0),{compact:!0})}},am=class{noSymbolDisplayStrategy;constructor(e){this.noSymbolDisplayStrategy=e}format(e,r,o){return`${this.noSymbolDisplayStrategy.format(e,r,o)} ${r.data?.symbol??""}`}};function pm(t){switch(t){case"full":return new sm;case"compact":return new am(new qa);case"compactNoSymbol":return new qa}}var Dk=Ye?[.25,.5,1]:[.5,1],jh=Ye?cm("full"):cm("compactNoSymbol"),Yh=Ye?pm("full"):pm("compact"),Nk={chainId:Z.Solana.Mainnet,slip44:"501",resourceType:"nativeToken"},Bk=()=>{let e=A(Re=>Re.amountType)==="sell"?"sell":"buy",r=A(Re=>Re.primaryCurrency),{currencySymbol:o,toUsd:n}=Ge(),i=r==="fiat"?o:void 0,c=A(Re=>Re.swapFilter),p=A(Re=>Re.setSwapFilter),u=id(),{handleCryptoAmountInputChange:l,handleFiatAmountInputChange:g,sellFungible:f,uiSellAmountCryptoInput:y,isFetchingQuote:h,notEnoughAssets:S,hasMinimumSellAmount:w,handleToggleCurrencyClick:b,uiSellAmountLocalFiatInput:x,handleSwapFilterClick:T,maxSellAmount:F}=_l(),P=A(Re=>Re.buyFungible),B=P?H(P):Nk,R=Zh(B),q=Zh(H(f)),G=Oa("sell",f,q,P,R),X=(0,Io.useMemo)(()=>({fungible:f,amount:r==="crypto"?y:x,secondaryCryptoSubtitle:r==="fiat"?Xh(n(x),f,Yh,q):void 0,balance:Jh(f,jh,u,F),isAmountLoading:h&&e!=="sell",isSecondaryCryptoSubtitleLoading:h,isWarning:S||!w,isAmountEditable:!0,supportsCurrencyDenominationSwitching:G,amountPrefix:i,filters:Dk,selectedFilter:c,warnings:[],usdAmount:q?De(Number(y),q):0}),[f,r,y,x,q,u,F,h,e,S,w,G,i,c,n]),{handleSwitchTokensClick:v,cryptoAmountInputValue:E,localFiatAmountInputValue:C,handleCryptoAmountInputChange:U}=Ll(),_=Oa("buy",f,q,P,R),k=em({sellAsset:f,buyAsset:P,currencyDenomination:r}),O=Ce(f?.data.chain.id,P?.data.chain.id),V=P?.data.chain.id,{fungible:D}=Jt({key:V?Xi(V,void 0):void 0}),ce=(0,Io.useMemo)(()=>{if(P)return{fungible:P,perspective:"buy",balance:Jh(P,jh,u),amount:r==="crypto"?E:C,secondaryCryptoSubtitle:r==="fiat"?Xh(n(C),P,Yh,R):void 0,isAmountLoading:h&&e!=="buy",isSecondaryCryptoSubtitleLoading:h,isWarning:!1,isAmountEditable:k,supportsCurrencyDenominationSwitching:_,amountPrefix:i,filters:[],selectedFilter:void 0,warnings:Kh(P,O?D:void 0),usdAmount:R?De(Number(E),R):0}},[P,u,r,E,C,R,h,e,k,_,i,n,O,D]),pe=(0,Io.useCallback)((Re,ie)=>{switch(p(void 0),Re){case"sell":r==="crypto"?l(ie):g(ie);break;case"buy":if(r==="fiat")return;U(ie);break}},[p,r,l,g,U]),Qe=te(),Ct=(0,Io.useCallback)(async()=>{e==="sell"&&(b(),await Qe.capture("swapperToggleQuoteCurrency",{data:{value:r==="fiat"?"native":"fiat"}}))},[e,Qe,r,b]),No=(0,Io.useCallback)((Re,ie)=>{ie==="sell"&&T(Re)},[T]);return{switchPerspective:v,sell:X,buy:ce,setAmount:pe,switchCurrencyDenomination:Ct,setFilter:No,currencyDenomination:r}};function Xh(t,e,r,o){let n=e.data?.symbol??"",i=Number(t);return o?r.format(i,e,o):`0 ${n}`}function Jh(t,e,r,o){let n=o?z(o):t.data?.balance;if(!(!n||r))return e.format(n,t.data?.symbol??"")}var Zh=t=>{let{data:e}=Je({query:{data:t}});return e?.usd};s();a();var Lk=["lastSubmittedPairs","slippageTolerance"],um=t=>{let e=String(t.queryKey[1]);return Lk.includes(e)};s();a();var eb=N(M());function lm(t){let{t:e}=pt();return(0,eb.useMemo)(()=>{let{networkFee:r,phantomFee:o,tokenAccountFee:n,nonIncludedFees:i,destinationNetworkFee:c,liquidityFee:p}=t;return{networkFee:{label:e("swapQuoteNetwork"),valueUsd:r.amountUsd,maxValueUsd:r.maxAmountUsd},bridgeFee:{label:e("swapQuoteBridgeFee"),valueUsd:i.amountUsd,maxValueUsd:i.maxAmountUsd},tokenAccountFee:{label:e("swapQuoteOneTimeTokenAccount"),valueUsd:n.amountUsd},phantomFeePercent:{label:o.pct?e("swapQuoteFeeDisclaimer",{feePercentage:Hm(o.pct)}):"",value:o.pct?`${o.pct}`:""},destinationNetworkFee:{label:e("swapQuoteDestinationNetwork"),valueUsd:c.amountUsd},liquidityProviderFee:{label:e("swapQuoteLiquidityProvider"),valueUsd:p.amountUsd}}},[t,e])}s();a();var tb=N(M());function Uk(){let t=te(),e=A(f=>f.buyFungible),r=A(f=>f.sellFungible),o=A(f=>f.setBuyFungible),n=A(f=>f.setSellFungible),i=A(f=>f.setSellAmount),c=A(f=>f.setUiSellAmountCryptoInput),p=A(f=>f.resetQuote),u=A(f=>f.setSwapFilter),l=r?.data.amount,{cancelQuotes:g}=Ea();return(0,tb.useCallback)(async f=>{if(r&&Ao(f,r)){f&&f.data.amount!==l&&(n(f),u(void 0));return}await g();let y=xa(f);t.capture("swapperUpdateFromAsset",{data:y}),n(f),u(void 0),e&&r&&Ao(f,e)&&o(r),f&&r?.data.chain.id!==f.data.chain.id&&(p(),o(void 0),i(""),c(""))},[t,e,g,l,p,r,o,i,n,u,c])}s();a();var cb=N(M());s();a();var Vr=N(M());s();a();s();a();s();a();var Va=class{sections(e){let r=yr().map(i=>i.programId),o=e.reduce((i,c)=>{if(c.data.spamStatus==="VERIFIED")return i.verified.push(c),i;if(c.type!=="SPL"||!c.data.ugcTokenMeta||c.data.ugcTokenMeta.status==="graduated"||!r.includes(c.data.ugcTokenMeta.programId))return i.unverified.push(c),i;let p=c.data.ugcTokenMeta.programId,u=i[p]??[];return u.push(c),i[p]=u,i},{verified:[],unverified:[]}),n=yr().map(i=>{let c=o[i.programId]??[];return{id:i.programId,header:{title:L.t("swapSectionTitleTokens",{section:i.name}),iconUrl:i.iconUrl},data:c,behavior:"collapsible"}});return[{id:"verified",data:o.verified,behavior:"static"},{id:"unverified",header:{title:L.t("swapUnverifiedTokens")},data:o.unverified,behavior:"collapsible"},...n]}};s();a();var Ga=class{sections(e){let r=e.filter(n=>n.data.spamStatus==="VERIFIED"),o=e.filter(n=>n.data.spamStatus!=="VERIFIED");return[{id:"verified",data:r,behavior:"static"},{id:"unverified",header:{title:L.t("swapUnverifiedTokens")},data:o,behavior:"static"}]}};function ob(t){return t?new Va:new Ga}s();a();var ib=N(M());s();a();var Ka=N(M());var nb=()=>{let{data:t}=ze({key:"lastSelectedTokens",queryKey:le.lastSelectedTokens()}),e=(0,Ka.useMemo)(()=>t?JSON.parse(t):{},[t]),{mutateAsync:r}=rt({key:"lastSelectedTokens",queryKey:le.lastSelectedTokens()}),o=(0,Ka.useCallback)(async n=>{let i={...e,[n]:!0};await r(JSON.stringify(i))},[e,r]);return{lastSelectedTokens:e,storeSelectedToken:o}};s();a();var Ha=class{constructor(e,r){this.lastSelectedTokens=e;this.storeSelectedToken=r}intercept(e){let r=J(H(e));return this.lastSelectedTokens[r]||this.storeSelectedToken(r),"continue"}};s();a();s();a();var $a=class{constructor(e){this.lastSelectedTokens=e}intercept(e,r){switch(e.type){case"SPL":{let o=J(H(e)),n=this.lastSelectedTokens[o];return e.data.ugcTokenMeta?.status==="preDeploy"&&!n?(rh(e),r("ugcWarning"),"interrupt"):"continue"}default:return"continue"}}};function _k({enableUgcSwaps:t,lastSelectedTokens:e,storeSelectedToken:r}){let o=[];return t&&o.push(new Ha(e,r),new $a(e)),o}function sb(t){let{lastSelectedTokens:e,storeSelectedToken:r}=nb();return(0,ib.useMemo)(()=>_k({enableUgcSwaps:t,lastSelectedTokens:e,storeSelectedToken:r}),[t,e,r])}var ab=(0,Vr.createContext)(void 0),Ok=({children:t})=>{let{data:[e]}=fe(["enable-ugc-swaps"]),r=(0,Vr.useMemo)(()=>ob(e),[e]),o=sb(e);return Vr.default.createElement(ab.Provider,{value:{buyAssetSectionAdapter:r,interceptors:o}},t)},Ti=()=>{let t=(0,Vr.useContext)(ab);if(!t)throw new Error("useSwapAssetSelect must be used within a SwapAssetSelectProvider");return t};var qk=()=>{let{interceptors:t}=Ti();return{executeInterceptors:(0,cb.useCallback)((r,o)=>{for(let n of t)if(n.intercept(r,o)==="interrupt")return"interrupt";return"continue"},[t])}};s();a();var Fo=N(M());var pb=3;function mm(t){return{id:t.id,data:t.data,...t.header?{header:t.header}:{}}}var Vk=t=>{let[e,r]=(0,Fo.useState)({}),o=(0,Fo.useCallback)((c,p)=>r(u=>({...u,[c]:p})),[]),{buyAssetSectionAdapter:n}=Ti(),i=(0,Fo.useMemo)(()=>n.sections(t),[n,t]);return(0,Fo.useMemo)(()=>i.map(c=>{switch(c.behavior){case"static":return mm(c);case"collapsible":{if(c.data.length<=pb)return mm(c);let p=e[c.id],u=p?c.data:c.data.slice(0,pb),l=()=>o(c.id,!p),g=mm(c);return{...g,header:{...g.header,button:{label:p?L.t("commandShowLess"):L.t("commandShowMore"),onClick:l}},data:u}}}}),[i,e,o])};s();a();var Gk=()=>{let t=re(),e=W();return me({mutationFn:async o=>{await $d(t,o),e.setQueryData(["termsHaveBeenAcknowledged2"],o)}})};s();a();s();a();var ub=async t=>!!await t.get("termsHaveBeenAcknowledged2");var dm=()=>{let t=re(),e=async()=>!!await ub(t);return $({queryKey:["termsHaveBeenAcknowledged2"],queryFn:e})};s();a();s();a();var fm=class{#e;constructor(e){this.#e=e}onBannerSeen=e=>{this.#e.capture("actionBannerSeenByUser",{data:{banner:e}})};onBannerClick=e=>{this.#e.capture("actionBannerClickedByUser",{data:{banner:e}})};onBannerDismiss=e=>{this.#e.capture("actionBannerDismissedByUser",{data:{banner:e}})};onInterstitialSeen=e=>{this.#e.capture("actionBannerInterstitialSeenByUser",{data:{banner:e}})};onInterstitialPrimaryClick=e=>{this.#e.capture("actionBannerInterstitialPrimaryButtonClickedByUser",{data:{banner:e}})};onInterstitialSecondaryClick=e=>{this.#e.capture("actionBannerInterstitialSecondaryButtonClickedByUser",{data:{banner:e}})};onInterstitialDismiss=e=>{this.#e.capture("actionBannerInterstitialDismissedByUser",{data:{banner:e}})}};s();a();var Kk=({id:t,humanReadableId:e,description:r,bannerType:o})=>({id:t,humanReadableId:e,description:r,type:o}),Hk=({id:t,humanReadableId:e,description:r,bannerType:o,interstitial:n})=>{let{title:i,primaryButtonText:c,secondaryButtonText:p}=n,u;if(o==="Modal")for(let[l,g]of Object.values(n.lineItems).entries())u={...u??{},[`lineItem${l+1}`]:{title:g.title,description:g.description}};return{id:t,humanReadableId:e,description:r,type:o,interstitial:{title:i,body:u,primaryButtonText:c??L.t("commandContinue"),secondaryButtonText:p??L.t("commandDismiss")}}};s();a();s();a();var jk=N(M());s();a();var lb=Qo(te,t=>new gm(t)),gm=class{#e;constructor(e){this.#e=e}onOpen=()=>this.#e.capture("connectHardwareOpen");onSelectedChains=e=>{let r=new Set(e),o=[];for(let i of I.getAllChainIDs())r.has(i)&&o.push(i);let n={numChains:o.length,selectedChains:o.map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(", ")};this.#e.capture("connectHardwareSelectedChains",{data:n})};onDerivedAccounts=e=>{let r={};for(let[o,n]of Object.entries(e.derivedAddresses)){if(!$k(o))continue;let i={numberOfDerivedAccounts:n.addresses.length};n.duration!==void 0&&(i.derivationDuration=n.duration),r[o]=i}this.#e.capture("connectHardwareAccountsDerived",{data:{...r}})};onDiscoveredAccounts=e=>{let{discoveredAccounts:r}=e,o={};for(let n of r){if(n.status==="undiscovered")continue;let i=n.accounts.reduce((c,{derivationPathType:p,hasAccountActivity:u})=>{let l=jr.getAddressType(p);return c[l]={derivationPathType:p,hasAccountActivity:u},c},{});for(let{hasAccountActivity:c,derivationPathType:p}of Object.values(i)){if(!c)continue;let u=o[p]??0;o[p]=u+1}}this.#e.capture("connectHardwareAccountsDiscovered",{data:{numberOfActiveAccounts:o}})};onConnectedAccounts=e=>{let r={};for(let o of e.accounts){let n=[...o.addresses,...o.publicKeys].reduce((i,c)=>{let p=jr.getAddressType(c.pathType);return i[p]=c.pathType,i},{});for(let i of Object.values(n)){let c=r[i]??0;r[i]=c+1}}this.#e.capture("connectHardwareAccountsConnected",{data:{numberOfAccountsImported:e.accounts.length,numberOfAccountsImportedByDerivationPath:r}})}};function $k(t){return typeof t!="string"?!1:Object.keys(Hc).includes(t)}s();a();s();a();var hme=["firstTimeOnboarding","isResettingApp"];s();a();s();a();var za="@phantom/onboarding",Sr={firstTimeOnboarding:[`${za}:first-time-onboarding`],isResettingApp:[`${za}:is-resetting-app`],deriveLedgerAccounts:[`${za}:derive-ledger-accounts`],discoverLedgerAccounts:[`${za}:discover-ledger-accounts`]};s();a();s();a();s();a();s();a();var Yk="/discover/v1",Xk={Accept:"application/json"},Jk=t=>{if(!t||!Array.isArray(t.accounts))return!1;for(let e of t.accounts)if(!(typeof e.address=="string"&&typeof e.amount=="string"&&(!e.lastActivityTimestamp||typeof e.lastActivityTimestamp=="number")&&e.chain&&typeof e.chain.id=="string"&&new Set(I.getAllNetworkIDs()).has(e.chain.id)&&typeof e.chain.name=="string"&&typeof e.chain.symbol=="string"&&typeof e.chain.imageUrl=="string"))return!1;return!0},Zk=t=>!!t&&typeof t.message=="string",ym=async t=>{if(!t.accounts.length)throw new Error("Must send at least 1 account for discovery");let e=await j.api().headers(Xk).post(Yk,t),r=e.data;if(!ne(e))throw Zk(r)?new Error(r.message):new Error(`Unable to discover accounts with args: ${JSON.stringify(t)}`);if(Jk(r))return r;throw new Error(`Invalid discover accounts response: ${JSON.stringify(r)}`)};var eR="fetch-multi-chain-accounts-by-seed",tR=()=>["bitcoinTaproot","bitcoinNativeSegwit"],rR=()=>["bip44Change","bip44","deprecated"],oR=()=>["bip44Ethereum","bip44EthereumSecondary","bip44EthereumTertiary"],nR=()=>["bip44Sui"],iR=(t,e)=>tR().map(r=>{let o={pathType:r,index:t},{publicKey:n}=e.derivePathType(r,t),i=jr.getAddressType(r),c=Qn({publicKey:n,addressType:i});return{chainType:i,chainId:Z.Bitcoin.Mainnet,address:c,publicKey:Buffer.from(n).toString("hex"),pathParams:o}}),sR=(t,e)=>oR().map(r=>{let o={pathType:r,index:t},{publicKey:n}=e.derivePathType(r,t),i=jr.getAddressType(r),c=Qn({publicKey:n,addressType:"eip155"});return{chainType:i,pathType:r,address:c,publicKey:Buffer.from(n).toString("hex"),pathParams:o}}),aR=(t,e)=>rR().map(r=>{let o={pathType:r,index:t},n=e.derivePathType(r,t),i;switch(r){case"bip44Root":case"bip44":case"bip44Change":i=n.publicKey;break;case"deprecated":i=Ym(n.secretKey).publicKey;break}let c=Qn({publicKey:i,addressType:"solana"});return{chainType:"solana",chainId:Z.Solana.Mainnet,address:c,publicKey:Buffer.from(i).toString("hex"),pathParams:o}}),cR=(t,e)=>nR().map(r=>{let o={pathType:r,index:t},{publicKey:n}=e.derivePathType(r,t),i=Qn({publicKey:n,addressType:"sui"});return{chainType:"sui",chainId:Z.Sui.Mainnet,address:i,publicKey:jm(n),pathParams:o}}),pR=1e4,mb=async(t,e=!0)=>{let r=Object.assign({},...t);try{let o=Object.values(r).map(({account:f})=>({address:f.address,chainId:f.chainId})),n;e?n=(await Vm(async()=>Ui(ym({accounts:o}),pR),()=>!0,2)).accounts:n=(await ym({accounts:o})).accounts;let i={};for(let f of n){let{account:y}=r[`${f.chain.id}-${f.address}`],h=y.publicKey,S=y.chainType,w=_i(y.pathParams),b={...f,publicKey:h,chainType:S,derivationPathType:y.pathParams.pathType,hasAccountActivity:!!f.lastActivityTimestamp||parseFloat(f.amount)>0};i[w]=[...i[w]||[],b]}Object.keys(i).forEach(f=>{i[f]=i[f].sort((y,h)=>I.compareNetworkID(y.chain.id,h.chain.id))});let c=Object.values(i),p=c.filter(f=>f.some(y=>y.hasAccountActivity)),u=!!p.length;return(u?p:c).map(f=>{let y=f[0];return{status:"discovered",seedIndex:r[`${y.chain.id}-${y.address}`].account.pathParams.index??-1,isSelectedByDefault:u,accounts:f}})}catch{let o=Object.values(r).map(({account:p})=>p),n={};for(let p of o){let{account:u}=r[`${p.chainId}-${p.address}`],l=_i(u.pathParams),g={...p,chain:{id:p.chainId,name:I.getNetworkName(p.chainId),symbol:I.getTokenSymbol(p.chainId)},chainType:jr.getAddressType(u.pathParams.pathType),derivationPathType:u.pathParams.pathType,hasAccountActivity:!1};n[l]=[...n[l]||[],g]}return Object.keys(n).forEach(p=>{n[p]=n[p].sort((u,l)=>I.compareNetworkID(u.chain.id,l.chain.id))}),Object.values(n).map(p=>{let u=p[0];return{status:"undiscovered",seedIndex:r[`${u.chain.id}-${u.address}`].account.pathParams.index??-1,accounts:p,isSelectedByDefault:!1}})}},uR=async({hdWallet:t,startIndex:e,endIndex:r,enabledAddressTypes:o,enabledChains:n})=>{let i=[];for(let c=e;c<=r;++c){let p={};if(o.includes("bip122_p2wpkh"))for(let u of iR(c,t))p[`${Z.Bitcoin.Mainnet}-${u.address}`]={account:u};if(o.includes("eip155")){let u=sR(c,t),l=n.filter(g=>I.isEVMNetworkID(I[g].mainnetID));for(let g of l){let f=I[g];for(let{address:y,publicKey:h,chainType:S,pathParams:w}of u)p[`${f.mainnetID}-${y}`]={account:{chainType:S,chainId:f.mainnetID,address:y,publicKey:h,pathParams:w}}}}if(o.includes("solana"))for(let u of aR(c,t))p[`${u.chainId}-${u.address}`]={account:u};if(o.includes("sui"))for(let u of cR(c,t))p[`${u.chainId}-${u.address}`]={account:u};i.push(p)}return mb(i)};function gde({batchSize:t,hdWallet:e,enabledAddressTypes:r,enabledChains:o}){let n=!!e&&r.length!=0;return kt({enabled:n,queryKey:[eR,t],queryFn:async({pageParam:u=0})=>{try{if(t<1)throw new Error(`Need positive batchSize: ${t}`);if(!e)throw new Error("Missing HDWallet");let l=[],g=[],f=u===0,y=u,h=!0;for(;h;){let S=y,w=y+t-1,x=(await uR({hdWallet:e,startIndex:S,endIndex:w,enabledAddressTypes:r,enabledChains:o})).flat(1);y+=t,h=!1;for(let T of x)l.push(T),(T.status==="undiscovered"||T.isSelectedByDefault)&&g.push(T),f&&T.status==="discovered"&&T.isSelectedByDefault&&(h=!0)}if(f&&g.length===0&&l.length>1){let S=l[0],w=S.accounts.map(x=>({...x,hasAccountActivity:!1})),b={status:"undiscovered",seedIndex:S.seedIndex,accounts:w,isSelectedByDefault:!1};g.push(b)}return g}catch(l){throw l instanceof Error&&Q.captureError(l,"account"),l}},getNextPageParam:(u,l)=>{let g=l.length,f=g?l[0]:[],y=f.length?lR(f[f.length-1].seedIndex,t):0;return g===1?y:y+t*(g-1)},gcTime:0,staleTime:0,initialPageParam:0})}var lR=(t,e)=>Math.ceil(t/e)*e+e;s();a();s();a();var mR=()=>{let t=re(),e=async()=>{let o=await t.get("firstTimeOnboarding");return o===null?!0:o.isFirstTimeOnboarding},{data:r}=$({queryKey:Sr.firstTimeOnboarding,queryFn:e});return r},dR=()=>{let t=re(),e=W();return me({mutationFn:async o=>{await t.set("firstTimeOnboarding",{isFirstTimeOnboarding:o}),zd(t,o?void 0:Date.now()),e.setQueryData(Sr.firstTimeOnboarding,o)}})};s();a();var fR=()=>{let t=re(),e=async()=>{let o=await t.get("isResettingApp");return o===null?{isResettingApp:!1,isFirstTimeResettingApp:!1}:o},{data:r}=$({queryKey:Sr.isResettingApp,queryFn:e});return r},gR=()=>{let t=re(),e=W();return me({mutationFn:async o=>{let i=(await t.get("isResettingApp"))?.isFirstTimeResettingApp??!1;await t.set("isResettingApp",{isResettingApp:o,isFirstTimeResettingApp:i}),e.setQueryData(Sr.isResettingApp,{isResettingApp:o,isFirstTimeResettingApp:i})}})},yR=()=>{let t=re(),e=W();return me({mutationFn:async o=>{let i=(await t.get("isResettingApp"))?.isResettingApp??!1;await t.set("isResettingApp",{isResettingApp:i,isFirstTimeResettingApp:o}),e.setQueryData(Sr.isResettingApp,{isResettingApp:i,isFirstTimeResettingApp:o})}})};s();a();var SR=N(kA()),wR=N(M());s();a();var db=N(M());s();a();s();a();var zt=N(M());s();a();s();a();s();a();var hR=["SwapperNoQuotes","UnsupportedCountry","UnknownError"],fb=(t,e,r,o)=>{t instanceof qe&&hR.includes(t.code)||(!e||e>=400&&e<500)&&(Q.addBreadcrumb(r,JSON.stringify(o),"info"),Q.captureError(t,"swapper"))};s();a();var gb=async(t,e,r=void 0)=>{if(ne(t))return Promise.resolve();let o;try{o=t.data}catch{throw new qe({key:r})}let n=Sw.safeParse(o);throw n.success?(Q.addBreadcrumb(e,JSON.stringify(n.data),"info"),new qe({key:n.data.name})):new qe({key:r})};s();a();var In=t=>{let e=new qe({key:"SwapperNoQuotes"});if(dl.safeParse(t?.type).success===!1)throw new Error("Invalid input");let r=fl.safeParse(t);if(!r.success||r.data.quotes.length===0)throw e;return r.data};var yb="swap-quotes";async function Wa({sellTokenCaip19:t,buyTokenCaip19:e,taker:r,takerDestination:o,exactOut:n,sellAmount:i,slippageTolerance:c,signal:p,enableAutoSlippage:u,priorityFee:l}){let g;try{Xr(r)&&(r.address=r.address.toLowerCase()),o&&Xr(o)&&(o.address=o.address.toLowerCase()),Xr(e)&&(e.address=e.address.toLowerCase()),Xr(t)&&(t.address=t.address.toLowerCase());let f="/swap/v2/quotes",y={sellToken:t,buyToken:e,taker:r,takerDestination:o,exactOut:n,sellAmount:i,slippageTolerance:c,autoSlippage:u,priorityFee:l},h=await j.api().post(f,y,{signal:p});return g=h.status,await gb(h,yb,"SwapperNoQuotes"),In(h.data)}catch(f){let y=f instanceof qe?f:new qe;throw fb(y,g,yb,{sellToken:t,buyToken:e,sellAmount:i,slippageTolerance:c}),y}}var ja=class{getQuotes(e){return Wa({sellTokenCaip19:e.sell,buyTokenCaip19:e.buy,taker:e.taker,takerDestination:e.takerDestination,sellAmount:e.amount,slippageTolerance:e.slippageTolerance,signal:e.signal,exactOut:e.exactOutEnabled,priorityFee:e.priorityFee,enableAutoSlippage:e.autoSlippageEnabled})}};s();a();s();a();var Ya=class{constructor(e,r,o,n,i,c){this.executingQuote=e;this.takerAddress=r;this.networkId=o;this.quote=n;this.executionId=i;this.evmSwapCommand=c}createTransaction(){return Sl({networkId:this.networkId,callerAddress:this.takerAddress,quote:this.quote})}async swap(e,r,o,n,i){return this.evmSwapCommand.swap(e,r,o,n,i)}async waitForConfirmation(e){return this.evmSwapCommand.waitForConfirmation(e)}};s();a();s();a();var hb=N(M());s();a();var Sb=N(M());function Xa(t){return(0,Sb.useMemo)(()=>be(t),[t])}function bb({sender:t}){let{t:e}=pt(),{currentQuote:r}=ee(),o=A(f=>f.buyFungible),n=A(f=>f.sellFungible),i=Xa(Ue(r)),{data:c}=Vt({callerAddress:t,quote:r,sellFungible:n}),p=c?.transactionPairs?.flatMap(f=>[...to(f.sellToken)??[],...to(f.buyToken)??[]])??[],u=[...new Set(p)],{fungibles:l}=yt({keys:u});return{pendingActivityRows:(0,hb.useMemo)(()=>Co({swapTransactions:c,sellFungible:n,buyFungible:o,fungibles:l,t:e,currentQuote:r,provider:i}),[c,n,o,l,e,r,i])}}function Co({swapTransactions:t,sellFungible:e,buyFungible:r,fungibles:o,currentQuote:n,provider:i,t:c}){let p={pendingSwapActivityRows:[],pendingApprovalActivityRows:[]};return t?t.type==="evm"?t.transactionTypes.reduce((u,l,g)=>{let f=e,y=r,h,S=t.transactionPairs;if(S&&S[g]){let w=S[g];f=Ja(w.sellToken,o)??e,y=Ja(w.buyToken,o)??r,h=w.approvalMetadata}if(l.includes("approval")){let w=f?.data.symbol??"";u.pendingApprovalActivityRows.push({topLeft:h?{text:`${c("transactionsPendingApproving")} ${h.symbol}`}:{text:`${c("transactionsPendingApproving")} ${w}`}})}else f&&y&&u.pendingSwapActivityRows.push(wb({sellFungible:f,buyFungible:y,sellAmount:n?.sellAmount,buyAmount:n?.buyAmount,provider:i,isBridge:l.includes("bridge"),t:c}));return u},p):t.transactionTypes.reduce((u,l,g)=>{let f=e,y=r,h=t.transactionPairs;if(h&&h[g]){let S=h[g];f=Ja(S.sellToken,o)??e,y=Ja(S.buyToken,o)??r}return f&&y&&u.pendingSwapActivityRows.push(wb({sellFungible:f,buyFungible:y,sellAmount:n?.sellAmount,buyAmount:n?.buyAmount,provider:i,isBridge:l.includes("bridge"),t:c})),u},p):p}var wb=({sellFungible:t,buyFungible:e,sellAmount:r,buyAmount:o,provider:n,isBridge:i,t:c})=>{let p=t.data.symbol,u=e.data.symbol,l=se(r??0,t.data.decimals??0),g=se(o??0,e.data.decimals??0);return{topLeft:{text:`${c(i?"transactionsPendingBridging":"transactionsPendingSwapping")} on ${n}`},topRight:{text:`${g} ${u}`,color:"accentSuccess"},bottomLeft:{text:`${p} \u2192 ${u}`},bottomRight:{text:`${l} ${p}`}}},Ja=(t,e)=>e.find(r=>(to(t)??[]).includes(r.data.key));var Ab="standard",Za=class{constructor(e,r,o,n,i,c){this.executingQuote=e;this.takerAddress=r;this.networkId=o;this.quote=n;this.executionId=i;this.gasEstimation=c}createTransaction(){return hl({quote:this.quote,callerAddress:this.takerAddress,networkId:this.networkId,sellFungible:this.executingQuote.sell})}async swap(e,r,o,n,i){let c=this.gasEstimation??await this.estimateGas(this.quote,this.executingQuote.response,Ab,r,o);if(!c)throw new Error(`No gas estimation found for ${Ab}`);let p=this.parsePendingActivity(this.executingQuote,r),{signature:u,error:l}=await Q.startSpan({name:"Process EVM Swap Txns"},()=>Fa({transactions:r.transactions,transactionTypes:r.transactionTypes,networkID:this.networkId,gasEstimation:c,pendingSwapActivityRows:p.pendingSwapActivityRows,pendingApprovalActivityRows:p.pendingApprovalActivityRows,accountIdentifier:e,accountSigner:n,storage:i}));if(l)throw l;return{networkID:this.networkId,id:u}}async waitForConfirmation(e){await md(e.networkID,e.id)}async estimateGas(e,r,o,n,i){let c=await dd(this.networkId,!0);if(!c)return;let p=c[o];if(!p)return;let u={networkID:this.networkId,gasLimit:new K(1),maxFeePerGas:p.maxFeePerGas,maxPriorityFeePerGas:p.maxPriorityFeePerGas};return la.estimateGas({swapTransactions:n,evmGasEstimation:u,currentQuote:e,scanResult:i,includeGasBuffer:!0,networkID:this.networkId,gasBuffer:r.gasBuffer})}parsePendingActivity(e,r){let o=be(Ue(e.quote));return Co({swapTransactions:r,sellFungible:e.sell,buyFungible:e.buy,fungibles:[],currentQuote:e.quote,provider:o,t:L.t})}};s();a();s();a();var Fn=class{constructor(e,r,o,n,i,c){this.executingQuote=e;this.takerAddress=r;this.networkId=o;this.quote=n;this.executionId=i;this.connection=c}async createTransaction(){return bl({quote:this.quote,connection:this.connection})}async swap(e,r,o,n,i){let c=this.parsePendingActivity(this.executingQuote,r),{signature:p,error:u}=await Ca({callerAddress:this.takerAddress,connection:this.connection,networkID:this.networkId,transactions:r.transactions,pendingSwapActivityRows:c.pendingSwapActivityRows,accountIdentifier:e,accountSigner:n,storage:i});if(u)throw u;return{networkID:this.networkId,id:p}}async waitForConfirmation(e){let r=Sd(e.networkID);await ji({connection:r,signature:e.id})}parsePendingActivity(e,r){let o=be(Ue(e.quote));return Co({swapTransactions:r,sellFungible:e.sell,buyFungible:e.buy,fungibles:[],currentQuote:e.quote,provider:o,t:L.t})}};var ec=class{constructor(e,r,o,n,i,c){this.executingQuote=e;this.takerAddress=r;this.networkId=o;this.quote=n;this.executionId=i;this.connection=c;this.solanaSwapCommand=new Fn(e,r,o,e.quote,i,c)}solanaSwapCommand;createTransaction(){return wl({quote:this.quote,connection:this.connection})}async swap(e,r,o,n,i){return this.solanaSwapCommand.swap(e,r,o,n,i)}async waitForConfirmation(e){return this.solanaSwapCommand.waitForConfirmation(e)}};s();a();var tc=class{constructor(e,r,o,n,i){this.executingQuote=e;this.takerAddress=r;this.networkId=o;this.quote=n;this.executionId=i}async createTransaction(){return Al({quote:this.quote})}async swap(e,r,o,n,i){let c=this.parsePendingActivity(this.executingQuote,r),{signature:p,error:u}=await Pa({callerAddress:this.takerAddress,networkID:this.networkId,transactions:r.transactions,pendingSwapActivityRows:c.pendingSwapActivityRows,accountIdentifier:e,accountSigner:n,storage:i});if(u)throw u;return{networkID:this.networkId,id:p}}async waitForConfirmation(e){await Wi(this.networkId,e.id)}parsePendingActivity(e,r){let o=be(Ue(e.quote));return Co({swapTransactions:r,sellFungible:e.sell,buyFungible:e.buy,fungibles:[],currentQuote:e.quote,provider:o,t:L.t})}};var rc=class{create(e,r,o,n,i){if(I.isSolanaNetworkID(o)&&So(e.quote))return new Fn(e,r,o,e.quote,ot(),n);if(I.isEVMNetworkID(o)&&bt(e.quote))return this.createEvmSwapCommand(e,r,o,i);if(I.isSuiNetworkID(o)&&wo(e.quote))return new tc(e,r,o,e.quote,ot());if(ae(e.quote)){if(I.isSolanaNetworkID(o))return new ec(e,r,o,e.quote,ot(),n);if(I.isEVMNetworkID(o)){let c=this.createEvmSwapCommand(e,r,o,i);return new Ya(e,r,o,e.quote,ot(),c)}}throw new Error("Unsupported SwapQuote}")}createEvmSwapCommand(e,r,o,n){let i=n?n.filter($i):void 0;return i&&i.length===0&&(i=void 0),new Za(e,r,o,e.quote,ot(),i)}};s();a();s();a();var bR=["UNSENT","OPENED","HEADERS_RECEIVED","LOADING","DONE"],Sm=class{ERROR=-1;CONNECTING=0;OPEN=1;CLOSED=2;CRLF=`\r
`;LF=`
`;CR="\r";lastEventId=null;status=this.CONNECTING;eventHandlers={open:[],message:[],error:[],close:[]};method;timeout;timeoutBeforeConnection;withCredentials;headers;body;debug;interval;lineEndingCharacter;_xhr=null;_pollTimer=null;_lastIndexProcessed=0;url;constructor(e,r={}){if(!e||typeof e!="string"&&typeof e.toString!="function")throw new SyntaxError("[EventSource] Invalid URL argument.");this.url=typeof e.toString=="function"?e.toString():e,this.method=r.method||"GET",this.timeout=r.timeout??0,this.timeoutBeforeConnection=r.timeoutBeforeConnection??500,this.withCredentials=r.withCredentials||!1,this.headers=r.headers||{},this.body=r.body||void 0,this.debug=r.debug||!1,this.interval=r.pollingInterval??5e3,this.lineEndingCharacter=r.lineEndingCharacter||null,this._pollAgain(this.timeoutBeforeConnection,!0)}_pollAgain(e,r){(e>0||r)&&(this._logDebug(`[EventSource] Will open new connection in ${e} ms.`),this._pollTimer=setTimeout(()=>{this.open()},e))}open(){try{this.status=this.CONNECTING,this._lastIndexProcessed=0,this._xhr=new XMLHttpRequest,this._xhr.open(this.method,this.url,!0),this.withCredentials&&(this._xhr.withCredentials=!0),this._xhr.setRequestHeader("Accept","text/event-stream"),this._xhr.setRequestHeader("Cache-Control","no-cache"),this._xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");for(let[e,r]of Object.entries(this.headers))this._xhr.setRequestHeader(e,r);this.lastEventId!==null&&this._xhr.setRequestHeader("Last-Event-ID",this.lastEventId),this._xhr.timeout=this.timeout,this._xhr.onreadystatechange=()=>{if(this.status===this.CLOSED)return;let e=this._xhr;this._logDebug(`[EventSource][onreadystatechange] ReadyState: ${bR[e.readyState]||"Unknown"}(${e.readyState}), status: ${e.status}`),[XMLHttpRequest.DONE,XMLHttpRequest.LOADING].includes(e.readyState)&&(e.status>=200&&e.status<400?(this.status===this.CONNECTING&&(this.status=this.OPEN,this.dispatch("open",{type:"open"}),this._logDebug("[EventSource][onreadystatechange][OPEN] Connection opened.")),this._handleEvent(e.responseText||""),e.readyState===XMLHttpRequest.DONE&&(this._logDebug("[EventSource][onreadystatechange][DONE] Operation done."),this._pollAgain(this.interval,!1))):e.status!==0&&(this.status=this.ERROR,this.dispatch("error",{type:"error",message:e.responseText,xhrStatus:e.status,xhrState:e.readyState}),e.readyState===XMLHttpRequest.DONE&&(this._logDebug("[EventSource][onreadystatechange][ERROR] Response status error."),this._pollAgain(this.interval,!1))))},this._xhr.onerror=()=>{this.status!==this.CLOSED&&(this.status=this.ERROR,this.dispatch("error",{type:"error",message:this._xhr.responseText,xhrStatus:this._xhr.status,xhrState:this._xhr.readyState}))},this.body?this._xhr.send(this.body):this._xhr.send(),this.timeout>0&&setTimeout(()=>{this._xhr.readyState===XMLHttpRequest.LOADING&&(this.dispatch("error",{type:"timeout"}),this.close())},this.timeout)}catch(e){this.status=this.ERROR,this.dispatch("error",{type:"exception",message:e.message,error:e})}}_logDebug(...e){this.debug&&console.debug(...e)}_handleEvent(e){if(this.lineEndingCharacter===null){let l=this._detectNewlineChar(e);if(l!==null)this._logDebug(`[EventSource] Automatically detected lineEndingCharacter: ${JSON.stringify(l).slice(1,-1)}`),this.lineEndingCharacter=l;else{console.warn("[EventSource] Unable to identify the line ending character. Ensure your server delivers a standard line ending character: \\r\\n, \\n, \\r, or specify your custom character using the 'lineEndingCharacter' option.");return}}let r=this._getLastDoubleNewlineIndex(e);if(r<=this._lastIndexProcessed)return;let o=e.substring(this._lastIndexProcessed,r).split(this.lineEndingCharacter);this._lastIndexProcessed=r;let n,i=null,c=[],p=0,u="";for(let l=0;l<o.length;l++)if(u=o[l].trim(),u.startsWith("event"))n=u.replace(/event:?\s*/,"");else if(u.startsWith("retry"))p=parseInt(u.replace(/retry:?\s*/,""),10),isNaN(p)||(this.interval=p);else if(u.startsWith("data"))c.push(u.replace(/data:?\s*/,""));else if(u.startsWith("id"))i=u.replace(/id:?\s*/,""),i!==""?this.lastEventId=i:this.lastEventId=null;else if(u===""&&c.length>0){let g=n||"message",f={type:g,data:c.join(`
`),url:this.url,lastEventId:this.lastEventId};this.dispatch(g,f),c=[],n=void 0}}_detectNewlineChar(e){let r=[this.CRLF,this.LF,this.CR];for(let o of r)if(e.includes(o))return o;return null}_getLastDoubleNewlineIndex(e){let r=this.lineEndingCharacter+this.lineEndingCharacter,o=e.lastIndexOf(r);return o===-1?-1:o+r.length}addEventListener(e,r){this.eventHandlers[e]===void 0&&(this.eventHandlers[e]=[]),this.eventHandlers[e].push(r)}removeEventListener(e,r){this.eventHandlers[e]!==void 0&&(this.eventHandlers[e]=this.eventHandlers[e].filter(o=>o!==r))}removeAllEventListeners(e){let r=Object.keys(this.eventHandlers);if(e===void 0)for(let o of r)this.eventHandlers[o]=[];else{if(!r.includes(e))throw Error(`[EventSource] '${e}' type is not supported event type.`);this.eventHandlers[e]=[]}}dispatch(e,r){if(Object.keys(this.eventHandlers).includes(e))for(let n of Object.values(this.eventHandlers[e]))n(r)}close(){this.status!==this.CLOSED&&(this.status=this.CLOSED,this.dispatch("close",{type:"close"})),clearTimeout(this._pollTimer),this._xhr&&this._xhr.abort()}},oc=Sm;var nc=class{eventSource;open(e,r){this.eventSource&&this.eventSource.close(),this.eventSource=new oc(this.createStreamUrl(e)),this.eventSource.addEventListener("new-quote-response",o=>{try{if(!o.data)throw new Error("No data in NewQuoteResponseEvent");let n=JSON.parse(o.data),i=In(n);r({type:"newQuoteResponse",quoteResponse:i})}catch{r({type:"error",error:new Error("Failed to parse NewQuoteResponseEvent")})}}),this.eventSource.addEventListener("open",()=>{r({type:"open"})}),this.eventSource.addEventListener("error",o=>{r({type:"error",error:new Error(`Error consuming event stream ${o.type}`)})})}close(){this.eventSource&&this.eventSource.close()}createStreamUrl({amount:e,buy:r,sell:o,taker:n,takerDestination:i,slippageTolerance:c,exactOut:p,autoSlippage:u}){return`https://staging-api.phantom.app/swap/v2/stream/quotes?${new URLSearchParams({taker:n,takerDestination:i,buyToken:r,sellToken:o,sellAmount:e,slippageTolerance:c.toString(),exactOut:p?"true":"false",autoSlippage:u?"true":"false"}).toString()}`}};s();a();var ic=class{eventSource;open(e,r){this.eventSource&&(this.eventSource.removeAllEventListeners(),this.eventSource.close()),this.eventSource=new oc(this.createStreamUrl(e));let o=n=>{switch(n.type){case"new-quote-response":try{if(!n.data)throw new Error("No data in NewQuoteResponseEvent");let i=JSON.parse(n.data),c=In(i);r({type:"newQuoteResponse",quoteResponse:c})}catch{r({type:"error",error:new Error("Failed to parse NewQuoteResponseEvent")})}break;case"open":r({type:"open"});break;case"error":r({type:"error",error:new Error(n.message)});break;case"close":r({type:"close"});break}};this.eventSource.addEventListener("new-quote-response",o),this.eventSource.addEventListener("open",o),this.eventSource.addEventListener("error",o),this.eventSource.addEventListener("close",o)}close(){this.eventSource&&(this.eventSource.removeAllEventListeners(),this.eventSource.close())}createStreamUrl({amount:e,buy:r,sell:o,taker:n,takerDestination:i,slippageTolerance:c,exactOut:p,autoSlippage:u}){return`https://staging-api.phantom.app/swap/v2/stream/quotes?${new URLSearchParams({taker:n,takerDestination:i,buyToken:r,sellToken:o,sellAmount:e,slippageTolerance:c.toString(),exactOut:p?"true":"false",autoSlippage:u?"true":"false"}).toString()}`}};s();a();s();a();s();a();s();a();var de=class extends Error{code;detailMessage;constructor(e,r){super(e),this.code=e,this.detailMessage=r}};var AR="slippageToleranceExceeded",TR="INSUFFICIENT_FUNDS",vR=ld,ER="insufficient lamports",xR="lower balance than rent-exempt minimum",IR=ud,FR="Transaction confirmation failed",CR=["Ledger App not open","Ledger not connected","Unable to connect to Ledger","Unable to connect to Ledger device","Need permission to connect to Ledger"],PR="Ledger user rejected action",kR="Ledger Sign Error";function RR(t){try{return Number(t.split('"Custom":')[1].split("}")[0])}catch{return null}}function DR(t){switch(RR(t.message)){case 301:return"slippageToleranceExceeded";case 6e3:return"EmptyRoute";case 6001:return"slippageToleranceExceeded";case 6002:return"InvalidCalculation";case 6003:return"MissingPlatformFeeAccount";case 6004:return"InvalidSlippage";case 6005:return"NotEnoughPercent";case 6006:return"InvalidInputIndex";case 6007:return"InvalidOutputIndex";case 6008:return"NotEnoughAccountKeys";case 6009:return"NonZeroMinimumOutAmountNotSupported";case 6010:return"InvalidRoutePlan";case 6011:return"InvalidReferralAuthority";case 6012:return"LedgerTokenAccountDoesNotMatch";case 6013:return"InvalidTokenLedger";case 6014:return"IncorrectTokenProgramID";case 6015:return"TokenProgramNotProvided";case 6016:return"SwapNotSupported";case 6017:return"ExactOutAmountNotMatched";case 6018:return"SourceAndDstinationMintCannotBeTheSame";default:return null}}function NR(t){return CR.some(r=>t.message.includes(r))?"LedgerConnectionError":t.message.includes(PR)?"LedgerRejectAction":t.message.includes(kR)?"LedgerUnknownSignError":t.message.toLowerCase().includes("ledger")?"LedgerUnknownError":null}function Gr(t){if(t===void 0)return new de("UnknownError","No error provided");if(t instanceof de)return t;let e=BR(t);if(e.message.includes(TR))return new de("INSUFFICIENT_FUNDS");if(LR(e.message))return new de("slippageToleranceExceeded");if(e.message==="Scan results are not valid")return new de("Scan results are not valid");if([vR,ER,IR,xR].some(u=>e.message.includes(u)))return new de("NotEnoughSol");let i=DR(e);if(i!==null)return new de(i);if(e.message.includes(FR))return new de("Transaction confirmation failed");let p=NR(e);return p!==null?new de(p):new de("UnknownError",e.message)}function BR(t){return typeof t=="string"?new Error(t):typeof t=="object"&&"logs"in t&&t.logs?.length?new Error(t.logs.join(`
`)):t}function LR(t){return t.includes(AR)}s();a();s();a();var Tb=3;function sc(){try{let t=ve.getMultivariateAssignment("swapper-high-slippage-threshold"),e=Number(t);return!t||isNaN(e)?Tb:e}catch{return Tb}}var vb=({currentQuote:t,quoteResponse:e,gasEstimation:r,swapTransactions:o,scanResults:n,isSwapSimulationDisabled:i,slippageTolerance:c})=>{if(!t)throw new de("Trying to execute swap with no current quote");if(!e)throw new de("Trying to execute swap with no quote response");if(I.isEVMNetworkID(e.sellToken.chainId)&&(!r||r?.length===0||r?.length<(o?.transactions.length??1)))throw new de("No gas estimation available");if(!o)throw new de("No swap transactions available");if(n.state!=="valid"&&(Q.addBreadcrumb("swapper","swapSimulationNotValid","info",br({scanResults:n.state})),!i)){let u=["Scan results are not valid","AccountFrozen","INSUFFICIENT_FUNDS","INSUFFICIENT_GAS","slippageToleranceExceeded","SIMULATION_TIMEOUT","MissingArgument","STALE_QUOTE","SimulationUnknownError"];if(MR(n.state)&&u.includes(n.state.code)){if(UR(n.state,c))return;throw n.state}else throw new de("Scan results are not valid")}};function UR(t,e){return t.code==="slippageToleranceExceeded"&&e&&e>=sc()}function MR(t){return t instanceof de}var QR={swap:{solana:"executeSolanaSwap",evm:"executeEvmSwap",sui:"executeSuiSwap"},bridge:{solana:"executeSolanaBridge",evm:"executeEvmBridge",sui:"executeSuiBridge"}},wm=(t,e)=>QR[t?"bridge":"swap"][e??"solana"],Eb=async({isBridge:t,addressType:e,isSwapSimulationDisabled:r,sender:o,currentQuote:n,quoteResponse:i,gasEstimation:c,swapTransactions:p,scanResults:u,pendingActivityRows:l,connection:g,logSwapFailureNoSignature:f,logTransactionSubmitted:y,onTransactionReceiptReceived:h,onTransactionSubmissionError:S,resetToInitialState:w,slippageTolerance:b,swapFungibles:x})=>{await Q.startSpan({name:wm(t,p?.type)},async()=>{w();let T;try{vb({currentQuote:n,quoteResponse:i,gasEstimation:c,swapTransactions:p,scanResults:u,isSwapSimulationDisabled:r,slippageTolerance:b});let F=await x({type:e,callerAddress:o,swapTransactions:p,pendingSwapActivityRows:l.pendingSwapActivityRows,pendingApprovalActivityRows:l.pendingApprovalActivityRows,gasEstimation:c,connection:g});if(h(F),F.error)throw F.id||f(),T=F.id,F.error;y(F)}catch(F){let P=Gr(F);S(P,T)}})};s();a();var ac=class{constructor(e){this.producer=e}listeners=new Set;openStream(e){this.listeners.forEach(r=>r.onEvent({type:"openRequested"})),this.producer.close(),this.producer.open(e,r=>{this.listeners.forEach(o=>o.onEvent(r))})}closeStream(){this.producer.close()}subscribe(e){this.listeners.add(e)}unsubscribe(e){this.listeners.delete(e)}};s();a();s();a();s();a();s();a();async function xb({transactions:t,locale:e,url:r,deviceId:o,takerAddress:n,networkId:i,slippageType:c,quote:p,quoteResponse:u}){return await Kn(e,o,{type:"transaction",userAccount:n,params:_R(t),url:r,networkID:i,context:ae(p)?"bridge":"swap",provider:OR(p),slippageType:c,metadata:{swapper:{quoteOutputAmount:p.buyAmount,quoteOutputToken:J(u.buyToken),quoteInputAmount:p.sellAmount,quoteInputToken:J(u.sellToken)}}})}var _R=t=>{switch(t.type){case"evm":return{transactions:t.transactions};case"solana":return{transactions:t.transactions,method:"signAndSendTransaction",simulatorConfig:{decodeAccounts:!1}};case"sui":return{transactions:t.transactions,method:"signAndSendTransaction"}}},OR=t=>{let e=ae(t)?wn(t):t?.sources??[];return be(e)};s();a();var Kr=(u=>(u.SlippageExceeded="SLIPPAGE_EXCEEDED",u.InsufficientFunds="INSUFFICIENT_FUNDS",u.InsufficientGas="INSUFFICIENT_GAS",u.AccountFrozen="ACCOUNT_FROZEN",u.SimulationTimeout="SIMULATION_TIMEOUT",u.StaleQuote="STALE_QUOTE",u.UnknownError="UNKNOWN_ERROR",u.SimulationFailed="SIMULATION_FAILED",u))(Kr||{}),Cn=class t extends Error{constructor(r,o,n){super(r);this.scannedTransactionResult=o;this.type=n;o&&(this.detailMessage=o.simulationError?.humanReadableError??(o.warnings.length>0?o.warnings[0].message:void 0)),this.type=n}detailMessage;static fromError(r){return r instanceof t?r:new t(r.message)}static fromScannedTransactionResult(r,o){return(i=>Object.values(Kr).includes(i))(r)?new t(r,o,r):new t(r,o)}};s();a();var Po=class t extends Error{constructor(r,o){super(r);this.type=o}static fromError(r){return new t(r.message)}static fromType(r){return new t(r,r)}};var Ib="https://phantom.com",cc=class{constructor(e,r,o){this.swapCommand=e;this.send=r;this.executingQuote=o;this.takerAddress=e.takerAddress,this.networkId=e.networkId,this.quote=e.quote,this.executionId=e.executionId}takerAddress;networkId;quote;executionId;createTransaction(){return this.send({type:"executeSwapStarted",executionId:this.executionId,executingQuote:this.executingQuote}),this.swapCommand.createTransaction()}async simulate(e,r,o){try{this.send({type:"simulationRequestStarted",executionId:this.executionId,executingQuote:this.executingQuote,networkId:this.networkId});let n,i=Ee(L.language)??"en";switch(I.isSuiNetworkID(this.networkId)?n={type:"transaction",expectedChanges:[],warnings:[],advancedDetails:void 0,error:void 0,simulationError:void 0,block:void 0}:n=await xb({transactions:e,locale:i,url:Ib,deviceId:o,takerAddress:this.takerAddress,networkId:this.networkId,slippageType:this.executingQuote.slippageType,quote:this.quote,quoteResponse:this.executingQuote.response}),n.error){case void 0:break;case"SIMULATION_FAILED":break;case"SLIPPAGE_EXCEEDED":if(this.executingQuote.response.slippageTolerance>=sc())break;default:throw Cn.fromScannedTransactionResult(n.error,n)}return this.send({type:"simulationPassed",scannedTransactionResult:n,executionId:this.executionId,networkId:this.networkId}),n}catch(n){throw this.send({type:"simulationFailed",error:Cn.fromError(n),executionId:this.executionId,networkId:this.networkId,url:Ib}),n}}async swap(e,r,o,n,i){this.send({type:"transactionSubmissionStarted",executionId:this.executionId});try{let c=await this.swapCommand.swap(e,r,o,n,i);if(!c.id)throw Po.fromType("noSignature");return this.send({type:"transactionSubmissionSuccess",txReceipt:c,executionId:this.executionId}),c}catch(c){let p=c instanceof Po?c:Po.fromError(c);throw this.send({type:"transactionSubmissionFailed",error:p,executionId:this.executionId}),p}}async waitForConfirmation(e){this.send({type:"transactionConfirmationStarted",executionId:this.executionId,txReceipt:e});try{let r=await this.swapCommand.waitForConfirmation(e);return this.send({type:"transactionConfirmed",executionId:this.executionId,txReceipt:e}),r}catch(r){throw this.send({type:"transactionConfirmationFailed",error:r,txReceipt:e,executionId:this.executionId}),r}}};s();a();s();a();var hm=class extends Error{constructor(e,r){super(`Can't transition to ${r} from ${e.type}`)}},pc=class{state=new Map;listeners=new Set;send(e){e.type==="executeSwapStarted"&&this.state.set(e.executionId,{type:"idle",executingQuote:e.executingQuote});let r=this.state.get(e.executionId);if(!r)throw new Error(`No previous state found for execution id: ${e.executionId}`);let o=r;try{return o=this.detectNextState(r,e),o.type==="transactionConfirmed"?this.state.delete(e.executionId):this.state.set(e.executionId,o),o}catch{return r}finally{this.notifyListeners(e,r,o,this.state)}}notifyListeners(e,r,o,n){try{this.listeners.forEach(i=>i.onStateChange(e,r,o,n))}catch{}}getState(){return this.state}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}detectNextState(e,r){switch(r.type){case"executeSwapStarted":return $t(e,"idle"),{type:"started",executingQuote:r.executingQuote};case"simulationRequestStarted":return $t(e,"started"),{type:"simulating",executingQuote:e.executingQuote};case"simulationPassed":return $t(e,"simulating"),{type:"simulated",scannedTransactionResult:r.scannedTransactionResult,executingQuote:e.executingQuote};case"simulationFailed":return $t(e,"simulating"),{type:"simulationFailed",error:r.error,executingQuote:e.executingQuote};case"transactionSubmissionStarted":return $t(e,"simulated"),{type:"submittingTransaction",executingQuote:e.executingQuote,scannedTransactionResult:e.scannedTransactionResult};case"transactionSubmissionFailed":return $t(e,"submittingTransaction"),{type:"transactionSubmissionFailed",error:r.error,executingQuote:e.executingQuote,scannedTransactionResult:e.scannedTransactionResult};case"transactionSubmissionSuccess":return $t(e,"submittingTransaction"),{type:"transactionSubmitted",txReceipt:r.txReceipt,executingQuote:e.executingQuote,scannedTransactionResult:e.scannedTransactionResult};case"transactionConfirmationStarted":return $t(e,"transactionSubmitted"),{type:"confirmingTransaction",txReceipt:e.txReceipt,scannedTransactionResult:e.scannedTransactionResult,executingQuote:e.executingQuote};case"transactionConfirmationFailed":return $t(e,"transactionSubmitted"),{type:"transactionNotConfirmed",txReceipt:e.txReceipt,scannedTransactionResult:e.scannedTransactionResult,error:r.error,executingQuote:e.executingQuote};case"transactionConfirmed":return $t(e,"confirmingTransaction"),{type:"transactionConfirmed",txReceipt:e.txReceipt,scannedTransactionResult:e.scannedTransactionResult,executingQuote:e.executingQuote}}}};function $t(t,e){if(t.type!==e)throw new hm(t,e)}s();a();s();a();var uc=class{queue=[];processing=!1;enqueue(e){this.queue.push(e),this.processNext()}clearQueue(){this.queue=[],this.processing=!1}async processNext(){if(this.processing||this.queue.length===0)return;this.processing=!0;let e=this.queue.shift();if(e)try{await e()}catch(r){console.error("Error processing task:",r)}this.processing=!1,this.processNext()}};var lc=class{constructor(e){this.quoteStreamer=e}state={type:"idle"};listeners=[];swapTransactionQueue=new uc;start(e,r){this.setState({type:"starting",input:e,account:r}),this.quoteStreamer.subscribe(this.quoteStreamListener),this.quoteStreamer.openStream(e)}stop(){this.swapTransactionQueue.clearQueue(),this.setState({type:"idle"}),this.quoteStreamer.closeStream(),this.quoteStreamer.unsubscribe(this.quoteStreamListener)}quoteStreamListener={onEvent:e=>{switch(e.type){case"newQuoteResponse":switch(this.state.type){case"starting":this.setState({type:"firstQuoteReceived",input:this.state.input,quote:e.quoteResponse.quotes[0],response:e.quoteResponse,account:this.state.account}),this.enqueueQuoteToProcess(this.state.input,e.quoteResponse,this.state.account);break;case"quoteProcessed":this.enqueueQuoteToProcess(this.state.input,e.quoteResponse,this.state.account,this.state.prevProcessedQuote);break}break;case"openRequested":break;case"close":this.setState({type:"idle"});break}}};enqueueQuoteToProcess(e,r,o,n){this.swapTransactionQueue.enqueue(()=>this.processQuote(r,e,o,n))}async processQuote(e,r,o,n){let i=e.quotes[0],c={quote:i};return this.setState({type:"quoteProcessed",input:r,response:e,quote:i,prevProcessedQuote:n,nextProcessedQuote:c,account:o}),c}subscribe(e){this.listeners.push(e)}unsubscribe(e){this.listeners=this.listeners.filter(r=>r!==e)}getState(){return this.state}setState(e){let r=this.state;this.state=e,this.listeners.forEach(o=>o.onStateChange(r,e))}};s();a();function Fb(t){return t.type==="quote"}s();a();s();a();var VR={"Could not find any routes":"noRoute"},Ei=class t extends Error{type;constructor(e,r){super(r??e),this.type=e}static fromMessage(e){let r=e?VR[e]??"undefinedError":"undefinedError";return new t(r,e)}};var ko=class extends Error{constructor(e,r){super(`Can't transition to ${r} from ${e.type}`)}},mc=class{state;listeners=new Set;constructor(e){this.state=e??{type:"idle"}}send(e){let r=this.state;try{return r=this.detectNextState(this.state,e),this.state=r,r}catch{return this.state}finally{this.notifyListeners(e,this.state,r)}}getState(){return this.state}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}notifyListeners(e,r,o){try{this.listeners.forEach(n=>n.onStateChange(e,r,o))}catch{}}detectNextState(e,r){switch(r.type){case"setPair":return{type:"pair",buy:r.buy,sell:r.sell,amount:r.amount};case"quoteRequestStarted":switch(e.type){case"pair":case"quote":case"quoteError":return{type:"fetchingQuote",buy:e.buy,sell:e.sell,amount:r.amount,slippageType:r.slippageType};default:throw new ko(e,r.type)}case"quoteRequestError":if(e.type!=="fetchingQuote")throw new ko(e,r.type);return{type:"quoteError",buy:e.buy,sell:e.sell,amount:e.amount,error:r.error,slippageType:e.slippageType};case"quoteResponseReceived":if(e.type!=="fetchingQuote")throw new ko(e,r.type);let o=r.response.quotes[0];return o?{type:"quote",response:r.response,buy:e.buy,sell:e.sell,quote:o,amount:e.amount,slippageType:e.slippageType}:{type:"quoteError",buy:e.buy,sell:e.sell,amount:e.amount,error:new Ei("noRoute"),slippageType:e.slippageType};case"quoteResponseStreamed":switch(e.type){case"pair":case"fetchingQuote":case"quote":case"quoteError":return{type:"quote",response:r.response,buy:e.buy,sell:e.sell,quote:r.response.quotes[0],amount:{amount:r.quoteInput.amount,perspective:r.quoteInput.exactOut?"buy":"sell"},slippageType:r.quoteInput.autoSlippage?"auto":"fixed"};default:throw new ko(e,r.type)}case"userSelectedQuote":if(e.type!=="quote")throw new ko(e,r.type);return{type:"quote",quote:r.quote,buy:e.buy,sell:e.sell,response:e.response,amount:e.amount,slippageType:e.slippageType}}}};s();a();var dc=class{async initialize(e,r,o){let{sellCaip19:n,buyCaip19:i}=this.getCaip19sForSwapMode(e),[c,p,u,l]=await Promise.all([this.getTokenBalance(n,r,o),this.getTokenPrice(n),this.getTokenBalance(i,r,o),this.getTokenPrice(i)]);return{sellToken:c,buyToken:u,sellTokenPrice:p,buyTokenPrice:l}}async getTokenBalance(e,r,o){let c=(await Od({addresses:[{chainId:e.chainId,address:r.address}],analytics:o,enableSolCompressedTokens:!1})).tokens.find(f=>{switch(f.type){case"SolanaNative":switch(e.resourceType){case"nativeToken":return!0;default:break}break;case"SPL":switch(e.resourceType){case"address":return f.data.mintAddress===e.address;case"nativeToken":return f.data.mintAddress===e.slip44;default:break}break}return!1});if(c)return qd({tokens:[c],priceMap:{}})[0];let p=e.resourceType==="address"?e.address:e.slip44,g=(await Is({query:p,networkIds:[e.chainId],searchContext:"swapper"})).results.map(f=>Zn(f))[0];if(g)return g;throw new Error(`Token not found ${e}`)}async getTokenPrice(e){return(await Dd({tokens:[e]}))[J(e)]}findCaip19ForInitializableToken(e,r){if(!I.isSolanaNetworkID(e))throw new Error("Unsupported network");switch(r){case"usdc":return{chainId:e,address:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",resourceType:"address"};case"native":return{chainId:e,resourceType:"nativeToken",slip44:I.getSlip44(e)}}}getCaip19sForSwapMode(e){let r="solana:101",o=e.type==="buy"?this.findCaip19ForInitializableToken(r,e.sellTokenType):Yr(e.sellCaip19);return{buyCaip19:e.type==="buy"?Yr(e.buyCaip19):this.findCaip19ForInitializableToken(r,e.buyTokenType),sellCaip19:o}}};s();a();var fc=class{state={type:"idle"};eventListeners=[];send(e){let r=this.state,o=this.detectNextState(e);this.state=o,this.eventListeners.forEach(n=>n.onStateChange(e,r,o))}detectNextState(e){switch(e.type){case"initializeStarted":return{type:"initializing",mode:e.mode};case"initializeCompleted":if(this.state.type==="initializing")return{type:"pair",mode:this.state.mode,sellToken:e.result.sellToken,buyToken:e.result.buyToken,sellTokenPrice:e.result.sellTokenPrice,buyTokenPrice:e.result.buyTokenPrice};throw new Error("Invalid state")}}getState(){return this.state}subscribe(e){this.eventListeners.push(e)}unsubscribe(e){this.eventListeners=this.eventListeners.filter(r=>r!==e)}};var xi=class{constructor(e,r,o,n){this.apiClient=e;this.swapCommandFactory=r;this.streamEventProducer=o;this.account=n,this.quoteProcessor=new lc(new ac(this.streamEventProducer)),this.quoteProcessor.subscribe(this.quoteProcessorListener)}stateMachine=new mc;executeSwapStateMachine=new pc;account;quoteProcessor;config={slippageType:"auto",slippageTolerance:1.3};swapInitializer=new dc;tokenStateMachine=new fc;initializeSwap(e,r){let o=e.type==="buy"?e.buyCaip19:e.sellCaip19,n=Yr(o),i=this.checkChainAddress(n.chainId);this.tokenStateMachine.send({type:"initializeStarted",mode:e}),this.swapInitializer.initialize(e,i,r).then(c=>{this.tokenStateMachine.send({type:"initializeCompleted",result:c}),this.setPair(c.buyToken,c.sellToken,{amount:"0",perspective:"sell"})}).catch(c=>{console.error("initializeSwap error",c)})}getTokenState(){return this.tokenStateMachine.getState()}subscribeToken(e){return this.tokenStateMachine.subscribe(e),()=>this.unsubscribeToken(e)}unsubscribeToken(e){this.tokenStateMachine.unsubscribe(e)}quoteProcessorListener={onStateChange:(e,r)=>{(r.type==="firstQuoteReceived"||r.type==="quoteProcessed")&&this.send({type:"quoteResponseStreamed",response:r.response,quoteInput:r.input})}};isValidAmount(e){try{let r=new z(e);return r.isFinite()?!r.isNegative():!1}catch{return!1}}setAmount(e){let{amount:r}=e;if(r===""&&(r="0"),!this.isValidAmount(r))return;this.quoteProcessor.stop();let o=this.checkAccount(),n=this.getState();switch(n.type){case"pair":case"quote":case"quoteError":if(r==="0"||r===""){this.send({type:"setPair",buy:n.buy,sell:n.sell,amount:e});return}let i=this.checkChainAddress(n.sell.data.chain.id),c=this.checkChainAddress(n.buy.data.chain.id),p={chainId:i.networkID,resourceType:"address",address:i.address},u={chainId:c.networkID,resourceType:"address",address:c.address};try{let l={amount:new z(e.amount).shiftedBy(e.perspective==="buy"?n.buy.data.decimals:n.sell.data.decimals).toString(),buy:J(H(n.buy)),sell:J(H(n.sell)),taker:J(p),takerDestination:J(u),slippageTolerance:this.config.slippageTolerance,autoSlippage:this.config.slippageType==="auto",exactOut:e.perspective==="buy"};this.quoteProcessor.start(l,o)}catch(l){console.error("Error when streaming quotes",l)}break}}setPair(e,r,o){this.send({type:"setPair",buy:e,sell:r,amount:o})}setAccount(e){this.account=e}getAccount(){return this.account}async fetchQuotes({amount:e,buy:r,sell:o,slippageTolerance:n,autoSlippageEnabled:i,priorityFee:c,signal:p}){let u=H(o),l=H(r),g=e.perspective==="buy",f=new z(e.amount).shiftedBy(e.perspective==="buy"?r.data.decimals:o.data.decimals).toString();this.send({type:"quoteRequestStarted",amount:e,slippageType:i?"auto":"fixed"});let y=this.checkChainAddress(o.data.chain.id),h={chainId:y.networkID,resourceType:"address",address:y.address},S;if(Ce(o.data.chain.id,r.data.chain.id)){let w=this.checkChainAddress(r.data.chain.id);S={chainId:w.networkID,resourceType:"address",address:w.address}}try{let w=await this.apiClient.getQuotes({sell:u,buy:l,amount:f,taker:h,takerDestination:S,slippageTolerance:n??0,autoSlippageEnabled:i,exactOutEnabled:g,priorityFee:c,signal:p});return this.send({type:"quoteResponseReceived",response:w}),w}catch(w){throw this.send({type:"quoteRequestError",error:w}),w}}async swap(e,r,o,n,i,c){let p=this.getState();if(!Fb(p))throw new Error(`Can't swap from ${p.type}`);this.quoteProcessor.stop();let u=this.checkAccount(),l=this.checkChainAddress(p.sell.data.chain.id),g={account:u,buy:p.buy,sell:p.sell,amount:p.amount,quote:p.quote,response:p.response,slippageType:p.slippageType},f=this.swapCommandFactory.create(g,l.address,l.networkID,i,c),y=new cc(f,S=>this.executeSwapStateMachine.send(S),g),h=await y.createTransaction();await Q.startSpan({name:wm(ae(p.quote),h.type)},async()=>{let S=await y.simulate(h,o,n),w=await y.swap(u.identifier,h,S,e,r);await y.waitForConfirmation(w)})}selectQuote(e){this.send({type:"userSelectedQuote",quote:e})}getState(){return this.stateMachine.getState()}getExecuteState(){return this.executeSwapStateMachine.getState()}stopProcessingQuotes(){this.quoteProcessor.stop()}subscribeExecution(e){return this.executeSwapStateMachine.addListener(e),()=>this.unsubscribeExecution(e)}unsubscribeExecution(e){this.executeSwapStateMachine.removeListener(e)}getQuoteProcessorState(){return this.quoteProcessor.getState()}subscribeQuoteProcessor(e){return this.quoteProcessor.subscribe(e),()=>this.unsubscribeQuoteProcessor(e)}unsubscribeQuoteProcessor(e){this.quoteProcessor.unsubscribe(e)}stopQuoteProcessor(){this.quoteProcessor.stop()}send(e){return this.stateMachine.send(e)}checkAccount(){if(!this.account)throw new Error("Must set a MultiChainAccount");return this.account}checkChainAddress(e){let o=this.checkAccount().addresses.find(n=>n.networkID===e);if(!o)throw new Error(`No address found for chain ${e}`);return Jm(o)&&(o.address=o.address.toLowerCase()),o}};var Pb=(0,zt.createContext)(null);function KR({children:t}){let{data:e}=ue(),r=(0,zt.useMemo)(()=>HR(),[]);return(0,zt.useEffect)(()=>{e&&r.setAccount(e)},[e,r]),zt.default.createElement(Pb.Provider,{value:r},t)}function wr(){let t=(0,zt.useContext)(Pb);if(!t)throw new Error("useSwapper must be used within a SwapperProvider");return t}function HR(){return new xi(new ja,new rc,Ye?new ic:new nc)}s();a();s();a();var gc=N(M());s();a();s();a();var Ft=N(M());s();a();s();a();s();a();s();a();function yc({buyAssetUsdValue:t,buyToken:e,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:i,phantomFeeUiAmount:c,priceImpact:p,provider:u,slippageTolerance:l,transactionId:g,slippageType:f,sellSwapFilter:y,isRetry:h,analyticsContext:S}){let w=Lw({buyAssetUsdValue:t,buyToken:e,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:i,phantomFeeUiAmount:c,priceImpact:p,provider:u,slippageTolerance:l,slippageType:f,sellSwapFilter:y,isRetry:h,analyticsContext:S});return w?{data:{...w,id:g}}:{}}s();a();var Sc=({txReceipt:t,networkID:e,amountType:r,swapAnalytics:o})=>{let n=vr(e);Q.addBreadcrumb("swapper","submittedTransaction","info",{...n,txReceipt:t.id,method:n.chainType==="solana"?"signAndSendTransaction":n.chainType==="eip155"?"eth_sendRawTransaction":n.chainType==="sui"?"signAndExecuteTransaction":"UNKNOWN"}),n.chainType==="solana"?o.submittedTransaction(t.id,{...n,method:"signAndSendTransaction",swapType:r==="sell"?"exactIn":"exactOut"}):n.chainType==="eip155"?o.submittedTransaction(t.id,{...n,method:"eth_sendRawTransaction",swapType:r==="sell"?"exactIn":"exactOut"}):n.chainType==="sui"&&o.submittedTransaction(t.id,{...n,method:"signAndExecuteTransaction",swapType:r==="sell"?"exactIn":"exactOut"})};s();a();var $r=t=>t?ae(t)?void 0:t.priceImpact:0;s();a();var kb=xe(t=>({lastFailedSwap:void 0,setLastFailedSwap:e=>{t({lastFailedSwap:e})}}));function Rb(){return kb.getState().lastFailedSwap}function bm(t){kb.getState().setLastFailedSwap(t)}var Ii=class{constructor(e,r){this.swapAnalytics=e;this.analytics=r}onStateChange(e,r,o,n){switch(e.type){case"executeSwapStarted":this.analytics.capture("swapperSwap");let i=wi({buyAssetUsdValue:o.executingQuote.buy.data.usd,buyToken:o.executingQuote.buy,sellAssetUsdValue:o.executingQuote.sell.data.usd,sellToken:o.executingQuote.sell,quote:o.executingQuote.quote,slippageTolerance:this.parseSlippageTolerance(o.executingQuote.slippageType,o.executingQuote.quote,o.executingQuote.response),slippageType:o.executingQuote.slippageType,sellSwapFilter:A.getState().swapFilter,isRetry:this.isRetry(o.executingQuote),analyticsContext:o.executingQuote.response?.analyticsContext});i&&(Q.addBreadcrumb("swapper","approved","info",br(i.swap)),this.swapAnalytics.approved(i));break;case"simulationFailed":e.error.type!=="SLIPPAGE_EXCEEDED"&&Q.captureError(e.error,"swapper"),this.analytics.capture("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:$R(e.error)}});break;case"transactionSubmissionFailed":Q.captureError(e.error,"swapper"),e.error.type==="noSignature"&&this.analytics.capture("swapperSwapFailureNoSignature"),this.analytics.capture("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:e.error.message}});break;case"transactionSubmissionSuccess":Sc({txReceipt:e.txReceipt,networkID:e.txReceipt.networkID,amountType:o.executingQuote.amount.perspective==="buy"?"buy":"sell",swapAnalytics:this.swapAnalytics});break;case"transactionConfirmationFailed":let c=Gr(e.error);Q.captureError(e.error,"swapper"),this.analytics.capture("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:c.message}});let p=vr(e.txReceipt.networkID),u={chainId:I.getChainID(e.txReceipt.networkID),networkId:e.txReceipt.networkID},l=e.txReceipt;switch(this.analytics.capture("waitForTransactionConfirmationError",{data:{...u,errorMessage:c.message}}),p.chainType){case"eip155":case"solana":case"sui":Q.addBreadcrumb("swapper","transactionStatus","error",{...p,txReceipt:l.id}),this.swapAnalytics.transactionStatus(l.id,{...p,status:{type:"error"}});break}break;case"transactionConfirmed":this.analytics.capture("swapperSwapSuccess",this.createAnalyticsPayload(o.executingQuote));let g=vr(e.txReceipt.networkID);switch(Q.addBreadcrumb("swapper","transactionStatus","info",{...g,txReceipt:e.txReceipt.id}),g.chainType){case"eip155":case"solana":case"sui":this.swapAnalytics.transactionStatus(e.txReceipt.id,{...g,status:{type:"confirmed"}});break}break}this.isFailureEvent(e)?bm(o.executingQuote):e.type==="transactionSubmissionSuccess"&&bm(void 0)}createAnalyticsPayload(e,r){let o=e.quote,n=A.getState();return yc({buyToken:e.buy,sellToken:e.sell,buyAmount:o.buyAmount.toString(),sellAmount:o.sellAmount.toString(),phantomFeeUiAmount:Ul(o).amountUsd?.toString()??"",priceImpact:$r(o),provider:be(Ue(o)),buyAssetUsdValue:n.buyUsdValue,sellAssetUsdValue:n.sellUsdValue,slippageTolerance:this.parseSlippageTolerance(e.slippageType,o,e.response),transactionId:r?.id??"",slippageType:e.slippageType,sellSwapFilter:n.swapFilter,isRetry:this.isRetry(e),analyticsContext:e.response?.analyticsContext})}parseSlippageTolerance(e,r,o){switch(e){case"fixed":return o.slippageTolerance;case"auto":return qt(r)?r.slippageTolerance:o.slippageTolerance}}isRetry(e){let r=Rb();if(!r)return!1;let o=J(H(r.buy)),n=J(H(r.sell)),i=J(H(e.buy)),c=J(H(e.sell));return o===i&&n===c}isFailureEvent(e){switch(e.type){case"simulationFailed":case"transactionSubmissionFailed":case"transactionConfirmationFailed":return!0;default:return!1}}};function $R(t){switch(t.type){case"SLIPPAGE_EXCEEDED":return"slippageToleranceExceeded";case"INSUFFICIENT_FUNDS":return"INSUFFICIENT_FUNDS";case"INSUFFICIENT_GAS":return"INSUFFICIENT_GAS";case"ACCOUNT_FROZEN":return"AccountFrozen";case"STALE_QUOTE":return"STALE_QUOTE";case"SIMULATION_TIMEOUT":return"SIMULATION_TIMEOUT";case"UNKNOWN_ERROR":return"SimulationUnknownError";case"SIMULATION_FAILED":return"SIMULATION_FAILED";default:return"Scan results are not valid"}}s();a();var Fi=class{constructor(e){this.queryClient=e}onStateChange(e,r,o,n){let{sell:i,quote:c,account:p}=o.executingQuote;if(e.type==="transactionConfirmed"){let u=new K(i.data.amount),l=new K(c.sellAmount),g=u.minus(l).toString();Na(this.queryClient,{id:An(i),amount:g}),this.queryClient.invalidateQueries({queryKey:Bd.tokens(p.addresses)})}}};s();a();var zR="swap-validation",Ci=class{simulationAnalytics;constructor(e){this.simulationAnalytics=new yo(e)}onStateChange(e,r,o){switch(e.type){case"simulationPassed":let n=e.scannedTransactionResult;this.simulationAnalytics.onScannedTransactionByUser({networkId:e.networkId,warnings:n.warnings.map(c=>c.severity),shouldBlock:!!n.block,errorCode:n.error??""});break;case"simulationFailed":let i=e.error.scannedTransactionResult;if(i){this.simulationAnalytics.onScannedTransactionByUser({networkId:e.networkId,warnings:i.warnings.map(c=>c.severity),shouldBlock:!!i.block,errorCode:i.error??""}),i?.error&&Q.addBreadcrumb(zR,`Simulation error: ${JSON.stringify({error:i.error})}`,"info");return}this.simulationAnalytics.onFailedScannedTransactionByUser({networkId:e.networkId,url:e.url}),Q.addBreadcrumb("simulation",`networkID: ${e.networkId}, url: ${e.url}, type: transaction`,"info");break}}};s();a();var Pi=class{onStateChange(e,r,o,n){let i=this.toLegacyTransition(e,o);i&&ca(i.nextState,i.event)}toLegacyTransition(e,r){let{buy:o,sell:n,quote:i,response:c}=r.executingQuote;switch(e.type){case"simulationFailed":return{event:{type:"simulationRequestError",error:e.error},nextState:{type:"simulationFailed",buy:o,sell:n,response:c,quote:i,scannedTransactionResult:e.error.scannedTransactionResult,simulationError:e.error.message}};case"transactionSubmissionFailed":return{event:{type:"transactionSubmissionFailed",error:e.error},nextState:{type:"transactionSubmissionFailed",buy:o,sell:n,response:c,quote:i,error:e.error}};case"transactionConfirmationFailed":return{event:{type:"transactionConfirmationFailed",error:e.error,txReceipt:e.txReceipt},nextState:{type:"transactionNotConfirmed",buy:o,sell:n,response:c,quote:i,error:e.error,txReceipt:e.txReceipt}};default:return}}};s();a();s();a();s();a();var wc=t=>t&&ae(t)?t.executionDuration:0;var ki=t=>{let e=wc(t);return Eo(e)};s();a();s();a();var jR=3e3,st=xe(t=>({toast:void 0,toastId:void 0,visible:!1,currentTimer:null,hideToast(e){t(r=>e&&r.toastId!==e?r:(r.currentTimer&&clearTimeout(r.currentTimer),{visible:!1,currentTimer:null}))},removeToast(){t(e=>(e.currentTimer&&clearTimeout(e.currentTimer),{toast:void 0,toastId:void 0,visible:!1,currentTimer:null}))},success(e){t(r=>{r.currentTimer&&clearTimeout(r.currentTimer);let o=setTimeout(()=>{t({visible:!1,currentTimer:null})},jR);return{toast:{type:"Success",...e},toastId:e.id??ot(),visible:!0,currentTimer:o}})},failed(e){t(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:"Failed",...e},toastId:e.id??ot(),visible:!0,currentTimer:null}))},progress(e){t(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:"Progress",...e},toastId:e.id??ot(),visible:!0,currentTimer:null}))},message(e){t(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:"Default",...e},toastId:e.id??ot(),visible:!0,currentTimer:null}))}}));s();a();s();a();function Db({sell:t,buy:e,onBuyFungiblePress:r}){let o=`${L.t("swapTxConfirmationSwapFailed")} ${t.data.symbol} \u2192 ${e.data.symbol}`,n=I.getChainDefinition(t.data.chain.id).tokenSymbol,i=L.t("buyAssetInterpolated",{tokenSymbol:n});return{title:o,message:L.t("swapTabInsufficientFunds"),onPress:r,buttonText:i}}s();a();function Nb(t){switch(t.type){case"SLIPPAGE_EXCEEDED":return L.t("swapTxConfirmationSwapFailedSlippageLimit");case"INSUFFICIENT_FUNDS":return L.t("swapTxConfirmationSwapFailedInsufficientBalance");case"INSUFFICIENT_GAS":return L.t("swapTxConfirmationSwapFailedInsufficientGas");case"ACCOUNT_FROZEN":return L.t("swapTxConfirmationSwapFailedAcountFrozen");case"SIMULATION_TIMEOUT":return L.t("swapTxConfirmationSwapFailedSimulationTimeout");case"STALE_QUOTE":return L.t("swapTxConfirmationSwapFailedStaleQuote");case"UNKNOWN_ERROR":return L.t("swapTxConfirmationSwapFailedSimulationUnknownError");default:return L.t("swapTxConfirmationSwapFailedTryAgain")}}function Bb(t,e,r,o,n,i){let{sell:c,buy:p}=e,u=YR(t,c,p,n,o,r,i);return u||{title:`${L.t("swapTxConfirmationSwapFailed")} ${c.data.symbol} \u2192 ${p.data.symbol}`,message:Nb(t),onPress:()=>{st.getState().hideToast(),o()},buttonText:L.t("commandRetry")}}function YR(t,e,r,o,n,i,c){if(!(t.type&&!c.includes(t.type)))switch(t.type){case"INSUFFICIENT_FUNDS":return Db({sell:e,buy:r,onBuyFungiblePress:()=>{st.getState().hideToast(),i()}});case"SLIPPAGE_EXCEEDED":return o.selectedSetting.type==="auto"?void 0:{title:L.t("swapEnableAutoSlippageTitleToast",{sellSymbol:e.data.symbol,buySymbol:r.data.symbol}),buttonText:L.t("swapEnableAutoSlippageButtonToast"),message:"",onPress:()=>{o.setSlippageSetting({type:"auto"}),n(),st.getState().hideToast()}}}}var hc=class{constructor(e,r,o,n,i){this.showFungibleDetails=e;this.showBuyFungibleScreen=r;this.slippageSettings=o;this.supportedCustomSimulationToastErrorTypes=n;this.retryAndNavigateToSwapper=i}onStateChange(e,r,o,n){let{sell:i,buy:c,quote:p}=o.executingQuote;switch(e.type){case"executeSwapStarted":XR(ae(p)?L.t("swapInitiatingBridgeToast",{sellSymbol:i.data.symbol,sellChain:i.data.chain.name,buySymbol:c.data.symbol,buyChain:c.data.chain.name}):L.t("swapSwappingToast",{sellSymbol:i.data.symbol,buySymbol:c.data.symbol}));break;case"transactionConfirmed":JR(ae(p)?L.t("swapBridgeInitiatedToast",{sellSymbol:i.data.symbol,sellChain:i.data.chain.name,buySymbol:c.data.symbol,buyChain:c.data.chain.name,estimatedTime:ki(p)}):L.t("swapSwappedToast",{sellSymbol:i.data.symbol,buySymbol:c.data.symbol}),()=>this.showFungibleDetails(c));break;case"simulationFailed":Lb(Bb(e.error,o.executingQuote,this.showBuyFungibleScreen,()=>this.handleRetryPress(o.executingQuote),this.slippageSettings,this.supportedCustomSimulationToastErrorTypes));break;case"transactionSubmissionFailed":case"transactionConfirmationFailed":Lb({title:`${L.t("swapTxConfirmationSwapFailed")} ${i.data.symbol} \u2192 ${c.data.symbol}`,message:L.t("swapTxConfirmationSwapFailedUnknownError"),onPress:()=>{this.handleRetryPress(o.executingQuote)},buttonText:L.t("commandRetry")});break}}handleRetryPress(e){st.getState().hideToast(),this.retryAndNavigateToSwapper(e)}};function XR(t){st.getState().progress({message:t,onPress:()=>{st.getState().hideToast()}})}function JR(t,e){st.getState().success({id:"swap-success",message:t,onPress:()=>{st.getState().hideToast(),e()}})}function Lb(t){st.getState().failed(t)}var bc=class{intercept(e){let{swapper:r,connection:o,storage:n,vaultProxy:i,locale:c,analytics:p,resetSwapper:u,queryClient:l,showFungibleDetails:g,showBuyFungibleScreen:f,swapAnalytics:y,gasEstimation:h,slippageSettings:S,supportedCustomSimulationToastErrorTypes:w,navigateToSwapper:b,storePairs:x}=e;if(r.getAccount()?.type==="ledger")return"continue";let F=r.getState();if(F.type!=="quote")return"continue";let{quote:P,sell:B,buy:R}=F;return this.isSupportedQuote(P)?((async()=>{x(B,R);let q=await p.getDeviceId(),G=new hc(g,f,S,w,U=>{b(U)}),X=new Fi(l),v=new Ii(y,p),E=new Ci(p),C=new Pi;try{r.subscribeExecution(X),r.subscribeExecution(E),r.subscribeExecution(v),r.subscribeExecution(G),r.subscribeExecution(C),await Promise.all([r.swap(i,n,c,q,o,h),u()])}catch{}finally{r.unsubscribeExecution(X),r.unsubscribeExecution(E),r.unsubscribeExecution(v),r.unsubscribeExecution(G),r.unsubscribeExecution(C)}})(),"interrupt"):"continue"}isSupportedQuote(e){return So(e)||bt(e)||wo(e)||ae(e)}};s();a();s();a();var Ac=class{intercept({hasViewedAutoSlippageOptIn:e,selectedSetting:r,setHasViewedAutoSlippageOptIn:o,showOverlay:n}){return!e&&r!=="auto"?(n("autoSlippageOptIn"),o(!0),"interrupt"):"continue"}};s();a();var Tc=class{intercept(){let{review:e}=Ur();return e?dr(e):go(),"continue"}};function Ub(t,e,r){let o=[];return t&&o.push(new Ac),r&&o.push(new bc),e||o.push(new Tc),o}s();a();var vc=class{async fetch(e){return await Wa(e)}stopFetching(){}};s();a();var Ec=class{constructor(e){this.swapper=e}async fetch(e){let r=eD(e.amount,e.sell,e.buy);return this.swapper.setPair(e.buy,e.sell,r),await this.swapper.fetchQuotes({buy:e.buy,sell:e.sell,amount:r,slippageTolerance:e.slippageTolerance,autoSlippageEnabled:e.enableAutoSlippage,priorityFee:e.priorityFee})}stopFetching(){this.swapper.stopProcessingQuotes()}};function eD(t,e,r){let o=t.type==="sell"?e:r;return{amount:new z(t.value).shiftedBy(-o.data.decimals).toString(),perspective:t.type}}s();a();var xc=class{constructor(e,r){this.swapper=e;this.queryClient=r}queryKey;quoteProcessorListener={onStateChange:(e,r)=>{if(!this.queryKey){console.error("queryKey is not set");return}r.type==="quoteProcessed"&&this.queryClient.setQueryData(this.queryKey,r.response)}};async fetch(e,r){return this.queryKey=r,this.swapper.unsubscribeQuoteProcessor(this.quoteProcessorListener),new Promise((o,n)=>{let i=tD(e.amount,e.sell,e.buy),c={onStateChange:(p,u)=>{u.type==="firstQuoteReceived"&&(o(u.response),this.swapper.unsubscribeQuoteProcessor(c))}};this.swapper.subscribeQuoteProcessor(this.quoteProcessorListener),this.swapper.subscribeQuoteProcessor(c),this.swapper.setPair(e.buy,e.sell,i),this.swapper.setAmount(i)})}stopFetching(){this.swapper.getQuoteProcessorState().type!=="idle"&&(this.swapper.stopProcessingQuotes(),this.swapper.unsubscribeQuoteProcessor(this.quoteProcessorListener))}};function tD(t,e,r){let o=t.type==="sell"?e:r;return{amount:new z(t.value).shiftedBy(-o.data.decimals).toString(),perspective:t.type}}s();a();var Am=N(M());var Mb=()=>{let t=(0,Am.useCallback)(()=>{dr()},[]),e=(0,Am.useCallback)(()=>{go()},[]);return{onSwapTabEnter:t,onSwapTabExit:e}};var Qb=(0,Ft.createContext)(void 0),rD=({children:t})=>{let{data:[e,r,o,n,i,c]}=fe(["enable-auto-slippage","enable-swapper-skip-review","enable-swapper-toasts","enable-swapper-toasts-auto-slippage","enable-swapper-keypad-swap","enable-quote-streaming"]),p=(0,Ft.useMemo)(()=>e?["auto","fixed"]:["fixed"],[e]),u=(0,Ft.useMemo)(()=>n?["SLIPPAGE_EXCEEDED"]:[],[n]),l=(0,Ft.useMemo)(()=>Ub(e,r,o),[e,r,o]),g=qc,f=r,y=wr(),h=W(),S=(0,Ft.useMemo)(()=>c?new xc(y,h):o&&Ye?new Ec(y):new vc,[y,o,c,h]),{onSwapTabEnter:w,onSwapTabExit:b}=Mb();return Ft.default.createElement(Qb.Provider,{value:{slippageSettingTypes:p,reviewInterceptors:l,inspectorEnabled:g,showStickyCTAButton:f,getSwapQuotesStrategy:S,supportedCustomSimulationToastErrorTypes:u,showKeypadSwapButton:i,onSwapTabEnter:w,onSwapTabExit:b}},t)},Tm=()=>{let t=(0,Ft.useContext)(Qb);if(!t)throw new Error("useSwapTab must be used within a SwapTabProvider");return t};s();a();var oD="https://help.phantom.com/hc/en-us/articles/33745013398675";s();a();var nD=t=>sa.safeParse(t).success;s();a();var zr=N(M());s();a();s();a();function _b(){return Ur().review!==null?1:0}var Ob=(0,zr.createContext)(void 0),sD=({children:t})=>{let e=(0,zr.useMemo)(()=>_b(),[]);return zr.default.createElement(Ob.Provider,{value:{infoRowDisplayStrategy:e}},t)},aD=()=>{let t=(0,zr.useContext)(Ob);if(!t)throw new Error("useSwapReview must be used within a SwapReviewProvider");return t};s();a();var Ro=N(M());var cD=d.object({programId:d.string(),complete:d.boolean(),progress:d.string()}),pD=d.object({bondingCurves:d.record(d.string(),cD)});function uD(t){let e=qb(t),o=W().getQueryData(e.queryKey),{data:n,isFetching:i,isError:c}=$({...e,initialData:o,staleTime:0}),p=(0,Ro.useMemo)(()=>yr(),[]);return(0,Ro.useMemo)(()=>{let u=o===n;if(i&&!u)return{type:"Loading"};if(c)return{type:"Error"};let l=pD.safeParse(n);if(!l.success)return{type:"Error"};let g=l.data.bondingCurves[t];if(!g)return{type:"NoBondingCurve"};let f=p.find(h=>h.programId===g.programId);if(!f)return{type:"NoBondingCurve"};let y=dD(g.progress);return y?g.complete?{type:"Graduated",ugcProgram:f}:{type:u&&i?"BondingCurveRefreshing":"BondingCurve",progressPercentage:y,ugcProgram:f}:{type:"Error"}},[o,t,n,c,i,p])}var lD=t=>{let e=W(),r=qb(t),o=ve.isFeatureEnabled("enable-ugc-swaps");return(0,Ro.useCallback)(async()=>{o&&await e.refetchQueries({queryKey:r.queryKey,type:"active"})},[e,r.queryKey,o])},qb=t=>{let e=(0,Ro.useMemo)(()=>yr(),[]),r=(0,Ro.useMemo)(()=>e.map(n=>n.programId),[e]);return{queryKey:["bonding-curve",t,r],queryFn:()=>mD(t,r)}},mD=async(t,e)=>(await j.api().post("/ugc/v1/bonding-curve",{tokens:[t],programIds:e})).data,dD=t=>{let e=Number(t);if(!isNaN(e))return Math.round(e*100)};s();a();var at=N(M());s();a();s();a();var hr=N(M());s();a();var Vb=({networkID:t,txReceipt:e,preferredExplorers:r})=>{let o=e?.id??"";if(!o)return;let n=r?.explorers[t];return nd({networkID:t,endpoint:"transaction",explorerType:n,param:o})};s();a();function Gb(t,e){if(e){let r=fD(t),o=yD(t,e),n=SD(t,e);return{notEnoughSol:e.message==="NotEnoughSol",txErrorTitle:r,txErrorMessage:o,txErrorHelpButtonLink:n}}return{notEnoughSol:!1,txErrorTitle:"",txErrorMessage:"",txErrorHelpButtonLink:""}}var fD=t=>t?L.t("swapTxBridgeFailed"):L.t("swapTxConfirmationSwapFailed"),gD=t=>{switch(t.message){case"LedgerConnectionError":return L.t("swapTxConfirmationSwapFailedLedgerConnectionError");case"LedgerRejectAction":return L.t("swapTxConfirmationSwapFailedLedgerReject");case"LedgerUnknownSignError":return L.t("swapTxConfirmationSwapFailedLedgerSignError");case"LedgerUnknownError":return L.t("swapTxConfirmationSwapFailedLedgerError");default:return null}},yD=(t,e)=>{let r=gD(e);if(r!==null)return r;if(t)switch(e.message){case"slippageToleranceExceeded":return L.t("swapTxConfirmationSwapFailedSlippageLimit");default:return L.t("swapTxBridgeFailedDescription")}else switch(e.message){case"INSUFFICIENT_FUNDS":return L.t("swapTxConfirmationSwapFailedInsufficientBalance");case"slippageToleranceExceeded":return L.t("swapTxConfirmationSwapFailedSlippageLimit");case"EmptyRoute":return L.t("swapTxConfirmationSwapFailedEmptyRoute");case"AccountFrozen":return L.t("swapTxConfirmationSwapFailedAcountFrozen");case"SIMULATION_TIMEOUT":return L.t("swapTxConfirmationSwapFailedSimulationTimeout");case"INSUFFICIENT_GAS":return L.t("swapTxConfirmationSwapFailedInsufficientGas");case"Scan results are not valid":return L.t("swapTxConfirmationSwapFailedUnknownError");case"STALE_QUOTE":return L.t("swapTxConfirmationSwapFailedStaleQuote");case"SimulationUnknownError":return L.t("swapTxConfirmationSwapFailedSimulationUnknownError");default:return L.t("swapTxConfirmationSwapFailedTryAgain")}},SD=(t,e)=>t?na:e.message==="AccountFrozen"?tw:na;s();a();var Kb=({sellAmount:t,sellFungible:e,buyAmount:r,buyFungible:o,txStatus:n,txReceipt:i,swapTransactions:c,isReadyToExecute:p,uiEstimatedTime:u,isBridge:l,isLedger:g,notEnoughSol:f,txError:y,txErrorTitle:h,txErrorMessage:S,explorerUrl:w,txErrorHelpButtonLink:b,addressType:x})=>{let T=se(t,e?.data.decimals??0).toNumber(),F=se(r,o?.data.decimals??0).toNumber(),P=n==="success",B=n==="error",R=!!i,q=c?.transactions.length||0;return{sellAsset:{amount:T,symbol:e?.data.symbol??"",networkID:e?.data.chain.id??Z.Solana.Mainnet},buyAsset:{amount:F,symbol:o?.data.symbol??"",networkID:o?.data.chain.id??Z.Solana.Mainnet},estimatedTime:u,isBridge:l,isSuccess:P,isFailure:B,isLedger:g,isClosable:R,notEnoughSol:f,txError:y,txErrorTitle:h,txErrorMessage:y?.detailMessage?`${S}

${y?.detailMessage}`:S,txLink:w??"",txErrorHelpButtonLink:b,numberOfTransactions:q,isReadyToExecute:p,addressType:x}};var vm=({sellFungible:t,txReceipt:e,swapTransactions:r,isBridge:o,txError:n,txStatus:i,isReadyToExecute:c,isLedger:p})=>{let u=t?.data.chain.id??Z.Solana.Mainnet,{notEnoughSol:l,txErrorTitle:g,txErrorMessage:f,txErrorHelpButtonLink:y}=(0,hr.useMemo)(()=>Gb(o,n),[o,n]),h=(0,hr.useMemo)(()=>I.getAddressType(u),[u]),{currentQuote:S}=ee(),[w]=(0,hr.useState)(S),{buyAmount:b,sellAmount:x}=w??{buyAmount:"0",sellAmount:"0"},T=A(q=>q.buyFungible),{data:F}=sd(),P=(0,hr.useMemo)(()=>Vb({txReceipt:e,networkID:u,preferredExplorers:F}),[e,u,F]),B=(0,hr.useMemo)(()=>ki(w),[w]);return(0,hr.useCallback)(()=>Kb({sellFungible:t,txReceipt:e,addressType:h,swapTransactions:r,isBridge:o,txError:n,sellAmount:x,buyAmount:b,buyFungible:T,txStatus:i,isReadyToExecute:c,uiEstimatedTime:B,isLedger:p,notEnoughSol:l,txErrorTitle:g,txErrorMessage:f,explorerUrl:P,txErrorHelpButtonLink:y}),[t,e,h,r,o,n,x,b,T,i,c,B,p,l,g,f,P,y])()};s();a();var Pn=N(M());var Do=()=>{let t=te(),e=ho(),{currentQuote:r,quoteResponse:o}=ee(),{analyticsContext:n}=o??{analyticsContext:void 0},i=A(R=>R.buyFungible),c=A(R=>R.sellFungible),p=A(R=>R.buyUsdValue),u=A(R=>R.sellUsdValue),l=A(R=>R.selectedProviderIndex),g=A(R=>R.swapFilter),{selectedSetting:f}=Fe(),y=A.getState().amountType,h=c?.data.chain.id??Z.Solana.Mainnet,S=Et(),{transition:w}=fr(),b=(0,Pn.useCallback)(R=>{let q=Mr(l,f.type,o);return yc({buyToken:i,sellToken:c,buyAmount:r?.buyAmount.toString()??"",sellAmount:r?.sellAmount.toString()??"",phantomFeeUiAmount:S.phantomFee.amountUsd?.toString()??"",priceImpact:$r(r),provider:be(Ue(r)),buyAssetUsdValue:p,sellAssetUsdValue:u,slippageTolerance:q,transactionId:R??"",slippageType:f.type,sellSwapFilter:g,analyticsContext:n})},[i,c,r,S.phantomFee.amountUsd,p,u,o,l,f.type,g,n]),x=(0,Pn.useCallback)(R=>{Sc({txReceipt:R,networkID:h,amountType:y,swapAnalytics:e})},[h,y,e]),T=(0,Pn.useCallback)((R,q)=>{w({type:"transactionSubmissionFailed",error:R}),R.message!=="Scan results are not valid"&&R.message!=="slippageToleranceExceeded"&&Q.captureError(R,"swapper");let G=b(q);t.capture("swapperSwapFailure",{data:{...G.data,error:R.message}})},[t,b,w]),F=()=>{t.capture("swapperSwapFailureNoSignature")},P=(0,Pn.useCallback)(R=>{let q=b(R.id);t.capture("swapperSwapSuccess",q);let G=vr(R.networkID);Q.addBreadcrumb("swapper","transactionStatus","info",{...G,txReceipt:R.id}),(G.chainType==="eip155"||G.chainType==="solana"||G.chainType==="sui")&&e.transactionStatus(R.id,{...G,status:{type:"confirmed"}})},[t,b,e]),B=(0,Pn.useCallback)((R,q)=>{let G=R?.networkID?vr(R.networkID):null;(G?.chainType==="eip155"||G?.chainType==="solana"||G?.chainType==="sui")&&R?.id&&(Q.addBreadcrumb("swapper","transactionStatus","error",{...G,txReceipt:R.id}),e.transactionStatus(R.id,{...G,status:{type:"error"}}),w({type:"transactionConfirmationFailed",error:q,txReceipt:R}))},[e,w]);return{logTransactionSubmitted:x,logTransactionSubmissionError:T,logSwapFailureNoSignature:F,logTransactionConfirmed:P,logTransactionConfirmationFailed:B}};s();a();var zb=N(M());s();a();var Ri=()=>{let{selectedSetting:t}=Fe(),e=A(c=>c.selectedProviderIndex),r=A(c=>c.quoteResponse),o=Mr(e,t.type,r),{data:n}=vo();return{slippageSetting:t,slippageTolerance:o??n??void 0}};s();a();s();a();var Ic=N(M());s();a();var Em="swap-validation",Hb=({scanResult:t,scanResultError:e,quote:r,sellToken:o,buyToken:n})=>{if(e)return"valid";if(!r||!o||!n)return Q.addBreadcrumb(Em,`Missing necessary args: ${JSON.stringify({quote:!!r,scanResult:!!t,sellToken:o,buyToken:n})}`,"info"),new de("MissingArgument");if(t?.error===Mt.SIMULATION_FAILED)return"valid";if(t?.error){if(Q.addBreadcrumb(Em,`Simulation error: ${JSON.stringify({error:t.error})}`,"info"),t.error===Mt.SLIPPAGE_EXCEEDED)return new de("slippageToleranceExceeded");if(t.error===Mt.INSUFFICIENT_FUNDS)return new de("INSUFFICIENT_FUNDS");if(t.error===Mt.INSUFFICIENT_GAS)return new de("INSUFFICIENT_GAS");if(t.error===Mt.ACCOUNT_FROZEN)return new de("AccountFrozen");if(t.error===Mt.SIMULATION_TIMEOUT)return new de("SIMULATION_TIMEOUT");if(t.error===Mt.STALE_QUOTE)return new de("STALE_QUOTE");if(t.error===Mt.UNKNOWN_ERROR){let i=wD(t);return new de("SimulationUnknownError",i)}return new de("Scan results are not valid")}return t?"valid":(Q.addBreadcrumb(Em,`Missing necessary args: ${JSON.stringify({quote:!!r,scanResult:!1,sellToken:o,buyToken:n})}`,"info"),new de("MissingArgument"))};function wD(t){return t.simulationError?t.simulationError.humanReadableError:t.warnings[0]?.message}var $b=({swapTransactions:t})=>{let e=A(w=>w.sellFungible),r=A(w=>w.buyFungible),o=e?.data.chain.id??Z.Solana.Mainnet,{selectedSetting:n}=Fe(),{currentQuote:i,quoteResponse:c}=ee(),p=be(Ue(i)),u=Ce(e?.data.chain.id,r?.data.chain.id),l=c?.buyToken?J(c?.buyToken):void 0,g=c?.sellToken?J(c?.sellToken):void 0,f={type:"transaction",userAccount:e?.data.walletAddress??"",params:void 0,url:"https://phantom.com",networkID:o,context:u?"bridge":"swap",provider:p,slippageType:n.type,metadata:{swapper:{quoteOutputAmount:i?.buyAmount,quoteOutputToken:l,quoteInputAmount:i?.sellAmount,quoteInputToken:g}}};t?.type==="evm"&&I.isEVMNetworkID(o)&&(f.params={transactions:t.transactions}),t?.type==="solana"&&I.isSolanaNetworkID(o)&&(f.params={transactions:t.transactions,method:"signAndSendTransaction",simulatorConfig:{decodeAccounts:!1}});let{transition:y}=fr(),h=(0,Ic.useCallback)((w,b)=>{b&&y({type:"simulationRequestError",error:b}),w&&y({type:"simulationResponseReceived",scannedTransactionResult:w})},[y]),S=fi(f,{disableRefetch:!0,onSettled:h,disabled:t?.type==="sui"});return(0,Ic.useMemo)(()=>{if(S.isLoading)return{isLoading:!0,state:"loading"};if(t?.type==="sui")return{isLoading:!1,state:"valid"};let w=Hb({scanResult:S.data,scanResultError:S.isError,quote:i,sellToken:c?.sellToken,buyToken:c?.buyToken,simulationTolerance:c?.simulationTolerance});return{isLoading:S.isLoading,state:w}},[S,i,c,t?.type])};function Wb({isBridge:t,addressType:e,isSwapSimulationDisabled:r,onTransactionReceiptReceived:o,onTransactionSubmissionError:n,resetToInitialState:i,sender:c}){let{logTransactionSubmitted:p,logSwapFailureNoSignature:u}=Do(),{connection:l}=Lt(),{data:g}=ue(),{currentQuote:f,quoteResponse:y}=ee(),{slippageTolerance:h}=Ri(),S=A(v=>v.gasEstimation.estimateWithBuffer),w=A(v=>v.sellFungible),b=w?.data.chain.id??Z.Solana.Mainnet,{data:x,isSuccess:T}=Vt({callerAddress:c,quote:f,sellFungible:w}),F=$b({swapTransactions:x}),{pendingActivityRows:P}=bb({sender:c}),{mutateAsync:B}=Bl({accountIdentifier:g?.identifier??"",networkID:b}),[R,q]=(0,zb.useState)(!1),G=async()=>(q(!0),Eb({isBridge:t,addressType:e,isSwapSimulationDisabled:r,sender:c,currentQuote:f,quoteResponse:y,gasEstimation:S,swapTransactions:x,scanResults:F,pendingActivityRows:P,connection:l,slippageTolerance:h,logSwapFailureNoSignature:u,logTransactionSubmitted:p,swapFungibles:B,onTransactionSubmissionError:n,onTransactionReceiptReceived:o,resetToInitialState:i}));return{isReadyToExecute:R||(!F.isLoading||r)&&T,executeSwap:G}}s();a();var Fc=N(M());var jb=({goToSwapTab:t,goToSwapReview:e,goToActivityTab:r})=>{let{resume:o}=wt(),{clearQuotes:n}=Nl(),i=gr(),c=(0,Fc.useCallback)(()=>{o(),n(),t()},[t,o,n]),p=(0,Fc.useCallback)(()=>{o(),e()},[e,o]),u=(0,Fc.useCallback)(()=>{i(),r()},[r,i]);return{onClose:c,onRetry:p,onSwapSuccess:u}};s();a();function Yb(){let{data:[t]}=fe(["kill-swapper-simulation"]);return t}s();a();var kn=N(M());var Xb=({onTransactionConfirmationSuccess:t,onTransactionConfirmationError:e,txReceipt:r})=>{let o=W(),{data:n}=ue(),i=(0,kn.useMemo)(()=>n?.addresses??[],[n]),c=Vd(i),p=gr(),{logTransactionConfirmed:u,logTransactionConfirmationFailed:l,logTransactionSubmissionError:g}=Do(),f=A(T=>T.sellFungible),{currentQuote:y}=ee(),{sellAmount:h}=y??{sellAmount:"0"},S=(0,kn.useCallback)(async T=>{if(u(T),p(),f){let F=new K(f.data.amount),P=new K(h),B=F.minus(P).toString();Na(o,{id:An(f),amount:B})}c()},[u,p,h,f,c,o]),{isSuccess:w,isError:b,error:x}=Md(S,r);(0,kn.useEffect)(()=>{if(w)t();else if(b){let T=Gr(x);e(T),l(r,T),g(T,r?.id)}},[w,b,x,r,l,t,e,g])};function Jb({isLedger:t,goToSwapTab:e,goToSwapReview:r,goToActivityTab:o}){let{currentQuote:n}=ee(),i=A(D=>D.buyFungible),c=A(D=>D.sellFungible),p=gr(),u=Yb(),{logTransactionSubmissionError:l}=Do(),[g]=(0,at.useState)(Ce(c?.data.chain.id,i?.data.chain.id)),f=c?.data.chain.id??Z.Solana.Mainnet,{data:y}=ue(),h=(0,at.useMemo)(()=>y?.addresses??[],[y]),S=(0,at.useMemo)(()=>h.find(D=>D.networkID===c?.data.chain.id)?.address??"",[h,c]),w=(0,at.useMemo)(()=>I.getAddressType(f),[f]),{data:b}=Vt({callerAddress:S,quote:n,sellFungible:c}),[x,T]=(0,at.useState)(),[F,P]=(0,at.useState)("loading"),[B,R]=(0,at.useState)(),q=()=>{P("loading"),R(void 0),T(void 0)},G=D=>{T(D)},X=(0,at.useCallback)((D,ce)=>{P("error"),R(D),l(D,ce)},[l]),v=(0,at.useCallback)(()=>{P("success")},[]),E=(0,at.useCallback)(D=>{P("error"),R(Gr(D))},[]);Xb({onTransactionConfirmationSuccess:v,onTransactionConfirmationError:E,txReceipt:F==="error"?void 0:x});let{executeSwap:C,isReadyToExecute:U}=Wb({isBridge:g,addressType:w,isSwapSimulationDisabled:u,onTransactionSubmissionError:X,onTransactionReceiptReceived:G,resetToInitialState:q,sender:S}),{onClose:_,onRetry:k,onSwapSuccess:O}=jb({goToSwapTab:e,goToSwapReview:r,goToActivityTab:o});return{...vm({sellFungible:c,txReceipt:x,swapTransactions:b,isBridge:g,txStatus:F,isReadyToExecute:U,isLedger:t,txError:B}),executeSwap:C,resetSwapper:p,onClose:_,onRetry:k,onSwapSuccess:O}}s();a();s();a();var Zb=N(M()),eA=()=>{let{data:[t,e]}=fe(["enable-auto-slippage","enable-swapper-priority-fee-settings"]);return(0,Zb.useMemo)(()=>t?e?"autoWithPriorityFees":"auto":"fixed",[t,e])};s();a();s();a();var tA=N(M());var hD=()=>{let{data:[t]}=fe(["enable-swapper-toasts"]),e=wr();return{selectQuote:(0,tA.useCallback)((o,n)=>{if(t){let i=o[n];i&&e.selectQuote(i)}},[t,e])}};s();a();s();a();var bD=t=>t.isGreaterThanOrEqualTo(1)?"0,0.[00]":"0,0.[00000]",Cc=t=>{let e=z(t);return Wm(t,bD(e))};s();a();s();a();s();a();var Rn=class t{constructor(e,r){this.tracer=r;this.name=e.name,this.context=e.context,this.marks=t.makeMarks(e.marks),this.derivedMarks=e.derivedMarks||[],this.onlyDev=e.onlyDev||!1}name;context;marks;derivedMarks;onlyDev;get markCount(){return this.marks.length+this.derivedMarks.length}getMark(e){return this.marks.find(r=>r.name===e)}qualify(e){return`${this.id}_${e}`}static makeMarks(e){return e.map(r=>typeof r=="string"?{name:r}:{name:r.name,metric:r.metric})}};s();a();var Di=class extends Rn{get id(){return`${this.context}_${this.name}`}startTrace(){jt()||this.tracer.startTrace(this,"start")}mark(e){jt()||this.tracer.mark(this,e)}};s();a();s();a();s();a();var Pc=class{nativeTimestamp;constructor(e){this.nativeTimestamp=e.nativeEvent.timeStamp}};var kc=class extends Rn{triggers;constructor(e,r){super(e,r),this.triggers=e.triggers}get id(){return`user_${this.context}_${this.name}`}startTrace(e,r){if(jt())return;let o=new Pc(r);this.tracer.startTrace(this,e,o.nativeTimestamp)}mark(e){jt()||this.tracer.mark(this,e)}markFrame(e){jt()||requestAnimationFrame(()=>{this.tracer.mark(this,e)})}};s();a();s();a();s();a();var Rc=class{constructor(e){this.cleanupOptions=e}cleanupInterval=null;lastActivityTimestamp=0;signalActive(){this.lastActivityTimestamp=performance.now(),this.ensureCleanup()}ensureCleanup(){this.cleanupInterval||(this.cleanupInterval=setInterval(()=>this.cleanupCycle(),this.cleanupOptions.cleanupIntervalMs))}cleanupCycle(){let{itemsRemaining:e}=this.runCleanup(),r=performance.now()-this.lastActivityTimestamp;e===0&&r>=this.cleanupOptions.maxAgeMs&&this.stopCleanup()}stopCleanup(){this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null)}};var Dc=class extends Rc{constructor(r){super({cleanupIntervalMs:10*60*1e3,maxAgeMs:4*60*1e3});this.perf=r}activeTraces=new Map;startTrace(r,o,n=this.perf.now()){let i=new xm(r,o,n);this.activeTraces.set(r.id,i),this.perf.mark(i.startMarkName,{timestamp:n}),this.signalActive()}mark(r,o){let n=this.activeTraces.get(r.id);if(!n||n.hasMark(o))return;let i=r.getMark(o);this.processMark(n,i),this.processDerivedMarks(n),n.numAddedMarks===r.markCount&&this.activeTraces.delete(r.id)}processMark(r,o){r.addMark(o.name);let n=r.operation.qualify(o.name);if(this.perf.mark(n),o.metric){let i=r.operation.qualify(o.metric),c=this.perf.measure(i,r.startMarkName,n);if(c===void 0){Q.captureMessage(`[OperationTracer] Unexpected measure duration 'undefined' for mark ${n}, ignoring`,"performance","error");return}console.log(`[OperationTracer] Metric '${i}': ${c}ms (trigger: ${r.trigger})`)}}processDerivedMarks(r){r.operation.derivedMarks.forEach(o=>{if(r.hasMark(o.name))return;o.dependsOn.every(i=>r.hasMark(i))&&this.processMark(r,o)})}runCleanup(){let r=this.perf.now();for(let[o,n]of this.activeTraces)n&&r-n.startTime>this.cleanupOptions.maxAgeMs&&this.activeTraces.delete(o);return{itemsRemaining:this.activeTraces.size}}},xm=class{constructor(e,r,o){this.operation=e;this.trigger=r;this.startTime=o}marks=new Set;get numAddedMarks(){return this.marks.size}get startMarkName(){return this.operation.qualify(this.trigger)}addMark(e){this.marks.add(e)}hasMark(e){return this.marks.has(e)}};s();a();var Nc=class{now(){return performance.now()}mark(e,r={timestamp:performance.now()}){performance.mark(e,{startTime:r.timestamp})}measure(e,r,o){try{let n=performance.measure(e,r,o).duration;return Math.round(n)}catch{return}}};var AD=new Nc,Im=new Dc(AD),Bc=class t{static createOperation(e){return new Di(e,Im)}static createUserOperation(e){return new kc(e,Im)}static measureFunc(e,r,o={onlyDev:!1}){if(jt())return r();let n=new Di({name:e,context:"func",marks:[{name:"done",metric:"time"}]},Im);n.startTrace();let i=r();return i&&typeof i.then=="function"?i.then(c=>(n.mark("done"),c)):(n.mark("done"),i)}static wrapFunc(e,r,o={onlyDev:!1}){return function(...n){return t.measureFunc(e,()=>r(...n),o)}}};var TD=Bc.createUserOperation({name:"switchTokens",context:"swapTab",triggers:["switchButtonClick"],marks:["sellTokenUpdated","buyTokenUpdated"],derivedMarks:[{name:"tokensSwitched",dependsOn:["sellTokenUpdated","buyTokenUpdated"],metric:"switchTime"}],onlyDev:!0});s();a();var nA=N(M());s();a();var rA=N(M());var vD={status:!1,timestamp:""},oA=()=>{let{data:t}=ze({key:"hasViewedAutoSlippageOptIn",queryKey:le.hasViewedAutoSlippageOptIn()}),{mutateAsync:e}=rt({key:"hasViewedAutoSlippageOptIn",queryKey:le.hasViewedAutoSlippageOptIn()}),r=(0,rA.useCallback)(o=>void e({status:o,timestamp:new Date().toISOString()}),[e]);return{viewedOptInState:t??vD,setViewedOptInState:r}};var Fm=()=>{let{viewedOptInState:t,setViewedOptInState:e}=oA(),{selectedSetting:r}=Fe(),{reviewInterceptors:o,supportedCustomSimulationToastErrorTypes:n}=Tm(),i=wr(),{connection:c}=Lt(),p=re(),u=qo(),l=L.language,g=te(),f=gr(),y=W(),h=ho(),S=A(T=>T.gasEstimation.estimateWithBuffer),w=Fe(),{storePairs:b}=Kt();return{executeInterceptors:(0,nA.useCallback)((T,F,P,B)=>{for(let R of o)if(R.intercept({hasViewedAutoSlippageOptIn:t.status,selectedSetting:r.type,setHasViewedAutoSlippageOptIn:e,showOverlay:T,swapper:i,connection:c,storage:p,vaultProxy:u,locale:l,analytics:g,resetSwapper:f,queryClient:y,showFungibleDetails:F,showBuyFungibleScreen:P,swapAnalytics:h,gasEstimation:S,slippageSettings:w,navigateToSwapper:B,supportedCustomSimulationToastErrorTypes:n,storePairs:b})==="interrupt")return"interrupt";return"continue"},[o,t.status,r.type,e,i,c,p,u,l,g,f,y,h,S,w,n,b])}};s();a();var zFe=xe(t=>({quoteSpan:void 0,previousBuyAmount:void 0,previousSellAmount:void 0,setQuoteSpan(e){t({quoteSpan:e})},setPreviousBuyAmount(e){t({previousBuyAmount:e})},setPreviousSellAmount(e){t({previousSellAmount:e})}}));s();a();var ZFe=xe(t=>({initialLoadSpan:void 0,setInitialLoadSpan(e){t({initialLoadSpan:e})}}));s();a();var xD=N(M());var iCe=["simulationRequestErrored","simulationFailed","transactionSubmissionFailed","transactionNotConfirmed"];s();a();var ID=N(M());s();a();var Lc=N(M());var FD=["enable","reject"],CD=({continueSwap:t,dismiss:e})=>{let r=te(),{setSlippageSetting:o}=Fe(),n=(0,Lc.useCallback)(c=>{switch(e(),c){case"enable":r.capture("autoSlippageOptIn",{data:{step:"enabledAutoSlippage"}}),o({type:"auto"}),dr();break;case"reject":r.capture("autoSlippageOptIn",{data:{step:"rejectedAutoSlippage"}}),o({type:"fixed"}),t();break}},[t,e,o,r]),i=(0,Lc.useMemo)(()=>FD.map(c=>({label:L.t(c==="enable"?"swapSlippageOptInEnableOption":"swapSlippageOptInRejectOption"),variant:c==="enable"?"primary":"secondary",onPress:()=>n(c)})),[n]);return{title:L.t("swapSlippageOptInTitle"),description:L.t("swapSlippageOptInSubtitle"),learnMoreText:L.t("commandLearnMore"),learnMoreUrl:_a,options:i}};s();a();var sA=N(M());var PD=({goToAssetSelect:t})=>{let{setSearchQuery:e}=A();return(0,sA.useCallback)(r=>{r==="buy"&&e(""),t(r)},[t,e])};s();a();s();a();s();a();var Dn=N(M());s();a();var Cm=N(M());s();a();var pA=N(M());s();a();function aA(t){if(t===void 0)return"#999";let e=parseFloat(t.toFixed(2));switch(!0){case e>=5:return"#EB3742";case(e>=1&&t<5):return"#FFDC62";case(t>=0&&t<1):return"#21E56F";default:return"#777777"}}s();a();function cA(t){if(t===void 0)return"-";switch(!0){case t>=1e3:return">1000%";case(t>=.01&&t<1e3):return`${t.toFixed(2)}%`;case(t>0&&t<.01):return"<0.01%";case t===0:return"0%";default:return"-"}}function Uc(t){return(0,pA.useMemo)(()=>{let e="",r="";if(t===void 0)return;let o=t*100;return e=aA(o),r=cA(o),{color:e,text:r,percentage:o}},[t])}s();a();var Mc=({priceImpact:t,slippage:e,transferFees:r,shouldShowFees:o,shouldShowPriceImpact:n,shouldShowSlippage:i,isQuoteStreaming:c})=>{let p=c?DD:RD;return[...kD({priceImpact:t,slippage:e,transferFees:r}),...p({shouldShowSlippage:i,shouldShowFees:o,shouldShowPriceImpact:n})]},kD=({priceImpact:t,slippage:e,transferFees:r})=>{let o=[];return t&&t.percentage>tl&&o.push("highPriceImpact"),e&&e.percentage>=rl&&o.push("highSlippage"),(r?.totalPercentFees??0)>0&&o.push("transferFees"),o},RD=({shouldShowSlippage:t,shouldShowFees:e,shouldShowPriceImpact:r})=>{let o=[];return o.push("providerPressable"),o.push("exchangeRate"),t&&o.push("slippagePressable"),e&&o.push("fees"),r&&o.push("priceImpact"),o},DD=({shouldShowSlippage:t,shouldShowFees:e,shouldShowPriceImpact:r})=>{let o=[];return o.push("pricing"),e&&o.push("fees"),r&&o.push("priceImpact"),t&&o.push("slippagePressable"),o};s();a();function Qc(t,e){let r="",o="";if(t===void 0)return;r=ND(t);let n=e==="auto"?`${L.t("swapSlippageSettingsAuto")} \u2022 `:"";return o=BD(t),{color:r,text:o,percentage:t,prefix:n}}function ND(t){let e=parseFloat(t.toFixed(2));switch(!0){case e>2:return"#EB3742";case(e>=1&&t<=2):return"#FFDC62";default:return"#777777"}}function BD(t){switch(!0){case t>=1e3:return">1000%";case(t>=.01&&t<1e3):return`${t.toFixed(2)}%`;case(t>0&&t<.01):return"<0.01%";case t===0:return"0%";default:return"-"}}s();a();var _c=t=>t.reduce((e,r)=>{if(!r||r.type!=="SPL")return e;let o;return r.type==="SPL"&&(o=LD(r)),o?{fees:[...e.fees,o],totalPercentFees:e.totalPercentFees+o.percentFee}:e},{fees:[],totalPercentFees:0}),LD=t=>{if(t.type!=="SPL")return;let r=(t.data.mintExtensions??[]).find(o=>o.extension==="transferFeeConfig");if(r)return{caip19:J(H(t)),fungibleKey:t.data.key,symbol:t.data.symbol??"",name:t.data.name??"",percentFee:r.state.newerTransferFee.transferFeeBasisPoints/100}};var uA=()=>{let{currentQuote:t,quoteResponse:e}=ee(),r=Uc($r(t)),{selectedSetting:o}=Fe(),n=(0,Cm.useMemo)(()=>Qc(e?.slippageTolerance,o.type),[e?.slippageTolerance,o.type]),i=A(f=>f.sellFungible),c=A(f=>f.buyFungible),p=(0,Cm.useMemo)(()=>_c([i,c]),[i,c]),{data:[u,l]}=fe(["enable-swapper-skip-review","enable-quote-streaming"]);return{logSwapHomeState:()=>{let f=Mc({priceImpact:r,slippage:n,transferFees:p,shouldShowFees:u,shouldShowPriceImpact:!!r&&u,shouldShowSlippage:!!n&&u,isQuoteStreaming:l}),y={slippage:JSON.stringify(n),priceImpact:JSON.stringify(r),rows:f};Q.addBreadcrumb("swapper","swap-home","info",br(y))}}};s();a();var mA=N(M());s();a();function lA({sellFungible:t,totalFees:e,minRequiredBalance:r,currentQuote:o}){let n=e.maxAmount??e.amount,i=t?.type?Ne(t?.type):!1,{source:c,destination:p}=r;if(i){let u=new z(o?.sellAmount??0);return n.plus(u)}else{let u=c.plus(p);return n.plus(u)}}var dA=()=>{let{currentQuote:t}=ee(),{totalFees:e}=Et(),r=A(c=>c.sellFungible),o=vn(),n=Tn();return(0,mA.useMemo)(()=>lA({sellFungible:r,totalFees:e,minRequiredBalance:{source:o,destination:n},currentQuote:t}),[r,e,o,n,t])};s();a();function fA({sellFungible:t,sellNativeFungible:e,totalNativeRequirement:r}){let o=t?.data.chain.id,n=e?Xe(e.data.amount,e.data.decimals):"-",i=e?Xe(r,e.data.decimals):"-";return{networkId:o,balance:n,required:i}}s();a();function gA({quoteResponse:t,hasInsufficientBalance:e,insufficientBalanceArgs:r,isTermsAcknowledged:o,shouldSkipSwapReview:n,logSwapHomeState:i,goToInsufficientBalance:c,goToSwapTermsOfService:p,goToSwapReview:u,onSwap:l,executeInterceptors:g}){if(t)e?c(r):(i(),o?g()==="continue"&&(n?l():u()):p());else return}var Pm=({goToSwapTermsOfService:t,goToSwapReview:e,goToInsufficientBalance:r,goToConfirmation:o,showOverlay:n,showFungibleDetails:i,showBuyFungibleScreen:c,navigateToSwapper:p})=>{let{data:[u]}=fe(["enable-swapper-skip-review"]),{quoteResponse:l}=ee(),g=A(R=>R.sellFungible),f=g?.data.chain.id,{data:y}=dm(),{logSwapHomeState:h}=uA(),{fungible:S}=Jt({key:f?Xi(f,void 0):void 0}),w=dA(),b=(0,Dn.useMemo)(()=>new z(S?.data.amount??0).lt(w),[S,w]),x=(0,Dn.useMemo)(()=>fA({sellFungible:g,sellNativeFungible:S,totalNativeRequirement:w}),[g,S,w]),T=hi({goToConfirmation:o}),{executeInterceptors:F}=Fm(),P=(0,Dn.useCallback)(()=>F(n,i,c,p),[F,n,i,c,p]);return{onClick:(0,Dn.useCallback)(()=>gA({quoteResponse:l,hasInsufficientBalance:b,insufficientBalanceArgs:x,isTermsAcknowledged:y,shouldSkipSwapReview:u,logSwapHomeState:h,goToInsufficientBalance:r,goToSwapTermsOfService:t,goToSwapReview:e,onSwap:T,executeInterceptors:P}),[l,b,x,y,u,h,r,t,e,T,P])}};s();a();var km=N(M());s();a();s();a();var yA=({sellFungible:t,totalFees:e,transactionSpeedsToUnitCost:r,currentQuote:o,isBridge:n,minRequiredBalance:i,customPriorityFee:c})=>{let p=t?Da({sellFungible:t,totalFees:e.amount,transactionSpeedsToUnitCost:I.isEVMNetworkID(t.data.chain.id)?r:void 0,isBridge:n,minRequiredBalance:i,customPriorityFee:c}):"0",u=t?.data.decimals;return o?.sellAmount?new K(se(o.sellAmount,u??0)).isLessThanOrEqualTo(new K(p)):!0};var SA=({sellFungible:t,isFetchingQuote:e,quoteResponse:r,currentQuote:o,gasEstimation:n,maxGasEstimation:i,hasNoRoutes:c,totalFees:p,transactionSpeedsToUnitCost:u,isBridge:l,minRequiredBalance:g,shouldSkipSwapReview:f,numTransactions:y,customPriorityFee:h})=>{let S=yA({sellFungible:t,totalFees:p,transactionSpeedsToUnitCost:u,currentQuote:o,isBridge:l,minRequiredBalance:g,customPriorityFee:h});switch(MD({quoteResponse:r,sellFungible:t,currentQuote:o,hasNoRoutes:c,hasEnoughAssets:S,isFetchingQuote:e,gasEstimation:n,maxGasEstimation:i,shouldSkipSwapReview:f,numTransactions:y})){case"notSwappable":return{title:L.t("swapReviewFlowActionButtonPrimary"),type:"secondary",disabled:!0};case"swappable":return{title:L.t("swapReviewFlowActionButtonPrimary"),type:"primary",disabled:!1};case"reviewable":return{title:L.t("swapFlowActionButtonText"),type:"primary",disabled:!1};case"notReviewable":return{title:L.t("swapFlowActionButtonText"),type:"secondary",disabled:!0};case"insufficientBalance":return{title:L.t("swapReviewInsufficientBalance"),type:"alert",disabled:!0};case"noRoutes":return{title:L.t("swapNoQuotesFound"),type:"secondary",disabled:!0}}},UD=({sellFungible:t})=>{let e=t?.data.chain.id??Z.Solana.Mainnet;return I.isEVMNetworkID(e)};function MD({quoteResponse:t,sellFungible:e,currentQuote:r,hasNoRoutes:o,hasEnoughAssets:n,isFetchingQuote:i,gasEstimation:c,maxGasEstimation:p,shouldSkipSwapReview:u,numTransactions:l}){if(!n)return"insufficientBalance";if(o)return"noRoutes";let g=UD({sellFungible:e}),f=!!(c&&(c??[]).length>=l&&(p??[]).length>=l);return!t||!e||!r||g&&!f||i?u?"notSwappable":"notReviewable":u?"swappable":"reviewable"}function QD({goToInsufficientBalance:t,goToSwapReview:e,goToSwapTermsOfService:r,goToConfirmation:o,showOverlay:n,showFungibleDetails:i,showBuyFungibleScreen:c,navigateToSwapper:p}){let{currentQuote:u,isFetchingQuote:l,quoteResponse:g}=ee(),{data:[f]}=fe(["enable-swapper-skip-review"]),y=A(V=>V.hasNoRoutes),h=A(V=>V.sellFungible),S=h?.data.chain.id,{estimate:w,estimateWithBuffer:b}=A(V=>V.gasEstimation),T=A(V=>V.buyFungible)?.data.chain.id,F=Ce(S,T),{totalFees:P}=Et(),{data:B}=Yi({networkID:S}),R=vn(),q=Tn(),{data:G}=ue(),X=(0,km.useMemo)(()=>G?.addresses??[],[G]),v=(0,km.useMemo)(()=>X.find(V=>V.networkID===h?.data.chain.id)?.address??"",[X,h]),{data:E}=Vt({callerAddress:v,quote:u,sellFungible:h}),{data:C}=_r(),{title:U,type:_,disabled:k}=SA({sellFungible:h,currentQuote:u,quoteResponse:g,isFetchingQuote:l,isBridge:F,gasEstimation:w,maxGasEstimation:b,hasNoRoutes:y,totalFees:P,transactionSpeedsToUnitCost:B,minRequiredBalance:{source:R,destination:q},shouldSkipSwapReview:f,numTransactions:E?.transactions?.length??0,customPriorityFee:new K(C??0).multipliedBy(10**9)}),{onClick:O}=Pm({goToInsufficientBalance:t,goToSwapReview:e,goToSwapTermsOfService:r,goToConfirmation:o,showOverlay:n,showFungibleDetails:i,showBuyFungibleScreen:c,navigateToSwapper:p});return{disabled:k,title:U,type:_,onClick:O}}s();a();s();a();var Ni=N(M());s();a();var Nn=N(M());var _D=K(1);function wA(t,e,r){let o=te(),[n,i]=(0,Nn.useState)(!1),c=(0,Nn.useCallback)(async()=>{await o.capture("swapperToggleBestPriceRatio",{data:{unitCurrency:n?"buy token":"sell token"}}),i(!n)},[o,n]),p=A(l=>l.sellFungible),u=A(l=>l.buyFungible);return(0,Nn.useMemo)(()=>{let l=!1,g="";if(e&&r){let f=u?.data,y=p?.data;if(f&&y){let{buyAmount:h,sellAmount:S}=r,w=se(h,f.decimals),b=se(S,y.decimals),x=w.dividedBy(b),T=`1 ${y.symbol} \u2248 ${Cc(x)} ${f.symbol}`,F=`1 ${f.symbol} \u2248 ${Cc(_D.dividedBy(x))} ${y.symbol}`;l=new K(r.buyAmount).isEqualTo(t),g=n?F:T}}return{isBestRate:l,rate:g,flip:c}},[t,r,n,e,p,u,c])}s();a();var hA=({buyNetwork:t,sellNetwork:e,executionDuration:r,priceImpact:o,slippage:n})=>{let i=[];return i.push("provider"),i.push("exchangeRate"),t&&e&&t!==e&&i.push("network"),n&&i.push("slippage"),i.push("fees"),r>0&&i.push("executionDuration"),o&&i.push("priceImpact"),i};function OD({isSwapReview:t,showProviders:e,showSwapSettings:r,showSwapPricing:o}){let{bestBuyAmount:n,currentQuote:i,hasNoRoutes:c,quoteResponse:p,quotes:u,isFetchingQuote:l}=ee(),g=wA(n,p,i),f=Uc($r(i)),{slippageSetting:y,slippageTolerance:h}=Ri(),S=(0,Ni.useMemo)(()=>Qc(h,y.type),[h,y.type]),w=Xa(Ue(i)),b=wc(i),x=Eo(b),[T]=(0,Ni.useState)(x),F=p?.sellToken?.chainId?I.getChainName(p.sellToken.chainId):void 0,P=p?.buyToken?.chainId?I.getChainName(p.buyToken.chainId):void 0,B=Et(),R=lm(B),q=A(O=>O.sellFungible),G=A(O=>O.buyFungible),X=(0,Ni.useMemo)(()=>_c([q,G]),[q,G]),{data:[v,E]}=fe(["enable-swapper-skip-review","enable-quote-streaming"]),C=!!B.phantomFee.pct&&(t||v),_={exchangeRate:g,priceImpact:f,slippage:S,provider:w,fees:B,executionDuration:b,uiEstimatedTime:T,isFetchingQuote:l,sellNetwork:F,buyNetwork:P,feeBreakdown:R,selectProviderEnabled:!t&&!!w,isSwapReview:t,showProviders:e,showSwapSettings:r,showSwapPricing:o,transferFees:X},k=t?hA({exchangeRate:g,priceImpact:f,slippage:S,buyNetwork:P,sellNetwork:F,executionDuration:b}):Mc({priceImpact:f,slippage:S,transferFees:X,shouldShowFees:v,shouldShowPriceImpact:!!f&&v,shouldShowSlippage:!!S&&v,isQuoteStreaming:E});return{exchangeRate:g,hasNoRoutes:c,priceImpact:f,slippage:S,provider:w,fees:B,nrOfQuotes:u.length,executionDuration:b,isFetchingQuote:l,sellNetwork:F,buyNetwork:P,rows:k,sharedRowProps:_,displayPhantomFeeRow:C}}s();a();s();a();var Bn=nt(new Li);function Rm(){return Rm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},Rm.apply(this,arguments)}m.NODE_ENV!=="production"&&(Bn.debugPrivate=!0);var qD=(t,e,r)=>t?.suspense&&VD(e,r),VD=(t,e)=>t.isPending&&!e,GD=({result:t,throwOnError:e,query:r})=>t.isError&&!t.isFetching&&KD(e,[t.error,r]);function KD(t,e){return typeof t=="function"?t(...e):!!t}var HD=t=>t.suspense&&typeof t.staleTime!="number"?Rm({},t,{staleTime:1e3}):t;function bA(t,e,r=o=>o(Bn)){let o=nt(0),n=nt(r);m.NODE_ENV!=="production"&&(n.debugPrivate=!0);let i=nt(()=>new WeakMap);m.NODE_ENV!=="production"&&(i.debugPrivate=!0);let c=nt(l=>{let g=l(n),f=t(l),y=g.defaultQueryOptions(f),h=l(i).get(g);return y._optimisticResults="optimistic",h&&h.setOptions(y,{listeners:!1}),HD(y)});m.NODE_ENV!=="production"&&(c.debugPrivate=!0);let p=nt(l=>{let g=l(n),f=l(c),y=l(i),h=y.get(g);if(h)return h;let S=new e(g,f);return y.set(g,S),S});m.NODE_ENV!=="production"&&(p.debugPrivate=!0);let u=nt(l=>{let g=l(p),f=l(c),y=g.getOptimisticResult(f),h=nt(y);return m.NODE_ENV!=="production"&&(h.debugPrivate=!0),h.onMount=S=>{let w=g.subscribe(Uo.batchCalls(S));return()=>{g.getCurrentResult().isError&&g.getCurrentQuery().reset(),w()}},h});return m.NODE_ENV!=="production"&&(u.debugPrivate=!0),nt(l=>{l(o);let g=l(p),f=l(c),y=l(l(u));if(qD(f,y,!1))return g.fetchOptimistic(f);if(GD({result:y,query:g.getCurrentQuery(),throwOnError:f.throwOnError}))throw y.error;return y},(l,g)=>{g(o,f=>f+1)})}function KDe(t,e=r=>r(Bn)){return bA(t,Qm,e)}function HDe(t,e=r=>r(Bn)){return bA(t,_m,e)}s();a();var YDe=Symbol((import.meta.env?import.meta.env.MODE:void 0)!=="production"?"RESET":"");var Dm=(t,e,r)=>(e.has(r)?e:e.set(r,t())).get(r),$D=new WeakMap,zD=(t,e,r,o)=>{let n=Dm(()=>new WeakMap,$D,e),i=Dm(()=>new WeakMap,n,r);return Dm(t,i,o)};function XDe(t,e,r=Object.is){return zD(()=>{let o=Symbol(),n=([c,p])=>{if(p===o)return e(c);let u=e(c,p);return r(p,u)?p:u},i=nt(c=>{let p=c(i),u=c(t);return n([u,p])});return i.init=o,i},t,e,r)}var WD=t=>typeof t?.then=="function";function jD(t=()=>{try{return self.localStorage}catch(r){(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&typeof self<"u"&&console.warn(r);return}},e){var r;let o,n,i={getItem:(u,l)=>{var g,f;let y=S=>{if(S=S||"",o!==S){try{n=JSON.parse(S,e?.reviver)}catch{return l}o=S}return n},h=(f=(g=t())==null?void 0:g.getItem(u))!=null?f:null;return WD(h)?h.then(y):y(h)},setItem:(u,l)=>{var g;return(g=t())==null?void 0:g.setItem(u,JSON.stringify(l,e?.replacer))},removeItem:u=>{var l;return(l=t())==null?void 0:l.removeItem(u)}},c=u=>(l,g,f)=>u(l,y=>{let h;try{h=JSON.parse(y||"")}catch{h=f}g(h)}),p;try{p=(r=t())==null?void 0:r.subscribe}catch{}return!p&&typeof self<"u"&&typeof self.addEventListener=="function"&&self.Storage&&(p=(u,l)=>{if(!(t()instanceof self.Storage))return()=>{};let g=f=>{f.storageArea===t()&&f.key===u&&l(f.newValue)};return self.addEventListener("storage",g),()=>{self.removeEventListener("storage",g)}}),p&&(i.subscribe=c(p)),i}var JDe=jD();s();a();var TA=N(M(),1);var AA=new WeakMap;function vA(t,e){let r=ss(e),o=YD(r);for(let[n,i]of t)(!o.has(n)||e?.dangerouslyForceHydrate)&&(o.add(n),r.set(n,i))}var YD=t=>{let e=AA.get(t);return e||(e=new WeakSet,AA.set(t,e)),e};var Oc=N(M());s();a();var Wt=()=>!0,EA={tokens:Wt,prices:Ud,collectibles:Gd,currency:cd,staking:Kd,swapper:um,transferFungibleLoggingContext:Wt,user:rd,[pd]:Wt,[Dr]:Wt,[Wc]:Wt,[Hd]:Wt,[zn]:Wt,[Qt]:Wt,"infinite-tokens":Wt,"token-transfers":Wt,"test-debug-query":Bi},xA=t=>{if(t.queryKey.length===0||t.state.status!=="success")return!1;let e=String(t.queryKey[0]);return EA[e]?EA[e](t):!1};var IA=new Li({defaultOptions:{mutations:{retry:!1,networkMode:"offlineFirst"},queries:{retry:!1,staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,networkMode:"offlineFirst"}}}),XD=Um({underlyingStorage:new kd,throttleMs:1e3,enableDebugLogs:Bi()}),JD=({children:t})=>(vA([[Bn,IA]]),t),PNe=t=>Oc.default.createElement(Om,{client:IA,persistOptions:{persister:XD,dehydrateOptions:{shouldDehydrateQuery:xA},buster:ZD,maxAge:1/0}},Oc.default.createElement(Cf,null,Oc.default.createElement(JD,null,t.children))),ZD="25.2.0";s();a();var eN=(D=>(D.HasOnboarded="hasOnboarded",D.ResetHasOnboarded="resetHasOnboarded",D.LockExtension="lockExtension",D.UnlockExtension="unlockExtension",D.IsExtensionUnlocked="IsExtensionUnlocked",D.SetPassword="setPassword",D.VerifyPassword="verifyPassword",D.UpdatePassword="updatePassword",D.ImportPrivateKeyAccount="importPrivateKeyAccount",D.ImportReadOnlyAccount="importReadOnlyAccount",D.ImportSeedAccount="importSeedAccount",D.ImportSeedlessAccount="importSocialSeedAccount",D.IsExistingSeed="isExistingSeed",D.AddAccountForSeed="addAccountForSeed",D.AddAccountForSeedless="addAccountForSeedless",D.AddLedgerAccounts="addLedgerAccounts",D.DeriveAddresses="deriveAddresses",D.ExportPrivateKey="exportPrivateKey",D.ExportEntropy="exportEntropy",D.SetAccountIcon="setAccountIcon",D.RemoveAccount="removeAccount",D.ReorderAccount="reorderAccount",D.GetAllAccounts="getAllAccounts",D.GetAllSeeds="getAllSeeds",D.GetAllSeedless="getAllSeedlessSeeds",D.GetAuthenticationPublicKey="getAuthenticationPublicKey",D.Sign="sign",D.SyncAccounts="syncAccounts",D.CheckVaultIntegrity="checkVaultIntegrity",D.LogMessage="logMessage",D.DownloadLogs="downloadLogs",D.ProviderInjectionOptions="providerInjectionOptions",D.ServiceWorkerMutexAcquire="serviceWorkerMutexAcquire",D.ServiceWorkerMutexRelease="serviceWorkerMutexRelease",D))(eN||{});export{mb as a,gde as b,hme as c,BA as d,ZA as e,HA as f,Mt as g,$A as h,rs as i,mp as j,tT as k,rT as l,dp as m,Kn as n,nt as o,mT as p,kf as q,dT as r,Bn as s,KDe as t,HDe as u,XDe as v,$e as w,Hp as x,ST as y,wT as z,zo as A,Op as B,hT as C,tg as D,IT as E,pg as F,HF as G,WF as H,fu as I,HE as J,Bx as K,Jn as L,pu as M,uu as N,lu as O,RF as P,DF as Q,qu as R,VF as S,ZF as T,nC as U,aC as V,AC as W,TC as X,gC as Y,mr as Z,$u as _,vC as $,LS as aa,pi as ba,EC as ca,wC as da,hC as ea,A as fa,Nl as ga,ee as ha,fo as ia,il as ja,To as ka,wt as la,PC as ma,kC as na,fi as oa,sP as pa,hi as qa,gP as ra,yP as sa,mk as ta,Tk as ua,Fk as va,wP as wa,Bk as xa,vP as ya,lm as za,gr as Aa,kl as Ba,Uk as Ca,Ok as Da,qk as Ea,FP as Fa,Vk as Ga,CP as Ha,mR as Ia,dR as Ja,fR as Ka,gR as La,yR as Ma,Gk as Na,dm as Oa,fm as Pa,Kk as Qa,Hk as Ra,KR as Sa,st as Ta,rD as Ua,Tm as Va,QD as Wa,oD as Xa,nD as Ya,TD as Za,sD as _a,aD as $a,uD as ab,lD as bb,Jb as cb,eA as db,hD as eb,OD as fb,CD as gb,PD as hb,xA as ib,IA as jb,PNe as kb,eN as lb};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=chunk-ZZPI23JA.js.map
