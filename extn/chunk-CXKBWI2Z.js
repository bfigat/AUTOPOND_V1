import{$ as wt,A as Vn,Da as At,Ea as Ie,K as Ln,Ta as kt,U as He,_ as Qn,a as ze,c as Dn,eb as Gn,f as Mn,j as Pe,k as K,l as G,ma as ye,na as Fe,o as Nn,oa as ae,p as _n,qa as Wn,za as Kn}from"./chunk-4MBFYWFI.js";import{d as qn,e as $n,f as jn}from"./chunk-2UCAAWZM.js";import{Hb as Cn,J as Tn,K as bn,L as qe,M as wn,N as An,O as $e,Sb as Ce,Ta as kn,Ub as Pn,Vb as bt,Wa as vn,Xb as Fn,Yb as In,_b as Bn,lc as je,qc as On,sc as Un,tc as Rn,ub as Sn,yb as En,zb as xn}from"./chunk-XA7AAXB6.js";import{Y as hn,a as fn,c as gn,j as yn}from"./chunk-C5GK3F6I.js";import{Cc as W,Hb as Ke,Mf as ge,O as rn,P as L,T as q,Te as Ge,W as Y,Zc as se,Ze as ee,cc as F,g as vo,kb as an,mc as ie,nb as N,oc as un,rb as cn,sb as We,sc as ln,tb as z,tc as dn,u as So,uc as pn,vc as mn,wb as fe,wd as Eo,xc as $,zc as X}from"./chunk-S3GUIRR4.js";import{u as nn}from"./chunk-JAJRGPOT.js";import{b as O,da as sn,k as on,l as xe,y as P}from"./chunk-AG2PIQR6.js";import{R as Z,c as M,f as oe,l as u}from"./chunk-DAZNTGG2.js";import{f as U,h as s,i as f,m as Buffer,n as a}from"./chunk-YJSZZTEX.js";s();a();var xo=0;function b(e,t){let n=`atom${++xo}`,r={toString(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof e=="function"?r.read=e:(r.init=e,r.read=Co,r.write=Po),t&&(r.write=t),r}function Co(e){return e(this)}function Po(e,t,n){return t(this,typeof n=="function"?n(e(this)):n)}var zn=(e,t)=>e.unstable_is?e.unstable_is(t):t===e,St=e=>"init"in e,vt=e=>!!e.write,Ye=new WeakMap,Et=e=>{var t;return xt(e)&&!((t=Ye.get(e))!=null&&t[1])},Fo=(e,t)=>{let n=Ye.get(e);if(n)n[1]=!0,n[0].forEach(r=>r(t));else if((import.meta.env?import.meta.env.MODE:void 0)!=="production")throw new Error("[Bug] cancelable promise not found")},Io=e=>{if(Ye.has(e))return;let t=[new Set,!1];Ye.set(e,t);let n=()=>{t[1]=!0};e.then(n,n),e.onCancel=r=>{t[0].add(r)}},xt=e=>typeof e?.then=="function",Hn=e=>"v"in e||"e"in e,Je=e=>{if("e"in e)throw e.e;if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},Jn=(e,t,n)=>{n.p.has(e)||(n.p.add(e),t.then(()=>{n.p.delete(e)},()=>{n.p.delete(e)}))},Bo=(e,t,n,r)=>{var o;if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&n===e)throw new Error("[Bug] atom cannot depend on itself");t.d.set(n,r.n),Et(t.v)&&Jn(e,t.v,r),(o=r.m)==null||o.t.add(e)},Oo=Symbol.for("JOTAI.EXPERIMENTAL.FLUSHSTOREHOOK"),Yn=(...e)=>{let[t,n,r,o,i,d]=e,c=w=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!w)throw new Error("Atom is undefined or null");let h=t(w);return h||(h={d:new Map,p:new Set,n:0},n(w,h),i?.(w,Qe)),h},p=new WeakMap,l=new Map,m=new Set,g=new Set,y=()=>{var w;let h=[],A=k=>{try{k()}catch(E){h.push(E)}};do{(w=Qe[Oo])==null||w.call(Qe);let k=new Set,E=k.add.bind(k);l.forEach(v=>{var C;return(C=v.m)==null?void 0:C.l.forEach(E)}),l.clear(),m.forEach(E),m.clear(),g.forEach(E),g.clear(),k.forEach(A),l.size&&ne()}while(l.size||m.size||g.size);if(h.length)throw h[0]},T=(w,h,A)=>{let k="v"in h,E=h.v,v=Et(h.v)?h.v:null;if(xt(A)){Io(A);for(let C of h.d.keys())Jn(w,A,c(C));h.v=A}else h.v=A;delete h.e,(!k||!Object.is(E,h.v))&&(++h.n,v&&Fo(v,A))},S=w=>{var h;let A=c(w);if(Hn(A)&&(A.m&&p.get(w)!==A.n||Array.from(A.d).every(([I,re])=>S(I).n===re)))return A;A.d.clear();let k=!0,E=()=>{A.m&&(Se(w,A),ne(),y())},v=I=>{if(zn(w,I)){let Tt=c(I);if(!Hn(Tt))if(St(I))T(I,Tt,I.init);else throw new Error("no atom init");return Je(Tt)}let re=S(I);try{return Je(re)}finally{Bo(w,A,I,re),k||E()}},C,B,Q={get signal(){return C||(C=new AbortController),C.signal},get setSelf(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!vt(w)&&console.warn("setSelf function cannot be used with read-only atom"),!B&&vt(w)&&(B=(...I)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&k&&console.warn("setSelf function cannot be called in sync"),!k)return yt(w,...I)}),B}};try{let I=r(w,v,Q);return T(w,A,I),xt(I)&&((h=I.onCancel)==null||h.call(I,()=>C?.abort()),I.then(E,E)),A}catch(I){return delete A.v,A.e=I,++A.n,A}finally{k=!1}},x=w=>Je(S(w)),D=w=>{var h;let A=new Map;for(let k of((h=w.m)==null?void 0:h.t)||[]){let E=c(k);E.m&&A.set(k,E)}for(let k of w.p)A.set(k,c(k));return A},J=w=>{let h=[w];for(;h.length;){let A=h.pop();for(let[k,E]of D(A))p.has(k)||(p.set(k,E.n),h.push(E))}},ne=()=>{var w;let h=[],A=new WeakSet,k=new WeakSet,E=Array.from(l);for(;E.length;){let[v,C]=E[E.length-1];if(k.has(v)){E.pop();continue}if(A.has(v)){p.get(v)===C.n?h.push([v,C,C.n]):(p.delete(v),l.set(v,C)),k.add(v),E.pop();continue}A.add(v);for(let[B,Q]of D(C))A.has(B)||E.push([B,Q])}for(let v=h.length-1;v>=0;--v){let[C,B,Q]=h[v],I=!1;for(let re of B.d.keys())if(re!==C&&l.has(re)){I=!0;break}I&&(S(C),Se(C,B),Q!==B.n&&(l.set(C,B),(w=B.u)==null||w.call(B))),p.delete(C)}},me=(w,...h)=>{let A=!0,k=v=>Je(S(v)),E=(v,...C)=>{var B;let Q=c(v);try{if(zn(w,v)){if(!St(v))throw new Error("atom not writable");let I=Q.n,re=C[0];T(v,Q,re),Se(v,Q),I!==Q.n&&(l.set(v,Q),(B=Q.u)==null||B.call(Q),J(Q));return}else return me(v,...C)}finally{A||(ne(),y())}};try{return o(w,k,E,...h)}finally{A=!1}},yt=(w,...h)=>{try{return me(w,...h)}finally{ne(),y()}},Se=(w,h)=>{var A;if(h.m&&!Et(h.v)){for(let[k,E]of h.d)if(!h.m.d.has(k)){let v=c(k);Ee(k,v).t.add(w),h.m.d.add(k),E!==v.n&&(l.set(k,v),(A=v.u)==null||A.call(v),J(v))}for(let k of h.m.d||[])if(!h.d.has(k)){h.m.d.delete(k);let E=ht(k,c(k));E?.t.delete(w)}}},Ee=(w,h)=>{var A;if(!h.m){S(w);for(let k of h.d.keys())Ee(k,c(k)).t.add(w);if(h.m={l:new Set,d:new Set(h.d.keys()),t:new Set},(A=h.h)==null||A.call(h),vt(w)){let k=h.m,E=()=>{let v=!0,C=(...B)=>{try{return me(w,...B)}finally{v||(ne(),y())}};try{let B=d(w,C);B&&(k.u=()=>{v=!0;try{B()}finally{v=!1}})}finally{v=!1}};g.add(E)}}return h.m},ht=(w,h)=>{var A;if(h.m&&!h.m.l.size&&!Array.from(h.m.t).some(k=>{var E;return(E=c(k).m)==null?void 0:E.d.has(w)})){let k=h.m.u;k&&m.add(k),delete h.m,(A=h.h)==null||A.call(h);for(let E of h.d.keys()){let v=ht(E,c(E));v?.t.delete(w)}return}return h.m},Qe={get:x,set:yt,sub:(w,h)=>{let A=c(w),E=Ee(w,A).l;return E.add(h),y(),()=>{E.delete(h),ht(w,A),y()}},unstable_derive:w=>Yn(...w(...e))};return Qe},Uo=e=>{let t=new Set,n,r=0,o=e.unstable_derive((...c)=>{let[p,l,,m]=c;return n=p,c[1]=function(y,T){l(y,T);let S=T.h;T.h=()=>{S?.(),T.m?t.add(y):t.delete(y)}},c[3]=function(y,T,S,...x){return r?S(y,...x):m(y,T,S,...x)},c}),i=o.set;return Object.assign(o,{dev4_get_internal_weak_map:()=>({get:c=>{let p=n(c);if(!(!p||p.n===0))return p}}),dev4_get_mounted_atoms:()=>t,dev4_restore_atoms:c=>{i({read:()=>null,write:(l,m)=>{++r;try{for(let[g,y]of c)St(g)&&m(g,y)}finally{--r}}})}})},Ct=()=>{let e=new WeakMap,t=Yn(n=>e.get(n),(n,r)=>e.set(n,r).get(n),(n,...r)=>n.read(...r),(n,...r)=>n.write(...r),(n,...r)=>{var o;return(o=n.unstable_onInit)==null?void 0:o.call(n,...r)},(n,...r)=>{var o;return(o=n.onMount)==null?void 0:o.call(n,...r)});return(import.meta.env?import.meta.env.MODE:void 0)!=="production"?Uo(t):t},Be,Zn=()=>(Be||(Be=Ct(),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=Be),globalThis.__JOTAI_DEFAULT_STORE__!==Be&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),Be);s();a();var R=U(M(),1);var er=(0,R.createContext)(void 0),tr=e=>{let t=(0,R.useContext)(er);return e?.store||t||Zn()},$s=({children:e,store:t})=>{let n=(0,R.useRef)(void 0);return!t&&!n.current&&(n.current=Ct()),(0,R.createElement)(er.Provider,{value:t||n.current},e)},Ft=e=>typeof e?.then=="function",nr=e=>{e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t})},Ro=R.default.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(nr(e),e)}),Pt=new WeakMap,Xn=e=>{let t=Pt.get(e);return t||(t=new Promise((n,r)=>{let o=e,i=p=>l=>{o===p&&n(l)},d=p=>l=>{o===p&&r(l)},c=p=>{"onCancel"in p&&typeof p.onCancel=="function"&&p.onCancel(l=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&l===p)throw new Error("[Bug] p is not updated even after cancelation");Ft(l)?(Pt.set(l,t),o=l,l.then(i(l),d(l)),c(l)):n(l)})};e.then(i(e),d(e)),c(e)}),Pt.set(e,t)),t};function V(e,t){let n=tr(t),[[r,o,i],d]=(0,R.useReducer)(l=>{let m=n.get(e);return Object.is(l[0],m)&&l[1]===n&&l[2]===e?l:[m,n,e]},void 0,()=>[n.get(e),n,e]),c=r;(o!==n||i!==e)&&(d(),c=n.get(e));let p=t?.delay;if((0,R.useEffect)(()=>{let l=n.sub(e,()=>{if(typeof p=="number"){let m=n.get(e);Ft(m)&&nr(Xn(m)),setTimeout(d,p);return}d()});return d(),l},[n,e,p]),(0,R.useDebugValue)(c),Ft(c)){let l=Xn(c);return Ro(l)}return c}function Oe(e,t){let n=tr(t);return(0,R.useCallback)((...o)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return n.set(e,...o)},[n,e])}function js(e,t){return[V(e,t),Oe(e,t)]}s();a();var Mo=u.object({data:u.string(),from:u.string(),to:u.string()}),No=u.object({transaction:Mo});async function _o({caip19:e,amount:t,owner:n}){let r=await q.api().post("/tokens/v1/unwrap",{owner:n,caip19:e,amount:t.toNumber()}),o=No.safeParse(r.data);if(!o.success){let{error:i}=o;throw F.captureError(i,"fungibles"),new Pe(`Failed to get unwrap transaction: ${i.message}`)}return o.data.transaction}var Vo=({caip19:e,amount:t,owner:n})=>W({gcTime:ze.Medium,staleTime:1/0,enabled:n!==""&&t.isGreaterThan(0),queryKey:K.unwrapTransaction({caip19:e,amount:t,owner:n}),async queryFn(){return await _o({caip19:e,amount:t,owner:n})}});s();a();function Lo(){let e=un(),t=Ge(),n=$();return X({async mutationFn({accountId:r,mutations:o}){await _n(e,t,{accountId:r,mutations:o})},async onSuccess(r,o){await Promise.all([n.invalidateQueries({queryKey:K.hiddenMints(o.accountId)}),n.invalidateQueries({queryKey:G.visibilityOverrides({accountId:o.accountId})})])}})}s();a();var Rt=U(Eo());s();a();s();a();var _=[];for(let e=0;e<256;++e)_.push((e+256).toString(16).slice(1));function rr(e,t=0){return(_[e[t+0]]+_[e[t+1]]+_[e[t+2]]+_[e[t+3]]+"-"+_[e[t+4]]+_[e[t+5]]+"-"+_[e[t+6]]+_[e[t+7]]+"-"+_[e[t+8]]+_[e[t+9]]+"-"+_[e[t+10]]+_[e[t+11]]+_[e[t+12]]+_[e[t+13]]+_[e[t+14]]+_[e[t+15]]).toLowerCase()}s();a();var It,Qo=new Uint8Array(16);function Bt(){if(!It){if(typeof self.crypto>"u"||!self.crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");It=self.crypto.getRandomValues.bind(self.crypto)}return It(Qo)}s();a();s();a();var Wo=typeof self.crypto<"u"&&self.crypto.randomUUID&&self.crypto.randomUUID.bind(self.crypto),Ot={randomUUID:Wo};function Ko(e,t,n){if(Ot.randomUUID&&!t&&!e)return Ot.randomUUID();e=e||{};let r=e.random??e.rng?.()??Bt();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){if(n=n||0,n<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let o=0;o<16;++o)t[n+o]=r[o];return t}return rr(r)}var Ut=Ko;s();a();var Ze={recipient:"",recipientHandle:"",addressBookRecipient:void 0,amountAsset:new O(0),amountUsd:0,transactionSpeed:"standard",solana:{references:[]},multichainTransaction:void 0},or=class extends Error{constructor(t){super(t),this.name="SendFungibleFlowError"}};var ir={sendSessionId:"",encodedCaip19:void 0,fungibleKey:void 0,splTokenAccount:void 0,analyticsRecipient:void 0,sendFormValues:Ze,shouldShowFiatValues:!1,retryArgs:void 0,confirmedFungibleAndSender:null,gasEstimation:void 0},Dt=ge((e,t)=>({...(0,Rt.default)(ir),resetSendSlice:()=>{let n=(0,Rt.default)(ir);n.sendSessionId=Ut(),e(n)},setAnalyticsRecipient:n=>{e({analyticsRecipient:n})},setSendFungibleKey:(n,r,o)=>{e({fungibleKey:n,splTokenAccount:r,encodedCaip19:o})},setSendFormValues:n=>{e({sendFormValues:n})},setInputAmount:n=>{let r=t();e({sendFormValues:{...r.sendFormValues,inputAmount:n}})},setShouldShowFiatValues:n=>{e({shouldShowFiatValues:n})},setRetryArgs:n=>{e({retryArgs:n})},setGasEstimation:n=>{e({gasEstimation:n})}}));s();a();var sr={collectible:void 0,sendFormValues:Ze,shouldRequireAmount:!1},Go=ge(e=>({...sr,resetSendSlice:()=>{e({...sr})},setSendCollectible:t=>{e({collectible:t})},setSendFormValues:t=>{e({sendFormValues:t})},setShouldRequireAmount:t=>{e({shouldRequireAmount:t})}}));s();a();s();a();var qo={query:""},$o=ge(e=>({...qo,setQuery:t=>{e({query:t})}}));s();a();s();a();s();a();var Xe=U(vo(),1),cr=U(So(),1);var ar=(0,Xe.struct)([(0,Xe.u8)("instruction")]);function ur(e,t,n,r=[],o=Ce){let i=Bn([{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}],n,r),d=Buffer.alloc(ar.span);return ar.encode({instruction:Fn.CloseAccount},d),new cr.TransactionInstruction({keys:i,programId:o,data:d})}var dr=U(M());var jo=()=>{let{connection:e}=He(),{data:t}=ee(),{solanaChainAddress:n,accountIdentifier:r}=(0,dr.useMemo)(()=>({solanaChainAddress:t?.addresses.find(fe),accountIdentifier:t?.identifier??""}),[t]),o=ie(),i=se(),{t:d}=Z();return X({mutationFn:async c=>{if(!n)throw new Error("solanaChainAddress not loaded");if(c.type!=="CompressedSPL")throw new Error("SPL is not compressed");let p=await On({owner:c.data.walletAddress,mint:c.data.mintAddress,amount:c.data.amount,programId:c.data.programId,connection:e}),{networkID:l,address:m}=n,g={ownerAddress:m,networkID:l,data:{signature:""},type:"decompress",display:{summary:{topLeft:{text:d("assetDetailClaiming")}}}};await je({accountIdentifier:r,accountSigner:i,connection:e,feePayer:new L.PublicKey(m),pendingTransactionInput:g,storage:o,transaction:p,useSubmissionService:!1})}})};s();a();var Ve=U(M());s();a();s();a();s();a();var Te=b(new dn);function Mt(){return Mt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mt.apply(this,arguments)}f.NODE_ENV!=="production"&&(Te.debugPrivate=!0);var zo=(e,t,n)=>e?.suspense&&Ho(t,n),Ho=(e,t)=>e.isPending&&!t,Jo=({result:e,throwOnError:t,query:n})=>e.isError&&!e.isFetching&&Yo(t,[e.error,n]);function Yo(e,t){return typeof e=="function"?e(...t):!!e}var Zo=e=>e.suspense&&typeof e.staleTime!="number"?Mt({},e,{staleTime:1e3}):e;function pr(e,t,n=r=>r(Te)){let r=b(0),o=b(n);f.NODE_ENV!=="production"&&(o.debugPrivate=!0);let i=b(()=>new WeakMap);f.NODE_ENV!=="production"&&(i.debugPrivate=!0);let d=b(l=>{let m=l(o),g=e(l),y=m.defaultQueryOptions(g),T=l(i).get(m);return y._optimisticResults="optimistic",T&&T.setOptions(y,{listeners:!1}),Zo(y)});f.NODE_ENV!=="production"&&(d.debugPrivate=!0);let c=b(l=>{let m=l(o),g=l(d),y=l(i),T=y.get(m);if(T)return T;let S=new t(m,g);return y.set(m,S),S});f.NODE_ENV!=="production"&&(c.debugPrivate=!0);let p=b(l=>{let m=l(c),g=l(d),y=m.getOptimisticResult(g),T=b(y);return f.NODE_ENV!=="production"&&(T.debugPrivate=!0),T.onMount=S=>{let x=m.subscribe(ln.batchCalls(S));return()=>{m.getCurrentResult().isError&&m.getCurrentQuery().reset(),x()}},T});return f.NODE_ENV!=="production"&&(p.debugPrivate=!0),b(l=>{l(r);let m=l(c),g=l(d),y=l(l(p));if(zo(g,y,!1))return m.fetchOptimistic(g);if(Jo({result:y,query:m.getCurrentQuery(),throwOnError:g.throwOnError}))throw y.error;return y},(l,m)=>{m(r,g=>g+1)})}function et(e,t=n=>n(Te)){return pr(e,pn,t)}function mr(e,t=n=>n(Te)){return pr(e,mn,t)}s();a();var Nc=Symbol((import.meta.env?import.meta.env.MODE:void 0)!=="production"?"RESET":"");var Nt=(e,t,n)=>(t.has(n)?t:t.set(n,e())).get(n),Xo=new WeakMap,ei=(e,t,n,r)=>{let o=Nt(()=>new WeakMap,Xo,t),i=Nt(()=>new WeakMap,o,n);return Nt(e,i,r)};function j(e,t,n=Object.is){return ei(()=>{let r=Symbol(),o=([d,c])=>{if(c===r)return t(d);let p=t(d,c);return n(c,p)?c:p},i=b(d=>{let c=d(i),p=d(e);return o([p,c])});return i.init=r,i},e,t,n)}var ti=e=>typeof e?.then=="function";function ni(e=()=>{try{return self.localStorage}catch(n){(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&typeof self<"u"&&console.warn(n);return}},t){var n;let r,o,i={getItem:(p,l)=>{var m,g;let y=S=>{if(S=S||"",r!==S){try{o=JSON.parse(S,t?.reviver)}catch{return l}r=S}return o},T=(g=(m=e())==null?void 0:m.getItem(p))!=null?g:null;return ti(T)?T.then(y):y(T)},setItem:(p,l)=>{var m;return(m=e())==null?void 0:m.setItem(p,JSON.stringify(l,t?.replacer))},removeItem:p=>{var l;return(l=e())==null?void 0:l.removeItem(p)}},d=p=>(l,m,g)=>p(l,y=>{let T;try{T=JSON.parse(y||"")}catch{T=g}m(T)}),c;try{c=(n=e())==null?void 0:n.subscribe}catch{}return!c&&typeof self<"u"&&typeof self.addEventListener=="function"&&self.Storage&&(c=(p,l)=>{if(!(e()instanceof self.Storage))return()=>{};let m=g=>{g.storageArea===e()&&g.key===p&&l(g.newValue)};return self.addEventListener("storage",m),()=>{self.removeEventListener("storage",m)}}),c&&(i.subscribe=d(c)),i}var _c=ni();s();a();s();a();s();a();var ri=e=>Wn(e)?.[0],fr=ri;function oi({caip19:e,...t}){let n=We(e);return{...t,type:e.includes("/nativeToken:")?"native":"fungible",chainName:N.getChainName(n.chainId).toLowerCase(),encodedCaip19:e,decodedCaip19:n,legacyKey:fr(n)??e}}var be=oi;var ii=u.object({account:u.string(),quantity:u.number(),quantityString:u.string()}),Ue=u.object({address:u.string(),quantity:u.number(),quantityString:u.string(),lastTransferredDate:u.coerce.date().nullish(),subaccounts:u.array(ii).optional()}),we=u.object({price:u.number(),priceChange24h:u.number().optional(),lastUpdatedAt:u.coerce.date(),marketCap:u.number().optional()}).nullish(),_t=u.object({id:u.string(),name:u.string(),imageUri:u.string().nullish().transform(e=>e??""),numTokens:u.number()}),Re=u.object({compression:u.object({compressed:u.boolean()}).optional(),creators:u.array(u.object({address:u.string(),share:u.number(),verified:u.boolean()})).nullish(),tokenProgram:u.string().nullish(),extensions:on(Dn).nullish()}),tt=u.enum(["TRUSTED","VERIFIED","NOT_VERIFIED","POSSIBLE_SPAM","SPAM"]),nu=u.object({totalValueUsdCentsCurrent:u.number().optional(),totalValueUsdStringCurrent:u.string().optional(),totalValueUsdCents24h:u.number().optional(),totalValueUsdString24h:u.string().optional(),totalPercentChange24h:u.number().optional()}),gr=u.object({name:u.string().nullish(),symbol:u.string().nullish(),decimals:u.number(),logoUri:u.string().nullish(),extraMetadata:Re.optional(),price:we}),nt=gr.extend({type:u.enum(["native","fungible"]),encodedCaip19:u.string(),decodedCaip19:cn,spamStatus:tt,chainName:u.string(),legacyKey:u.string()}),si=gr.extend({caip19:u.string(),spamStatus:tt.nullish().transform(e=>e??"NOT_VERIFIED")}),yr=u.union([si.transform(e=>be(e)),nt]),ru=nt.extend({extraMetadata:Re.extend({id:u.string().nullish().default(null),description:u.string().nullish().default(null),marketCap:u.coerce.number().optional(),circulatingSupply:u.coerce.number().optional(),totalSupply:u.coerce.number().optional(),liquidity:u.coerce.number().optional(),holders:u.coerce.number().optional(),links:u.array(u.object({type:u.string(),url:u.string()})).optional(),volume24hUSD:u.coerce.number().optional(),volume24hUSDChangePercentage:u.coerce.number().optional(),trades24h:u.coerce.number().optional(),trades24hChangePercentage:u.coerce.number().optional(),uniqueWallets24h:u.coerce.number().optional(),uniqueWallets24hChangePercentage:u.coerce.number().optional(),top10HoldersPercent:u.coerce.number().optional(),mintable:u.boolean().optional(),freezable:u.boolean().optional(),mutableMetadata:u.boolean().optional(),ownershipRenounced:u.boolean().optional(),updateAuthority:u.string().optional(),createdDate:u.string().datetime().nullish().default(null)}).optional(),categories:u.array(_t),createdDate:u.coerce.date().nullish().default(null)}),hr=nt.extend({totalQuantity:u.number(),totalQuantityString:u.string(),walletAddress:u.string().optional(),queriedWalletBalances:u.array(Ue),livePrice:we}),Tr=nt.extend({timestamp:u.string().nullish(),totalQuantityString:u.string(),totalQuantity:u.number(),queriedWalletBalances:u.array(Ue)});s();a();s();a();s();a();function H(e){let t=b(0),n=b(()=>({i:0}),(p,l)=>{let m=p(n);return Object.assign(m,{m:!0,peek:p,set:l}),l(t,g=>g+1),()=>{m.m=!1,d(m),c(m)}});n.onMount=p=>p();let r=b(p=>{p(t);let l=p(n);if(!l.m||l.irc||l.i&&!l.irf)return l.p;c(l);let m=new Map,g=x=>{let D=p(x);return m.set(x,D),D};g.peek=l.peek;let y=(...x)=>{try{return++l.i,l.set(...x)}finally{Array.from(m.keys(),p),--l.i}};y.recurse=(x,...D)=>{if(l.fc){if(f.NODE_ENV!=="production")throw new Error("set.recurse is not allowed in cleanup");return}try{return l.irc=!0,l.set(x,...D)}finally{l.irc=!1,Array.from(m).some(T)&&i(l)}};function T([x,D]){return p(x)!==D}++l.i;function S(){try{if(l.irf=!1,!l.m)return;d(l),l.c=o.effect(g,y)}catch(x){l.e=x,i(l)}finally{l.p=void 0,--l.i}}return l.irf?S():l.p=Promise.resolve().then(S)});if(f.NODE_ENV!=="production"){let p=function(l,m){Object.defineProperty(l,"debugLabel",{get:()=>`${o.debugLabel??"effect"}:${m}`}),l.debugPrivate=!0};p(t,"refresh"),p(n,"ref"),p(r,"base")}let o=b(p=>void p(r));return o.effect=e,o;function i(p){try{p.irf=!0,p.set(t,l=>l+1)}finally{p.irf=!1}}function d(p){if(typeof p.c=="function")try{p.fc=!0,p.c()}finally{p.fc=!1,p.c=void 0}}function c(p){if("e"in p){let l=p.e;throw delete p.e,l}}}s();a();var ai=()=>{try{return typeof chrome<"u"&&(chrome.runtime?.id!==void 0||typeof browser<"u")}catch(e){return console.error("Error checking for extension context:",e),!1}},Vt=class{browser;storage;constructor(t){if(!t||!t.storage||!t.storage.local)throw new Error("[ExtensionStorage] Invalid 'browser' object received.");this.browser=t,this.storage=this.browser.storage.local}async get(t){try{let r=(await this.storage.get(t))[t];return r==null||typeof r!="string"?null:JSON.parse(r)}catch(n){return console.error(`[ExtensionStorage.get] Error getting/parsing key (${t}):`,n),null}}async getAll(t){try{let n=await this.storage.get(t),r={};for(let o in n)if(Object.prototype.hasOwnProperty.call(n,o)){let i=n[o];if(i==null||typeof i!="string")r[o]=null;else try{r[o]=JSON.parse(i)}catch(d){console.error(`[ExtensionStorage.getAll] Error parsing key (${o}):`,d),r[o]=null}}return r}catch(n){let r=`[ExtensionStorage.getAll] Error getting keys (${t}): ${n}`;throw console.error(r),new Error(r)}}async remove(t){try{await this.storage.remove(t)}catch(n){let r=`[ExtensionStorage.remove] Error removing key(s) (${t}): ${n}`;throw console.error(r),new Error(r)}}async set(t,n){try{let r=JSON.stringify(n);await this.storage.set({[t]:r})}catch(r){let o=`[ExtensionStorage.set] Error setting/stringifying key (${t}): ${r}`;throw console.error(o),new Error(o)}}async setAll(t){try{let n={};for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=JSON.stringify(t[r]));await this.storage.set(n)}catch(n){let o=`[ExtensionStorage.setAll] Error setting/stringifying keys (${Object.keys(t)}): ${n}`;throw console.error(o),new Error(o)}}async update(t,n){if(!navigator.locks){let r=await this.get(t),o=await n(r);o===null?await this.remove(t):await this.set(t,o);return}try{await navigator.locks.request(`storage.${t}`,async r=>{let o=await this.get(t),i=await n(o);i===null?await this.remove(t):await this.set(t,i)})}catch(r){let o=`[ExtensionStorage.update] Error updating key (${t}): ${r}`;throw console.error(o),new Error(o)}}async clear(){try{await this.storage.clear()}catch(t){let n=`[ExtensionStorage.clear] Error clearing storage: ${t}`;throw console.error(n),new Error(n)}}},rt=class{storage=self.localStorage;async get(t){try{let n=this.storage.getItem(t);return n===null||typeof n!="string"?null:JSON.parse(n)}catch(n){return console.error(`[WebLocalStorage.get] Error getting/parsing key (${t}):`,n),null}}async getAll(t){let n={},r=t??Object.keys(this.storage);for(let o of r)try{let i=this.storage.getItem(o);if(t&&i===null)continue;if(i===null||typeof i!="string")n[o]=null;else try{n[o]=JSON.parse(i)}catch(d){console.error(`[WebLocalStorage.getAll] Error parsing key (${o}):`,d),n[o]=null}}catch(i){console.error(`[WebLocalStorage.getAll] Error reading key (${o}) from storage:`,i),t||(n[o]=null)}return n}async remove(t){try{let n=Array.isArray(t)?t:[t];for(let r of n)this.storage.removeItem(r)}catch(n){let r=`[WebLocalStorage.remove] Error removing key(s) (${t}): ${n}`;throw console.error(r),new Error(r)}}async set(t,n){try{let r=JSON.stringify(n);this.storage.setItem(t,r)}catch(r){let o=`[WebLocalStorage.set] Error setting/stringifying key (${t}): ${r}`;throw console.error(o),new Error(o)}}async setAll(t){let n=!1,r=Object.keys(t);for(let o in t)if(Object.prototype.hasOwnProperty.call(t,o))try{await this.set(o,t[o])}catch{n=!0}if(n)throw new Error(`[WebLocalStorage.setAll] One or more errors occurred while setting keys (${r})`)}async update(t,n){if(!navigator.locks){let r=await this.get(t),o=await n(r);o===null?await this.remove(t):await this.set(t,o);return}try{await navigator.locks.request(`storage.${t}`,async r=>{let o=await this.get(t),i=await n(o);i===null?await this.remove(t):await this.set(t,i)})}catch(r){let o=`[WebLocalStorage.update] Error updating key (${t}): ${r}`;throw console.error(o),new Error(o)}}async clear(){try{this.storage.clear()}catch(t){let n=`[WebLocalStorage.clear] Error clearing storage: ${t}`;throw console.error(n),new Error(n)}}},Lt=class{initPromise;storageImpl=null;constructor(){this.initPromise=this._initialize(),this.initPromise.catch(t=>{console.error("LocalStorage initialization failed:",t)})}async _initialize(){if(!this.storageImpl)if(ai())try{let n=(await import("./browser-polyfill-QMB4KO7Y.js")).default;if(!n||!n.storage||!n.storage.local)throw new Error("webextension-polyfill loaded but missing storage.local API.");this.storageImpl=new Vt(n)}catch{this.storageImpl=new rt}else this.storageImpl=new rt}async ensureInitialized(){if(await this.initPromise,!this.storageImpl)throw new Error("LocalStorage is not initialized. Initialization may have failed.")}async get(t){return await this.ensureInitialized(),this.storageImpl.get(t)}async getAll(t){return await this.ensureInitialized(),this.storageImpl.getAll(t)}async remove(t){return await this.ensureInitialized(),this.storageImpl.remove(t)}async set(t,n){return await this.ensureInitialized(),this.storageImpl.set(t,n)}async setAll(t){return await this.ensureInitialized(),this.storageImpl.setAll(t)}async update(t,n){return await this.ensureInitialized(),this.storageImpl.update(t,n)}async clear(){return await this.ensureInitialized(),this.storageImpl.clear()}},Qt=new Lt;s();a();s();a();var De=class{namespaceKey;ttlMilliseconds;storage;onError;data={};isLoaded=!1;constructor(t){this.namespaceKey=t.namespaceKey,this.ttlMilliseconds=t.ttlMilliseconds,this.storage=t.storage,this.onError=t.onError,this._load().then(()=>{if(this._cleanupExpired())return this._save()}).catch(n=>{console.error("Failed to load data",n)})}async _load(){if(!this.isLoaded){try{let t=await this.storage.get(this.namespaceKey);t?(this.data=t,(typeof this.data!="object"||this.data===null)&&(this.onError?.(new Error("Stored data is not a valid object."),"load"),this.data={})):this.data={}}catch(t){this.onError?.(t instanceof Error?t:new Error("Failed to parse stored data"),"load"),this.data={}}this.isLoaded=!0}}async _save(){try{await this.storage.set(this.namespaceKey,this.data)}catch(t){this.onError?.(t instanceof Error?t:new Error("Failed to serialize data for storage"),"save")}}_cleanupExpired(){let t=Date.now(),n=!1;for(let r in this.data)Object.prototype.hasOwnProperty.call(this.data,r)&&this.data[r].expiresAt<=t&&(delete this.data[r],n=!0);return n}_updateExpiration(t){return this.data[t]?(this.data[t].expiresAt=Date.now()+this.ttlMilliseconds,!0):!1}async set(t,n){this.isLoaded||await this._load(),this._cleanupExpired(),this.data[t]={value:n,expiresAt:Date.now()+this.ttlMilliseconds},await this._save()}async get(t,n){this.isLoaded||await this._load();let r=this._cleanupExpired(),o=this.data[t];if(!o)return r&&await this._save(),null;let i=this._updateExpiration(t),d=n.safeParse(o.value);return d.success?((r||i)&&await this._save(),d.data):(this.onError?.(new oe(d.error.issues),`get (validation failed for key: ${t})`),delete this.data[t],await this._save(),null)}async remove(t){let n=this._cleanupExpired(),r=!1;Object.prototype.hasOwnProperty.call(this.data,t)&&(delete this.data[t],r=!0),(n||r)&&await this._save()}async clear(){this.data={},await this._save()}};var br=new Map;function ci({storage:e,namespaceKey:t,ttlMs:n}){let r=br.get(t);if(r)return r;if(!e)throw new Error("Storage is required");let o=new De({storage:e,namespaceKey:t,ttlMilliseconds:n,onError:(i,d)=>{console.error(`[PersistentStore Error - ${d}]:`,i.message),i instanceof oe&&console.error("Zod Issues:",i.issues)}});return br.set(t,o),o}var Wt=ci;function ui({atomToStoreOffline:e,namespaceKey:t,ttlMs:n,initialValue:r,schema:o,...i}){let d=b({status:"pending",value:r}),c=b(g=>{if("offlineKey"in i)return g(i.offlineKey);let y=g(e);if("offlineKey"in y&&typeof y.offlineKey=="string")return y.offlineKey;throw new Error("No key provided")}),p=H((g,y)=>{Wt({storage:Qt,namespaceKey:`.offline.${t}`,ttlMs:n}).get(g(c),o).then(T=>{T&&y(d,{status:"offline",value:T})}).catch(T=>{console.error(T)})}),l=H((g,y)=>{g(c),y(d,{status:"pending",value:r})}),m=H((g,y)=>{let T=g(e),S=g(c);T.status==="success"&&T.data&&T.data!==g(d).value&&(y(d,{status:"live",value:T.data}),Wt({storage:Qt,namespaceKey:`.offline.${t}`,ttlMs:n}).set(S,T.data).catch(x=>{F.addBreadcrumb("tokens","Error storing offline data","error",{namespaceKey:t,error:x.toString()})}))});return j(b(g=>{let y=g(e);g(l),g(p),g(m);let T=g(d);return y.data?{status:"live",value:y.data}:{status:"offline",value:T.value}}),g=>g.value)}var ot=ui;s();a();s();a();var Kt=u.object({caip19:u.string(),name:u.string().nullish(),symbol:u.string().nullish(),decimals:u.number(),spamStatus:tt.nullish().transform(e=>e??"NOT_VERIFIED"),logoUri:u.string().nullish()}),wr=Kt.extend({totalQuantity:u.number(),totalQuantityString:u.string(),queriedWalletBalances:u.array(Ue),extraMetadata:Re.optional(),price:we}),Ar=wr.transform(be),kr=u.object({items:u.array(wr),cursor:u.string().nullish().default(null),errors:u.array(u.object({code:u.string(),message:u.string(),details:u.object({chainId:u.string(),address:u.string()})})).optional()}).transform(e=>{let{items:t,cursor:n,errors:r,...o}=e;return{...o,nextCursor:n,tokens:t,errors:r||[],updatedAt:Date.now()}}),vr=Kt.extend({timestamp:u.string().nullish(),postQuantityString:u.string(),postQuantity:u.number(),price:we,queriedWalletBalances:u.array(Ue)}),Sr=vr.transform(e=>{let{postQuantity:t,postQuantityString:n,...r}=be(e);return{...r,totalQuantity:t,totalQuantityString:n}}),Er=u.object({cursor:u.string().nullish().default(null),items:u.array(vr)}).transform(e=>({nextCursor:e.cursor,transfers:e.items})),Vu=u.object({totalValueUsdCentsCurrent:u.number(),totalValueUsdStringCurrent:u.string(),totalValueUsdCents24h:u.number(),totalValueUsdString24h:u.string(),totalPercentChange24h:u.number(),errors:u.array(u.object({code:u.string(),message:u.string(),details:u.object({chainId:u.string(),address:u.string()})})).optional()}),Gt=Kt.extend({createdDate:u.coerce.date().nullish().default(null),extraMetadata:Re.extend({id:u.string().nullish().default(null),description:u.string().nullish().default(null),marketCap:u.coerce.number().optional(),circulatingSupply:u.coerce.number().optional(),totalSupply:u.coerce.number().optional(),liquidity:u.coerce.number().optional(),holders:u.coerce.number().optional(),links:u.array(u.object({type:u.string(),url:u.string()})).optional(),volume24hUSD:u.coerce.number().optional(),volume24hUSDChangePercentage:u.coerce.number().optional(),trades24h:u.coerce.number().optional(),trades24hChangePercentage:u.coerce.number().optional(),uniqueWallets24h:u.coerce.number().optional(),uniqueWallets24hChangePercentage:u.coerce.number().optional(),top10HoldersPercent:u.coerce.number().optional(),mintable:u.boolean().optional(),freezable:u.boolean().optional(),mutableMetadata:u.boolean().optional(),ownershipRenounced:u.boolean().optional(),updateAuthority:u.string().optional(),createdDate:u.string().datetime().nullish().default(null)}).optional(),categories:u.array(_t).optional().default([]),price:we}),xr=Gt.transform(be);s();a();var li=e=>N.isBitcoinNetworkID(e.decodedCaip19.chainId)&&e.decodedCaip19.resourceType==="nativeToken"?e.queriedWalletBalances.map(r=>{let o=Ke(e.decodedCaip19.chainId,r.address),i=ye.get(e.decodedCaip19.chainId).nativeTokenFungibleBalanceKey(e.decodedCaip19.chainId,o);if(!i)throw new Error("No legacy key found for bitcoin native token");return{...e,legacyKey:i,queriedWalletBalances:[r],totalQuantity:r.quantity,totalQuantityString:r.quantityString,walletAddress:r.address}}):[e],di=e=>t=>t.map(n=>e.parse(n)),ju=di(yr),pi=e=>t=>t.flatMap(n=>{let r=e.parse(n);return li(r)}),Cr=pi(Ar),mi=e=>t=>t.map(n=>e.parse(n)),Pr=mi(Sr);async function fi(e){let t={walletAddresses:e.walletCaip19s.join(","),includePrices:"true"};"cursor"in e&&(t.cursor=e.cursor),"fromMicroseconds"in e?t.fromTimestamp=e.fromMicroseconds.toString():"from"in e&&(t.fromTimestamp=e.from.toString());let n=await q.api().timeout(P({seconds:30})).get("/portfolio/v1/fungibles/updates",{params:t}).then(r=>{if(Y(r))return r.data;throw new Error(r.data?.message||r.data?.error||r.statusText||`Status: ${r.status}`,{cause:r.data?.code??r.data?.name})}).catch(r=>{throw F.addBreadcrumb("tokens","getTokenBalanceUpdates","error",{message:r.message,cause:r.cause,...t}),F.captureError(r,"tokens"),r});try{return Er.parse(n)}catch(r){throw r instanceof oe&&F.addBreadcrumb("tokens","getTokenBalanceUpdates parse error","error",{message:r.message,...r.issues?{issues:JSON.stringify(r.issues)}:{},result:JSON.stringify(n)}),r}}async function Fr(e){let t=[],n=()=>t.at(-1)?.nextCursor;do{let r=n(),o=await fi(r?{walletCaip19s:e.walletCaip19s,cursor:r}:e);t.push(o)}while(n());return Pr(t.flatMap(r=>r.transfers))}s();a();s();a();function gi(e){let t=Fe(e.decodedCaip19);return t==="SPL"?e.extraMetadata?.compression?.compressed||"queriedWalletBalances"in e&&e.queriedWalletBalances.some(n=>!n.subaccounts?.length)?"CompressedSPL":"SPL":t}var Ir=gi;function qt({newUpdates:e,existingUpdates:t={}}){return e.reduce((n,r)=>n[r.encodedCaip19]?.totalQuantityString===r.totalQuantityString?n:Ir(r)==="CompressedSPL"?{...n,[`${r.encodedCaip19}-compressed`]:r}:r?{...n,[r.encodedCaip19]:r}:n,t)}s();a();function yi(e){let t=e.match(/(.*\d{2}:\d{2}:\d{2})\.(?<fraction>\d+)Z/);if(!t||!t.groups?.fraction)throw new Error("Invalid date format");let n=new Date(e).getTime(),i=t.groups.fraction.padEnd(6,"0").slice(-3);return n*1e3+parseInt(i,10)}var $t=yi;s();a();var hi=b(!1),Br=hi;s();a();s();a();s();a();var Ti=P({minutes:5}),Ne=0;function Pl(){if(!Ne){Ne=Math.floor(Math.random()*1e6);return}Ne++}async function jt({walletCaip19s:e,fungibleCaip19s:t,cursor:n,cacheBust:r}){let o={walletAddresses:e.join(","),includePrices:"true"};n&&(o.cursor=n),(r||Ne)&&(o.cacheBust=r?.toString()||Ne.toString()),t&&t.length>0&&(o.fungibleAddresses=t.sort().join(","));try{let i=await q.api().timeout(P({seconds:30})).get("/portfolio/v1/fungibles/balances",{params:o}).then(c=>{if(Y(c))return c.data;throw new Error(c.data?.message||c.data?.error||c.statusText||`Status: ${c.status}`,{cause:c.data?.code})}),d=kr.parse(i);return d.errors&&d.errors.length>0&&d.errors.forEach(c=>{F.addBreadcrumb("tokens","getTokenBalances_partialError","info",{code:c.code,message:c.message,chainId:c.details.chainId,address:c.details.address})}),{...d,tokens:Cr(d.tokens)}}catch(i){throw i instanceof Error&&(F.addBreadcrumb("tokens","getTokenBalances","error",{...o,message:i.message,...typeof i.cause=="string"||typeof i.cause=="number"?{cause:i.cause}:{}}),F.captureError(i,"tokens")),i}}function Or({walletCaip19s:e,isEnabled:t=!0,cacheBust:n}){return{staleTime:Ti,gcTime:P({days:3}),queryKey:G.infiniteTokenBalances({walletCaip19s:e}),enabled:t&&!!e.length,queryFn:async({pageParam:r})=>jt({walletCaip19s:e,cursor:r,cacheBust:n}),initialPageParam:"",getNextPageParam:r=>r?.nextCursor||void 0}}function Ur(e){let{walletCaip19s:t,encodedCaip19:n,queryOptions:r={enabled:!0}}=e;return{staleTime:P({seconds:10}),gcTime:P({days:3}),queryKey:G.tokenBalance({wallets:t,encodedCaip19:n}),enabled:r.enabled&&!!t.length,queryFn:async()=>(await jt({walletCaip19s:t,fungibleCaip19s:[n]})).tokens}}s();a();s();a();var bi=b(null),st=bi;var wi=b(e=>{let t=e(st);return t?t.addresses.map(n=>z({chainId:n.networkID,address:n.address,resourceType:"address"})).sort():[]}),Ae=wi;var Ai=mr(e=>{let t=e(Ae);return Or({walletCaip19s:t})}),te=Ai;var ki=b(e=>{let{data:t}=e(te),n=t?.pages[0];return!n||!n.tokens.length?0:n.updatedAt}),Rr=ki;s();a();var vi=j(st,e=>e?.identifier),ue=vi;var Si=1e3,Dr=5e3,Mr=Math.ceil(Dr*2.25);function Nr(e){return P(e)*1e3}function Ei(e){if(!e?.length)return null;let t=new Date(Date.now()-Mr).toISOString();return Math.floor(Math.max(...e.map(({timestamp:n})=>$t(n||t))))}function xi(e){let t=Ei(e);return t?t-Nr({seconds:1}):null}var Ci=et(e=>{let t=e(Te),n=e(Rr),r=Math.floor(n-P({minutes:10})),o=e(Ae),i=e(Br),d=r>Date.now()-P({days:10}),c=G.tokenUpdates({walletCaip19s:o,from:r}),p=async()=>{let l=t.getQueryData(c)?.lastTimestamp;if(!l){let T=new Date(r-Mr).toISOString();return{updates:{},lastTimestamp:$t(T)}}let m=await Fr({walletCaip19s:o,fromMicroseconds:l-Nr({seconds:30})}),g=t.getQueryData(c)?.updates??{};return{updates:qt({newUpdates:m,existingUpdates:g}),lastTimestamp:Math.max(xi(m)??0,l)}};return{meta:{fetchCount:0},enabled:d&&!i&&o.length>0,queryKey:c,refetchInterval:l=>{let m=Number(l.meta?.fetchCount??0);return l.meta&&(l.meta.fetchCount=m+1),Math.min(Math.max(m*250,Si),Dr)},queryFn:p}}),Pi=ot({atomToStoreOffline:Ci,offlineKey:b(e=>`${e(ue)??""}:token-balance-updates`),namespaceKey:"fungible-tokens",ttlMs:P({days:10}),initialValue:{updates:{},lastTimestamp:0},schema:u.object({updates:u.record(u.string(),Tr),lastTimestamp:u.number()})}),Fi=j(Pi,e=>e?.updates??{},(e,t)=>JSON.stringify(e)===JSON.stringify(t)),at=Fi;s();a();s();a();function ct(e){return t=>{let n=!1,r={...t};for(let[o,i]of Object.entries(e)){let d=i?.price,c=i?.lastUpdatedAt?new Date(i.lastUpdatedAt):null;if(!d||!c)continue;let p=t[o]?.price!==d&&(!t[o]?.lastUpdatedAt||c>t[o].lastUpdatedAt);n=n||p,p&&(r[o]={price:i.price,priceChange24h:i.priceChange24h,lastUpdatedAt:c})}return n?r:t}}s();a();var Ii=b(e=>{let{data:t,status:n}=e(te);return{data:t?.pages.flatMap(r=>r.tokens),status:n}}),Bi=ot({atomToStoreOffline:Ii,offlineKey:b(e=>`${e(ue)??""}:infinite-tokens`),namespaceKey:"fungible-tokens",ttlMs:P({days:10}),initialValue:[],schema:u.array(hr)}),le=Bi;var ut=b({}),Oi=b(e=>e(le).slice(-100).reduce((r,o)=>(o.price&&(r[o.encodedCaip19]=o.price),r),{})),Ui=H((e,t)=>{let n=e(Oi);!n||Object.keys(n).length===0||t(ut,ct(n))}),Ri=b(e=>{let t=e(at);return Object.values(t).reduce((r,o)=>(o.price&&(r[o.encodedCaip19]=o.price),r),{})}),Di=H((e,t)=>{let n=e(Ri);!n||Object.keys(n).length===0||t(ut,ct(n))}),Mi=b(e=>(e(Ui),e(Di),e(ut)),(e,t,n)=>{t(ut,n)}),de=Mi;s();a();s();a();var Ni=j(te,e=>e.hasNextPage),ke=Ni;var _e=b(1/0),lt=b(e=>(e(_i),e(Vi),e(ke)?e(_e):0),(e,t,n)=>{if(n===null){t(_e,1/0);return}let r=Math.min(e(_e),n);r!==e(_e)&&t(_e,r)}),_r=lt,_i=H((e,t)=>{let{hasNextPage:n}=e(te),r=e(le),o=e(de);if(r.length>0&&!n){t(lt,0);return}let i=r.slice(-100).filter(d=>d.type==="fungible").map(d=>{let c=o[d.encodedCaip19]??d.price;return c?d.totalQuantity*c.price/10**d.decimals:1/0});t(lt,Math.min(...i))}),Vi=H((e,t)=>{e(ue)&&t(lt,1/0)});function Li(e,t){if(e.type==="native"&&t.type!=="native")return-1;if(e.type!=="native"&&t.type==="native")return 1;if(e.type==="native"&&t.type==="native")return e.name&&t.name?e.name.localeCompare(t.name):0}function Qi(e,t){if(!e&&t)return 1;if(e&&!t)return-1}function Vr(e,t){if(e&&t)return e.localeCompare(t);if(e&&!t)return-1;if(!e&&t)return 1}function Lr(e,t){if(e!==t)return t-e}function Wi(e){return{totalQuantity:e.totalQuantity,totalQuantityString:e.totalQuantityString}}var Ki=b(e=>{let t=e(le),n=e(at),r=new Set(Object.keys(n));if(t.length===0)return[];let o=t.map(i=>{let d=i.extraMetadata?.compression?.compressed?`${i.encodedCaip19}-compressed`:i.encodedCaip19,c=n[d];return c?(r.delete(d),{...i,...Wi(c)}):i});return r.forEach(i=>{let d=n[i];d&&o.push(d)}),o}),Gi=b(e=>{let t=e(de),n=e(Ki),r=e(_r),o=n.filter(i=>i.totalQuantity>0||i.type==="native").map(i=>({...i,livePrice:t[i.encodedCaip19]??i.price})).sort((i,d)=>{let c=i.livePrice?.price,p=d.livePrice?.price,l=Qi(c,p);if(l)return l;let m=i.totalQuantity/10**i.decimals,g=d.totalQuantity/10**d.decimals;if(!c&&!p){let x=Li(i,d);if(x)return x;let D=Lr(m,g);if(D)return D;let J=Vr(i.name,d.name);return J||0}let y=(c??0)*m,T=(p??0)*g,S=Lr(y,T);return S||(Vr(i.name,d.name)??0)});return r?o.filter(i=>{let d=i.livePrice?.price,c=i.totalQuantity/10**i.decimals;return(d??0)*c>=r}):o}),pe=Gi;s();a();function qi(e){if(e)return typeof e=="string"||typeof e=="number"?new Date(e):e}function $i(e,{key:t,newPriceData:n}){let r=e[t];if(!n||r?.price===n?.price)return e;let o=qi(n.lastUpdatedAt);return!o||!(!r?.lastUpdatedAt||o>r.lastUpdatedAt)?e:{...e,[t]:{price:n.price,priceChange24h:n.priceChange24h??n.usd_24h_change,lastUpdatedAt:o}}}var dt=$i;var ji=(e,t,n)=>{let r=e.extraMetadata?.compression?.compressed,o=t.extraMetadata?.compression?.compressed;if(r!==o)return n?r?-1:1:r?1:-1},zi=(e,t,n)=>{let r=e.legacyKey===n,o=t.legacyKey===n;if(r!==o)return r?-1:1},Hi=({isSplCompressed:e,legacyKey:t},n)=>n.length?n.length===1?n[0]:[...n].sort((o,i)=>{if(e!==void 0&&(o.encodedCaip19.includes("solana:")||i.encodedCaip19.includes("solana:"))){let d=ji(o,i,e);if(d)return d}if(t){let d=zi(o,i,t);if(d)return d}return i.totalQuantity-o.totalQuantity})[0]:null,pt=e=>{let t=V(Ae),n=V(pe),r=(0,Ve.useMemo)(()=>n.filter(c=>c.encodedCaip19===e.encodedCaip19&&(!e.legacyKey||c.legacyKey===e.legacyKey)),[e.encodedCaip19,e.legacyKey]),o=Ur({...e,walletCaip19s:t});o.refetchInterval||(o.refetchInterval=P({seconds:3}));let i=W({...o,select:c=>Hi(e,c),placeholderData:r}),d=Oe(de);return(0,Ve.useEffect)(()=>{let c=i.data;c&&!i.isPlaceholderData&&c.price&&d(p=>{let l=c.encodedCaip19,m=c.price;return dt(p,{key:l,newPriceData:m})})},[i.data,i.isPlaceholderData,d]),i},mt=({networkID:e,queryOptions:t,addressType:n})=>{let r={chainId:e,slip44:N.getSlip44(e),resourceType:"nativeToken"},o=ye.get(e).nativeTokenFungibleBalanceKey(e,n)??null,i=z(r);return pt({encodedCaip19:i,legacyKey:o,queryOptions:t})},Ji=()=>{let{data:e}=ee(),t=(0,Ve.useMemo)(()=>e?.addresses.find(n=>N.isSolanaNetworkID(n.networkID)),[e]);return mt({networkID:t?.networkID||"solana:101",addressType:t?.addressType})};s();a();s();a();s();a();s();a();function zt(e,t){return{gcTime:ze.Long,staleTime:1/0,enabled:!!t&&!!e,queryKey:G.visibilityOverrides({accountId:t??""}),async queryFn(){return!t||!e?new Map:await Nn(e,t)}}}s();a();var Yi=b(null),Qr=Yi;var Zi=new Map,Wr=et(e=>{let t=e(Qr),n=e(ue);return zt(t,n)}),Kr=j(Wr,e=>e.status),Xi=b(e=>e(Wr).data??Zi),ve=Xi;var es=b(e=>{let{isLoading:t}=e(te),n=e(le),r=e(Kr);return t&&n.length===0||r==="pending"}),ft=j(es,e=>e);function Gr(){let e=V(pe),t=V(ft),n=V(ke),r=V(ve);return{isLoading:t,hasNextPage:n,fungibleTokens:e,visibilityOverrides:r}}s();a();s();a();var qr=U(M());var ts=({wallets:e,encodedCaip19:t,isSplCompressed:n=!1})=>{let r=$();return(0,qr.useCallback)(()=>void r.invalidateQueries({queryKey:G.tokenBalance({wallets:e,encodedCaip19:t,isSplCompressed:n})}),[r,e,t,n])},ns=ts;s();a();function $r({tokens:e}){return Mn({tokens:e}).catch(t=>{throw F.addBreadcrumb("tokens","getTokenPrices","error",{message:t.message,cause:t.cause,tokens:e.map(z).join(",")}),F.captureError(t,"tokens"),t})}s();a();s();a();var rs=b(e=>{let t=e(ve);return e(pe).filter(r=>Vn(t??new Map,{key:r.legacyKey??"",spamStatus:r.spamStatus}))}),jr=rs;function zr(){let e=V(jr),t=V(ft),n=V(ke),r=V(ve);return{isLoading:t,hasNextPage:n,fungibleTokens:e,visibilityOverrides:r}}s();a();var Le=U(M());s();a();s();a();function os(e){let t={message:"Failed to parse token details response"};if(e instanceof oe)try{t.zodIssuesJson=JSON.stringify(e.issues.map(n=>({path:n.path.join("."),message:n.message,code:n.code})))}catch{t.zodIssuesJson="Failed to stringify Zod issues"}else t.errorMessage=e instanceof Error?e.message:String(e);return t}var Hr=os;function Jr(e){return e.resourceType==="nativeToken"?`/fungibles/v1/${e.chainId}/${e.resourceType}/${e.slip44}`:`/fungibles/v1/${e.chainId}/${e.resourceType}/${e.address}`}function is(e){return Jr(We(e))}function ss(e){let t=new URLSearchParams,n="encodedCaip19"in e?is(e.encodedCaip19):Jr(e.decodedCaip19);return e.includePrice&&t.append("includePrice","true"),e.includeFungibleDetails&&t.append("includeFungibleDetails","true"),[n,{params:t}]}async function Ht(e){let t=await q.api().timeout(P({seconds:10})).get(...ss(e)).then(n=>{if(Y(n))return n.data;throw new Error(n.data?.message||n.data?.error||n.statusText||`Status: ${n.status}`,{cause:n.data?.code})}).catch(n=>{throw F.addBreadcrumb("tokens","getTokenDetails","error",{message:n.message,cause:n.cause,..."encodedCaip19"in e&&{caip19:e.encodedCaip19},..."decodedCaip19"in e&&{caip19:z(e.decodedCaip19)}}),F.captureError(n,"tokens"),n});try{return Gt.parse(t)}catch(n){console.error(n);let r=Hr(n);throw"encodedCaip19"in e&&typeof e.encodedCaip19=="string"?r.caip19=e.encodedCaip19:"decodedCaip19"in e&&(r.caip19=z(e.decodedCaip19)),F.addBreadcrumb("tokens","getTokenDetails.ParseError","error",r),n}}function as({caip19:e,includePrice:t}){let n=(0,Le.useMemo)(()=>typeof e=="string"?e:z(e),[e]),r=V(pe),o=(0,Le.useMemo)(()=>{let c=r.find(p=>p.encodedCaip19===n);return c?{chainName:c.chainName,encodedCaip19:n,decodedCaip19:c.decodedCaip19,type:c.type,categories:[],price:c.price,symbol:c.symbol??"",name:c.name??"",decimals:c.decimals,legacyKey:c.legacyKey??n,spamStatus:c.spamStatus??"NOT_VERIFIED",logoUri:c.logoUri??null,extraMetadata:{description:"",id:"",isMutable:!0,createdDate:null,...c.extraMetadata},createdDate:null}:null},[n,t]),i=W({refetchInterval:P({seconds:t?5:30}),queryKey:G.tokenDetails({caip19:n,includePrice:t}),queryFn:async()=>{let c=await Ht(typeof e=="string"?{encodedCaip19:e,includeFungibleDetails:!0,includePrice:t}:{decodedCaip19:e,includeFungibleDetails:!0,includePrice:t});return xr.parse(c)},...o&&{placeholderData:o}}),d=Oe(de);return(0,Le.useEffect)(()=>{let c=i.data;c&&!i.isPlaceholderData&&t&&c.price&&d(p=>{let l=c.encodedCaip19,m=c.price;return dt(p,{key:l,newPriceData:m})})},[i.data,i.isPlaceholderData,d,t]),i}var Jt=as;s();a();var Xt=U(M());s();a();var Yt=new O(0),Zt=({chainAddress:e,type:t,balance:n,decimals:r,recipient:o,gasEstimation:i,clampToZero:d=!0})=>{let{data:c,isPending:p}=wt(e);if(!t||!n)return Yt;let l=new O(n).multipliedBy(sn(r));if(!ae(t))return l;if(!i)return;let m=new O(0);if(qe(i))m=l.minus(new O(i.value));else if(An(i)){let{gasLimit:g,maxFeePerGas:y,l1Fee:T=new O(0)}=i,S=g.times(y).plus(T);m=l.minus(S)}else if($e(i)){if(!e||p)return;let g=e.addressType,y=c?.safeToSendUtxos??[],T=bn(i.btcPerKilobyte),S=o&&an.safeParse(o).success?o:"bc1p",D=[{value:y.reduce((ne,me)=>ne.plus(new O(me.value)),new O(0)).toNumber(),address:S}],J=Sn(g,y,D,T.toNumber(),[]);if(J.type==="error")m=new O(J.maxAmount).integerValue(O.ROUND_DOWN);else{let{inputs:ne,fee:me}=J;m=ne.reduce((Se,Ee)=>Se.plus(new O(Ee.value)),new O(0)).minus(me).integerValue(O.ROUND_DOWN)}}else if(wn(i))m=l.minus(i.gasBudget);else return xe(i);return m.isGreaterThan(Yt)?m:d?Yt:m};var cs=({networkID:e,addressType:t,gasEstimation:n,transactionValue:r=new O(0),recipient:o})=>{let{data:i,isLoading:d,isError:c}=mt({networkID:e,addressType:t}),p=ye.get(e).nativeFungibleTokenType,l="unknown",m="",g=(0,Xt.useMemo)(()=>{let T=i?.queriedWalletBalances[0]?.address;if(!T)return;let S=Ke(e,T);return{networkID:e,address:T,addressType:S}},[i?.queriedWalletBalances,e]),y=Zt({chainAddress:g,type:p,balance:i?.totalQuantityString?new O(i?.totalQuantityString):void 0,decimals:i?.decimals??0,recipient:o,gasEstimation:n,clampToZero:!1});return!c&&i&&y&&(y.gte(r)?l="sufficient":l="insufficient",m=i?.symbol||""),(0,Xt.useMemo)(()=>({hasSufficientFunds:l,nativeTokenSymbol:m,isLoading:d,isError:c}),[l,m,d,c])};s();a();var eo=U(M());s();a();var en=U(M());s();a();var Yr=({chainAddresses:e=[]})=>{let t=K.tokensErrorCount(e);return W({queryKey:t,initialData:0})};s();a();var us=({errors:e})=>e;function Zr({chainAddresses:e,queryOptions:t}){return Kn({select:us,chainAddresses:e,queryOptions:t})}var Xr=3,ls=1,tn=({networkID:e,chainAddresses:t=[]})=>{let{data:n=[]}=Zr({chainAddresses:t}),{data:r=0}=Yr({chainAddresses:t}),o=r>=Xr,{data:i=0}=Ln(),d=i>=Xr,c=n.length===ls&&n.some(m=>m.code==="TokensTrimmed"),{t:p}=Z(),l=(0,en.useMemo)(()=>{if(o)return p("partialErrorGeneric");let m=n.filter(y=>e?y.details.chainId===e:!0),g=m.length+(d?1:0);return g?g>1?p("partialErrorGeneric"):d?p("partialErrorTokenPrices"):c?p("partialErrorTokensTrimmed"):e?p("partialErrorTokenDetail"):p("partialErrorBalanceChainName",{chainName:N.getChainName(m[0].details.chainId)}):""},[o,n,d,e,c,p]);return(0,en.useMemo)(()=>({partialErrorMessage:l,shouldShowPartialError:l!==""}),[l])};function ds(e){let{onTappingBuy:t,onTappingReceive:n,onTappingSend:r,onTappingSwap:o,account:i}=e,{shouldShowPartialError:d,partialErrorMessage:c}=tn({chainAddresses:i?.addresses});return{ctaActions:ps({onTappingBuy:t,onTappingReceive:n,onTappingSend:r,onTappingSwap:o}),shouldShowPartialError:d,partialErrorMessage:c}}function ps(e){let{t}=Z();return(0,eo.useMemo)(()=>{let r=[];return r.push({text:t("commandSend"),type:"send",onClick:e.onTappingSend}),r.push({text:t("commandSwap"),type:"swap",onClick:e.onTappingSwap}),r.push({text:t("commandReceive"),type:"receive",onClick:e.onTappingReceive}),r.push({text:t("commandBuy"),type:"buy",onClick:e.onTappingBuy}),r.sort((o,i)=>(kt.get(o.type)??100)-(kt.get(i.type)??100)),{primary:r,more:[]}},[t,e.onTappingSend,e.onTappingSwap,e.onTappingReceive,e.onTappingBuy])}s();a();var to=U(M());var ms=({networkID:e,unsignedTransaction:t,pendingActivityRows:n,accountIdentifier:r,accountSigner:o,storage:i,includeCallPayload:d})=>({accountSigner:o,accountIdentifier:r,networkID:e,unsignedTransaction:t,...d&&{callPayload:{from:t.from,to:t.to,data:t.data,value:t.value}},pendingTransactionInput:{ownerAddress:t.from,networkID:e,data:{nonce:"",unsignedTransaction:t,hash:""},type:"swap",display:{summary:n}},storage:i}),fs=async({t:e,fungible:t,unsignedUnwrapTx:n,gasEstimation:r,storage:o,accountMetadata:i,accountSigner:d})=>{if(!n)throw new Error("Unsigned unwrap transaction is required");if(!r)throw new Error("Gas estimation is required");let{chain:c,balance:p}=t.data;if(!N.isEthereumNetworkID(c.id))throw new Error(`Chain is not supported: ${c.id}`);let l=c.id,m={topRight:{text:`+${p} ${c.symbol}`},topLeft:{text:e("transactionsPendingSwapping")},bottomRight:{text:`-${p} ${t.data.symbol}`},bottomLeft:{text:`${t.data.name}`}},g=nn.parse({type:"0x2",chainId:N.getEVMNetworkIDValue(l),gas:`0x${r.gasLimit.toString(16)}`,maxFeePerGas:`0x${r.maxFeePerGas.toString(16)}`,maxPriorityFeePerGas:`0x${r.maxPriorityFeePerGas.toString(16)}`,...n}),y=ms({storage:o,accountSigner:d,pendingActivityRows:m,includeCallPayload:!1,networkID:l,unsignedTransaction:g,accountIdentifier:i.accountIdentifier});return Cn(y)},gs=()=>{let{data:e}=ee();return(0,to.useMemo)(()=>{let n=e?.type,r=e?.name??"",o=e?.identifier??"";return{accountName:r,accountType:n,accountIdentifier:o}},[e])},ys=e=>{let t=ie(),n=$(),{t:r}=Z(),o=gs(),i=se();return X({async mutationFn({fungible:d,unsignedUnwrapTx:c,gasEstimation:p}){return await fs({t:r,fungible:d,unsignedUnwrapTx:c,gasEstimation:p,accountMetadata:o,storage:t,accountSigner:i})},async onSuccess(){await n.invalidateQueries({queryKey:K.tokens(e)})}})};s();a();s();a();s();a();var no=()=>{let{setRetryArgs:e}=Dt();return t=>{if(t instanceof xn){let{successfulTxIds:n}=t,[r,o]=n;e({type:"BRC20",commitTxId:r,revealTxId:o})}}};function hs(){let e=ie(),{data:t}=ee({select:d=>d.identifier}),n=no(),r=Qn(),o=se();return X({mutationFn:async({multichainTransaction:d,pendingTransactionInput:c,senderAddress:p,gasEstimation:l})=>{if(!t)throw new Error("No account identifier found");let{networkID:m}=d,g=await kn.get(m).onBeforeSend({multichainTransaction:d,gasEstimation:l}),y=await Rn({accountIdentifier:t,accountSigner:o,multichainTransaction:g,networkID:m,pendingTransactionInput:c,senderAddress:p,storage:e,utxoManager:r});return Un(m,y)},onError(d){d instanceof Error&&(F.captureError(d,"fungibles"),d instanceof En&&n(d))}})}s();a();var ro=U(M());var Ts=(e,t,n)=>{let r=$(),{fungibles:o}=Ie({keys:[e]}),i=o.length===1?o[0]:void 0;(0,ro.useEffect)(()=>{if(!i)return;let{type:d,data:c}=i,{balance:p,decimals:l,chain:m}=c,{id:g}=m,y=ae(d)===!0;if(!n||!p||y||p.isEqualTo(t))return;let T=K.transferFungibleLoggingContext(e),S={transactionId:n,decimals:l,chainId:g,isNativeToken:y,previousBalance:p,fungibleKey:e};r.setQueryData(T,S)},[n])};s();a();var io=U(M());s();a();function oo(e,t,n){return L.PublicKey.findProgramAddressSync([e.toBuffer(),n.toBuffer(),t.toBuffer()],Pn)[0]}var bs=new Pe("Unable to unwrap SOL. Wrapped SOL Token account does not exist."),ws=new Pe("Unable to unwrap SOL. Token account is not expected mint.");async function As(e,t){let n=await e.getAccountInfo(t);if(!n)throw bs;let r=In.decode(n.data);return new L.PublicKey(r.mint)}function ks(e){if(e)return typeof e=="string"?new L.PublicKey(e):e}function vs(){let{connection:e}=He(),{data:t}=ee(),{solanaChainAddress:n,accountIdentifier:r}=(0,io.useMemo)(()=>({solanaChainAddress:t?.addresses.find(fe),accountIdentifier:t?.identifier??""}),[t]),o=ie(),i=se(),{t:d}=Z();return X({mutationFn:async c=>{if(!n)return Promise.reject("solanaChainAddress not loaded");try{let{networkID:p,address:l}=n,m=new L.PublicKey(l),g=ks(c?.tokenAccount)??oo(m,bt,Ce);if((await As(e,g)).toBase58()!==bt.toBase58())throw ws;let T=ur(g,m,m,[],Ce),S=new rn.Transaction().add(T),x={ownerAddress:l,networkID:p,data:{signature:""},type:"unwrapSOL",display:{summary:{topLeft:{text:d("assetDetailUnwrappingSOL")}}}},D=await je({accountIdentifier:r,accountSigner:i,connection:e,feePayer:new L.PublicKey(l),pendingTransactionInput:x,storage:o,transaction:S,useSubmissionService:!1});return{networkID:p,id:D}}catch(p){throw p instanceof Error&&F.captureError(p,"tokens"),p}}})}s();a();var so=P({minutes:1}),Ss=(e,t=!0)=>{let n=K.solanaBalance(e);return W({enabled:!!e&&t&&fe(e),gcTime:so,staleTime:so,queryKey:n,async queryFn(){if(!e)throw new Error("No chain address provided");if(fe(e))return vn(e.networkID).getBalance(new L.PublicKey(e.address));throw new Error(`SOL balance not implemented for ${e.networkID}`)}})};s();a();s();a();var ao=U(M());var Es=e=>{let{data:t}=hn();return(0,ao.useMemo)(()=>{if(!e||!t)return;let n=e.data.chain.id,r=t.explorers[n]??fn.get(n).defaultExplorer,o,i;if(ae(e.type))i="address",o=e.data.walletAddress;else switch(e.type){case"SuiCoin":{i="token",o=e.data.contractAddress;break}case"ERC20":{i="address",o=e.data.contractAddress;break}case"SPL":case"CompressedSPL":{i="address",o=e.data.mintAddress;break}case"BRC20":return{explorerName:"Unisat",explorerUrl:`https://unisat.io/brc20?q=${e.data.walletAddress}`}}let d=yn({networkID:n,endpoint:i,explorerType:r,param:o});return{explorerName:gn[r],explorerUrl:d}},[e,t])};s();a();var co=U(M());var xs=e=>{let t=$();return(0,co.useCallback)(()=>t.invalidateQueries({queryKey:K.tokens(e)}),[t,e])};s();a();var uo=U(M()),Cs=(e,t)=>(0,uo.useMemo)(()=>{if(e)if($e(e)){let n=Tn(e).toNumber().toLocaleString("en-US");return{leftSubtext:void 0,leftSubtextColor:void 0,rightSubtext:t("satsAmount",{sats:n.toString()})}}else return qe(e)&&e.highFees?{leftSubtext:t("notificationTransactionApprovalNetworkFeeHighWarning"),leftSubtextColor:"accentWarning",rightSubtext:""}:void 0},[e,t]);s();a();var Ps=U(M());s();a();var lo=U(M());var Fs=({caip19:e,fungibleCaip19:t,fungibleKeys:n,isSplCompressed:r})=>{let{fungibles:o,isLoadingTokens:i,refetch:d}=Ie({keys:n}),{data:c,refetch:p,isLoading:l}=pt({encodedCaip19:e,legacyKey:n?.[0]??null,isSplCompressed:r}),{data:m,isLoading:g}=Jt({caip19:e,includePrice:!0}),y=Us(o,r),T=(0,lo.useMemo)(()=>{if(!y)return;if(!c)return y;let x=At(c.totalQuantityString,c.decimals);return{...y,data:{...y.data,balance:x,usd:c.price?.price?x.times(c.price.price).toNumber():void 0,usd_24h_change:c.price?.priceChange24h!==void 0?po(x.times(c.price.price).toNumber(),c.price?.priceChange24h):void 0}}},[y,c]);return{derivedFungible:Is({fungible:T,fungibleCaip19:t,tokenDetails:m,tokenBalance:c}),isLoading:i||g||l,refetchFungibleBalance:d,refetchTokenBalance:p}};function Is({fungible:e,fungibleCaip19:t,tokenDetails:n,tokenBalance:r}){if(e)return e;if(!n)return;let o=Gn(n),i="address"in t?Bs(t,o):Os(t,o);if(i){if(r){r.extraMetadata?.compression?.compressed&&(i.type="CompressedSPL");let d=At(r.totalQuantityString,r.decimals);i.data.balance=d,i.data.amount=r.totalQuantityString,i.data.usd=r.price?.price?d.times(r.price.price).toNumber():void 0,i.data.usd_24h_change=r.price?.priceChange24h!==void 0?po(d.times(r.price.price).toNumber(),r.price?.priceChange24h):void 0,i.data.walletAddress=r.queriedWalletBalances.find(c=>c.quantity>0)?.address??""}return i}F.addBreadcrumb("tokens","deriveFungible","error",{fungibleCaip19:JSON.stringify(t),tokenDetails:JSON.stringify(n),tokenBalance:JSON.stringify(r)}),F.captureError(new Error(`Fungible type could not be derived from ${JSON.stringify(t)}`),"fungibles")}function Bs(e,t){let n=Fe(e);if(ae(n))throw new Error("Cannot create fake non-native fungible for native token");let r=t.address??e.address,o={amount:"0",balance:O(0),chain:t.chain,decimals:t.decimals,logoUri:t.logoURI??t.logoUri,name:t.name??"Unknown",symbol:t.symbol??"Unknown",key:r,walletAddress:"",spamStatus:t.spamStatus};switch(n){case"SPL":return{type:n,data:{...o,mintAddress:r,programId:"",splTokenAccountPubkey:""}};case"CompressedSPL":return{type:n,data:{...o,mintAddress:r,programId:""}};case"ERC20":case"SuiCoin":return{type:n,data:{...o,contractAddress:r}};case"BRC20":return{type:n,data:{...o,firstCreatedInscriptionId:r}};case"HypercoreAsset":return;default:xe(n)}}function Os(e,t){let n=Fe(e),r={amount:"0",balance:O(0),chain:t.chain,decimals:t.decimals,logoUri:t.logoURI??t.logoUri,name:t.name??"Unknown",symbol:t.symbol??"Unknown",key:n,walletAddress:"",spamStatus:t.spamStatus};switch(e.slip44){case"501":return{type:"SolanaNative",data:r};case"0":return{type:"BitcoinNative",data:r};case"60":return{type:"EthereumNative",data:r};case"8453":return{type:"BaseNative",data:r};case"143":return{type:"MonadNative",data:r};case"9001":return{type:"ArbitrumNative",data:r};case"925":return{type:"HypercoreNative",data:r};case"966":return{type:"PolygonNative",data:r};case"784":return{type:"SuiNative",data:r};default:{let o=new Error("Missing native token implementation when creating fake a Fungible");throw xe(e.slip44,o),o}}}var Us=(e,t)=>e?.length?[...e].sort((r,o)=>{if(t!==void 0){let i=r.type==="CompressedSPL",d=o.type==="CompressedSPL";if(i!==d)return t?i?-1:1:i?1:-1}return o.data.balance.minus(r.data.balance).toNumber()})[0]:void 0,po=(e,t)=>{if(t===-100)return-1*e;let n=e/(1+t/100);return e-n};s();a();s();a();var bo=U(M());s();a();s();a();var mo="@phantom/wallet-screening",fo=`${mo}:wallet-screen-action`,Rs=`${mo}:wallet-screen-geo`,gt={walletScreenAction(e){return[fo,e]},walletGeo(){return[Rs]}};s();a();var go=new Error("Failed to fetch wallet screen action.");async function yo(e){try{let t=await q.api().post("/wallet_screen/v1",e);if(!Y(t))throw go;let n=t.data;return qn.parse(n)}catch{throw go}}var ho=P({days:7}),To=e=>{let t=e!==void 0&&N.isMainnetNetworkID(e.networkID),n=[];if(e!==void 0){let c=N.isEVMNetworkID(e.networkID)?e.address.toLowerCase():e.address;n=[{chainId:e.networkID,address:c,resourceType:"address"}]}let r={addresses:n},o=$(),i=gt.walletScreenAction(r),d=[i[0]];return W({enabled:t,queryKey:i,gcTime:ho,staleTime:ho,refetchInterval:!1,refetchOnMount:!1,async queryFn(){if(Ms(o,d))return"FAIL_SEVERE";let p=await yo(r);return Ns(p)}})},Ms=(e,t)=>{let n=e.getQueriesData({queryKey:t,exact:!1}),r=!1;for(let[o,i]of n){let d=i;if(d&&d==="FAIL_SEVERE"){r=!0;break}}return r},Ns=e=>{let t=e.addressScreenResults;return t.some(n=>n.action==="FAIL_SEVERE")?"FAIL_SEVERE":t.some(n=>n.action==="FAIL_HIGH")?"FAIL_HIGH":t.some(n=>n.action==="NO_ACTION")?"NO_ACTION":"DATA_NOT_FOUND"};var _s=(e,t)=>{let n=Ge(),{data:r}=To(e);switch((0,bo.useEffect)(()=>{r&&e&&n.capture("walletScreened",{data:{walletScreen:{action:r.toString(),surface:t},chainId:N.getChainID(e.networkID),networkId:e.networkID}})},[r,e,t,n]),r){case"FAIL_SEVERE":case"FAIL_HIGH":throw new jn(`Transaction disabled: ${t}`);case"NO_ACTION":case"DATA_NOT_FOUND":return}};s();a();s();a();s();a();var wo=new Error("Failed to fetch wallet geo.");async function Ao(){try{let e=await q.api().get("/wallet_screen/v1/geo");if(!Y(e))throw wo;let t=e.data;return $n.parse(t).country}catch{throw wo}}var ko=P({hours:1}),Vs=()=>{let e=gt.walletGeo();return W({queryKey:e,staleTime:ko,refetchInterval:ko,queryFn:Ao})};s();a();export{ur as a,b,tr as c,$s as d,V as e,Oe as f,js as g,Te as h,et as i,j,Vo as k,Lo as l,or as m,Dt as n,Go as o,hs as p,Ts as q,Zt as r,vs as s,jo as t,Ss as u,Es as v,ns as w,_t as x,nu as y,yr as z,ru as A,Vu as B,Ti as C,Pl as D,H as E,ot as F,Ir as G,Br as H,st as I,Ae as J,te as K,Rr as L,ue as M,Ci as N,de as O,ke as P,pe as Q,pt as R,Ji as S,$r as T,Qr as U,ve as V,ft as W,Gr as X,jr as Y,zr as Z,Jt as _,cs as $,tn as aa,ds as ba,xs as ca,Cs as da,ys as ea,Fs as fa,fo as ga,_s as ha,Vs as ia};
//# sourceMappingURL=chunk-CXKBWI2Z.js.map
