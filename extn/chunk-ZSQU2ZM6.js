import{h as Ui}from"./chunk-PKAXVJFX.js";import{$a as gt,Ab as hi,Fb as xe,G as ri,Ga as ci,H as ft,Hb as fe,Ib as eo,Jb as $e,Jc as Ri,Kc as Li,Mb as to,Na as Jr,Nb as Ti,Oa as ui,Ob as Ye,Pa as pi,Qb as oo,Rb as ht,Sb as Ai,Tb as xi,Tc as Bi,Ub as wi,Wc as Mi,Yb as Ei,Yc as Oi,ab as mi,ac as vi,bb as di,cb as fi,eb as Ci,fa as Ct,ga as je,ha as Fe,hb as bi,ia as si,ja as li,kc as Ii,l as We,lc as Pi,mc as Di,ob as yi,p as Jo,pb as Si,pc as ki,qa as ai,r as ei,s as ti,tb as gi,u as dt,v as oi,wa as bt,x as ii,xa as yt,y as ni,ya as St,zb as ze}from"./chunk-R5HJQXZQ.js";import{a as $o,c as Yo,j as Xo}from"./chunk-P4LRI3S3.js";import{Bd as Ne,Cb as ut,Db as Wo,De as mt,Gb as jo,H as Ro,Hb as zo,K as ee,L as w,S as k,Ua as Ho,V as ye,W as Se,Wa as lt,_a as _o,bb as Ko,ce as Zo,db as Me,de as Ve,eb as at,gb as E,gd as H,hb as qo,ib as Oe,rb as Go,tb as ct,xb as Qo,y as Xt,ze as pt}from"./chunk-S6KJ2BHO.js";import{p as Re}from"./chunk-7ZZNCPHU.js";import{a as Z,m as L}from"./chunk-MNQ7RLHG.js";import{ha as F,ja as ie,ma as O,p as it,ra as N,xa as D}from"./chunk-NMZ7IVPZ.js";import{U as Vo,Y as Zt,a as c,b as Ae,ba as rt,c as R,d as Lo,da as Jt,f as Bo,fa as st,ia as Fo,k as Mo,l as Le,o as Oo,p as Be,r as nt,s as No,x as U}from"./chunk-H6ILHDLW.js";import{a as T}from"./chunk-7X4NV6OJ.js";import{f as S,h as s,l as Zr,m as Buffer,n as l}from"./chunk-3KENBVE7.js";s();l();var $=e=>{if(e!=null&&!(e.constructor===Object&&Object.keys(e).length===0))return e},es=e=>e??[],te=class extends Error{constructor(t){super(t),this.name="CollectiblesError"}},I=c.string().nullish().transform($),we=c.number().nullish().transform($),io=c.union([I,we]).transform(e=>typeof e=="number"?e.toString():e),ts=c.object({name:I,symbol:I,decimals:we,address:I}),no=(b=>(b[b.Uninitialized=0]="Uninitialized",b[b.EditionV1=1]="EditionV1",b[b.MasterEditionV1=2]="MasterEditionV1",b[b.ReservationListV1=3]="ReservationListV1",b[b.MetadataV1=4]="MetadataV1",b[b.ReservationListV2=5]="ReservationListV2",b[b.MasterEditionV2=6]="MasterEditionV2",b[b.EditionMarker=7]="EditionMarker",b[b.UseAuthorityRecord=8]="UseAuthorityRecord",b[b.CollectionAuthorityRecord=9]="CollectionAuthorityRecord",b[b.TokenOwnedEscrow=10]="TokenOwnedEscrow",b[b.TokenRecord=11]="TokenRecord",b[b.MetadataDelegate=12]="MetadataDelegate",b))(no||{}),Tt=c.nativeEnum(no),Ni=c.object({price:c.number(),token:ts.nullish().transform($)}),os=Ni.nullish().transform($),is=c.object({name:I,url:I,isVerified:c.coerce.boolean()}),Vi=c.object({id:c.string(),isValidCollectionId:c.coerce.boolean(),name:I,description:I,externalUrl:I,imageUrl:I,isSpam:c.coerce.boolean(),spamStatus:c.nativeEnum(xe).optional().default("NOT_VERIFIED"),floorPrice:Ni.nullish().transform($),ownerCount:we,totalCount:we,tokenCount:we,marketplaces:c.array(is)}),ns=c.object({small:I,medium:I,large:I,blurhash:I}),rs=ns.nullish().transform($),ss=c.enum(["image","video","audio","model","other"]),ls=c.object({url:I}),Xe=ls.nullish().transform($),as=c.object({type:ss,image:Xe,video:Xe,audio:Xe,model:Xe,other:Xe,previews:rs}),cs=as.nullish().transform($),us=c.object({trait_type:I,value:I.or(we),display_type:I}),ps=c.object({id:c.string(),contract:c.string(),standard:c.nativeEnum(hi)}),ro=c.object({compressed:c.boolean(),merkleTree:c.string(),leafIndex:c.number()}),ms=c.object({mint:c.string(),tokenAccount:c.string(),standard:c.nativeEnum(ze),compression:ro.nullish().transform($),programId:c.string(),mintExtensions:Mo(gi).optional()}),ds=c.object({id:c.string(),url:c.string(),displayName:c.string(),description:c.string(),count:c.number()}),Fi=c.object({hash:c.string(),index:c.number(),distinctRareSats:c.number(),satributes:c.array(ds),blockNumber:c.number(),value:c.number(),backgroundImageUrl:c.string()}),fs=c.object({firstCreatedTransactionHash:c.string(),firstCreatedInscriptionId:c.string(),inscriptionId:I,inscriptionNumber:io,outputValue:io,satNumber:io,satName:I,satRarity:I,protocolName:I,utxoHash:I,utxoIndex:we,createdAt:c.string().nullish().transform($),utxoDetails:Fi.nullish().transform($)}),Cs=c.object({objectId:c.string()}),rc=c.object({firstCreatedTransactionHash:c.string(),firstCreatedInscriptionId:c.string(),utxoDetails:Fi}),bs=c.object({listingPrice:c.string(),listingPriceUiAmount:c.string(),isNative:c.boolean(),url:c.string()}),ys=c.union([ms,ps,fs,Cs]),so=c.object({id:qo,chain:Qo,name:I,symbol:I,description:I,externalUrl:I,collection:Vi,media:cs,uri:I,attributes:c.array(us).nullish().transform(es),lastSalePrice:os,balance:I,decimals:I,owner:I,chainData:ys.optional(),listings:c.record(bs).nullish().transform($)}),Ss=Vi.extend({items:c.array(so)}),sc=c.object({items:c.array(Ss),isTrimmed:c.boolean()});var gs=c.object({networkID:at}),At=gs.extend({type:c.literal("transferSPLToken"),senderAddress:ct,mint:c.string(),amount:c.union([c.instanceof(R),c.string()]),memo:c.string().optional()}),lc=At.extend({destination:c.string(),senderAccount:c.string(),decimals:c.number(),references:c.array(c.string()).optional(),programId:c.string()}),ac=At.extend({destination:c.string(),compression:ro.nullish().transform($).refine(e=>e?.compressed)}),cc=c.object({compression:ro.nullish().transform($).refine(e=>e?.compressed),mint:c.string()}),uc=At.extend({destination:c.string(),senderAccount:c.string(),standard:c.enum(["ProgrammableNonFungible","ProgrammableNonFungibleEdition"])}),pc=At.extend({destination:c.string()}),mc=c.object({root:c.string(),proof:c.array(c.string()),merkleTree:c.string(),dataHash:c.string(),creatorHash:c.string(),leafIndex:c.number(),owner:c.string(),delegate:c.string().optional()}),Hi=c.object({networkID:Me}),dc=Hi.extend({senderAddress:ct,type:c.literal("transferERC721Evm"),destination:c.string(),amount:c.literal(1),contractAddress:c.string(),tokenID:c.string()}),fc=Hi.extend({senderAddress:ct,type:c.literal("transferERC1155Evm"),destination:c.string(),amount:c.union([c.instanceof(R),c.string()]),contractAddress:c.string(),tokenID:c.string()}),_i=c.object({networkID:Ko}),Cc=_i.extend({type:c.literal("ordinal"),inscriptionId:c.string(),value:c.string(),senderAddress:c.string(),destination:c.string(),amount:c.literal(1),utxoHash:c.string(),utxoIndex:c.number()}),bc=_i.extend({type:c.literal("raresats"),hash:c.string(),index:c.number(),value:c.string(),senderAddress:c.string(),destination:c.string(),amount:c.literal(1)});s();l();function K(e){return e?.tokenAccount!==void 0}function ne(e){return e?.contract!==void 0}function re(e){return e!==void 0&&"firstCreatedTransactionHash"in e}function Ki(e){return e!==void 0&&"objectId"in e}function xt(e){return re(e)&&!!e.utxoDetails}var qi=e=>e.type==="transferERC721Evm",Gi=e=>e.type==="transferERC1155Evm",Qi=e=>"compression"in e&&!!e.compression?.compressed,Wi=e=>"standard"in e&&(e.standard==="ProgrammableNonFungible"||e.standard==="ProgrammableNonFungibleEdition"),ji=e=>e.type==="transferSPLToken"&&"destination"in e,zi=e=>e.type==="ordinal",$i=e=>e.type==="raresats";s();l();s();l();var lo=S(Zr());s();l();var Yi=new w.PublicKey("NTYeYJ1wr4bpM5xo6zx5En44SvJFAd35zTxxNoERYqd"),Ec=new w.PublicKey("M2mx93ekt1fmXSVkTrUL9xVFHkmME8HTUi5Cyc5aF7K"),vc="https://magiceden.io/terms-of-service.pdf";var He=e=>{for(let t of e.instructions)for(let o of t.keys)if(o.isSigner&&o.pubkey.toBase58()===Yi.toBase58())return!0;return!1},pe=e=>{switch(e){case"mainnet-beta":return 101;case"testnet":return 102;case"devnet":return 103;case"localhost":return 101}},wt=e=>new R(e).multipliedBy(w.LAMPORTS_PER_SOL).toNumber();function Et(e){let t=[2,6],o=Tt.safeParse(e);return o.success&&t.includes(o.data)}var ao=lo.Buffer.from("metadata"),hs=lo.Buffer.from("edition"),co=We.toBuffer();function Mc(e){let[t]=w.PublicKey.findProgramAddressSync([ao,co,e],We);return t}function Xi(e){let[t]=w.PublicKey.findProgramAddressSync([ao,co,e,hs],We);return t}function Oc(e){let[t]=w.PublicKey.findProgramAddressSync([ao,co,e],We);return t}s();l();s();l();var oe=(e,t,o,i)=>{(!t||t>=400&&t<500)&&(D.addBreadcrumb(o,JSON.stringify(i),"info"),D.captureError(e,"collectibles"))};s();l();var vt=e=>{let t=!1;return{collectibles:e.reduce((i,n)=>{let r=so.safeParse(n);return r.success?i.push(r.data):t=!0,i},[]),containsParseFailure:t}};var Ts="collectibles",As=new Error("Failed to fetch collectibles for addresses");async function It(e){let t="/collectibles/v1";try{let i=(await k.api().post(t,{addresses:e})).data,n=!!i.isTrimmed;if(!i.collectibles)throw As;let{collectibles:r,containsParseFailure:a}=vt(i.collectibles);return a&&D.captureError(new Error("collectibles failed to parse some items"),"collectibles"),{allCollectibles:r,isTrimmed:n}}catch(o){if(Se(o)){let i=o.response?.status;oe(o,i,Ts)}throw o}}s();l();var Zi=new Error("Failed to fetch spl collectible marketplace stats"),uo=async(e,t,o)=>{let i=`/solana/nft/v1/mint/${e}/stats`,n=new URLSearchParams;n.set("chainId",t.toString()),o&&n.set("pubkey",o);let r;try{r=await k.api().headers({Accept:"application/json"}).get(`${i}?${n.toString()}`)}catch{throw Zi}if(!ye(r))throw Zi;return r.data.stats};s();l();var xs="spl-listings",ws=new Error("Failed to fetch SPL listings"),Pt=async e=>{let t;try{let o=e.chainId.replace("solana:",""),i=e.address,n=new URLSearchParams;n.append("chainId",o);let r=await k.api().headers({Accept:"application/json"}).get(`/solana/nft/v1/pubkey/${i}/listings?${n.toString()}`);if(t=r.status,!ye(r))throw ws;return r.data.filter(m=>!!m.listings?.magic_eden)}catch(o){let i=o instanceof Error?o:new Error("Non-Error was thrown during fetching of spl listings");throw oe(i,t,xs),i}};var Es=U({seconds:10}),vs=U({seconds:5}),Is="CollectibleEdition";function Ps(e,t){return O({queryKey:[Is,{mintAddress:e}],async queryFn(){if(!t)return{};let o=Buffer.from(new w.PublicKey(e).toBytes()),i=Xi(o),{Edition:n}=await ei();try{let r=await n.fromAccountAddress(t,i),a=Tt.safeParse(r.key);if(!a.success)throw new Error(`Invalid MetaplexTokenEdition: ${r.key}`);return{key:a.data,isMasterEdition:Et(r.key)}}catch{return{key:void 0,isMasterEdition:void 0}}}})}var Ds="SPLTokenAccountListingStats";function ks(e,t,o){return O({enabled:t!=="",refetchInterval:Es,gcTime:vs,queryKey:[Ds,{cluster:e,mint:t,pubkey:o}],async queryFn({queryKey:i}){let[,{mint:n,cluster:r}]=i,a=pe(r);return await uo(n,a,o)}})}var Us=async(e,t,o,i,n=20,r=1e3)=>{try{let a=pe(t);return await Be(async()=>{let m=await uo(e,a);if(!m[o])return;let d=(m[o].activities??[]).find(f=>f.signature===i);if(!d)throw new Error("no activity with that signature yet!");return d},()=>!0,n,r)}catch{}},Rs=async(e,t,o,i,n=20,r=1e3)=>{try{let a=pe(o);return await Be(async()=>{let m=await Pt({address:e,chainId:`solana:${a}`});for(let p of m)if(p.listings?.[i]&&p.asset.mintPubKey===t)throw new Error("still in listings");return m},()=>!0,n,r)}catch{}},Ls=async(e,t,o=20,i=1e3)=>{try{return await Be(async()=>{let{allCollectibles:r}=await It(e.map(bt));for(let a of r)if(K(a.chainData)&&a.chainData.mint===t)return a;throw new Error("cant find mint in tokens")},()=>!0,o,i)}catch{}};s();l();var mo=S(T());s();l();s();l();var Bs="collectibles",Ji=new Error("Failed to fetch collectibles details for addresses");async function en(e){let t="/collectibles/v1/collectibles-details",o;try{let i=await k.api().post(t,{addresses:e});if(o=i.status,!ye(i))throw Ji;let n=i.data;if(!n.collectibles)throw Ji;let{collectibles:r,containsParseFailure:a}=vt(n.collectibles);return a&&D.captureError(new Error("collectibles failed to parse some items"),"collectibles"),r}catch(i){let n=i instanceof Error?i:new Error("Non-Error was thrown during fetching of collectibles details");throw oe(n,o,Bs),n}}var tn=async e=>{let t=e.find(d=>E.isSolanaNetworkID(d.chainId));if(!t)throw new Error("no solana account");let{chainId:o}=t,i=await Be(()=>Pt(t),()=>!0),n=i.reduce((d,f)=>({...d,[f.asset.mintPubKey]:f}),{}),r=i.map(d=>({chainId:o,address:d.asset.mintPubKey})),u=Lo(r,100).map(d=>en(d));return(await Promise.all(u)).flat().reduce((d,f)=>{if(!K(f.chainData))return d;let{asset:y,listings:b}=n[f.chainData.mint];return d.push({...f,chainData:{...f.chainData,tokenAccount:y.pubkey},...b?{listings:b}:{}}),d},[])};s();l();s();l();var nn=e=>{let t=[];for(let[o,i]of e){i.sort((r,a)=>{let u=r.name??"",m=a.name??"",p=u.localeCompare(m);if(u.localeCompare(m))return p;let d=on(r),f=on(a);return d.localeCompare(f)});let[n]=i;n&&t.push({..."externalUrl"in n?{externalUrl:n.externalUrl}:void 0,...n.collection,items:i})}return t.sort((o,i)=>{if(o.items.length>i.items.length)return-1;if(i.items.length>o.items.length)return 1;let n=o.name??o.id??"",r=i.name??i.id??"";return n.localeCompare(r)})};function on(e){let t=e.chainData;return K(t)?t.tokenAccount:ne(t)?t.id:(re(t),e.id)}function rn(e){let t=new Map;for(let o of e){let i=o.collection.id,n=t.get(i)??[];n.push(o),t.set(i,n)}return nn(t)}s();l();var sn=(e,t)=>{let o=[],i=new Set,n=[...e,...t];for(let r of n)i.has(r.id)||(o.push(r),i.add(r.id));return o};s();l();s();l();var le="collectibles",po=[le,"collectibleBids"],x={collections:e=>[le,"collections",{addresses:e.map(bt)}],hiddenCollections:e=>[le,"hiddenCollections",e],unhiddenCollections:e=>[le,"unhiddenCollections",e],visibilityOverrides:e=>[le,"visibilityOverrides",e],pinnedCollections:e=>[le,"pinnedCollections",e],optimisticUpdates:()=>[le,"optimisticUpdates"],collectibleBids:e=>[...po,e],collectibleMintGasEstimation:e=>[le,"mintNFTGasEstimation",e],collectibleSellSteps:e=>[le,"collectibleSellSteps",e],createMintTransaction:e=>[le,"createMintTransaction",e],transferTransaction:(e,t,o)=>[le,"transferTransaction",{transferArgs:e,transactionUnitCost:t,utxoState:o}]};var Ms=20;function _e(e,t){let o=x.optimisticUpdates(),i=e.getQueryData(o)??[];e.setQueryData(o,[...i,t])}async function ln(e,t){let o=x.optimisticUpdates(),i=await e.getQueryState(o);if(i){let n=t??Date.now(),r=i.dataUpdatedAt,a=U({seconds:Ms});return n-r>a?(e.removeQueries({queryKey:o}),[]):i?.data??[]}else return[]}function an(e,t){let o=t.reduce((i,n)=>{let{id:r,amount:a}=n,u=new R(a);return i[r]=(i[r]??new R(0)).plus(u),i},{});for(let i of e)i.items=i.items.reduce((n,r)=>{let a=r.id,u=o[a];if(u){let m=new R(r.balance??0);return m.minus(u).isGreaterThan(0)?n.concat({...r,balance:m.minus(u).toString()}):n}else return n.concat(r)},[]);return e=e.filter(i=>i.items.length>0),e}s();l();var ae=(n=>(n[n.Always=1/0]="Always",n[n.Short=U({days:1})]="Short",n[n.Medium=U({days:3})]="Medium",n[n.Long=U({days:7})]="Long",n))(ae||{}),me=(r=>(r[r.Immediate=0]="Immediate",r[r.Short=U({minutes:1})]="Short",r[r.Medium=U({minutes:2.5})]="Medium",r[r.Long=U({minutes:5})]="Long",r[r.Never=1/0]="Never",r))(me||{}),Ze=(u=>(u[u.Shortest=U({seconds:10})]="Shortest",u[u.Shorter=U({seconds:30})]="Shorter",u[u.Short=U({minutes:1})]="Short",u[u.Medium=U({minutes:2.5})]="Medium",u[u.Long=U({minutes:5})]="Long",u[u.Longer=U({minutes:7.5})]="Longer",u[u.Longest=U({minutes:10})]="Longest",u))(Ze||{});var cn=({addresses:e,queryOptions:t={staleTime:me.Short,refetchInterval:Ze.Long},select:o})=>{let i=F(),n=x.collections(e);return O({enabled:e.length!==0&&e.every(r=>!E.isLocalNetworkID(r.networkID)),queryKey:n,gcTime:ae.Medium,staleTime:t.staleTime,refetchInterval:t.refetchInterval,async queryFn({queryKey:[,,{addresses:r}]}){let[a,u]=await Promise.allSettled([tn(r),It(r)]);if(u.status==="rejected")throw new Error("failed to load unlisted collections");let{allCollectibles:m,isTrimmed:p}=u.status==="fulfilled"?u.value:{allCollectibles:[],isTrimmed:!1},d=a.status==="fulfilled"?a.value:[],f=sn(d,m),y=rn(f),b=await ln(i),g=an(y,b);return{items:g,nrOfItems:g.reduce((h,A)=>h+A.items.length,0),isTrimmed:p}},select:o})},Ee=e=>cn({...e,select:(0,mo.useCallback)(t=>t.items,[]),enabled:e.enabled??!0}),Os=e=>cn({...e,select:(0,mo.useCallback)(o=>o.isTrimmed,[])}).data??!1;s();l();s();l();var fo=class extends te{constructor(t){super(t),this.name="GetPinnedCollectionsError"}};async function Dt(e){try{return await e.get("pinnedCollections")}catch{throw new fo("")}}var Co=class extends te{constructor(t){super(t),this.name="SetPinnedCollectionsError"}};async function bo(e,t){try{return await e.set("pinnedCollections",t)}catch{throw new Co("")}}var kt=e=>{let t=N();return O({enabled:e.length!==0,queryKey:x.pinnedCollections(e),gcTime:ae.Long,staleTime:1/0,refetchInterval:!1,refetchOnMount:!0,async queryFn(){try{return(await Dt(t)??{})[e]||[]}catch(o){return o instanceof Error&&D.captureError(o,"collectibles"),[]}}})};s();l();var un=S(T());var Ns=({id:e,addresses:t})=>{let{data:o,isSuccess:i}=Ee({addresses:t});return(0,un.useMemo)(()=>{let r={isSuccess:i,data:void 0};for(let a of o??[])for(let u of a.items)if(u.id===e)return{...r,data:u};return r},[e,o,i])};s();l();var W=S(T());s();l();function Y(e){let t=N();return O({gcTime:ae.Long,staleTime:1/0,enabled:!!e,queryKey:x.visibilityOverrides(e??""),async queryFn(){return e?await fe(t,e):new Map}})}s();l();var Ie=S(T());s();l();function ve(){let e=N(),t=F(),o=H();return ie({async mutationFn({accountId:i,mutations:n}){await $e(e,o,{accountId:i,mutations:n})},async onSuccess(i,{accountId:n}){await t.invalidateQueries({queryKey:x.visibilityOverrides(n)}),await Promise.allSettled([t.invalidateQueries({queryKey:x.hiddenCollections(n)}),t.invalidateQueries({queryKey:x.unhiddenCollections(n)})])}})}async function Rt({collectible:e,visibilityOverrides:t,setVisibilityOverrides:o,accountId:i,desiredVisibility:n,onSuccess:r,onError:a}){if(!t)return;let u=e.collection.id||e.id,m=t.get(u)?.status;try{let p=mn(n,e.collection);await o({accountId:i,mutations:[{id:u,visibility:p}]}),await r({collectible:e,desiredVisibility:n,previousVisibility:m,updatedVisibility:p})}catch(p){await a(p,{collectible:e,desiredVisibility:n})}}async function pn({collection:e,visibilityOverrides:t,setVisibilityOverrides:o,accountId:i,desiredVisibility:n,onSuccess:r,onError:a}){if(!t)return;let u=e.id,m=t.get(u)?.status;try{let p=mn(n,e);await o({accountId:i,mutations:[{id:u,visibility:p}]}),r&&await r({collection:e,desiredVisibility:n,previousVisibility:m,updatedVisibility:p})}catch(p){a&&await a(p,{collection:e,desiredVisibility:n})}}function mn(e,t){let{spamStatus:o}=t;switch(e){case"hidden:reported_spam":if(o==="NOT_VERIFIED"||o==="VERIFIED")return"hidden:reported_spam";if(o==="POSSIBLE_SPAM"||o==="SPAM")return null;throw new Error(`Unexpected spam status: ${o} found while marking spam.`);case"visible:reported_notSpam":if(o==="NOT_VERIFIED"||o==="VERIFIED")return null;if(o==="POSSIBLE_SPAM"||o==="SPAM")return"visible:reported_notSpam";throw new Error(`Unexpected spam status: ${o} found while marking not spam.`);case"hidden":if(o==="NOT_VERIFIED"||o==="VERIFIED")return"hidden";if(o==="POSSIBLE_SPAM"||o==="SPAM")return null;throw new Error(`Unexpected spam status: ${o} found while marking hidden.`);case"visible":if(o==="NOT_VERIFIED"||o==="VERIFIED")return null;if(o==="POSSIBLE_SPAM"||o==="SPAM")return"visible";throw new Error(`Unexpected spam status: ${o} found while marking visible.`)}throw new Error(`Unexpected desired visibility: ${e} found while calculating new visibility.`)}function ge(e){return{networkId:e.chain.id,chainId:E.getChainID(e.chain.id),collectionId:e.collection.id,collectibleId:e.id,collectibleName:e.name,collectibleDescription:e.description,collectionName:e.collection.name,collectionDescription:e.collection.description,collectionUrl:e.collection.externalUrl}}function dn({accountId:e,onError:t,onSuccess:o}){let{data:i}=Y(e),{mutateAsync:n}=ve();return(0,Ie.useCallback)(async r=>{await Rt({collectible:r,visibilityOverrides:i,setVisibilityOverrides:n,accountId:e,desiredVisibility:"hidden:reported_spam",onSuccess:o,onError:t})},[i,n,e,t,o])}function fn({accountId:e,onError:t,onSuccess:o}){let{data:i}=Y(e),{mutateAsync:n}=ve();return(0,Ie.useCallback)(async r=>{await Rt({collectible:r,visibilityOverrides:i,setVisibilityOverrides:n,accountId:e,desiredVisibility:"visible:reported_notSpam",onSuccess:o,onError:t})},[i,n,e,t,o])}function Cn({accountId:e,onError:t,onSuccess:o}){let{data:i}=Y(e),{mutateAsync:n}=ve();return(0,Ie.useCallback)(async r=>{await Rt({collectible:r,visibilityOverrides:i,setVisibilityOverrides:n,accountId:e,desiredVisibility:"hidden",onSuccess:o,onError:t})},[i,n,e,t,o])}function bn({accountId:e,onError:t,onSuccess:o}){let{data:i}=Y(e),{mutateAsync:n}=ve();return(0,Ie.useCallback)(async r=>{await Rt({collectible:r,visibilityOverrides:i,setVisibilityOverrides:n,accountId:e,desiredVisibility:"visible",onSuccess:o,onError:t})},[i,n,e,t,o])}function yn({accountId:e,onError:t,onSuccess:o}){let{data:i}=Y(e),{mutateAsync:n}=ve();return(0,Ie.useCallback)(async r=>{await pn({collection:r,visibilityOverrides:i,setVisibilityOverrides:n,accountId:e,desiredVisibility:"hidden",onSuccess:o,onError:t})},[i,n,e,t,o])}function Sn({accountId:e,onError:t,onSuccess:o}){let{data:i}=Y(e),{mutateAsync:n}=ve();return(0,Ie.useCallback)(async r=>{await pn({collection:r,visibilityOverrides:i,setVisibilityOverrides:n,accountId:e,desiredVisibility:"visible",onSuccess:o,onError:t})},[i,n,e,t,o])}s();l();var yo=S(T());var gn=({toast:e,accountId:t})=>{let{t:o}=L(),i=H(),n=(0,yo.useCallback)(({collectible:a,updatedVisibility:u})=>{u!==null&&i.capture("collectionHidden",{data:ge(a)}),e&&e.success(o("collectionHideSuccess"))},[o,e,i]),r=(0,yo.useCallback)((a,u)=>{e&&e.error(o("collectionHideFail"))},[o,e]);return Cn({accountId:t,onSuccess:n,onError:r})};s();l();var So=S(T());var hn=({toast:e,accountId:t})=>{let{t:o}=L(),i=H(),n=(0,So.useCallback)(({collectible:a,updatedVisibility:u})=>{u!==null&&i.capture("collectionUnhidden",{data:ge(a)}),e&&e.success(o("collectionUnhideSuccess"))},[o,e,i]),r=(0,So.useCallback)((a,u)=>{e&&e.error(o("collectionUnhideFail"))},[o,e]);return bn({accountId:t,onSuccess:n,onError:r})};function Vs({accountId:e,collectible:t,toast:o}){let i=gn({accountId:e,toast:o}),n=(0,W.useCallback)(()=>{if(t)return i(t)},[i,t]),r=hn({accountId:e,toast:o}),a=(0,W.useCallback)(()=>{if(t)return r(t)},[r,t]),{data:u}=Y(e??""),m=(0,W.useMemo)(()=>u?.get(t?.collection.id??t?.id??""),[u,t]),p=(0,W.useMemo)(()=>t?ht(m,{spamStatus:t.collection.spamStatus}):!1,[t,m]),d=(0,W.useCallback)(()=>p?a():n(),[p,n,a]);return(0,W.useMemo)(()=>({isHidden:p,onHideCollectible:n,onUnhideCollectible:a,onToggleHide:d}),[n,d,a,p])}function Fs(e){let{data:t,isPending:o}=Y(e),i=(0,W.useCallback)(a=>{if(!a)return!1;let u=a.collection.id||a.id;return oo(t,{spamStatus:a.collection.spamStatus,key:u})},[t]),n=(0,W.useCallback)(a=>{if(!a)return"NOT_VERIFIED";let u=a.collection.id||a.id;return to(t,{spamStatus:a.collection.spamStatus,key:u})},[t]),r=(0,W.useCallback)(a=>Ye(n(a)),[n]);return(0,W.useMemo)(()=>({getIsHidden:i,getSpamStatus:n,getIsSpam:r,isLoading:o}),[i,n,r,o])}function Tn(e){let{data:t,isPending:o}=Y(e),i=(0,W.useCallback)(a=>{if(!a)return!1;let u=a.id;return oo(t,{spamStatus:a.spamStatus,key:u})},[t]),n=(0,W.useCallback)(a=>{if(!a)return"NOT_VERIFIED";let u=a.id;return to(t,{spamStatus:a.spamStatus,key:u})},[t]),r=(0,W.useCallback)(a=>Ye(n(a)),[n]);return(0,W.useMemo)(()=>({getIsHidden:i,getSpamStatus:n,getIsSpam:r,isLoading:o}),[i,n,r,o])}function An(e){let t=Tn(e),o=yn({accountId:e}),i=Sn({accountId:e});return(0,W.useMemo)(()=>({...t,hideCollection:o,unhideCollection:i}),[t,o,i])}s();l();var xn=S(T());var Hs=({id:e,addresses:t})=>{let{data:o}=Ee({addresses:t});return(0,xn.useMemo)(()=>(o??[]).find(i=>i.id===e),[e,o])};s();l();var wn=S(T()),Lt=(e,t)=>(0,wn.useMemo)(()=>t?e.includes(t):!1,[t,e]);s();l();var Om=e=>`${e/100}%`,En=(e,t)=>e*t/100/100;s();l();var kn=S(Zt()),Pe=S(T());s();l();var _s=c.object({caip19:c.string(),name:c.string(),symbol:c.string()}),In=c.object({bps:c.number(),kind:c.union([c.literal("marketplace"),c.literal("royalty")]),recipient:c.string().optional()}),Ks=c.object({amount:c.number(),feeBreakdown:c.array(In),netAmount:c.number(),token:_s,totalFeeBps:c.number()}),qs=c.object({name:c.string(),logo:c.string(),url:c.string().optional()}),Pn=c.object({id:c.string(),expiration:c.string().optional(),price:Ks,source:qs}),Gs=c.object({bids:c.array(Pn)}),vn=new te("Failed to fetch collectible bids."),Qs="collectible-instant-sell-bids",Ws=async e=>{if(!e.address)throw vn;try{let t=await k.api().validateStatus(!0).post("/collectibles/v1/bids",{asset:e}),{bids:o}=Gs.parse(t.data);return o}catch(t){if(Se(t)){let o=t.response?.status;oe(t,o,Qs)}throw vn}},go=({bidAsset:e,isEnabled:t})=>{let o=t&&e.address!==null&&e.chainId!==null;return O({enabled:o,staleTime:me.Short,refetchInterval:Ze.Shortest,queryKey:x.collectibleBids(e),async queryFn(){return Ws(e)}})},Bt=e=>{let t=e?.chainData,o=e?.chain.id??null,i=ne(t),n=K(t),r=i?{tokenId:t.id}:{},a=n?{contractType:t.standard}:{},u=i?t.contract.toLowerCase():n?t.mint:null;return{chainId:o,address:u,resourceType:"address",...r,...a}};s();l();var js=S(T());var _=c.enum(["auth","nft-approval","sale","order-signature","refetch","blur-swap","update-proof"]),zs=c.enum(["/execute/auth-signature/v1","/order/v3"]),de=c.enum(["transaction","signature","post","refetch"]),$s=c.enum(["eip712","eip191"]),Ys=c.object({domain:c.any(),types:c.any(),value:c.any()}),Xs=c.object({message:c.string()}),Zs=c.object({from:c.string(),to:c.string(),data:c.string()}),Js=c.object({endpoint:zs,body:c.object({id:c.string(),kind:c.string()})}),el=c.object({action:_,chainId:Me,type:c.literal(de.enum.signature),data:c.object({signatureKind:$s,signatureData:c.union([Xs,Ys]),postData:Js})}),tl=c.object({chainId:Me,action:_,data:Zs,type:c.literal(de.enum.transaction)}),ol=c.object({chainId:Me,action:_,type:c.literal(de.enum.refetch),data:c.object({resource:c.string()})}),il=c.union([el,tl,ol]),nl=c.object({action:_,chainId:at,type:c.literal(de.enum.transaction),data:c.object({transaction:c.string()})}),rl=c.union([il,nl]),sl=c.object({steps:c.array(rl),orderId:c.string().optional()}),ll=new te("Failed to fetch collectible sell steps."),al="collectible-instant-sell-steps",cl=async e=>{try{let t=await k.api().validateStatus(!0).post("/collectibles/v1/sell",e);return sl.parse(t.data)}catch(t){if(Se(t)){let o=t.response?.status;if(oe(t,o,al),t.response?.data?.code){let{code:i}=t.response.data;throw{code:i}}if(o)throw t}throw ll}},ho=({sellAsset:e})=>{let t=e.details.orderId!==void 0;return O({enabled:t,queryKey:x.collectibleSellSteps(e),staleTime:1/0,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:(o,i)=>i.code?!1:o<3,async queryFn(){return cl(e)}})};var Dn=(e,t,o)=>{let i=o?.chainData,n=ne(i),r=K(i),a=o?.owner,u=n?a?.toLowerCase():a,m=t?.id,p=t?.source?.name,d=r?{minPrice:t?.price?.netAmount,tokenAccount:i.tokenAccount}:{};return{details:{asset:e,owner:u,orderId:m,marketplace:p,...d}}};s();l();Ae.config({EXPONENTIAL_AT:1e3,DECIMAL_PLACES:78});var Ke=(e,t)=>new Ae(e).div(rt(t)).toNumber();var ul={steps:[],orderId:""},pl=({collectible:e})=>{let{t}=L(),o=(0,Pe.useMemo)(()=>Bt(e),[e]),i=(0,Pe.useMemo)(()=>Un(e),[e]),{data:n=[],isPending:r,isError:a}=go({bidAsset:o,isEnabled:!i}),u=(0,Pe.useMemo)(()=>n.length>0?n[0]:void 0,[n]),m=(0,Pe.useMemo)(()=>Dn(o,u,e),[o,u,e]),{data:p=ul,isPending:d,isError:f,refetch:y,error:b}=ho({sellAsset:m}),g=(0,Pe.useMemo)(()=>u&&e?Rn({t,bid:u,collectible:e}):void 0,[t,u,e]),h=(0,Pe.useMemo)(()=>f?Number.isInteger(b.code):!1,[f,b]);return{bid:u,bidSummary:g,isLoadingBids:r,isErrorBids:a,sellSteps:p,isLoadingSellSteps:d,isErrorSellSteps:f,refetchSellSteps:y,sellStepsError:b,isSellErrorCode:h,isListedOnSolana:i}},ml=({lastSale:e,receiveAmount:t})=>e!==void 0?t-e:t,Un=e=>{if(!e)return!1;let{listings:t,chainData:o}=e,n=(t?Object.keys(t):[]).length>0,r=o?K(o):!1;return n&&r},dl=({offerAmount:e,collectionFloor:t})=>e-t,fl=e=>{let t=Math.abs(e)<.001?"0.0000%":"0.00%",o=(0,kn.default)(e).format(t);return`${e>0?"+":""}${o}`},Cl=e=>{if(e){let{price:t,token:o}=e,i=o?.decimals;if(i)return Ke(t,i)}},bl=e=>{if(e){let{price:t,token:o}=e,i=o?.decimals;if(i)return Ke(t,i)}},yl=e=>{if(!e||!e.previews)return;let{previews:t}=e;if(t.small)return t.small;if(t.medium)return t.medium;if(t.large)return t.large};var Rn=({bid:e,collectible:t,t:o})=>{let{lastSalePrice:i,media:n,name:r,collection:a}=t,{name:u,logo:m}=e.source,{amount:p,netAmount:d,feeBreakdown:f,token:y,totalFeeBps:b}=e.price,{symbol:g,caip19:h}=y,A=0,P=d,j=a.id,M=t.id,G=bl(i),X=g.slice(0,6),v=t.chain.symbol,ue=Cl(a.floorPrice),B=ue?dl({offerAmount:p,collectionFloor:ue}):void 0,Q=B?fl(B):void 0;return{bidTokenSymbol:X,caip19:h,collectionId:j,collectibleId:M,orderId:e.id,collectibleChainId:t.chain.id,collectibleChainSymbol:v,collectionFloor:ue,collectibleImage:yl(n),collectibleName:r??o("collectiblesUnknownCollectible"),collectionName:a.name??o("collectiblesUnknownCollection"),currencySymbol:e.source.name==="Blur"?v:X,fees:f,floorDifference:B,floorDifferencePercent:Q,lastSale:G,marketplace:u,marketplaceLogoURL:m,offerAmount:p,offerAmountFormatted:st(p),phantomFeePercentage:A,pnl:ml({lastSale:G,receiveAmount:P}),receiveAmount:P,receiveAmountFormatted:st(P),totalFeeBps:b}},Sl=({gasFee:e,totalFeeBps:t,offerAmount:o})=>{let i=En(t,o)+e.toNumber();return{raw:i,formatted:st(i)}};s();l();var Ln=new Map([[_.enum["nft-approval"],8e4],[_.enum["blur-swap"],42e3],[_.enum.sale,39e4],["default",42e4]]),hl=(e,t,o,i)=>{let n=e==="Blur",r=o.filter(h=>h.type==="transaction").map(({action:h})=>({action:h}));if(r.some(({action:h})=>h===_.enum["nft-approval"])||(r=[...r,{action:_.enum["nft-approval"]}]),n){let h=r.some(({action:P})=>P===_.enum.sale),A=r.some(({action:P})=>P===_.enum["blur-swap"]);h||(r=[...r,{action:_.enum.sale}]),A||(r=[...r,{action:_.enum["blur-swap"]}])}let u=r?.reduce((h,{action:A})=>{let P=Ln.get(A)??Ln.get("default");return h+(P??0)},0),m=new R(u),{status:p,data:d}=wi({gasLimit:m,networkID:t,transactionSpeed:"standard"}),{data:f}=vi(t,d),y=ri(d),b=Number(y?.replace(/[^\d.]/g,"")??0),g=i?i.isGreaterThan(b):!1;return{gasEvm:b,gasEstimation:d,gasEstimationStatus:p,ethFeeUI:y,gasEstimationPrice:f,hasEnoughGas:g}};s();l();var Ce=S(T());s();l();var Mt=(e,t)=>{e.invalidateQueries({queryKey:po}),e.invalidateQueries({predicate:({queryKey:o})=>o.includes("collectibleSellSteps")&&o[2].details.orderId===t?.orderId})};var wl=()=>{let{data:e}=Ve();return(0,Ce.useMemo)(()=>{let o=e?.type,i=e?.name??"",n=e?.addresses??[],r=e?.identifier??"";return{isLedger:e?.type==="ledger",accountName:i,accountType:o,chainAddresses:n,accountIdentifier:r}},[e])},El=({networkID:e,unsignedTransaction:t,pendingActivityRows:o,accountIdentifier:i,accountSigner:n,storage:r,includeCallPayload:a})=>({accountSigner:n,accountIdentifier:i,networkID:e,unsignedTransaction:t,...a&&{callPayload:{from:t.from,to:t.to,data:t.data,value:t.value}},pendingTransactionInput:{ownerAddress:t.from,networkID:e,data:{nonce:"",unsignedTransaction:t,hash:""},type:"sell",display:{summary:o}},storage:r}),vl=async(e,t,o,i,n,r,a)=>{try{if(!o)throw new Error("Gas estimation is required");if(!a)throw new Error("Bid summary is required");let{data:u,chainId:m,action:p}=t,{collectionName:d,marketplace:f,receiveAmount:y,currencySymbol:b,collectibleChainSymbol:g,bidTokenSymbol:h}=a,A=nt(f),P={};p==="nft-approval"&&(P={topRight:{text:""},bottomRight:{text:""},topLeft:{text:e("collectiblesApproveCollection",{collectionName:d})},bottomLeft:{text:A}}),p==="sale"&&(P={topRight:{text:`+${y} ${b}`},topLeft:{text:e("collectiblesSoldCollectible")},bottomRight:{text:`-${d}`},bottomLeft:{text:A}}),p==="blur-swap"&&(P={topRight:{text:`+${y} ${g}`},topLeft:{text:e("transactionsSwapped")},bottomRight:{text:`-${y} ${h}`},bottomLeft:{text:A}});let j=Re.parse({type:"0x2",to:u.to,from:u.from,data:u.data,chainId:E.getEVMNetworkIDValue(m),gas:`0x${o.gasLimit.toString(16)}`,maxFeePerGas:`0x${o.maxFeePerGas.toString(16)}`,maxPriorityFeePerGas:`0x${o.maxPriorityFeePerGas.toString(16)}`}),M=El({storage:i,accountSigner:n,pendingActivityRows:P,includeCallPayload:!1,networkID:m,unsignedTransaction:j,accountIdentifier:r.accountIdentifier}),G=await ci(M);return{type:t.type,data:G}}catch(u){return{type:t.type,error:u}}},Il=async(e,t,o)=>{try{let{chainId:i,data:n}=e,{signatureData:r,signatureKind:a,postData:u}=n;if(a==="eip191"&&"message"in r){let m=await t.sign(o.accountIdentifier,{signingType:"message",chainType:"eip155",message:r.message});if(m.status==="success")return await k.api().post("/collectibles/v1/submit-signature",{chainId:i,signature:m.signature,postData:u}),{type:e.type,data:"success"};throw new Error("Execute Sell: Couldn't sign message")}throw new Error("Execute Sell: EIP721 is not yet supported")}catch(i){return{type:e.type,error:i}}},Pl=async(e,t)=>{try{let{resource:o}=e.data;if(o==="/sell"){let{data:i}=await t();return{type:e.type,data:i?.steps}}throw new Error("Execute Sell: Resource is not supported")}catch(o){return{type:e.type,error:o}}},Dl=[_.enum.auth,_.enum["nft-approval"],_.enum.sale],kl="Steps are required",Ul="These steps are not from the same bid",Ot=class extends Error{message=kl},Nt=class extends Error{message=Ul},Rl=(e,t,o,i,n,r,a)=>{let u=N(),m=H(),p=F(),d=Ne(),[f,y]=(0,Ce.useState)("idle"),[b,g]=(0,Ce.useState)(null),[h,A]=(0,Ce.useState)(null),{t:P}=L(),j=wl(),{chainAddresses:M,isLedger:G}=j;(0,Ce.useEffect)(function(){f==="loading"&&Mt(p,n)},[f,p,n]),(0,Ce.useEffect)(function(){f==="success"&&n&&_e(p,{id:n.collectibleId,amount:1})},[f,p,M,n]);let X=()=>{y("idle"),g(null),A(null)},v=a&&n?.receiveAmount?n.receiveAmount*a:void 0,ue=async(B,Q=new Map)=>{let V=B??t;try{if(e&&e!==""&&e!==n?.orderId)throw new Nt;if(!Array.isArray(V)||V.length===0)throw new Ot;y("loading");for await(let z of V){let{action:J}=z,zr=Q.get(J)==="success",$r=J===_.enum.sale,Do=J===_.enum.refetch,Yr=Dl.some(Ue=>Ue===J);if(zr)continue;Do||Q.set(J,"loading");let Xr=async Ue=>{switch(Ue.type){case de.enum.transaction:return await vl(P,Ue,o,u,d,j,n);case de.enum.signature:return await Il(Ue,d,j);case de.enum.refetch:return await Pl(Ue,i)}},{type:ko,data:Yt,error:Uo}=await Xr(z);if(Yr&&Uo)throw Uo;if(Yt&&(Do||Q.set(J,"success"),ko===de.enum.transaction&&$r&&A(Yt),ko===de.enum.refetch))return await Oo(500),await ue(Yt,Q)}y("success"),m.capture("collectibleSellSuccess",{data:{bidSummary:n,usdSaleValue:v}})}catch(z){let J=z?.message??"";(!(z instanceof Ot)||!(z instanceof Nt))&&(D.captureError(z,"collectibles"),m.capture("collectibleSellFailure",{data:{bidSummary:n,usdSaleValue:v,errorMessage:J}})),y("error"),g(z)}};return{executeSellEvmSteps:ue,reset:X,error:b,result:h,status:f,isLedger:G}};s();l();var ce=S(T());var Ll=()=>{let{data:e}=Ve();return(0,ce.useMemo)(()=>{let o=e?.identifier??"",i=e?.type==="ledger",n=e?.addresses??[],r=n.find(Go),a=r?.networkID,u=r?.address??"",m=li(a),p=si(m);return{accountIdentifier:o,chainAddresses:n,chainId:a,solanaPublicKey:u,isLedger:i,cluster:m,connection:p}},[e])},Bl=(e,t)=>{let[o,i]=(0,ce.useState)(void 0);return(0,ce.useEffect)(()=>{(async()=>{if(!e)return;let a=e.find(d=>d.type==="transaction")?.data?.transaction;if(!a)return;let u=Xt(a,"base64"),m=await fi(t,[u.message]),p=Ro(m.value);i(p)})()},[e,t]),o},Ml=async(e,t,o,i,n,r)=>{if(!r)throw new Error("Bid summary is required");let{collectionName:a,marketplace:u,receiveAmount:m,currencySymbol:p}=r,d={topRight:{text:`+${m} ${p}`},topLeft:{text:e("collectiblesSoldCollectible")},bottomRight:{text:`-${a}`},bottomLeft:{text:nt(u)}},{data:f,chainId:y,type:b}=t,{transaction:g}=f,h=Xt(g,"base64"),A={ownerAddress:o.solanaPublicKey,networkID:y,data:{signature:""},type:"sell",display:{summary:d}},{accountIdentifier:P,solanaPublicKey:j,connection:M}=o,G=new w.PublicKey(j),X=await bi({accountIdentifier:P,feePayer:G,transaction:h,pendingTransactionInput:A,connection:M,accountSigner:i,storage:n,opts:{skipPreflight:!0}});return{type:b,data:X}},Ol="Steps are required",Nl="These steps are not from the same bid",Vt=class extends Error{message=Ol},Ft=class extends Error{message=Nl},Vl=(e,t,o,i)=>{let n=N(),r=H(),a=F(),u=Ne(),[m,p]=(0,ce.useState)("idle"),[d,f]=(0,ce.useState)(null),[y,b]=(0,ce.useState)(null),{t:g}=L(),h=Ll(),{chainId:A,connection:P,chainAddresses:j,isLedger:M}=h,G=A&&E.isSolanaNetworkID(A)?A:Oe.Solana.Mainnet,X=Bl(t,G);(0,ce.useEffect)(function(){m==="loading"&&Mt(a,o)},[m,a,o]),(0,ce.useEffect)(function(){m==="success"&&o&&_e(a,{id:o.collectibleId,amount:1})},[m,a,j,o]);let v=()=>{p("idle"),f(null),b(null)},ue=i&&o?.receiveAmount?o.receiveAmount*i:void 0;return{executeSellSolanaSteps:async()=>{try{if(e&&e!==o?.orderId)throw new Ft;if(!Array.isArray(t)||t.length===0)throw new Vt;p("loading");for await(let Q of t){let V=await Ml(g,Q,h,u,n,o);b(V.data),await Ci({connection:P,signature:V.data})}p("success"),r.capture("collectibleSellSuccess",{data:{bidSummary:o,usdSaleValue:ue}})}catch(Q){let V=Q?.message??"";(!(Q instanceof Vt)||!(Q instanceof Ft))&&(D.captureError(Q,"collectibles"),r.capture("collectibleSellFailure",{data:{bidSummary:o,usdSaleValue:ue,errorMessage:V}})),p("error"),f(Q)}},reset:v,gas:X,error:d,result:y,status:m,isLedger:M}};s();l();var Fl=.01,Hl=e=>{let{fungible:t}=Bi({key:Mi(e.collectibleChainId,void 0)}),o=t?.data.balance;return{hasEnoughGas:o?o.isGreaterThan(Fl):!1}};s();l();var On=S(T()),_l=e=>e.reduce((t,o)=>({...t,[o]:1}),{});function To({allCollections:e=[],pinnedCollectionIds:t=[],getIsHidden:o,getIsSpam:i}){let n=[],r=[],a=[],u=[],m=_l(t),p={};for(let f of e)i(f)&&o(f)?u.push(f):o(f)?r.push(f):m[f.id]?p[f.id]=f:i(f)?a.push(f):n.push(f);let d=[];for(let f of t)p[f]&&d.push(p[f]);return{collections:[...d,...n,...a],hiddenCollections:r,spamCollections:u}}var Kl=({allCollections:e=[],pinnedCollectionIds:t=[],getIsHidden:o,getIsSpam:i})=>(0,On.useMemo)(()=>To({allCollections:e,pinnedCollectionIds:t,getIsHidden:o,getIsSpam:i}),[e,o,i,t]);s();l();var Ht=S(T()),Ao={location:0,distance:50,threshold:.3},Pf={...Ao,keys:["name"]},Df={...Ao,keys:["name"]},kf={...Ao,keys:["name"]},Je=(e,t)=>{if(t===void 0)return!1;let o=e.toLowerCase();return t.toLowerCase().split(" ").map(i=>i.startsWith(o)||o.startsWith(i)&&t.toLowerCase().includes(o)).includes(!0)};var Nn=(e,t)=>(0,Ht.useMemo)(()=>({collections:e.filter(i=>Je(t,i.name||i.items[0].name))}),[t,e]),ql=(e,t,o,i)=>{let n=(0,Ht.useMemo)(()=>e.flatMap(r=>r.items),[e]);return(0,Ht.useMemo)(()=>{let r=e.filter(p=>Je(i,p.name)),a=n.filter(p=>Je(i,p.name)),u=t.filter(p=>Je(i,p.name)),m=o.filter(p=>Je(i,p.name));return{collections:r,collectibles:a,hiddenCollections:u,spamCollections:m}},[i,n,e,t,o])};s();l();var he=S(T());var Gl=U({seconds:10}),Ql=U({seconds:5});function Wl({account:e}){let t=e?.identifier??"",o=e?.addresses??[],{data:i=[],isLoading:n}=Ee({addresses:o,queryOptions:{staleTime:Ql,refetchInterval:Gl}}),[r,a]=(0,he.useState)(""),u=Vo(r)??"",m=(0,he.useCallback)(M=>a(typeof M=="string"?M:M.currentTarget.value),[a]),{getIsHidden:p,getIsSpam:d,getSpamStatus:f,hideCollection:y,unhideCollection:b,isLoading:g}=An(t),h=(0,he.useMemo)(()=>{let{collections:M,hiddenCollections:G,spamCollections:X}=To({allCollections:i,getIsHidden:p,getIsSpam:d});return[...M,...G,...X]},[i]),A=Nn(h,u),P=(0,he.useCallback)(({item:M,status:G})=>G==="show"?b(M):y(M),[b,y]);return{viewState:(0,he.useMemo)(()=>({accountId:t,listItems:u?A.collections:h,searchQuery:r,debouncedSearchQuery:u,handleSearch:m,getIsHidden:p,getIsSpam:d,getSpamStatus:f,onToggleHidden:P}),[t,A.collections,r,m,h,P,p,d,f,u]),viewStateLoading:g||n}}s();l();var Vn={listCollectible:null,listCollectiblePrice:null,editListCollectiblePrice:null,unlistCollectible:null,transactionURL:null},be=mt(e=>({...Vn,reset:()=>e({...Vn}),setListCollectible:t=>e({listCollectible:t}),setListPrice:t=>e({listCollectiblePrice:t}),setEditListPrice:t=>e({editListCollectiblePrice:t}),setUnlistCollectible:t=>e({unlistCollectible:t}),setTransactionURL:t=>e({transactionURL:t})}));s();l();var q=S(Jr());var jl="token-account-min-balances",Fn=q.struct([q.blob(32,"mint"),q.blob(32,"owner"),q.nu64("amount"),q.blob(93)]),$f=q.struct([q.blob(44),q.u8("decimals"),q.blob(37)]),zl=q.struct([q.blob(679)]),$l=q.struct([q.u8("edition"),q.blob(281)]),Yl=async e=>e.getMinimumBalanceForRentExemption(Fn.span).then(R),Xl=async e=>R(await e.getMinimumBalanceForRentExemption(zl.span)+await e.getMinimumBalanceForRentExemption($l.span)+await e.getMinimumBalanceForRentExemption(Fn.span));function Zl({tokenEdition:e,connection:t}){return O({queryKey:[jl,{tokenEdition:e}],queryFn:async()=>t?e===null||!Et(e)?Yl(t):Xl(t):R(0)})}s();l();var Hn=S(T()),Jl=(e,t,o=!1,i)=>(0,Hn.useMemo)(()=>{if(e)return _t({collectibleMedia:e,isImageAnimationEnabled:o,previewSize:i??"medium",mediaTypeOverride:t})},[e,t,o,i]),_t=({collectibleMedia:e,isImageAnimationEnabled:t,previewSize:o,mediaTypeOverride:i})=>{let n=i??e.type;if((n==="image"||n==="other")&&e.previews?.[o]){let a=t?"":`${o==="medium"?"=":"-"}k`;return`${e.previews[o]}${a}`}return e[n]?.url};s();l();var _n=S(T());var ea=!1,ta="small",oa="image",ia=e=>(0,_n.useMemo)(()=>Kn(e),[e]),Kn=(e,t=ta)=>{if(!e)return;let{media:o,collection:i}=e,n=ea,r=oa;return o?_t({collectibleMedia:o,isImageAnimationEnabled:n,previewSize:t,mediaTypeOverride:r}):i.imageUrl};s();l();var qn=S(T()),Gn=e=>{let{items:t}=e;if(t.length!==0)return t.find(({media:o})=>o?.type==="image")},na=e=>(0,qn.useMemo)(()=>{if(e)return Gn(e)??e.items[0]},[e]);s();l();var Qn=S(T());var ra=e=>(0,Qn.useMemo)(()=>{if(!(!e||e.items.length===0))return Wn(e)},[e]),Wn=e=>{let{items:t}=e,{length:o}=t;if(o===1){let[{balance:i="",chainData:n}]=t;if(K(n)&&n.standard==="SemiFungible"){let r=parseInt(i,10);return isNaN(r)?1:r}}return o};s();l();s();l();var jn={burnCollectibleTx:void 0,burnCollectibleTxFee:void 0},zn=e=>({...jn,resetBurnCollectible:()=>e({...jn}),setBurnCollectibleTx:t=>e({burnCollectibleTx:t}),setBurnCollectibleTxFee:t=>e({burnCollectibleTxFee:t})});s();l();var $n={multichainSellCollectible:void 0},Yn=e=>({...$n,resetMultichainSellCollectible:()=>e({...$n}),setMultichainSellCollectible:t=>e({multichainSellCollectible:t})});s();l();var Xn={listCollectible:null,listCollectiblePrice:null,editListCollectiblePrice:null,unlistCollectible:null,transactionURL:null},Zn=e=>({...Xn,reset:()=>e({...Xn}),setListCollectible:t=>e({listCollectible:t}),setListPrice:t=>e({listCollectiblePrice:t}),setEditListPrice:t=>e({editListCollectiblePrice:t}),setUnlistCollectible:t=>e({unlistCollectible:t}),setTransactionURL:t=>e({transactionURL:t})});s();l();var Jn={multichainListCollectible:null,multichainListCollectiblePrice:null,editMultichainListCollectiblePrice:null,unlistMultichainCollectible:null,multichainTransactionURL:null},er=e=>({...Jn,reset:()=>e({...Jn}),setMultichainListCollectible:t=>e({multichainListCollectible:t}),setMultichainListPrice:t=>e({multichainListCollectiblePrice:t}),setEditMultichainListPrice:t=>e({editMultichainListCollectiblePrice:t}),setUnlistMultichainCollectible:t=>e({unlistMultichainCollectible:t}),setMultichainTransactionURL:t=>e({multichainTransactionURL:t})});var sa=mt((e,t)=>({...Zn(e,t),...zn(e,t),...er(e,t),...Yn(e,t)}));s();l();s();l();var la=500,tr=x.collections([])[1],aa=[tr,x.hiddenCollections("")[1],x.unhiddenCollections("")[1],x.pinnedCollections("")[1]],ca=e=>{let t=String(e.queryKey[1]);return t===tr?e.state.data?.nrOfItems<=la:aa.includes(t)};s();l();var ar=S(T());s();l();s();l();s();l();var or="#F7931A",ua=5e4,pa="https://help.magiceden.io/en/articles/8450002-mastering-utxo-management-extracting-splitting-sats-on-magic-eden-bitcoin",ir={sendSuccessCondition:"SUBMISSION",collectibleDetailPrecision:7,collectibleDetailCtaBanner:(e,t)=>{let o=e.chainData;if(xt(o)&&t){let i=new R(o.utxoDetails.value??0);if(i.lte(ua))return;let n=Object.values(o.utxoDetails.satributes).reduce((m,{count:p})=>m+p,0),r=Jt(n,E.bitcoin.tokenDecimals),a=Jt(i,E.bitcoin.tokenDecimals),u=Fo(a.minus(r).times(t));return{title:Z.t("collectibleDetailUtxoSplitterCtaTitle"),subtitle:Z.t("collectibleDetailUtxoSplitterCtaSubtitle",{value:u}),iconFill:or,modal:{title:Z.t("collectibleDetailUtxoSplitterModalCtaTitle"),subtitle:Z.t("collectibleDetailUtxoSplitterModalCtaSubtitle",{value:u}),buttonText:Z.t("collectibleDetailUtxoSplitterModalCtaButton"),uri:pa,iconFill:or}}}}};s();l();var et={sendSuccessCondition:"CONFIRMATION",collectibleDetailPrecision:5,collectibleDetailCtaBanner:void 0};s();l();var nr={sendSuccessCondition:"CONFIRMATION",collectibleDetailPrecision:5,collectibleDetailCtaBanner:void 0};var ma=new zo({solana:nr,ethereum:et,polygon:et,base:et,monad:et,bitcoin:ir,sui:{}}),De=jo(ma);s();l();var lr=S(T());s();l();var rr=S(Zt()),sr=({value:e,type:t})=>{if(!e)return"";try{switch(t){case"number":return(0,rr.default)(e).format("0,0.[00]").toString();case"date":return new Date(Number(e)).toLocaleDateString();default:return`${e}`}}catch{return`${e}`}};var wo=e=>(0,lr.useMemo)(()=>{if(!e)return[];let t=e.chainData;return re(t)&&t.utxoDetails?t.utxoDetails.satributes.map(({count:o,displayName:i,description:n,url:r})=>({type:i.toUpperCase(),value:Z.t(da(o,"collectibleDetailSatsCount_one","collectibleDetailSatsCount_other"),{count:o})??"",modal:{name:i,description:n,iconUrl:r}})):e.attributes.map(({trait_type:o,value:i,display_type:n})=>({type:o,value:sr({value:i,type:n})}))},[e]),da=(e,t,o)=>e===1?t:o;function fa(e){let{chain:t,owner:o}=e||{},i=t?.id,{data:n}=pt({address:o,networkID:i});Di(n);let r=wo(e),a=i?E.getChainID(i):void 0,u=a?Wo(a):void 0,{data:m}=Ei({query:u?{data:u}:void 0});return{ctaBanner:(0,ar.useMemo)(()=>{if(!(!e||!m||!a))return De.get(a).collectibleDetailCtaBanner?.(e,m.price)},[a,e,m]),traits:r}}s();l();var kr=S(T());s();l();function Ca(e,t,o){let i=t.collectible;if(!i||!t.sendFormValues)throw new Error("State is missing necessary data");let{decimals:n="0"}=i,r=parseFloat(n),a=i.chainData,{mint:u,standard:m,tokenAccount:p,compression:d}=a,{amountAsset:f}=t.sendFormValues,y={networkID:i.chain.id,addressType:"solana",address:i.owner??""},b=Li(i);switch(m){case"NonFungible":case"NonFungibleEdition":case"ProgrammableNonFungible":case"ProgrammableNonFungibleEdition":return{type:"transferSPLToken",networkID:e,senderAddress:y,destination:o,amount:"1",senderAccount:p,mint:u,decimals:r,standard:m,compression:d,programId:a.programId,transferHookProgramId:b};case"SemiFungible":return{type:"transferSPLToken",networkID:e,senderAddress:y,destination:o,amount:f.isZero()?"1":f.toString(),senderAccount:p,mint:u,decimals:r,standard:m,programId:a.programId,transferHookProgramId:b};default:throw new Error("Unknown fungible token type")}}function ba(e,t,o){let i=t.collectible;if(!i||!t.sendFormValues)throw new Error("State is missing necessary data");let{chainData:n}=i,{id:r,contract:a,standard:u}=n,{amountAsset:m}=t.sendFormValues,p={networkID:i.chain.id,addressType:"eip155",address:i.owner??""};switch(u){case"ERC721":return{type:"transferERC721Evm",networkID:e,senderAddress:p,destination:o,amount:1,contractAddress:a,tokenID:r};case"ERC1155":return{type:"transferERC1155Evm",networkID:e,senderAddress:p,destination:o,amount:m??"1",contractAddress:a,tokenID:r};default:throw new Error("Unknown fungible token type")}}function ya(e,t,o){let i=t.collectible;if(!i||!i.owner||!t.sendFormValues)throw new Error("State is missing necessary data");let{chainData:n}=i,{firstCreatedInscriptionId:r,utxoDetails:a,outputValue:u,utxoHash:m,utxoIndex:p}=n,d;if(a)d={type:"raresats",networkID:e,hash:a.hash,index:a.index,value:a.value.toString(),senderAddress:i.owner,destination:o,amount:1};else if(m&&p!==void 0)d={type:"ordinal",networkID:e,inscriptionId:r,value:u,amount:1,senderAddress:i.owner,destination:o,utxoHash:m,utxoIndex:p};else throw new Error(`Unable to determine transfer type for collectible: ${i.id}`);return d}function cr(e,t){let o=e?.collectible?.chain.id;if(o){if(E.isBitcoinNetworkID(o))return ya(o,e,t);if(E.isSolanaNetworkID(o))return Ca(o,e,t);if(E.isEVMNetworkID(o))return ba(o,e,t);if(E.isSuiNetworkID(o))throw new _o("create transfer args");return Le(o)}}s();l();s();l();s();l();var ur=S(lt()),pr=S(lt()),mr=S(Ho()),dr=({value:e,senderAddress:t,destination:o,utxoState:{safeToSendUtxos:i},feerate:n,utxoHash:r,utxoIndex:a})=>{let u={transactionHash:r,index:a,value:e,isSafeToSend:!1,owner:t},m=[u],p=[{address:o,value:parseFloat(u.value),script:(0,mr.toOutputScript)(o)}],d=yt(ut(Oe.Bitcoin.Mainnet,t),i,p,n,m),f=new pr.Psbt({network:ur.networks.bitcoin});if(d.type==="success"){let{inputs:y,outputs:b}=d;f.addInputs(y.map(g=>St(g,t,!0))),f.addOutputs(b)}return[f,f.data.inputs.map((y,b)=>({address:t,signingIndexes:[b]})),d.vb]};s();l();var fr=S(lt()),Cr=S(lt()),br=S(Ho()),yr=({hash:e,index:t,value:o,senderAddress:i,destination:n,utxoState:{safeToSendUtxos:r},feerate:a})=>{let u={index:t,transactionHash:e,value:o,isSafeToSend:!1,owner:i},m=[u],p=[{address:n,value:parseFloat(u.value),script:(0,br.toOutputScript)(n)}],d=yt(ut(Oe.Bitcoin.Mainnet,i),r,p,a,m),f=new Cr.Psbt({network:fr.networks.bitcoin});if(d.type==="success"){let{inputs:b,outputs:g}=d;f.addInputs(b.map(h=>St(h,i,!0))),f.addOutputs(g)}let y=f.data.inputs.map((b,g)=>({address:i,signingIndexes:[g]}));return[f,y,d.vb]};function Sr(e,t,o){let i,n,r,a=o,u=Math.round(a?ii(a.btcPerKilobyte).toNumber():oi);if(zi(e))[i,n,r]=dr({...e,utxoState:t,feerate:u});else if($i(e))[i,n,r]=yr({...e,utxoState:t,feerate:u});else return Le(e);return{networkID:e.networkID,psbt:i,vb:r,psbtChain:void 0,inputsToSign:n}}s();l();s();l();var Sa=["function safeTransferFrom(address from, address to, uint256 tokenId)","function transferFrom(address from, address to, uint256 tokenId)"],gr=new Error("Error populating ERC721 transaction data."),hr=async e=>{let{sender:t,networkID:o,destination:i,contractAddress:n,tokenID:r,ethereumNetworkID:a}=e,u=ft(o,n,Sa,t),m;try{let d=await u.populateTransaction.safeTransferFrom(t,i,new R(r).toString(10));if(d.data)m=d.data;else throw gr}catch{throw gr}return Re.parse({type:"0x2",from:t,to:n,chainId:typeof a=="number"?a:E.getEVMNetworkIDValue(a),data:m})};s();l();var ga=["function safeTransferFrom(address from, address to, uint256 id, uint256 amount, bytes data)","function transferFrom(address from, address to, uint256 id, uint256 amount, bytes data)"],Tr=new Error("Error populating ERC1155 transaction data."),Ar=async e=>{let{sender:t,networkID:o,destination:i,contractAddress:n,tokenID:r,value:a,ethereumNetworkID:u}=e,m=ft(o,n,ga,t),p;try{let f=await m.populateTransaction.safeTransferFrom(t,i,new R(r).toString(10),a.toString(10),[]);if(f.data)p=f.data;else throw Tr}catch{throw Tr}return Re.parse({type:"0x2",from:t,to:n,chainId:typeof u=="number"?u:E.getEVMNetworkIDValue(u),data:p})};async function xr(e){let t;if(qi(e)){let{networkID:o,senderAddress:i,destination:n,contractAddress:r,tokenID:a}=e;t=await hr({sender:i.address,networkID:o,destination:n,contractAddress:r,tokenID:a,value:1,ethereumNetworkID:o})}else if(Gi(e)){let{networkID:o,senderAddress:i,destination:n,contractAddress:r,tokenID:a,amount:u}=e;t=await Ar({sender:i.address,networkID:o,destination:n,contractAddress:r,tokenID:a,value:typeof u=="string"?new R(u,10):u,ethereumNetworkID:o})}else return Le(e);return{networkID:e.networkID,unsignedTransaction:t}}s();l();s();l();s();l();var Kt=class extends Error{constructor(t){super(t),this.name="ProofError"}};async function wr({networkID:e,mintAddress:t}){let o="/collectibles/v1/proof",i;try{i=await k.api().post(o,{chainId:e,address:t})}catch{let r=new Kt(`Failed to fetch proof for ${t} on network ${e}.`);throw D.captureError(r,"collectibles"),r}if(i.status!==200){let r=new Kt(`Failed to fetch proof for ${t} on network ${e}.`);throw D.captureError(r,"collectibles"),r}return await i.data}async function Er(e){let{senderAddress:t,mint:o}=e,i=new ee.Transaction,n=await wr({networkID:t.networkID,mintAddress:o});return i.add(await Jo({...e,...n})),i}s();l();async function vr({networkID:e,destination:t,mint:o,senderAddress:i}){let{createComputeBudgetIx:n,createOCPTransferIX:r,getOCPMintState:a}=await dt(),u=Fe(e),m=new w.PublicKey(o),p=await a(m,u);if(!p)throw new Error("Mint state not found for OCP transfer");it()&&console.log("This is a Magic Eden Open Creator Protocol Token");let d=new ee.Transaction;d.add(n());let{destinationAddress:f}=await gt({solanaConnection:u,destination:new w.PublicKey(t),mint:m,programId:je}),y=new w.PublicKey(i.address),{initAccountIX:b,transferIX:g}=await r({senderAddress:y,destinationAddress:f,mintAddress:m,mintState:p,connection:u});return b&&d.add(b),d.add(g),d}s();l();async function Ir({networkID:e,senderAddress:t,senderAccount:o,destination:i,mint:n}){let r=Fe(e),a=new w.PublicKey(n),{destinationAddress:u,destinationAccount:m}=await gt({solanaConnection:r,destination:new w.PublicKey(i),mint:a,programId:je}),{createPNFTTransferIX:p}=await dt(),d=new ee.Transaction,f=new w.PublicKey(t.address),y=new w.PublicKey(o),b=m;if(!b){let[g,h]=await pi(f,u,a,je);d.add(ui({account:u,owner:w.SystemProgram.programId})),d.add(g),b=h}return d.add(await p({senderAddress:f,tokenAccount:y,destinationAddress:u,destinationAccount:b,mintAddress:a,connection:r})),d}async function Pr(e){let{networkID:t,mint:o}=e,i=Fe(t),n;if(Qi(e))n=await Er(e);else if(Wi(e))n=await Ir(e);else if(ji(e)&&await ti(new w.PublicKey(o),i))n=await vr({...e});else if(ni(e))n=await di({...e,connection:i});else throw new Error("Unsupported transferSPLSolana args");let{memo:r}=e;return r&&n.add(mi({memoText:r})),n.feePayer=new w.PublicKey(e.senderAddress.address),n=await ai(n,{connection:i}),n.recentBlockhash=(await i.getLatestBlockhash("confirmed")).blockhash,{networkID:e.networkID,transaction:[n]}}async function Dr(e,t,o){if(ha(e))return Pr(e);if(Ta(e))return xr(e);if(Aa(e)){if(!t)throw new Error("Missing utxo state for Bitcoin transaction.");return Sr(e,t,o)}else throw new Error(`Unsupported transaction type: ${JSON.stringify(e)}`)}var ha=e=>E.isSolanaNetworkID(e.networkID),Ta=e=>E.isEVMNetworkID(e.networkID),Aa=e=>E.isBitcoinNetworkID(e.networkID);var xa="collectible-transfer-tx",wa=U({seconds:30});function Ea(e){let{data:t}=Ve(),o=ki(e?.sendFormValues?.recipient,e?.collectible?.chain.id)??"",i=(0,kr.useMemo)(()=>{if(t)return cr(e,o)},[t,e,o]),n=e?.collectible?.owner,{data:r}=pt({address:n,networkID:i?.networkID}),{data:a}=Pi(r),u=e?.sendFormValues.transactionSpeed??"standard",{data:m}=xi({networkID:i?.networkID,enableFallback:!0}),p=m?m[u]:void 0;return O({staleTime:wa,enabled:va(i,a),queryKey:x.transferTransaction(i,p,a),async queryFn(){if(i)try{return await Dr(i,a,p)}catch(d){if(Se(d)){let f=d.response?.status;oe(d,f,xa,{})}throw d}}})}function va(e,t){return!e||E.isBitcoinNetworkID(e.networkID)&&!t?!1:!new Ae(e.amount).isNaN()}s();l();var qt=e=>{let t=N();return O({enabled:e.length!==0,queryKey:x.hiddenCollections(e),gcTime:ae.Long,staleTime:1/0,async queryFn(){try{let o=await fe(t,e);return Array.from(o.values()).filter(i=>ht(i,{spamStatus:"NOT_VERIFIED"})).map(({id:i})=>i)}catch(o){return o instanceof Error&&D.captureError(o,"collectibles"),[]}}})};s();l();s();l();var Ur=S(T());var Ia=e=>{let t=F();return(0,Ur.useCallback)(()=>t.invalidateQueries({queryKey:x.collections(e)}),[t,e])};s();l();var Pa=2e3,Gt=class extends te{constructor(t){super(t),this.name="UsePinCollectionError"}};function Qt(){let e=N(),t=F();return ie({async mutationFn({collectionId:o,accountId:i,pinned:n}){let r=await Dt(e)??{},a=r[i]??[];if(n){if(Object.values(r).flat().length+1>Pa)throw new Gt("Pinned limit reached");let m=[...new Set([...a,o])],p={...r,[i]:m};await bo(e,p)}else{let u=a.indexOf(o);if(u===-1)throw new Gt("Collection not previously pinned");let m=[...a];m.splice(u,1);let p={...r,[i]:m};await bo(e,p)}},async onSuccess(o,i){await t.invalidateQueries({queryKey:x.pinnedCollections(i.accountId)})}})}s();l();var Rr=S(T());var Da=e=>{let t=F();return(0,Rr.useCallback)(()=>t.refetchQueries({queryKey:x.collections(e)}),[t,e])};s();l();s();l();var ka=new Error("Failed to report event for collectible");async function Lr(e){try{let t=await k.api().post("/collectibles/v1/events",{events:e});if(!ye(t))throw new Error}catch{throw ka}}function Br(){return ie({async mutationFn({event:e}){try{await Lr([e])}catch{}}})}s();l();function Ua(){let{data:e}=Zo(),t=N(),o=F(),i=Ii(),n=Ne();return ie({mutationFn:async({multichainTransaction:a,pendingTransactionInput:u,senderAddress:m,optimisticUpdate:p,gasEstimation:d})=>{if(!e)throw new Error("No account identifier found");let{networkID:f}=a,y=await Ct.get(f).onBeforeSend({multichainTransaction:a,gasEstimation:d}),b=await Si({accountIdentifier:e,accountSigner:n,multichainTransaction:y,networkID:f,pendingTransactionInput:u,senderAddress:m,storage:t,utxoManager:i});return p&&_e(o,p),yi(f,b)},onError(a){a instanceof Error&&D.captureError(a,"collectibles")}})}s();l();var Wt=e=>{let t=N();return O({enabled:e.length!==0,queryKey:x.unhiddenCollections(e),gcTime:ae.Long,staleTime:1/0,async queryFn(){try{let o=await fe(t,e);return Array.from(o.values()).filter(i=>Ai(i,{spamStatus:"NOT_VERIFIED"})).map(({id:i})=>i)}catch(o){return o instanceof Error&&D.captureError(o,"collectibles"),[]}}})};s();l();var Ra=2e3,Eo=class extends Error{constructor(t){super(t),this.name="UseUnhideCollectionError"}};function jt(){let e=N(),t=F(),o=H();return ie({async mutationFn(i){let{collectionId:n,accountId:r}=i,a=await eo(e);if(!(await fe(e,r)).has(n)&&a>=Ra)throw new Eo("Too many ids unhidden");await $e(e,o,{accountId:r,mutations:[{id:n,visibility:"visible"}]})},async onSuccess(i,n){await t.invalidateQueries({queryKey:x.unhiddenCollections(n.accountId)}),await t.invalidateQueries({queryKey:x.hiddenCollections(n.accountId)})}})}s();l();var ke=S(T());s();l();var vo=S(T());var Mr=({toast:e,accountId:t})=>{let{t:o}=L(),i=H(),n=(0,vo.useCallback)(({collectible:a,previousVisibility:u,updatedVisibility:m})=>{m!==null&&i.capture("collectiblesReportAsNotSpam",{data:ge(a)}),e.success(u==="visible"?o("collectiblesNotSpamSuccess"):o("collectiblesNotSpamAndUnhiddenSuccess"))},[o,e,i]),r=(0,vo.useCallback)((a,u)=>{e.error(o("collectiblesNotSpamFail"))},[o,e]);return fn({accountId:t,onSuccess:n,onError:r})};s();l();var Io=S(T());var Or=({toast:e,accountId:t})=>{let{t:o}=L(),i=H(),n=(0,Io.useCallback)(({collectible:a,previousVisibility:u,updatedVisibility:m})=>{m!==null&&i.capture("collectiblesReportAsSpam",{data:ge(a)}),e.success(u==="hidden"?o("collectiblesSpamSuccess"):o("collectiblesSpamAndHiddenSuccess"))},[o,e,i]),r=(0,Io.useCallback)((a,u)=>{e.error(o("collectiblesSpamFail"))},[o,e]);return dn({accountId:t,onSuccess:n,onError:r})};function La({accountId:e,collectible:t,toast:o}){let i=Or({collectible:t,accountId:e,toast:o}),n=(0,ke.useCallback)(()=>{if(t)return i(t)},[i,t]),r=Mr({collectible:t,accountId:e,toast:o}),a=(0,ke.useCallback)(()=>{if(t)return r(t)},[r,t]),{data:u}=Y(e??""),m=(0,ke.useMemo)(()=>u?.get(t?.collection.id??t?.id??""),[u,t]),p=(0,ke.useMemo)(()=>t?Ti(m,{spamStatus:t.collection.spamStatus}):"NOT_VERIFIED",[t,m]),d=Ye(p);return(0,ke.useMemo)(()=>({isSpam:d,spamStatus:p,onReportSpam:d?void 0:n,onReportNotSpam:d?a:void 0}),[p,d,n,a])}s();l();var Nr=S(Zt()),Vr=S(T());s();l();var zt=(e,t)=>{let o=new Ae(e);if(o.isZero())return"0";let i=rt(-t);return o.abs().lt(i)?o.isPositive()?`<${i.toFixed()}`:`-<${i.toFixed()}`:parseFloat(o.toString()).toLocaleString("en-US",{maximumFractionDigits:t})};var Ba=(e,t)=>{let{t:o}=L();return(0,Vr.useMemo)(()=>{let n=[];if(!e)return n;let r=e?.chain.id,a=De.get(r).collectibleDetailPrecision;e.collection.name&&n.push({label:o("collectibleScreenCollectionLabel"),value:e.collection.name});let u,m;if(e.collection.floorPrice){let{price:f,token:y}=e.collection.floorPrice;if(y&&y.decimals&&y.symbol){let{decimals:b,symbol:g}=y,h=Ke(f,b);n.push({label:o("collectiblesFloorPrice"),value:`${zt(h,a)} ${g}`}),u=h,m=g}}let p,d;if(e.lastSalePrice){let{price:f,token:y}=e.lastSalePrice;if(y&&y.decimals&&(y.symbol||y.name)){let{decimals:b,symbol:g,name:h}=y,A=Ke(f,b);n.push({label:o("collectiblesLastSalePrice"),value:`${zt(A,a)} ${g??h}`}),p=A,d=g}}if(u&&p&&m===d){let f=u-p;n.push({label:o("collectiblesTotalReturn"),value:`${zt(f,a)} ${d}`,color:f>0?t?.positiveColor:f===0?void 0:t?.negativeColor})}return e.collection.ownerCount&&n.push({label:o("collectiblesUniqueHolders"),value:(0,Nr.default)(e.collection.ownerCount).format("0,0")}),e.chain.name&&n.push({label:o("sendFungibleSummaryNetwork"),value:E.getNetworkName(e.chain.id)}),it()&&n.push({label:"Standard",value:Ma(e)}),Ri(e)&&n.push({label:o("collectiblesNonTransferable"),value:o("collectiblesNonTransferableYes")}),n},[e,t?.negativeColor,t?.positiveColor,o])};function Ma(e){let t=e.chainData;if(K(t))return t.standard;if(ne(t))return t.standard;if(re(t))return"Ordinals"}s();l();var Hr=S(T());s();l();var Oa=S(T());s();l();var Na=S(T());s();l();var Fr=S(T()),$t=(e,t,o,i)=>(0,Fr.useMemo)(()=>t.includes(o)?!1:e.includes(o)?!0:!!i,[e,t,o,i]);s();l();var tt=S(T());s();l();var _r=S(T()),Po=({accountId:e,collectionId:t,isPinned:o,pinMessages:i,pinCollection:n,toast:r,sendAnalyticEvent:a,unhideCollection:u,isHidden:m})=>(0,_r.useCallback)(()=>{(async()=>{if(!t||!e){r.error(o?i.unpinFail:i.pinFail);return}try{await n({collectionId:t,accountId:e,pinned:!o}),m&&!o&&await u({collectionId:t,accountId:e}),r.success(o?i.unpinSuccess:i.pinSuccess),a&&a(o?"collectionUnpinned":"collectionPinned")}catch{r.error(o?i.unpinFail:i.pinFail)}})()},[t,e,o,i,n,r,a,u,m]);var _a=({collectionId:e,isSpam:t,accountId:o,networkId:i,toast:n})=>{let{t:r}=L(),a=H(),{mutateAsync:u}=jt(),{data:m=[]}=qt(o||""),{data:p=[]}=Wt(o||""),d=$t(m,p,e??"",!!t),{mutateAsync:f}=Qt(),{data:y=[]}=kt(o||""),b=Lt(y,e??""),g=(0,tt.useMemo)(()=>({pinSuccess:r("collectionPinSuccess"),pinFail:r("collectionPinFail"),unpinSuccess:r("collectionUnpinSuccess"),unpinFail:r("collectionUnpinFail")}),[r]),h=(0,tt.useCallback)(P=>{i&&a.capture(P,{data:{networkId:i,chainId:E.getChainID(i)}})},[a,i]),A=Po({accountId:o,collectionId:e,isPinned:b,pinMessages:g,pinCollection:f,toast:n,sendAnalyticEvent:h,unhideCollection:u,isHidden:d});return(0,tt.useMemo)(()=>({isPinned:b,onTogglePin:A}),[b,A])};s();l();var ot=S(T());var Ka=({networkID:e,isTxError:t,isTxConfirmed:o,isTxSubmitted:i})=>{let n=De.get(e).sendSuccessCondition,r=(0,ot.useMemo)(()=>t?"ERROR":n==="SUBMISSION"&&i||n==="CONFIRMATION"&&o?"SUCCESS":"LOADING",[o,t,i,n]),a=n==="CONFIRMATION"?"sendStatusConfirmedSuccessTitle":"sendStatusSubmittedSuccessTitle",u=(0,ot.useMemo)(()=>{switch(r){case"LOADING":return Z.t("sendStatusLoadingTitle");case"ERROR":return Z.t("sendStatusErrorTitle");case"SUCCESS":return Z.t(a)}},[r,a]),{isError:m,isSuccess:p}=(0,ot.useMemo)(()=>({isError:r==="ERROR",isSuccess:r==="SUCCESS"}),[r]),{transactionSpeed:d="standard"}=Ui(y=>y.sendFormValues),f=(0,ot.useMemo)(()=>{let y=Ct.get(e).transactionSpeedDescription(d);return y?Z.t(y):""},[e,d]);return{title:u,isError:m,isSuccess:p,sendSuccessCondition:n,estimatedTime:f}};s();l();var qe=S(T());var qa=()=>{let e=be(p=>p.listCollectible),t=be(p=>p.editListCollectiblePrice),[o,i]=(0,qe.useState)(),[n,r]=(0,qe.useState)(!1),[a,u]=(0,qe.useState)();return{editList:(0,qe.useCallback)(async(p,d)=>{if(i(void 0),r(!0),!e||!t){i(new Error("missing collectible or price")),r(!1);return}try{let f=new URLSearchParams;f.set("pubKey",d.toBase58()),f.set("mint",e.asset.mintPubKey),f.set("account",e.asset.pubkey),f.set("quotePrice",`${wt(t)}`),f.set("marketplace","magic_eden");let y=pe(p);f.set("chainId",y.toString());let b=`/solana/composer/v1/list?${f.toString()}`,h=(await k.api().retry(3,2e3).get(b)).data,A=ee.Transaction.from(Buffer.from(h.transaction,"base64"));He(A)?u(A):i(new Error("Failed to initialize transaction")),r(!1)}catch(f){console.error(f),i(new Error("Failed to initialize transaction")),r(!1)}},[e,t]),isLoading:n,error:o,transaction:a}};s();l();var Ge=S(T());var Ga=()=>{let e=be(p=>p.listCollectible),t=be(p=>p.listCollectiblePrice),[o,i]=(0,Ge.useState)(),[n,r]=(0,Ge.useState)(!1),[a,u]=(0,Ge.useState)();return{list:(0,Ge.useCallback)(async(p,d)=>{if(i(void 0),r(!0),!e||!t){i(new Error("missing collectible or price")),r(!1);return}try{let f=new URLSearchParams;f.set("pubKey",d.toBase58()),f.set("mint",e.asset.mintPubKey),f.set("account",e.asset.pubkey),f.set("quotePrice",`${wt(t)}`),f.set("marketplace","magic_eden");let y=pe(p);f.set("chainId",y.toString());let b=`/solana/composer/v1/list?${f.toString()}`,h=(await k.api().retry(3,2e3).get(b)).data,A=ee.Transaction.from(Buffer.from(h.transaction,"base64"));He(A)?u(A):i(new Error("Failed to initialize transaction")),r(!1)}catch(f){i(new Error("Failed to initialize transaction")),r(!1),D.captureError(f,"magicEden")}},[e,t]),isLoading:n,error:o,transaction:a}};s();l();var Qe=S(T());var Qa=()=>{let e=be(m=>m.unlistCollectible),[t,o]=(0,Qe.useState)(),[i,n]=(0,Qe.useState)(!1),[r,a]=(0,Qe.useState)();return{unlist:(0,Qe.useCallback)(async(m,p)=>{if(o(void 0),n(!0),!e){o(new Error("missing collectible")),n(!1);return}try{let d=new URLSearchParams;d.set("pubKey",p.toBase58()),d.set("mint",e.asset.mintPubKey),d.set("account",e.asset.pubkey),d.set("marketplace","magic_eden");let f=pe(m);d.set("chainId",f.toString());let y=`/solana/composer/v1/unlist?${d.toString()}`,g=(await k.api().retry(3,2e3).get(y)).data,h=ee.Transaction.from(Buffer.from(g.transaction,"base64"));He(h)?a(h):o(new Error("Failed to initialize transaction")),n(!1)}catch(d){o(new Error("Failed to initialize transaction")),n(!1),D.captureError(d,"magicEden")}},[e]),isLoading:i,error:t,transaction:r}};s();l();var Kr=S(T()),Wa=e=>(0,Kr.useMemo)(()=>e.filter(t=>t?.media?.type==="image"),[e]);s();l();var qr=S(T());var ja=(e,t)=>(0,qr.useMemo)(()=>{if(!e||!t)return;let o=e.chain.id,i=t.explorers[o]??$o.get(o).defaultExplorer,n,r;if(K(e.chainData))r="address",n=e.chainData.mint;else if(ne(e.chainData))if(e.chainData.contract)e.chainData.id?(r="nft",n=[e.chainData.contract,e.chainData.id]):(r="token",n=e.chainData.contract);else return;else if(re(e.chainData))if(xt(e.chainData)){let{hash:u,index:m}=e.chainData.utxoDetails;r="transaction",n=`${u}#flow=&vout=${m}`}else return{name:"Ordinals",url:`https://ordinals.com/inscription/${e.chainData.firstCreatedInscriptionId}`};else if(Ki(e.chainData))r="nft",n=e.chainData.objectId;else throw new Error(`Unhandled collectible explorer for chain id: ${e.chain.id}`);if(!n)return;let a=Xo({networkID:o,endpoint:r,explorerType:i,param:n});if(a)return{name:Yo[i],url:a}},[e,t]);s();l();var Gr=S(T()),za=e=>(0,Gr.useMemo)(()=>{let t=new Set;return e.filter(o=>{if(!o?.media?.image?.url)return!1;let{url:i}=o.media.image;return t.has(i)?!1:(t.add(i),!0)})},[e]);s();l();var Qr=S(T());var $a=e=>{let{t}=L();return(0,Qr.useMemo)(()=>{let i=[];if(!e)return;let n=e.chainData;if(re(n)){let{outputValue:r,satNumber:a,satName:u,inscriptionId:m,inscriptionNumber:p,protocolName:d,createdAt:f,utxoDetails:y}=n,b=t(m?"collectibleDetailOrdinalInfo":"collectibleDetailRareSatsInfo"),g;return r?g=parseFloat(r).toLocaleString("en-US"):y&&(g=y.value.toLocaleString("en-US")),i.push(g?{label:t("collectibleDetailSatsInUtxo"),value:t("collectibleDetailSatsInUtxoValue",{satsInUtxo:g})??void 0}:null),i.push(a?{label:t("collectibleDetailSatNumber"),value:a}:null),i.push(u?{label:t("collectibleDetailSatName"),value:u}:null),i.push(m?{label:t("collectibleDetailInscriptionId"),value:No(m,5,3)}:null),i.push(p?{label:t("collectibleDetailInscriptionNumber"),value:p}:null),i.push(d?{label:t("collectibleDetailStandard"),value:d?.toUpperCase()}:null),i.push(f?{label:t("collectibleDetailCreated"),value:Ya(new Date(f))}:null),{label:b,items:i.filter(Bo)}}},[e,t])};function Ya(e){let t=e.toLocaleDateString(void 0,{month:"numeric",day:"numeric",year:"numeric"}),o=e.toLocaleTimeString();return`${t} ${o}`}s();l();var jr=S(T()),Te=()=>{},Wr=new Map([["send",1],["list",2],["pin",3],["unpin",4],["share",5],["setAsAvatar",6],["saveToLibrary",7],["hide",8],["reportAsSpam",9],["reportAsNotSpam",10],["burnToken",11],["viewOnExplorer",12]]);function Xa(e){let{amountToBurn:t=0,explorerName:o,isBurnable:i,isHidden:n,isPinned:r,isSpam:a,onBurnToken:u,onList:m,onReportNotSpam:p,onReportSpam:d,onSaveToLibrary:f,onSend:y,onSetAsAvatar:b,onShare:g,onToggleHide:h,onTogglePin:A,onViewOnExplorer:P,shortcuts:j,shouldDisplaySend:M,shouldDisplayShortcuts:G,shouldDisplayListOnSolana:X}=e,{t:v}=L();return(0,jr.useMemo)(()=>{let B=[];if(M&&B.push({text:v("commandSend"),type:"send",onClick:y??Te}),X&&B.push({text:v("collectibleDetailList"),type:"list",onClick:m}),f&&B.push({text:v("assetDetailSaveToPhotos"),singleWordAltText:v("commandSave"),type:"saveToLibrary",menuOnly:!0,onClick:f??Te}),b&&!a&&B.push({text:v("collectibleDetailSetAsAvatar"),singleWordAltText:v("collectibleDetailSetAsAvatarSingleWorkAlt"),type:"setAsAvatar",menuOnly:!0,onClick:b??Te}),g&&B.push({text:v("collectibleDetailShare"),singleWordAltText:v("commandShare"),type:"share",menuOnly:!0,onClick:g??Te}),A){let V=v(r?"assetDetailUnpinCollection":"assetDetailPinCollection"),z=v(r?"commandUnpin":"commandPin"),J=r?"unpin":"pin";B.push({text:V,singleWordAltText:z,type:J,menuOnly:!0,onClick:A??Te})}if(h){let V=v(n?"assetDetailUnhideCollection":"assetDetailHideCollection"),z=v(n?"commandUnhide":"commandHide"),J=n?"unhide":"hide";B.push({text:V,singleWordAltText:z,type:J,menuOnly:!0,onClick:h??Te})}if(p){let V=v("collectiblesReportAsNotSpam");B.push({text:V,type:"reportAsNotSpam",singleWordAltText:v("collectiblesReportNotSpam"),menuOnly:!0,isDestructive:!0,onClick:p})}if(d){let V=v("collectiblesReportAsSpam");B.push({text:V,type:"reportAsSpam",singleWordAltText:v("commandReport"),menuOnly:!0,isDestructive:!0,onClick:d})}if(i){let V=v(t===1?"collectibleBurnTitleWithCount_one":"collectibleBurnTitleWithCount_other");B.push({text:V,singleWordAltText:v("commandBurn"),type:"burnToken",menuOnly:!0,isDestructive:!0,onClick:u??Te})}return!!P&&!!o&&B.push({text:v("assetDetailViewOnExplorer",{explorer:o}),singleWordAltText:v("commandView"),type:"viewOnExplorer",menuOnly:!0,onClick:P??Te}),B.sort((V,z)=>(Wr.get(V.type)??100)-(Wr.get(z.type)??100)),{actions:Oi(B,4),shortcuts:G?j:[]}},[t,o,i,n,r,a,u,m,p,d,f,y,b,g,h,A,P,j,M,G,X,v])}s();l();export{ss as a,vc as b,Et as c,Mc as d,Xi as e,Oc as f,K as g,ne as h,re as i,xt as j,Ps as k,ks as l,Us as m,Rs as n,Ls as o,ca as p,fa as q,wr as r,Ea as s,Ee as t,Os as u,Ia as v,kt as w,Da as x,Br as y,Ua as z,Ns as A,Vs as B,Fs as C,Tn as D,La as E,Ba as F,Hs as G,Lt as H,Om as I,En as J,pl as K,Sl as L,hl as M,Rl as N,Nl as O,Vl as P,Hl as Q,Kl as R,ql as S,Wl as T,_a as U,Ka as V,be as W,qa as X,Ga as Y,Qa as Z,Zl as _,Jl as $,ia as aa,na as ba,ra as ca,Wa as da,ja as ea,za as fa,$a as ga,Xa as ha,sa as ia};
//# sourceMappingURL=chunk-ZSQU2ZM6.js.map
