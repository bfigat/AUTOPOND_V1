import{b as $e}from"./chunk-4P3F3ICM.js";import{a as Ue}from"./chunk-OVQZ6HTN.js";import{b as Be}from"./chunk-EQDXPIVC.js";import{a as Ee}from"./chunk-GS2UJNU3.js";import{Yb as Pe,_c as Ie,wb as Y,xb as k,zc as we}from"./chunk-R5HJQXZQ.js";import{b as xe}from"./chunk-UDFQ3C42.js";import{h as Ae}from"./chunk-GBKSQA4Y.js";import{f as Le}from"./chunk-ALR5MBQI.js";import{c as R,i as Me,k as Ne}from"./chunk-UFPGJN5T.js";import{D as Qe,Z as De,a as E,c as ee,n as s,o as g,t as N}from"./chunk-BFV33OZC.js";import{dd as Se,de as ke,gb as W,gd as Fe,ob as Te}from"./chunk-S6KJ2BHO.js";import{a as Z,m as ve}from"./chunk-MNQ7RLHG.js";import{D as K,xa as Ce}from"./chunk-NMZ7IVPZ.js";import{U as be}from"./chunk-H6ILHDLW.js";import{a as he}from"./chunk-7X4NV6OJ.js";import{f as ge,h as Q,n as D}from"./chunk-3KENBVE7.js";Q();D();var e=ge(he());Q();D();var a=ge(he()),qe=({width:f,trackColor:b="#181818",spinnerColor:n="#AB9FF2"})=>a.default.createElement("svg",{width:f,height:f,viewBox:"0 0 26 26"},a.default.createElement("g",null,a.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13 23.413c5.751 0 10.413-4.662 10.413-10.413S18.751 2.587 13 2.587 2.587 7.249 2.587 13 7.249 23.413 13 23.413zm0 2.315c7.03 0 12.727-5.699 12.727-12.728S20.03.273 13 .273C5.97.273.273 5.97.273 13 .273 20.03 5.97 25.728 13 25.728z",fill:b})),a.default.createElement("g",null,a.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.382 24.125a1.157 1.157 0 01.623-1.513 10.412 10.412 0 005.607-13.617 1.157 1.157 0 112.136-.89 12.726 12.726 0 01-6.853 16.643 1.157 1.157 0 01-1.513-.623z",fill:n})));qe.defaultProps={width:44};var te=({diameter:f,color:b,trackColor:n,position:P})=>a.default.createElement(a.default.Fragment,null,a.default.createElement("style",null,`@keyframes rotate {
            100% {
              transform: rotate(360deg);
            }
          }`),a.default.createElement("div",{style:{position:P,width:`${f}px`,height:`${f}px`,animation:"rotate 0.5s linear infinite"}},a.default.createElement(qe,{width:f,spinnerColor:b,trackColor:n})));te.defaultProps={diameter:44};var Dt=({onClose:f,onClickBuy:b})=>{let{t:n}=ve(),[P,x]=(0,e.useState)(void 0),oe=Ne(),d=Me(),{quickSelectDenominations:Ve,minPurchaseAmountUsd:B,maxPurchaseAmountUsd:U,purchaseType:$,fungible:ze,ownerPublicKey:q,purchaseAmount:c,setState:l,paymentMethod:V,provider:z,checkoutQuoteType:je,redirectURL:ne}=d,p=parseFloat(c),m=$==="currency",{name:j,symbol:r,decimals:re,caip19:C,logoURI:Oe}=ze||{},h=C?.chainId,O=Fe(),{data:_e=""}=ke({select:t=>t?.name}),{data:ie}=Pe({query:{data:C}}),i=ie?ie?.usd:void 0,{currencySymbol:He,currencyCode:A,toUsd:w,fromUsd:S}=xe(),I=(0,e.useMemo)(()=>{if(P)return!1;let t=c.length>0,o=p>0,y=Number.isFinite(p);return t&&o&&y},[P,c,p]),Xe=(0,e.useMemo)(()=>{if(!i)return`??? ${r}`;if(m){let o=we.get(h).formDisplayPrecision,y=w(p),L=k(y,i,o),T=Ie(L,o);return c===""?`0 ${r}`:T.length+(r?.length??0)<15?`~${T} ${r}`:`~${T.substring(0,8)}... ${r}`}let t=c===""?0:Y(p,i);return e.default.createElement(Ue,{value:t,font:"caption",color:"textSecondary"})},[r,h,c,p,m,w,i]),[Ge,_]=(0,e.useState)(500),Je=be({purchaseAmount:c,purchaseType:$},Ge),{purchaseAmount:F,purchaseType:se}=Je,M=(0,e.useCallback)(t=>{let o=parseFloat(t),y=m?A?.toUpperCase():r,L=m?Number(S(B)):k(B,i??0,R),T=m?Number(S(U)):k(U,i??0,R),tt=o<L,ot=o>T,ye=tt?n("buyAssetScreenMinPurchasePriceInterpolated",{amount:`${L} ${y}`}):ot?n("buyAssetScreenMaxPurchasePriceInterpolated",{amount:`${T} ${y}`}):void 0;return ye==null?{status:"pass"}:{status:"fail",message:ye}},[S,m,n,A,r,B,i,U]),Ke=(0,e.useCallback)(({value:t})=>M(t),[M]),ae=(0,e.useCallback)(t=>{let o=M(t);_(500),l({...d,purchaseAmount:t,checkoutQuoteType:"recommended"}),x(o?o.message:void 0)},[d,l,M]),Ze=(0,e.useCallback)(t=>{O.capture("fiatOnrampAmountSelected",{data:{networkId:h,chainId:W.getChainID(h),asset:{name:j,symbol:r,type:"fungible"},amount:t}}),_(100),l({...d,purchaseAmount:t,purchaseType:"currency",checkoutQuoteType:"recommended"}),x(void 0)},[d,r,j,h,l,O]),We=(0,e.useCallback)(t=>{if(t.preventDefault(),!i)return;let o=m?k(w(p),i,re):S(Y(p,i));_(100),l({...d,purchaseAmount:o.toString(),purchaseType:m?"token":"currency"}),x(void 0)},[d,re,S,p,l,m,w,i]),H=(0,e.useMemo)(()=>({...se==="currency"?{fiatAmount:F}:{tokenAmount:F},token:C,fiatCurrencyCode:A,destinationAddress:{address:q,chainId:C?.chainId,resourceType:"address"}}),[C,F,se,A,q]),X=je==="selected",G=!X&&I&&!!F,{data:J,isLoading:de,isError:me}=Le("web-embedded",K,Z.language,{...H,paymentMethodId:V?.id,providerId:z?.id},G),u=X?V:J?.paymentMethod,v=X?z:J?.provider,ue=(0,e.useCallback)(()=>{l({...d,paymentMethod:u}),oe.toStack("fiat-ramp-detail")},[oe,d,u,l]),ce=(0,e.useMemo)(()=>G&&de?{id:"recommended-quote-loading",topLeft:n("buyThirdPartyScreenLoadingQuote"),end:e.default.createElement(te,{diameter:20}),disabled:!0}:!I||!u||!v||me?{type:"drawer",id:"no-quote",topLeft:()=>e.default.createElement(e.default.Fragment,null,e.default.createElement(ee.CreditCard,{size:18}),e.default.createElement(g,{font:"caption"},n("buyThirdPartyScreenChoseQuote"))),disabled:!0,onClick:()=>null}:{type:"drawer",id:"selected-quote",onClick:ue,topLeft:{text:u?.name,before:u?.assets?.icon?e.default.createElement("img",{src:u?.assets?.icon,width:24,height:24}):void 0},topRight:{text:v?.name}},[ue,I,G,me,de,u,v,n]),[Ye,le]=(0,e.useState)(!1),pe=I&&(!!J||!!V&&!!z),Re=(0,e.useMemo)(()=>({...H,paymentMethodId:u?.id||"",providerId:v?.id||"",redirectURL:ne}),[H,u?.id,v?.id,ne]),et=Se(),fe=async t=>{if(pe){t&&t.preventDefault(),O.capture("fiatOnrampBuyClickedByUser",{data:{networkId:h,chainId:W.getChainID(h),asset:{name:j,symbol:r,type:"fungible"},purchaseType:$,amount:F,paymentMethod:u?.id,provider:v?.id}}),l({...d,price:i??0}),le(!0);try{let{url:o,sessionId:y}=await Ee("web-embedded",K,Z.language,Re,et);self.open(o,"_blank")?.focus(),b&&b(y,Te(C))}catch(o){Ce.captureError(o,"onRamp")}le(!1)}};return e.default.createElement(s,{justifyContent:"space-between",height:"100%"},e.default.createElement(s,null,e.default.createElement(s,{alignItems:"center",gap:32},e.default.createElement(g,{font:"heading3"},n("buyAssetInterpolated",{tokenSymbol:r})),e.default.createElement(Be,{image:{type:"fungible",src:Oe,fallback:r??""},size:96})),e.default.createElement(s,{direction:"row",gap:8,alignItems:"center",justifyContent:"flex-start",marginTop:24,padding:16,borderRadius:16,backgroundColor:"bgArea"},e.default.createElement(g,{font:"body"},_e),e.default.createElement(g,{font:"caption",color:"textSecondary"},"(",Ae(q,4),")")),e.default.createElement("form",{onSubmit:void 0,className:E({marginTop:8})},e.default.createElement(Qe,{value:c,onChangeText:ae,placeholder:n("amount"),id:"purchaseAmount",label:n("amount"),end:m?A:r,showLabel:!1,validator:Ke,setValue:ae}),e.default.createElement(s,{justifyContent:"space-between",direction:"row",alignItems:"center",marginTop:8},e.default.createElement(s,null,e.default.createElement(s,{onPress:We,gap:4},i?e.default.createElement(g,{color:"textSecondary",font:"caption"},Xe,i===0?null:e.default.createElement(ee.Swap2Vertical,{size:12,className:E({marginLeft:4})})):e.default.createElement(g,null,`??? ${r}`))),e.default.createElement(s,{direction:"row",gap:8},Ve.map(t=>e.default.createElement(N,{size:"micro",key:t,theme:c===t?"primary":"secondary",onClick:()=>Ze(t)},He,e.default.createElement(g,{font:"label"},t))))))),e.default.createElement(s,null,ce&&e.default.createElement(De,{rows:[ce]}),e.default.createElement(s,{gap:8,marginTop:12,direction:"row",justifyContent:"space-between",className:$e},e.default.createElement(N,{theme:"secondary",onClick:f},n("commandCancel")),e.default.createElement(N,{theme:"primary",disabled:!pe||Ye,onClick:fe},n("commandBuy")))))};export{Dt as a};
//# sourceMappingURL=chunk-SVW4WYQN.js.map
