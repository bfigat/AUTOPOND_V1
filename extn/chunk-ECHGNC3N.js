import{b as P}from"./chunk-ZZPI23JA.js";import{Gd as H,ea as w,gb as _}from"./chunk-S6KJ2BHO.js";import{m as h}from"./chunk-MNQ7RLHG.js";import{F as E}from"./chunk-NMZ7IVPZ.js";import{o as L}from"./chunk-H6ILHDLW.js";import{a as C}from"./chunk-7X4NV6OJ.js";import{f as I,h as i,n as a}from"./chunk-3KENBVE7.js";i();a();i();a();var s=I(C());i();a();var O=t=>t.reduce((o,n)=>{let e=o;for(let c of n.accounts){let r=c.chain.name.toLowerCase();if(o[r]?.balance&&o[r]?.history)continue;let l="amount"in c?parseFloat(c.amount)>0:!1,u=c.hasAccountActivity;if(!o[r]){e={...e,[r]:{balance:l,history:u}};continue}e={...e,[r]:{...e[r],balance:l||e[r]?.balance,history:u||e[r]?.history}}}return e},{});i();a();var v=I(C()),U=t=>{let o=H(),n=(0,v.useCallback)(e=>o.includes(_.getChainID(e.chain.id)),[o]);return(0,v.useMemo)(()=>t?t.map(e=>e.status==="undiscovered"?{...e,accounts:e.accounts.filter(c=>n(c))}:{...e,accounts:e.accounts.filter(c=>n(c)&&c.hasAccountActivity)}):[],[n,t])};i();a();var b=I(C()),T=t=>{let[o,n]=(0,b.useState)(null);return(0,b.useEffect)(()=>{if(t.length){let e=new w(t);return n(e),()=>{n(null),e.cleanup()}}},[t]),o};var $=t=>(0,s.useMemo)(()=>t.reduce((o,n,e)=>(o[e]=e===0||n.isSelectedByDefault,o),{}),[t]),ee=(t,o)=>(0,s.useMemo)(()=>t?.reduce((n,e,c)=>o[c]?[...n,e]:n,[])??[],[t,o]),te=(t,o)=>{(0,s.useEffect)(()=>{o(n=>{let{length:e}=Object.keys(t),c={};for(let r=0;r<e;r++)c[r]=n[r]===void 0?t[r]:n[r];return c})},[t,o])},oe=3e3,ne=(t,o)=>{let{t:n}=h();return(0,s.useEffect)(()=>{let e;if(t){let{pages:c}=t,r=c.length>1,l=c[c.length-1].length===0;r&&l&&(o(n("onboardingSelectAccountsFindMoreNoneFound")),e=setTimeout(()=>{o(n("onboardingSelectAccountsFindMoreAccounts"))},oe))}return()=>{e&&clearTimeout(e)}},[t])},ce=({activeAccountsNumber:t,allAccountsNumber:o,hasDiscoveryFailed:n})=>{let{t:e}=h(),c=t>0&&!n;return(0,s.useMemo)(()=>o===0?e("onboardingImportImportingFindingAccounts"):t===0?e("onboardingImportAccountsEmptyResult"):o===1?c?e("onboardingImportAccountsFoundAccounts_one",{numberOfWallets:t}):e("onboardingImportAccountsFoundAccountsNoActivity_one",{numberOfWallets:o}):o>1?c?e("onboardingImportAccountsFoundAccounts_other",{numberOfWallets:t}):e("onboardingImportAccountsFoundAccountsNoActivity_other",{numberOfWallets:o}):"",[t,o,c,e])},W={extension:7,ios:7,android:7,web:7},re=({seed:t,navigationCallback:o,storageCallback:n,enabledAddressTypes:e,enabledChains:c})=>{let{t:r}=h(),l=r("onboardingSelectAccountsFindMoreAccounts"),[u,A]=(0,s.useState)({}),[S,M]=(0,s.useState)(!1),[B,R]=(0,s.useState)(!1),[k,K]=(0,s.useState)(l),Q=T(t),{data:D,status:p,fetchNextPage:N,isFetchingNextPage:j}=P({batchSize:W[E],hdWallet:Q,enabledAddressTypes:e,enabledChains:c}),g=(0,s.useMemo)(()=>D?.pages.flat()??[],[D]),x=U(g),q=$(x),m=ee(g,u),G=ce({activeAccountsNumber:x.length,allAccountsNumber:g.length,hasDiscoveryFailed:g[0]?.status==="undiscovered"});ne(D,K),te(q,A);let Y=(0,s.useCallback)(()=>R(!0),[]),V=(0,s.useCallback)(y=>{if(p!=="success")return;let d={...u};d[y]=!d[y],A(d)},[p,u,A]),Z=(0,s.useCallback)(()=>{p==="success"&&A(y=>{let d={...y},X=Object.values(d).every(Boolean);return Object.keys(d).forEach((ae,J)=>{d[J]=!X}),d})},[p,A]),z=(0,s.useCallback)(async()=>{S||(M(!0),await L(0),await n(m,O(m)),M(!1),o(O(m)))},[S,m,o,n]),F={expanded:B,findMoreAccountsButtonText:k,isFetchingMoreAccounts:j,isImporting:S,renderedPages:x,selectedAccounts:u,subtitle:G,findMoreAccounts:N,onExpand:Y,onImport:z,onSelect:V,onSelectAll:Z};return p!=="success"?{status:"loading",isImportButtonDisabled:!0,...F}:{status:"success",isImportButtonDisabled:m.length===0,...F}};i();a();export{W as a,re as b};
//# sourceMappingURL=chunk-ECHGNC3N.js.map
