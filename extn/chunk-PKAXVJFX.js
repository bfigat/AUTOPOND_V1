import{$c as Fn,A as $t,Aa as Zt,Ac as it,B as Yt,Bc as O,C as ve,Cb as ln,Db as Le,Dc as at,Eb as E,Ec as fn,Fc as yn,Ga as en,Gb as cn,Gc as Sn,Hc as bn,Kb as dn,Nc as An,Ob as we,Pc as st,Qc as ce,Ra as Ae,Sc as ae,Ta as tn,Ua as Be,Wa as nn,Wc as Tn,Xa as rn,Xc as ut,Zb as mn,Zc as wn,_c as pt,ad as hn,fa as jt,gc as _e,ha as zt,hb as Ne,kc as gn,lc as ot,mb as on,nb as an,ob as sn,pb as un,qb as Te,rb as Oe,sb as rt,ub as pn,w as Qt,x as qt,xa as Xt,z as Pe,za as Jt}from"./chunk-R5HJQXZQ.js";import{K as Ht,S as Wt,a as et,c as tt,j as nt,w as Kt}from"./chunk-P4LRI3S3.js";import{h as Ze,r as Or}from"./chunk-GBKSQA4Y.js";import{Bd as X,Cb as Gt,De as le,K as Mt,L as w,S as re,V as Ut,W as ze,c as Br,cb as Lt,de as H,eb as _t,gb as h,gd as K,ib as j,lb as Vt,nb as be,ob as z,r as Nr,rb as ie}from"./chunk-S6KJ2BHO.js";import{N as Dt,p as It}from"./chunk-7ZZNCPHU.js";import{a as d,m as k,n as Je}from"./chunk-MNQ7RLHG.js";import{_ as Xe,ha as _,ja as V,ma as N,ra as G,xa as D}from"./chunk-NMZ7IVPZ.js";import{A as Pt,C as vt,L as Bt,Z as Nt,a as R,b as f,ba as Ot,l as Se,x as oe}from"./chunk-H6ILHDLW.js";import{a as T}from"./chunk-7X4NV6OJ.js";import{f as b,h as i,m as Buffer,n as a}from"./chunk-3KENBVE7.js";i();a();i();a();i();a();var ii=new Set(["trustedApplicationsByOwner","trustedApplicationsByOwnerBrowser","trustedApplicationsByOwnerMobile"]),ai="userTrustedApps";i();a();i();a();var wi="userExplorerPreferenceV2";i();a();var Pi=new Error("Failed to get cluster from storage");var vi={"mainnet-beta":j.Solana.Mainnet,devnet:j.Solana.Devnet,testnet:j.Solana.Testnet,localhost:j.Solana.Localnet};i();a();i();a();var Yi="isAnalyticsOptedOut";i();a();i();a();i();a();i();a();var En=e=>{let{accountIdentifier:t,autoConfirmEnabled:n=!1,trustedAppsByAccount:r}=e;if(!t||!r)return;let o=Object.values(r),s=[],u=[];n?(o.forEach(l=>{l.autoConfirm&&Kt(l.autoConfirm)?s.push(l):u.push(l)}),s.sort((l,m)=>(m.autoConfirm?.sessionStartTime??0)-(l.autoConfirm?.sessionStartTime??0))):u=o;let c=Pt(u.map(l=>{let m=l.lastConnectedTimestamp??0;return{timestamp:m,data:{...l,lastConnectedTimestamp:m}}}));return{autoConfirmEnabledApps:s,timeBucketedApps:c}};i();a();var Cn=(e,t)=>{if(!t||e.autoConfirm?.sessionStartTime===void 0||e.autoConfirm?.maxSessionDuration===void 0)return;let n=new Date(e.autoConfirm?.sessionStartTime+e.autoConfirm?.maxSessionDuration*1e3);return vt(n).format("h:mm A")};i();a();var Yr=R.object({data:R.string(),from:R.string(),to:R.string()}),jr=R.object({transaction:Yr});async function zr({caip19:e,amount:t,owner:n}){let r=await re.api().post("/tokens/v1/unwrap",{owner:n,caip19:e,amount:t.toNumber()}),o=jr.safeParse(r.data);if(!o.success){let{error:s}=o;throw D.captureError(s,"fungibles"),new Le(`Failed to get unwrap transaction: ${s.message}`)}return o.data.transaction}var Xr=({caip19:e,amount:t,owner:n})=>N({gcTime:Te.Medium,staleTime:1/0,enabled:n!==""&&t.isGreaterThan(0),queryKey:E.unwrapTransaction({caip19:e,amount:t,owner:n}),async queryFn(){return await zr({caip19:e,amount:t,owner:n})}});i();a();function lt(){let e=G(),t=K(),n=_();return V({async mutationFn({accountId:r,mutations:o}){await cn(e,t,{accountId:r,mutations:o})},async onSuccess(r,o){await n.invalidateQueries({queryKey:E.hiddenMints(o.accountId)})}})}i();a();var ct=b(Or());i();a();var Ke={recipient:"",recipientHandle:"",addressBookRecipient:void 0,amountAsset:new f(0),amountUsd:0,transactionSpeed:"standard",solana:{references:[]},multichainTransaction:void 0},xn=class extends Error{constructor(t){super(t),this.name="SendFungibleFlowError"}};var Rn={sendSessionId:"",fungibleKey:void 0,splTokenAccount:void 0,analyticsRecipient:void 0,sendFormValues:Ke,shouldShowFiatValues:!1,retryArgs:void 0,confirmedFungibleAndSender:null},dt=le((e,t)=>({...(0,ct.default)(Rn),resetSendSlice:()=>{let n=(0,ct.default)(Rn);n.sendSessionId=Dt(),e(n)},setAnalyticsRecipient:n=>{e({analyticsRecipient:n})},setSendFungibleKey:(n,r)=>{e({fungibleKey:n,splTokenAccount:r})},setSendFormValues:n=>{e({sendFormValues:n})},setInputAmount:n=>{let r=t();e({sendFormValues:{...r.sendFormValues,inputAmount:n}})},setShouldShowFiatValues:n=>{e({shouldShowFiatValues:n})},setRetryArgs:n=>{e({retryArgs:n})}}));i();a();var kn={collectible:void 0,sendFormValues:Ke,shouldRequireAmount:!1},Jr=le(e=>({...kn,resetSendSlice:()=>{e({...kn})},setSendCollectible:t=>{e({collectible:t})},setSendFormValues:t=>{e({sendFormValues:t})},setShouldRequireAmount:t=>{e({shouldRequireAmount:t})}}));i();a();i();a();var Zr={query:""},eo=le(e=>({...Zr,setQuery:t=>{e({query:t})}}));i();a();i();a();i();a();var He=b(Br(),1),Mn=b(Nr(),1);var In=(0,He.struct)([(0,He.u8)("instruction")]);function Un(e,t,n,r=[],o=Ae){let s=rn([{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}],n,r),u=Buffer.alloc(In.span);return In.encode({instruction:nn.CloseAccount},u),new Mn.TransactionInstruction({keys:s,programId:o,data:u})}var vn=b(T());i();a();function Dn(e,t,n){return w.PublicKey.findProgramAddressSync([e.toBuffer(),n.toBuffer(),t.toBuffer()],tn)[0]}var to=new Le("Unable to unwrap SOL. Wrapped SOL Token account does not exist.");function mt(){let{connection:e}=_e(),{data:t}=H(),{solanaChainAddress:n,accountIdentifier:r}=(0,vn.useMemo)(()=>({solanaChainAddress:t?.addresses.find(ie),accountIdentifier:t?.identifier??""}),[t]),o=G(),s=X(),{t:u}=k();return V({mutationFn:async()=>{if(!n)return Promise.reject("solanaChainAddress not loaded");let{networkID:c,address:l}=n,m=new w.PublicKey(l),g=Dn(m,Be,Ae);if(!await e.getAccountInfo(g))throw to;let S=Un(g,m,m,[],Ae),I=new Mt.Transaction().add(S),P={ownerAddress:l,networkID:c,data:{signature:""},type:"unwrapSOL",display:{summary:{topLeft:{text:u("assetDetailUnwrappingSOL")}}}},ee=await Ne({accountIdentifier:r,accountSigner:s,connection:e,feePayer:new w.PublicKey(l),pendingTransactionInput:P,storage:o,transaction:I,useSubmissionService:!1});return{networkID:c,id:ee}}})}i();a();var Bn=b(T());var no=()=>{let{connection:e}=_e(),{data:t}=H(),{solanaChainAddress:n,accountIdentifier:r}=(0,Bn.useMemo)(()=>({solanaChainAddress:t?.addresses.find(ie),accountIdentifier:t?.identifier??""}),[t]),o=G(),s=X(),{t:u}=k();return V({mutationFn:async c=>{if(!n)throw new Error("solanaChainAddress not loaded");if(c.type!=="CompressedSPL")throw new Error("SPL is not compressed");let l=await on({owner:c.data.walletAddress,mint:c.data.mintAddress,amount:c.data.amount,programId:c.data.programId,connection:e}),{networkID:m,address:g}=n,y={ownerAddress:g,networkID:m,data:{signature:""},type:"decompress",display:{summary:{topLeft:{text:u("assetDetailClaiming")}}}};await Ne({accountIdentifier:r,accountSigner:s,connection:e,feePayer:new w.PublicKey(g),pendingTransactionInput:y,storage:o,transaction:l,useSubmissionService:!1})}})};i();a();var yt=b(T());i();a();var gt=new f(0),ft=({chainAddress:e,type:t,balance:n,decimals:r,recipient:o,gasEstimation:s,clampToZero:u=!0})=>{let{data:c,isLoading:l}=ot(e);if(!t||!n)return gt;let m=new f(n).multipliedBy(Ot(r));if(!O(t))return m;if(!s)return;let g=new f(0);if(Pe(s))g=m.minus(new f(s.value));else if(Yt(s)){let{gasLimit:y,maxFeePerGas:S,l1Fee:I=new f(0)}=s,P=y.times(S).plus(I);g=m.minus(P)}else if(ve(s)){if(!e||l)return;let y=e.addressType,S=c?.safeToSendUtxos??[],I=qt(s.btcPerKilobyte),P=o&&Lt.safeParse(o).success?o:"bc1p",ue=[{value:S.reduce((v,te)=>v.plus(new f(te.value)),new f(0)).toNumber(),address:P}],Q=Xt(y,S,ue,I.toNumber(),[]);if(Q.type==="error")g=new f(Q.maxAmount).integerValue(f.ROUND_DOWN);else{let{inputs:v,fee:te}=Q;g=v.reduce((de,M)=>de.plus(new f(M.value)),new f(0)).minus(te).integerValue(f.ROUND_DOWN)}}else if($t(s))g=m.minus(s.gasBudget);else return Se(s);return g.isGreaterThan(gt)?g:u?gt:g};i();a();var Nn=(e,t,n)=>{let r=Tn(e,t),{fungibles:o,isLoadingTokens:s,isErrorTokens:u,isErrorPrices:c}=ae({...n,keys:r?[r]:[]});return{isError:c||u,fungible:o.length===1?o[0]:void 0,isLoading:s}};var ro=(e,t,n,r=new f(0),o)=>{let{fungible:s,isLoading:u,isError:c}=Nn(e,t),l="unknown",m="",g=(0,yt.useMemo)(()=>{let S=s?.data.walletAddress;if(!S)return;let I=Gt(e,S);return{networkID:e,address:S,addressType:I}},[e,s?.data.walletAddress]),y=ft({chainAddress:g,type:s?.type,balance:s?.data.balance,decimals:s?.data.decimals??0,recipient:o,gasEstimation:n,clampToZero:!1});return!c&&s&&y&&(y.gte(r)?l="sufficient":l="insufficient",m=s.data.symbol||""),(0,yt.useMemo)(()=>({hasSufficientFunds:l,nativeTokenSymbol:m,isLoading:u,isError:c}),[l,m,u,c])};i();a();var Vn=b(T());i();a();var St=b(T());i();a();var On=({chainAddresses:e=[]})=>{let t=E.tokensErrorCount(e);return N({queryKey:t,initialData:0})};i();a();var oo=({errors:e})=>e;function Ln({chainAddresses:e,queryOptions:t}){return An({select:oo,chainAddresses:e,queryOptions:t})}var _n=3,io=1,Ce=({networkID:e,chainAddresses:t=[]})=>{let{data:n=[]}=Ln({chainAddresses:t}),{data:r=0}=On({chainAddresses:t}),o=r>=_n,{data:s=0}=mn(),u=s>=_n,c=n.length===io&&n.some(g=>g.code==="TokensTrimmed"),{t:l}=k(),m=(0,St.useMemo)(()=>{if(o)return l("partialErrorGeneric");let g=n.filter(S=>e?S.details.chainId===e:!0),y=g.length+(u?1:0);return y?y>1?l("partialErrorGeneric"):u?l("partialErrorTokenPrices"):c?l("partialErrorTokensTrimmed"):e?l("partialErrorTokenDetail"):l("partialErrorBalanceChainName",{chainName:h.getChainName(g[0].details.chainId)}):""},[o,n,u,e,c,l]);return(0,St.useMemo)(()=>({partialErrorMessage:m,shouldShowPartialError:m!==""}),[m])};function ao(e){let{onTappingBuy:t,onTappingReceive:n,onTappingSend:r,onTappingSwap:o,account:s}=e,{shouldShowPartialError:u,partialErrorMessage:c}=Ce({chainAddresses:s?.addresses});return{ctaActions:so({onTappingBuy:t,onTappingReceive:n,onTappingSend:r,onTappingSwap:o}),shouldShowPartialError:u,partialErrorMessage:c}}function so(e){let{t}=k();return(0,Vn.useMemo)(()=>{let r=[];return r.push({text:t("commandSend"),type:"send",onClick:e.onTappingSend}),r.push({text:t("commandSwap"),type:"swap",onClick:e.onTappingSwap}),r.push({text:t("commandReceive"),type:"receive",onClick:e.onTappingReceive}),r.push({text:t("commandBuy"),type:"buy",onClick:e.onTappingBuy}),r.sort((o,s)=>(ut.get(o.type)??100)-(ut.get(s.type)??100)),{primary:r,more:[]}},[t,e.onTappingSend,e.onTappingSwap,e.onTappingReceive,e.onTappingBuy])}i();a();i();a();i();a();i();a();var uo="TokenDetailNotLoading";async function At(e){let t=be(e.caip19),n=t.resourceType==="nativeToken"?t.slip44:t.address,r=await re.api().timeout(oe({seconds:10})).get(`/tokens/v1/${t.chainId}/${t.resourceType}/${n}`);if(r.status!==200)throw new Je({key:uo});let o=await r.data;pn.parse(o.data);let s=o.data.description,u=s&&s.replace(/<[^>]*>/g,"");return{...o,data:{...o.data,description:u}}}i();a();var Gn={fungibleDetail({caip19:e}){return["fungibleDetail",{caip19:e}]}};var po="get-fungible-detail",Kn=e=>({gcTime:Te.Short,staleTime:Oe.Long,queryKey:Gn.fungibleDetail({caip19:e.caip19}),async queryFn(){try{return(await At(e)).data}catch(t){if(ze(t)){let n=t.response?.status;rt(t,n,po,{})}throw t}}});function Tt(e){return N(Kn(e))}var W=b(T());i();a();var Qn=b(T());i();a();var Hn=({canSwap:e,fungible:t,openBuySellToken:n})=>({swapBuy:{enabled:e,onClick:()=>n(z(ce(t)),"buy")},swapSell:{enabled:e&&new f(t.data.amount?t.data.amount:0).gt(0),onClick:()=>n(z(ce(t)),"sell")}});i();a();var lo=[{type:"swapBuy",textKey:"commandBuy"},{type:"swapSell",textKey:"commandSell"}],Wn=({t:e,trackFooterCtaClick:t,enabledCtas:n})=>lo.reduce((r,o)=>{let s=n[o.type];return s===void 0?r:!!("enabled"in s?s.enabled:s.onClick)&&s.onClick?[...r,{type:o.type,text:e(o.textKey),onClick:()=>{t(o.type),s.onClick()}}]:r},[]);var qn=({fungible:e,canSwap:t,openBuySellToken:n})=>{let{t:r}=k(),o=K();return(0,Qn.useMemo)(()=>e?Wn({t:r,trackFooterCtaClick:u=>{o.capture("fungibleFooterCtaClicked",{data:{action:u,caip19:z(ce(e))}})},enabledCtas:{...Hn({canSwap:t,fungible:e,openBuySellToken:n})}}):[],[o,e,n,t,r])};i();a();var wt={control:{showSwapButtons:!1,replaceSwapCta:!1},"show-swap-buttons":{showSwapButtons:!0,replaceSwapCta:!1},"replace-swap-cta":{showSwapButtons:!0,replaceSwapCta:!0}},$n=()=>{let e=Xe.getMultivariateAssignment("swap-buysell-buttons-config"),t=e?wt[e]:null;return t||(Xe.isFeatureEnabled("swap-buysell-buttons-config")?wt["show-swap-buttons"]:wt.control)};i();a();function mo({fungibleDetail:e,showSummaryTooltip:t,copyAddress:n,fungibleType:r}){if(!e)return;let o=[];A(o,d.t("nounSymbol"),e.symbol),A(o,d.t("nounNetwork"),e.chain.name),A(o,_t.safeParse(e.chain.id).success?d.t("publicFungibleDetailMint"):d.t("publicFungibleDetailContract"),n),lr(o,d.t("publicFungibleDetailMarketCap"),e.marketCap);let s=Re(e.totalSupply);A(o,d.t("publicFungibleDetailTotalSupply"),s);let u=Re(e.circulatingSupply);A(o,d.t("publicFungibleDetailCirculatingSupply"),u);let c=So(e.maxSupply);A(o,d.t("publicFungibleDetailMaxSupply"),c);let l=Re(e.holders);A(o,d.t("publicFungibleDetailHolders"),l);let m=yo(e.mintExtensions?.find(yn)?.state.newerTransferFee.transferFeeBasisPoints);return A(o,d.t("sendFungibleTransferFee"),m,d.t("sendFungibleTransferFeeToolTip"),t),r==="CompressedSPL"&&A(o,d.t("assetDetailCompressed"),d.t("assetDetailCompressedYes")),o}function go(e){if(!e)return;let t=[],n=xe(e.volume24hUSDChangePercentage,{includePlusPrefix:!0});lr(t,d.t("publicFungibleDetailVolume"),e.volume24hUSD,n);let r=Re(e.trades24h),o=xe(e.trades24hChangePercentage,{includePlusPrefix:!0});zn(t,d.t("publicFungibleDetailTrades"),r,o);let s=Re(e.uniqueWallets24h),u=xe(e.uniqueWallets24hChangePercentage,{includePlusPrefix:!0});return zn(t,d.t("publicFungibleDetailTraders"),s,u),t.length>0?t:void 0}function fo(e,t){if(!e)return;let n=[],r=xe(e.top10HoldersPercent);A(n,d.t("publicFungibleDetailTop10Holders"),r,d.t("publicFungibleDetailTop10HoldersTooltip"),t);let o=We(e.mintable);A(n,d.t("publicFungibleDetailMintable"),o,d.t("publicFungibleDetailMintableTooltip"),t);let s=We(e.mutableMetadata);A(n,d.t("publicFungibleDetailMutableInfo"),s,d.t("publicFungibleDetailMutableInfoTooltip"),t);let u=We(e.ownershipRenounced);A(n,d.t("publicFungibleDetailOwnershipRenounced"),u,d.t("publicFungibleDetailOwnershipRenouncedTooltip"),t);let c=Yn(e.updateAuthority);A(n,d.t("publicFungibleDetailUpdateAuthority"),c,d.t("publicFungibleDetailUpdateAuthorityTooltip"),t);let l=Yn(e.freezeAuthority);A(n,d.t("publicFungibleDetailFreezeAuthority"),l,d.t("publicFungibleDetailFreezeAuthorityTooltip"),t);let m=jn(e.mintExtensions?.find(Sn)?.state.delegate);A(n,d.t("permanentDelegateTitle"),m,d.t("permanentDelegateTooltipValue"),t);let g=jn(e.mintExtensions?.find(bn));return A(n,d.t("sendFungibleNonTransferable"),g,d.t("sendFungibleNonTransferableToolTip"),t),n.length>0?n:void 0}function Xn(e,{derivedSpamStatus:t,includeUgcItemTypes:n,caip19:r,hasFungibleDetail:o}){t!=="VERIFIED"&&(o&&n?e.push({type:"ugcWarningBanner",data:{caip19:r,spamStatus:t}}):!n&&o&&e.push({type:"unverifiedBanner"}))}function Jn(e,{fungible:t,derivedSpamStatus:n,onMarkNotSpamAsync:r}){n!=="VERIFIED"&&t&&n&&n==="POSSIBLE_SPAM"&&e.push({type:"spamTreatment",data:{fungible:t,spamStatus:n,markAsNotSpam:r}})}function Zn(e,{isLoading:t,shouldShowPartialError:n,partialErrorMessage:r}){!t&&n&&e.push({type:"partialError",data:r})}function er(e,{caip19:t}){e.push({type:"priceHistory",data:{caip19:t}})}function tr(e,{isLoading:t,isErrorFungibleDetail:n}){t||!n||e.push({type:"error",data:void 0})}function nr(e,{isLoading:t,actions:n}){if(t){e.push({type:"cta",data:{status:"pending"}});return}n.primary.length>0&&e.push({type:"cta",data:{status:"success",actions:n}})}function rr(e,{isLoading:t,fungible:n,isReadOnly:r}){if(t){e.push({type:"balance",data:{status:"pending"}});return}n&&(e.push({type:"balance",data:{status:"success",fungible:n}}),!r&&n.type==="SolanaNative"&&(e.push({type:"sectionHeader",data:d.t("assetDetailStakingLabel")}),e.push({type:"staking",data:n})))}function or(e,{isLoading:t,fungibleDetail:n}){if(t){e.push({type:"about",data:{status:"pending"}});return}n?.description&&e.push({type:"sectionHeader",data:d.t("publicFungibleDetailAbout")},{type:"about",data:{status:"success",description:n.description.trim()}})}function ir(e,{isLoading:t,fungibleDetail:n,trackLink:r}){t||!n?.links||e.push({type:"links",data:{links:n.links,trackAction:r}})}function ar(e,{isLoading:t,fungible:n,fungibleKeys:r,caip19:o,derivedSpamStatus:s}){t||!n||n.data.balance.gt(0)&&s!=="POSSIBLE_SPAM"&&n.type!=="CompressedSPL"&&e.push({type:"transactionHistory",data:{fungible:n,caip19:o,fungibleKey:(r??[]).find(Boolean)}})}function sr(e,{isLoading:t,fungibleDetail:n,showSummaryTooltip:r}){if(t)return;let o=fo(n,r);o&&e.push({type:"sectionHeader",data:d.t("publicFungibleDetailSecurity")},{type:"table",data:{key:"security",rows:o}})}function ur(e,{isLoading:t,fungibleDetail:n}){if(t)return;let r=go(n);r&&e.push({type:"sectionHeader",data:d.t("publicFungibleDetailPerformance")},{type:"table",data:{key:"performance",rows:r}})}function pr(e,{isLoading:t,fungibleDetail:n,fungibleType:r,copyAddress:o,showSummaryTooltip:s,includeUgcItemTypes:u,caip19:c}){if(t)return;let l=mo({fungibleDetail:n,fungibleType:r,copyAddress:o,showSummaryTooltip:s});l&&(e.push({type:"sectionHeader",data:d.t("publicFungibleDetailInfo")}),u?e.push({type:"tableWithBondingCurveProgress",data:{caip19:c,rows:l,key:"info"}}):e.push({type:"table",data:{key:"info",rows:l}}))}var Yn=e=>e?Ze(e):void 0,yo=e=>e?xe(fn(e)):void 0,xe=(e,t)=>e?Nt(e/100,t):void 0,Re=e=>e?pt(e):void 0,So=e=>e===null?"\u221E":e===void 0?void 0:pt(e),We=e=>e==null?void 0:e?d.t("nounYes"):d.t("nounNo"),jn=e=>e==null?void 0:We(!!e);function A(e,t,n,r,o){n&&e.push({label:t,value:n,tooltipContent:r,handleTooltip:o?()=>{o(t,r??"")}:void 0})}function zn(e,t,n,r,o,s){!n||!r||e.push({label:t,value:n,change:r,tooltipContent:o,handleTooltip:s?()=>{s(t,o??"")}:void 0})}function lr(e,t,n,r){if(!n)return;let o={label:t,value:null,usdValue:n};r&&(o.change=r),e.push(o)}i();a();var Z=b(T());i();a();var cr=b(T());var Ft=e=>{let{data:t}=Wt();return(0,cr.useMemo)(()=>{if(!e||!t)return;let n=e.data.chain.id,r=t.explorers[n]??et.get(n).defaultExplorer,o,s;if(O(e.type))s="address",o=e.data.walletAddress;else switch(e.type){case"SuiCoin":{s="token",o=e.data.contractAddress;break}case"ERC20":{s="address",o=e.data.contractAddress;break}case"SPL":case"CompressedSPL":{s="address",o=e.data.mintAddress;break}case"BRC20":return{explorerName:"Unisat",explorerUrl:`https://unisat.io/brc20?q=${e.data.walletAddress}`}}let u=nt({networkID:n,endpoint:s,explorerType:r,param:o});return{explorerName:tt[r],explorerUrl:u}},[e,t])};var bo=[{type:"receive",text:"commandReceive"},{type:"send",text:"commandSend"},{type:"decompress",text:"commandClaim"},{type:"swap",text:"commandSwap"},{type:"buy",text:"commandBuy"},{type:"share",text:"commandShare"},{text:"assetDetailStakeSOL",singleWordAltText:"commandStake",type:"stakeSol",menuOnly:!0},{text:"commandMintLST",singleWordAltText:"commandMintLST",type:"mintLST",menuOnly:!0},{text:"assetDetailUnwrapAll",singleWordAltText:"commandUnwrap",type:"unwrapWrappedSol",menuOnly:!0},{text:"commandStake",singleWordAltText:"commandStake",type:"stake",menuOnly:!0},{text:"commandUnstake",singleWordAltText:"commandUnstake",type:"unstake",menuOnly:!0},{text:"commandReportAsSpam",type:"reportAsSpam",isDestructive:!0,menuOnly:!0},{text:"commandReportAsNotSpam",type:"reportAsNotSpam",isDestructive:!0,menuOnly:!0},{text:"",singleWordAltText:"commandView",type:"viewOnExplorer",menuOnly:!0}];function Ao(e,t){return bo.reduce((n,r)=>{let o=e[r.type];return o===void 0?n:!!("enabled"in o?o.enabled:o.onClick)&&o.onClick?[...n,{...r,onClick:o.onClick,text:o.text?o.text:t(r.text),..."singleWordAltText"in r&&{singleWordAltText:t(r.singleWordAltText)},..."typeSpecificMetadata"in o&&{typeSpecificMetadata:o.typeSpecificMetadata}}]:n},[])}function mr(e){let{accountId:t,caip19:n,showCashBuyText:r,canBuy:o,canSwap:s,fungible:u,fungibleCaip19:c,openBuy:l,openLink:m,openSwapper:g,onReceive:y,onSend:S,title:I,onShare:P,onUnwrapWrappedSol:ee,onDecompressSpl:ue,onStakeSol:Q,derivedSpamStatus:v,onNativeMintLSTPress:te,onStakeLSTPress:ke,onUnstakeLSTPress:de,isReadOnly:M}=e,{t:me}=k(),{data:$e}=Ht(),{onMarkAsSpam:Ie,onMarkNotSpam:L}=ht({fungible:u,accountId:t,fungibleCaip19:c}),q=dr(y,u),pe=dr(S,u),B=u?.type==="CompressedSPL",Me=(0,Z.useCallback)(()=>{n&&g({buyFungibleCaip19:n})},[n,g]),$=Ft(u),ge=(0,Z.useCallback)(()=>{$?.explorerUrl&&m($?.explorerUrl)},[$?.explorerUrl,m]),Y=!!u&&u.data.balance.gt(0),fe=O(u?.type),Ue=!!u&&!!u.data.walletAddress,F={caip19:n,hasBalance:Y,title:I},ye=hn.getUrlFromFungible({caip19:c,isAnalyticsOptedOut:!!$e}),C=u&&u.type==="SPL"&&u?.data.tokenAddress===Be.toBase58()&&!M&&u.data.balance.isGreaterThan(f(an).dividedBy(w.LAMPORTS_PER_SOL)),{mutateAsync:ne}=mt(),Ye=Ao({receive:{enabled:!M&&(Y||fe)&&Ue,onClick:q,typeSpecificMetadata:F},send:{enabled:!M&&Y&&!B,onClick:pe,typeSpecificMetadata:F},decompress:{enabled:B,onClick:ue&&u?()=>{ue(u)}:void 0},swap:{enabled:!M&&s,onClick:Me,typeSpecificMetadata:F},buy:{enabled:!M&&o,onClick:l,text:r?me("commandCashBuy"):void 0,typeSpecificMetadata:F},unwrapWrappedSol:{enabled:C,onClick:ee?()=>ee(ne):void 0},stakeSol:{enabled:!M&&u?.type==="SolanaNative",onClick:Q,typeSpecificMetadata:F},mintLST:{enabled:!M&&Y,onClick:te},stake:{enabled:!M&&Y,onClick:ke},unstake:{enabled:!M&&Y,onClick:de},share:{onClick:ye?()=>P(ye):void 0,typeSpecificMetadata:F},reportAsSpam:{enabled:v&&!we(v),onClick:Ie,typeSpecificMetadata:F},reportAsNotSpam:{enabled:v&&we(v),onClick:L,typeSpecificMetadata:F},viewOnExplorer:{enabled:!!$,onClick:ge,text:me("assetDetailViewOnExplorer",{explorer:$?.explorerName}),typeSpecificMetadata:{...F,origin:Bt($?.explorerUrl)}}},me);return wn(Ye,4)}function dr(e,t){return(0,Z.useMemo)(()=>{if(e)return()=>{t&&e(t)}},[e,t])}function ht({fungible:e,accountId:t,fungibleCaip19:n}){let r=K(),{mutateAsync:o}=lt(),s=(0,Z.useCallback)(async()=>{!e||!t||(r.capture("fungiblesReportAsNotSpam",{data:{caip19:z(n)}}),await o({accountId:t,mutations:[{fungibleKey:e.data.key,visibility:"visible:reported_notSpam"}]}))},[t,e,o,r,n]),u=(0,Z.useCallback)(()=>{s()},[s]);return{onMarkAsSpam:(0,Z.useMemo)(()=>{if(e&&O(e.type))return;let l=Fn({analytics:r,fungible:e,accountId:t,setVisibilityOverrides:o});if(l)return()=>{l()}},[t,e,o,r]),onMarkNotSpam:u,onMarkNotSpamAsync:s}}function To(e){let{fungibleAnalytics:t,caip19:n,canBuy:r,canSwap:o,entryPoint:s,fungibleKey:u,openBuy:c,openLink:l,openSwapper:m,openBuySellToken:g,showSummaryTooltip:y,title:S,onShare:I,onSend:P,onReceive:ee,copyAddress:ue,includeUgcItemTypes:Q,refetchBondingCurve:v,onUnwrapWrappedSol:te,onDecompressSpl:ke,onStakeSol:de,onNativeMintLSTPress:M,onStakeLSTPress:me,onUnstakeLSTPress:$e}=e,Ie=K(),L=(0,W.useMemo)(()=>be(n),[n]),{data:q}=H(),pe=q?.isReadOnly??!1,{data:B,refetch:Me,isError:$}=Tt({caip19:n}),ge=Ro(u,L);!u&&h.getChainName(L.chainId)===h.bitcoin.name&&L.resourceType==="nativeToken"&&(ge=at(L,q?.addresses.find(je=>je.networkID==="bip122:000000000019d6689c085ae165831e93")?.address));let{fungibles:Y,isLoadingTokens:fe,refetch:Ue}=ae({keys:ge}),F=Co(Y),ye=xo(B,F,S),U=wo({fungible:F,fungibleDetail:B,fungibleCaip19:L}),C=fe||!U,ne=Eo({fungible:U,accountId:q?.identifier}),{onMarkNotSpamAsync:Ye}=ht({fungible:U,accountId:q?.identifier,fungibleCaip19:L}),{partialErrorMessage:kr,shouldShowPartialError:Ir}=Ce({chainAddresses:q?.addresses,networkID:L.chainId}),Et=(0,W.useRef)(!1);(0,W.useEffect)(()=>{!Et.current&&!fe&&(Et.current=!0,t.onPublicFungiblePageOpen({caip19:n,uiContext:{name:s},hasBalance:!!U?.data.balance.gt(0)}))},[t,n,U,s,fe]);let Mr=(0,W.useCallback)(()=>{Promise.all([Me(),Ue(),v()])},[Me,Ue,v]),Ur=(0,W.useCallback)(je=>{Ie.capture("onPublicFungibleLinkOpen",{data:{url:je}})},[Ie]),Ct=ko({networkEnabled:o(U?.data.chain.id),isCompressedSPL:U?.type==="CompressedSPL",derivedSpamStatus:ne}),xt=(0,W.useMemo)(()=>$n(),[]),Rt=xt.showSwapButtons,Dr=Rt&&!pe&&Ct,Pr=!xt.replaceSwapCta&&Ct,vr=qn({fungible:U,openBuySellToken:g,canSwap:Dr}),De=mr({caip19:n,showCashBuyText:Rt,canBuy:r,canSwap:Pr,fungible:U,fungibleCaip19:L,openBuy:c,openLink:l,openSwapper:m,onSend:P,onReceive:ee,title:ye,onShare:I,isReadOnly:pe,derivedSpamStatus:ne,accountId:q?.identifier,onUnwrapWrappedSol:te,onDecompressSpl:ke,onStakeSol:de,onNativeMintLSTPress:M,onStakeLSTPress:me,onUnstakeLSTPress:$e}),kt=!pe&&De.primary.length===0&&De.more.length>0,x=[];return Zn(x,{isLoading:C,shouldShowPartialError:Ir,partialErrorMessage:kr}),er(x,{isLoading:C,caip19:n}),nr(x,{isLoading:C,actions:De}),Jn(x,{fungible:U,derivedSpamStatus:ne,onMarkNotSpamAsync:Ye}),Xn(x,{derivedSpamStatus:ne,includeUgcItemTypes:Q,caip19:n,hasFungibleDetail:!!B}),rr(x,{isLoading:C,fungible:F,isReadOnly:pe}),tr(x,{isLoading:C,isErrorFungibleDetail:$}),or(x,{isLoading:C,fungibleDetail:B}),ir(x,{isLoading:C,fungibleDetail:B,trackLink:Ur}),pr(x,{isLoading:C,fungibleDetail:B,copyAddress:ue,showSummaryTooltip:y,includeUgcItemTypes:Q,caip19:n,fungibleType:F?.type}),ur(x,{isLoading:C,fungibleDetail:B}),sr(x,{isLoading:C,fungibleDetail:B,showSummaryTooltip:y}),ar(x,{isLoading:C,fungible:F,fungibleKeys:ge,caip19:n,derivedSpamStatus:ne}),{title:ye,caip19:n,fungible:U,items:x,actions:kt?De:void 0,showMoreInHeader:kt,isLoading:C,footerButtons:vr,refetch:Mr}}function wo({fungible:e,fungibleDetail:t,fungibleCaip19:n}){if(e)return e;if(!t)return;let r="address"in n?Fo(n,t):ho(n,t);if(r)return r;D.captureError(new Error(`Fungible type could not be derived from ${JSON.stringify(n)}`),"fungibles")}function Fo(e,t){let n=it(e);if(O(n))throw new Error("Cannot create fake non-native fungible for native token");let r=t.address??e.address,o={amount:"0",balance:f(0),chain:t.chain,decimals:t.decimals,logoUri:t.logoURI??t.logoUri,name:t.name??"Unknown",symbol:t.symbol??"Unknown",key:r,walletAddress:"",spamStatus:t.spamStatus};switch(n){case"SPL":return{type:n,data:{...o,mintAddress:r,programId:"",splTokenAccountPubkey:""}};case"CompressedSPL":return{type:n,data:{...o,mintAddress:r,programId:""}};case"ERC20":case"SuiCoin":return{type:n,data:{...o,contractAddress:r}};case"BRC20":return{type:n,data:{...o,firstCreatedInscriptionId:r}};default:Se(n)}}function ho(e,t){let n=it(e),r={amount:"0",balance:f(0),chain:t.chain,decimals:t.decimals,logoUri:t.logoURI??t.logoUri,name:t.name??"Unknown",symbol:t.symbol??"Unknown",key:n,walletAddress:"",spamStatus:t.spamStatus};switch(e.slip44){case"501":return{type:"SolanaNative",data:r};case"0":return{type:"BitcoinNative",data:r};case"60":return{type:"EthereumNative",data:r};case"8453":return{type:"BaseNative",data:r};case"143":return{type:"MonadNative",data:r};case"966":return{type:"PolygonNative",data:r};case"784":return{type:"SuiNative",data:r};default:{let o=new Error("Missing native token implementation when creating fake a Fungible");throw Se(e.slip44,o),o}}}function Eo({fungible:e,accountId:t}){let{data:n}=st(t??"");return e?dn(n,{key:e.data.key,spamStatus:e?.data.spamStatus??"NOT_VERIFIED"}):void 0}var Co=e=>{if(e?.length)return e.reduce((t,n)=>!t||t.data.balance.lt(n.data.balance)?n:t,void 0)},xo=(e,t,n)=>e?.name||t?.data.name||n||"",Ro=(e,t)=>e?[e]:t?at(t):void 0,ko=({networkEnabled:e,isCompressedSPL:t,derivedSpamStatus:n})=>e&&!t&&!!n&&!we(n);i();a();var gr=b(T());var Io=({networkID:e,unsignedTransaction:t,pendingActivityRows:n,accountIdentifier:r,accountSigner:o,storage:s,includeCallPayload:u})=>({accountSigner:o,accountIdentifier:r,networkID:e,unsignedTransaction:t,...u&&{callPayload:{from:t.from,to:t.to,data:t.data,value:t.value}},pendingTransactionInput:{ownerAddress:t.from,networkID:e,data:{nonce:"",unsignedTransaction:t,hash:""},type:"swap",display:{summary:n}},storage:s}),Mo=async({t:e,fungible:t,unsignedUnwrapTx:n,gasEstimation:r,storage:o,accountMetadata:s,accountSigner:u})=>{if(!n)throw new Error("Unsigned unwrap transaction is required");if(!r)throw new Error("Gas estimation is required");let{chain:c,balance:l}=t.data;if(!h.isEthereumNetworkID(c.id))throw new Error(`Chain is not supported: ${c.id}`);let m=c.id,g={topRight:{text:`+${l} ${c.symbol}`},topLeft:{text:e("transactionsPendingSwapping")},bottomRight:{text:`-${l} ${t.data.symbol}`},bottomLeft:{text:`${t.data.name}`}},y=It.parse({type:"0x2",chainId:h.getEVMNetworkIDValue(m),gas:`0x${r.gasLimit.toString(16)}`,maxFeePerGas:`0x${r.maxFeePerGas.toString(16)}`,maxPriorityFeePerGas:`0x${r.maxPriorityFeePerGas.toString(16)}`,...n}),S=Io({storage:o,accountSigner:u,pendingActivityRows:g,includeCallPayload:!1,networkID:m,unsignedTransaction:y,accountIdentifier:s.accountIdentifier});return en(S)},Uo=()=>{let{data:e}=H();return(0,gr.useMemo)(()=>{let n=e?.type,r=e?.name??"",o=e?.identifier??"";return{accountName:r,accountType:n,accountIdentifier:o}},[e])},Do=e=>{let t=G(),n=_(),{t:r}=k(),o=Uo(),s=X();return V({async mutationFn({fungible:u,unsignedUnwrapTx:c,gasEstimation:l}){return await Mo({t:r,fungible:u,unsignedUnwrapTx:c,gasEstimation:l,accountMetadata:o,storage:t,accountSigner:s})},async onSuccess(){await n.invalidateQueries({queryKey:E.tokens(e)})}})};i();a();i();a();i();a();var fr=()=>{let{setRetryArgs:e}=dt();return t=>{if(t instanceof Zt){let{successfulTxIds:n}=t,[r,o]=n;e({type:"BRC20",commitTxId:r,revealTxId:o})}}};function Po(){let e=G(),{data:t}=H({select:u=>u.identifier}),n=fr(),r=gn(),o=X();return V({mutationFn:async({multichainTransaction:u,pendingTransactionInput:c,senderAddress:l,gasEstimation:m})=>{if(!t)throw new Error("No account identifier found");let{networkID:g}=u,y=await jt.get(g).onBeforeSend({multichainTransaction:u,gasEstimation:m}),S=await un({accountIdentifier:t,accountSigner:o,multichainTransaction:y,networkID:g,pendingTransactionInput:c,senderAddress:l,storage:e,utxoManager:r});return sn(g,S)},onError(u){u instanceof Error&&(D.captureError(u,"fungibles"),u instanceof Jt&&n(u))}})}i();a();var yr=b(T());var vo=(e,t,n)=>{let r=_(),{fungibles:o}=ae({keys:[e]}),s=o.length===1?o[0]:void 0;(0,yr.useEffect)(()=>{if(!s)return;let{type:u,data:c}=s,{balance:l,decimals:m,chain:g}=c,{id:y}=g,S=O(u)===!0;if(!n||!l||S||l.isEqualTo(t))return;let I=E.transferFungibleLoggingContext(e),P={transactionId:n,decimals:m,chainId:y,isNativeToken:S,previousBalance:l,fungibleKey:e};r.setQueryData(I,P)},[n])};i();a();var Sr=oe({minutes:1}),Bo=(e,t=!0)=>{let n=E.solanaBalance(e);return N({enabled:!!e&&t&&ie(e),gcTime:Sr,staleTime:Sr,queryKey:n,async queryFn(){if(!e)throw new Error("No chain address provided");if(ie(e))return zt(e.networkID).getBalance(new w.PublicKey(e.address));throw new Error(`SOL balance not implemented for ${e.networkID}`)}})};i();a();i();a();var Oo=b(T());i();a();i();a();var Bd=R.object({data:ln});i();a();var br=b(T());var Lo=e=>{let t=_();return(0,br.useCallback)(()=>t.invalidateQueries({queryKey:E.tokens(e)}),[t,e])};i();a();var Ar=b(T()),_o=(e,t)=>(0,Ar.useMemo)(()=>{if(e)if(ve(e)){let n=Qt(e).toNumber().toLocaleString("en-US");return{leftSubtext:void 0,leftSubtextColor:void 0,rightSubtext:t("satsAmount",{sats:n.toString()})}}else return Pe(e)&&e.highFees?{leftSubtext:t("notificationTransactionApprovalNetworkFeeHighWarning"),leftSubtextColor:"#ffdc62",rightSubtext:""}:void 0},[e,t]);i();a();var Vo=b(T());i();a();i();a();var Rr=b(T());i();a();var qe=(o=>(o.FAIL_SEVERE="FAIL_SEVERE",o.FAIL_HIGH="FAIL_HIGH",o.NO_ACTION="NO_ACTION",o.DATA_NOT_FOUND="DATA_NOT_FOUND",o))(qe||{}),Ko=R.object({action:R.nativeEnum(qe),address:Vt,expirationUnixtimeInSec:R.number().nullish().default(null)}),Tr=R.object({addressScreenResults:R.array(Ko)}),Qe=class extends Error{constructor(t){super(t),this.name="WalletScreenError"}};i();a();i();a();var Ho="@phantom/wallet-screening",wr=`${Ho}:wallet-screen-action`,Fr={walletScreenAction(e){return[wr,e]}};i();a();var hr=new Error("Failed to fetch wallet screen action.");async function Er(e){try{let t=await re.api().post("/wallet_screen/v1",e);if(!Ut(t))throw hr;let n=t.data;return Tr.parse(n)}catch{throw hr}}var Cr=oe({days:7}),xr=e=>{let t=e!==void 0&&h.isMainnetNetworkID(e.networkID),n=[];if(e!==void 0){let c=h.isEVMNetworkID(e.networkID)?e.address.toLowerCase():e.address;n=[{chainId:e.networkID,address:c,resourceType:"address"}]}let r={addresses:n},o=_(),s=Fr.walletScreenAction(r),u=[s[0]];return N({enabled:t,queryKey:s,gcTime:Cr,staleTime:Cr,refetchInterval:!1,refetchOnMount:!1,async queryFn(){if(Wo(o,u))return"FAIL_SEVERE";let l=await Er(r);return Qo(l)}})},Wo=(e,t)=>{let n=e.getQueriesData({queryKey:t,exact:!1}),r=!1;for(let[o,s]of n){let u=s;if(u&&u==="FAIL_SEVERE"){r=!0;break}}return r},Qo=e=>{let t=e.addressScreenResults;return t.some(n=>n.action==="FAIL_SEVERE")?"FAIL_SEVERE":t.some(n=>n.action==="FAIL_HIGH")?"FAIL_HIGH":t.some(n=>n.action==="NO_ACTION")?"NO_ACTION":"DATA_NOT_FOUND"};var qo=(e,t)=>{let n=K(),{data:r}=xr(e);switch((0,Rr.useEffect)(()=>{r&&e&&n.capture("walletScreened",{data:{walletScreen:{action:r.toString(),surface:t},chainId:h.getChainID(e.networkID),networkId:e.networkID}})},[r,e,t,n]),r){case"FAIL_SEVERE":case"FAIL_HIGH":throw new Qe(`Transaction disabled: ${t}`);case"NO_ACTION":case"DATA_NOT_FOUND":return}};i();a();i();a();export{En as a,Cn as b,Un as c,Xr as d,lt as e,xn as f,dt as g,Jr as h,Po as i,vo as j,ft as k,mt as l,no as m,Bo as n,ro as o,ao as p,Lo as q,_o as r,Tt as s,To as t,Do as u,Qe as v,wr as w,qo as x};
//# sourceMappingURL=chunk-PKAXVJFX.js.map
