import{a as zn}from"./chunk-XUF4GR6V.js";import{a as jn,b as Zn,d as Xn,e as Yn,f as qn}from"./chunk-5XCOLT7V.js";import{a as wo}from"./chunk-B5HUTZOW.js";import{a as xt}from"./chunk-GIUU5FZA.js";import{a as kt}from"./chunk-I5RT5666.js";import{d as $n}from"./chunk-255U7RYV.js";import{f as _n}from"./chunk-MP5POVPU.js";import{a as ut}from"./chunk-QY4L72L3.js";import{h as Kn,j as Wn}from"./chunk-BL5NQCM4.js";import{O as Gn,db as Ye,v as Hn}from"./chunk-ONJA4ZEG.js";import{e as J}from"./chunk-RBBZHETH.js";import{J as Un,oa as Ln}from"./chunk-ZZPI23JA.js";import{o as nn}from"./chunk-2THQDEWP.js";import{f as dt,g as f,i as hn,j as Cn,k as vn,n as In,o as En,q as Rn,r as Nn,x as On}from"./chunk-PKAXVJFX.js";import{Bc as Tn,E as sn,Ic as Fn,Oc as kn,Qc as xn,Ra as dn,Sa as cn,Sc as wn,Tb as it,Tc as We,Vb as ln,Vc as xe,Wb as Ke,Yb as un,_c as _e,ac as pn,cc as fn,cd as Bn,dc as Ft,fa as Pe,ha as an,id as Pn,jc as gn,jd as Dn,nc as Sn,qc as bn,uc as yn,wb as Xe,wc as An,xb as mn,zc as ct}from"./chunk-R5HJQXZQ.js";import{h as Tt}from"./chunk-PPMPQKRK.js";import{b as at}from"./chunk-UDFQ3C42.js";import{R as on,Z as ke}from"./chunk-P4LRI3S3.js";import{h as Te}from"./chunk-GBKSQA4Y.js";import{R as Vn,b as mt,n as Z,o as D,t as Mn,w as lt}from"./chunk-BFV33OZC.js";import{Cb as Qt,L as ot,Lb as Jt,Pd as Fe,Yb as en,de as rn,gb as E,gd as Ge,ib as Ze,md as tn,x as Ot,ze as st}from"./chunk-S6KJ2BHO.js";import{a as d,l as qt,m as ae}from"./chunk-MNQ7RLHG.js";import{F as Gt,Ra as rt,ma as Yt,p as Ht,xa as Be}from"./chunk-NMZ7IVPZ.js";import{$ as Xt,S as _t,U as $t,V as zt,X as jt,_ as Zt,b as ge,ca as ht,da as Ne,f as Kt,x as Wt}from"./chunk-H6ILHDLW.js";import{a as I}from"./chunk-7X4NV6OJ.js";import{f as v,h as i,m as Buffer,n as a}from"./chunk-3KENBVE7.js";i();a();var $e=v(I());i();a();var Ce=v(I());i();a();var we=v(I());i();a();var Qn=Gt==="extension"?"onClick":"onPress";var Jn=({goHome:e})=>we.default.createElement(Z,{height:"100%",paddingY:36,paddingX:"screen",justifyContent:"center",alignItems:"center"},we.default.createElement(Z,{flex:1,justifyContent:"center",alignItems:"center"},we.default.createElement(Z,{marginBottom:24},we.default.createElement(lt,{icon:"X",size:64,shape:"circle",backgroundColor:"accentAlert"})),we.default.createElement(D,{color:"textPrimary",align:"center",font:"title1Semibold",marginBottom:8},d.t("sendErrorTitle")),we.default.createElement(D,{color:"textSecondary",align:"center",font:"body"},d.t("sendErrorFallback"))),we.default.createElement(Mn,{theme:"secondary",[Qn]:e},d.t("homeTab")));var wt=(0,Ce.createContext)(!1),Rr=({goHome:e,children:t})=>{let n=(0,Ce.useCallback)(()=>{f.getState().resetSendSlice(),e()},[e]);return Ce.default.createElement(ut,{fallback:o=>{if(o instanceof dt)return Ce.default.createElement(Jn,{goHome:n});throw o}},Ce.default.createElement(wt.Provider,{value:!0},t))};i();a();var to=v(I());i();a();var Ct=(e,t)=>{let n=Te(e,4);return t?`${t} (${n})`:n};i();a();i();a();var eo=(e,t)=>{let{getExistingAccount:n,getKnownAddressLabel:o}=ke();if(!e)return null;let r=n(e),s=o(e,t),m=r?r.name:s;return m||null};var vt=({recipient:e,recipientHandle:t,networkID:n})=>{let o=eo(e,n),{data:r}=Sn(e,n),s=r?.address&&e;return{recipient:r?.address?r.address:e,recipientHandle:t||o||s||""}};var pt=()=>{let e=f(s=>s.sendFormValues.recipient),t=f(s=>s.sendFormValues.recipientHandle),n=f(s=>s.fungibleKey),o=f(s=>s.splTokenAccount),{fungible:r}=We({key:n,splTokenAccount:o});return vt({recipient:e,recipientHandle:t,networkID:r?.data.chain.id??Ze.Solana.Mainnet})},It=()=>{let{recipient:e,recipientHandle:t}=pt();return(0,to.useMemo)(()=>Ct(e,t),[e,t])};var re=()=>{if(!(0,$e.useContext)(wt))throw new Error("useSendFungibleFlow must be used within a SendFungibleFlowErrorBoundary");let t=f(z=>z.fungibleKey),n=f(z=>z.splTokenAccount),{fungible:o}=We({key:t,splTokenAccount:n}),[r]=(0,$e.useState)(o),{data:s}=st({address:r?.data.walletAddress,networkID:r?.data.chain.id});if(!s||!r)throw new dt("senderAddress or fungible is undefined, send flow is broken");let{data:m,type:p}=r,{chain:l,decimals:c,logoUri:u,symbol:C,tokenAddress:T,balance:P,key:O}=m,U=l.id,M=C??(T?Te(T,4):d.t("tokenRowUnknownToken")),S=T??"",x=p==="SPL"?r.data.programId:null,k=It(),H=f(z=>z.sendFormValues),{amountAsset:W}=H,y=Ne(W,c),R=`${_e(y,c)} ${M}`,N=(0,$e.useMemo)(()=>xn(r),[r]),{data:F}=un({query:N?{data:N}:void 0}),{fromUsd:B,formatLocalizedPrice:w}=at(),G=F?.usd??0,_=Xe(y.toNumber(),G),ne=B(_),Se=w(ne),ve=G?`~${Se}`:"-",be=Fn(r);return{senderAddress:s,networkID:U,tokenAddress:S,symbol:M,balance:P,decimals:c,programId:x,formattedRecipient:k,uiAmount:y,usdPriceOfToken:G,formattedUiAmount:R,formattedCurrencyAmount:ve,tokenPrice:Se,logoUri:u,type:p,key:O,transferFeePercent:be}};i();a();var ft=v(I());i();a();i();a();var Co=[dn.toString(),cn.toString()],oo=async(e,t)=>{let n=an(t);try{let o=await n.getParsedAccountInfo(new ot.PublicKey(e));if(o&&Co.includes(o.value?.owner.toString()??"")&&"mintAuthority"in(o.value?.data).parsed.info)return!0}catch{}return!1};var vo=1*24*60*1e3,Io=1*60*1e3,ro=({address:e,networkID:t})=>Yt({queryKey:["is-mint-account",e],queryFn:async()=>{if(!E.isSolanaNetworkID(t))throw new Error("Attempting to get mint account for non-Solana network");return oo(e,t)},enabled:!!e&&E.isSolanaNetworkID(t),gcTime:vo,staleTime:Io});i();a();var io=v(I());i();a();var so=890880,qe=()=>{let{senderAddress:e,type:t}=re(),n=f(m=>m.sendFormValues),o=t==="SolanaNative",{data:r}=In({...e,address:n.recipient},o);return o&&typeof r<"u"&&r<so?so:0};var ao=(e,t,n)=>{let{fungibleKey:o,splTokenAccount:r}=f(P=>({fungibleKey:P.fungibleKey,splTokenAccount:P.splTokenAccount})),{data:[s]}=rt(["kill-send-simulation"]),m=qe(),p=(0,io.useMemo)(()=>{if(!(!e||s))return{sendSessionId:"simulate-send",shouldShowFiatValues:!1,fungibleKey:o,splTokenAccount:r,confirmedFungibleAndSender:null,sendFormValues:{recipient:t,recipientHandle:"",amountAsset:new ge(m===0?1:m),solana:{references:[]}}}},[s,m,e,o,t,r]),{data:l,isLoading:c}=xe(p),u={type:"transaction",userAccount:e,params:void 0,url:"https://phantom.com",networkID:n};l&&(E.isEVMNetworkID(l.networkID)&&(u.params={transactions:[l.unsignedTransaction]}),E.isSolanaNetworkID(l.networkID)&&(u.params={transactions:l.transaction.map(P=>Ot(P)),method:"signAndSendTransaction"}));let{data:C,isLoading:T}=Ln(u,{disabled:!l||s,disableRefetch:!0});return{data:C,isLoading:!s&&(c||T)}};var Eo=(e,t)=>({address:e,addressType:Qt(t,e),networkID:t}),Ro=({senderAddress:e,senderAccounts:t,networkID:n})=>(0,ft.useMemo)(()=>e?t.reduce((o,r)=>{let s=r.addresses.filter(m=>m.networkID===n&&m.address!==e);if(n)for(let m of s)o.push({label:r.name,address:m.address,chainID:n});return o},[]):[],[e,t,n]);function No(e){if(!e)return"";let{warnings:t=[],error:n=""}=e;return n==="UNKNOWN_ERROR"?t[0]?.message:n==="INSUFFICIENT_FUNDS"?d.t(`sendWarning_${n}`):""}var Bo=({senderAddress:e,recipient:t,networkID:n})=>{let{data:o,isLoading:r}=ao(e??"",t,n);return{simulationWarning:No(o),isSimulationLoading:r}},Po=({recipient:e,networkID:t})=>{let{currentRecipient:n,isStaleRecipient:o,recipientError:r}=yn(e,t);return!o&&!r&&n.length>0?n:""},Do=({recipient:e,networkID:t})=>{let{data:n=[],isLoading:o}=kn({chainAddresses:e?[Eo(e,t)]:[]});return{recipientHasZeroBalance:(0,ft.useMemo)(()=>n.length===1&&n[0].data.amount==="0",[n]),recipientTokensIsLoading:o}},Qe=({senderAddress:e,senderAccounts:t,networkID:n,recipient:o})=>{let{recentAddresses:r,savedAddresses:s}=ke(),m=Ro({senderAddress:e,senderAccounts:t,networkID:n}),p=Po({recipient:o,networkID:n}),{recipientHasZeroBalance:l,recipientTokensIsLoading:c}=Do({recipient:p,networkID:n}),{data:u,isLoading:C}=ro({address:p,networkID:n}),{simulationWarning:T,isSimulationLoading:P}=Bo({senderAddress:e??"",recipient:p,networkID:n}),O=!p||c||C&&E.isSolanaNetworkID(n)||P;return{sendAddressWarning:(0,ft.useMemo)(()=>O||!e?null:u?d.t("sendMintAccountWarning"):m.find(S=>S.address===p)?null:T||(r.addresses.find(S=>S.address===o)||s.addresses.find(S=>S.address===o)?null:e===p?d.t("sendSameAddressWarning"):l?d.t("sendRecipientZeroBalanceWarning"):d.t("sendUnknownAddressWarning")),[r,s,o,p,m,e,l,u,T,O]),sendAddressVariant:u?"danger":"warning"}};i();a();var L=v(I());i();a();function co(e,t){return e.isZero()?new ge(Pe.get(t).amountForGasEstimation??0):e}var Uo=Wt({seconds:10}),Mo=({onClose:e,onNext:t})=>{let{senderAddress:n,networkID:o,decimals:r,programId:s,type:m,balance:p,usdPriceOfToken:l,symbol:c,logoUri:u,formattedUiAmount:C,formattedCurrencyAmount:T}=re(),P=qe(),O=Ne(P,r).toNumber(),[U,M]=(0,L.useState)(""),S=(0,L.useMemo)(()=>{try{let h=new ge(U);if(!h.isNaN())return h}catch{}return new ge(0)},[U]),x=f(h=>h),k=f(h=>h.sendFormValues),H=f(h=>h.resetSendSlice),{amountAsset:W,amountUsd:y,recipient:R}=k,N=f(h=>h.setSendFormValues),F=f(h=>h.shouldShowFiatValues),B=f(h=>h.setShouldShowFiatValues),w=s===Jt,G=k.solana.memo,_=(0,L.useMemo)(()=>{let h=x.sendFormValues.recipient;return{...x,sendFormValues:{...k,recipient:h||n.address,amountAsset:co(k.amountAsset,o)}}},[k,x,n,o]),{data:ne}=xe(_),{data:Se}=Ke({networkID:o,multichainTransaction:ne,transactionSpeed:"fastest",queryOptions:{refetchInterval:Uo}}),{currencySymbol:ve,currencyCode:be,toUsd:z,fromUsd:$,formatLocalizedPrice:ye}=at(),me=vn({chainAddress:n,type:m,balance:p,decimals:r,recipient:R,gasEstimation:Se,clampToZero:!1}),q=Ne(me??0,r),Ue=Xe(q.toNumber(),l),X=$(Ue,2),le=F?ve:void 0,Q=F?void 0:` ${c}`,Ae=F?be:c,oe=(0,L.useMemo)(()=>{if(S.isZero())return;let h=ct.get(o),V=F?h.minimumSendableCurrencyAmount:O,he=F?X:q,yt=S.lt(V),At=S.gt(he);return yt?d.t("sendFormErrorMinRequiredInterpolated",{minAmount:V,tokenName:Ae}):At?d.t("sendFormErrorInsufficientBalance"):void 0},[S,F,o,X,q,O,Ae]),Y=(0,L.useCallback)(h=>{let V=Zt(h),he=Xt(V,r);M(he)},[r]),se=(0,L.useCallback)(()=>{let h=Ne(W,r).toString(10),V=$(y??0).toString(10);Y(F?h:V),B(!F)},[F,B,W,y,r,Y,$]),ue=(0,L.useCallback)(()=>{Y(F?X.toString(10):q.toString(10))},[Y,F,q,X]);(0,L.useEffect)(()=>{let h,V,he;F?(he=S.toNumber(),V=z(he),h=ht(mn(V,l,r),r)):(h=ht(S,r),V=Xe(S.toNumber(),l)),N({...f.getState().sendFormValues,amountAsset:h,amountUsd:V})},[N,S,F,l,r,z]),(0,L.useEffect)(()=>{if(U)return;let h=F?y:Ne(W,r).toNumber();h&&M(h.toString())},[]);let Me=(0,L.useMemo)(()=>F?l?`${C}`:`??? ${c}`:`${T}`,[F,l,c,C,T]),Ve=(0,L.useMemo)(()=>{let h=le??"",V=Q??"";return F?`${ye(X)}`:`${h}${_e(q)}${V}`},[F,X,q,le,Q,ye]),pe=(0,L.useCallback)(h=>{let V=k.solana;V.memo=h,N({...k,solana:V})},[k,N]),Ie=(0,L.useMemo)(()=>!oe&&W.gt(0),[oe,W]),Le=(0,L.useCallback)(()=>{Ie&&t()},[Ie,t]),nt=(0,L.useCallback)(()=>{e(),H()},[e,H]),je=(0,L.useMemo)(()=>({next:d.t("commandNext"),send:d.t("commandSend"),cancel:d.t("commandCancel"),maxInput:d.t("maxInputMax"),inputAmountPlaceholder:d.t("maxInputAmount"),recipientAddress:d.t("sendRecipientAddress"),memoPlaceholder:d.t("sendMemoOptional"),availableToSend:d.t("availableToSend"),available:d.t("available"),pageTitle:`${d.t("commandSend")} ${c}`}),[c]),j=E.isMainnetNetworkID(o);return{networkID:o,handleClose:nt,handleInputChange:Y,handleMemoChange:pe,handleNext:Le,primaryTextPrefix:le,primaryText:U,primaryTextSuffix:Q,toggleDenomination:se,errorText:oe,secondaryText:Me,formattedMaxAmount:Ve,primarySymbol:Ae,symbol:c,decimals:r,logoUri:u,canGoNext:Ie,i18nStrings:je,handleSetMax:ue,showSecondaryText:j,canSendCurrencyAmount:j&&!!l,isMemoEnabled:w,memo:G}};i();a();var de=v(I());var Vo=({onClose:e,onRecipientNavigation:t,onAmountNavigation:n,networkID:o})=>{let{recipientHandle:r}=f(y=>y.sendFormValues),{data:s,isLoading:m}=Un({usernameOrUserProfileId:r}),p=(0,de.useMemo)(()=>{if(s?.addresses)return Object.keys(s.addresses)},[s]),{fungibles:l,isLoadingTokens:c,visibilityOverrides:u}=wn(),C=(0,de.useMemo)(()=>{let y=o?l.filter(N=>N.data.chain.id===o):l;return(p?y.filter(N=>p.includes(N.data.chain.id)):y).filter(N=>N.type!=="CompressedSPL")},[o,l,p]),[T,P]=(0,de.useState)(""),O=$t(T)??"",U=zt(C,O,Bn),M=f(y=>y.resetSendSlice),S=(0,de.useMemo)(()=>({close:d.t("commandClose"),search:d.t("assetListSearch"),unknownToken:d.t("assetDetailUnknownToken"),noTokens:d.t("sendNoTokens")}),[]),x=(0,de.useCallback)(y=>P(y),[P]),k=(0,de.useCallback)(()=>{e(),M()},[e,M]),H=(0,de.useCallback)(y=>{let R=f.getState().fungibleKey;R&&R!==y.data.key&&f.getState().resetSendSlice(),f.setState({fungibleKey:y.data.key,splTokenAccount:y.type==="SPL"?y.data.splTokenAccountPubkey:void 0});let N=f.getState().sendFormValues;if(N.recipientHandle&&!N.recipient){let F=s?.addresses[y.data.chain.id];if(F){f.setState({sendFormValues:{...N,recipient:F}}),n();return}}t()},[t,n,s?.addresses]);return{fungibles:U,isLoading:c||m,visibilityOverrides:u,searchQuery:T,handleSearch:x,handleClose:k,handleSelect:H,i18nStrings:S}};i();a();i();a();var Et=v(I());var Rt=()=>{let e=f(c=>c.analyticsRecipient),t=f(c=>c.fungibleKey),n=f(c=>c.splTokenAccount),{fungible:o}=We({key:t,splTokenAccount:n}),{data:r=[]}=Fe(),{data:s}=tn(),m=(0,Et.useMemo)(()=>r.some(c=>c.addresses.some(u=>u.address===e?.address)),[r,e]),p=o?.data.chain.id??Ze.Solana.Mainnet,{data:l}=st({address:o?.data.walletAddress,networkID:p});return(0,Et.useMemo)(()=>({assetType:"token",networkId:p,recipient:e,senderAddress:l?.address??"",senderUsername:s?.username??"",tokenAddress:o?.data.tokenAddress??"",tokenSymbol:o?.data.symbol??"",tokenType:o?.type,selfSend:m}),[p,e,l?.address,s?.username,o,m])};i();a();var Lo=v(I());i();a();var Oo=v(I());i();a();var te=v(I());i();a();var uo=v(I(),1),po=v(I(),1),Ho=e=>typeof e=="function",mo=(e,t)=>Ho(e)?e(t):e,Go=(()=>{let e=0;return()=>(++e).toString()})();var Ko=20,gt=new Map,Wo=1e3,lo=e=>{if(gt.has(e))return;let t=setTimeout(()=>{gt.delete(e),St({type:4,toastId:e})},Wo);gt.set(e,t)},_o=e=>{let t=gt.get(e);t&&clearTimeout(t)},Bt=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,Ko)};case 1:return t.toast.id&&_o(t.toast.id),{...e,toasts:e.toasts.map(s=>s.id===t.toast.id?{...s,...t.toast}:s)};case 2:let{toast:n}=t;return e.toasts.find(s=>s.id===n.id)?Bt(e,{type:1,toast:n}):Bt(e,{type:0,toast:n});case 3:let{toastId:o}=t;return o?lo(o):e.toasts.forEach(s=>{lo(s.id)}),{...e,toasts:e.toasts.map(s=>s.id===o||o===void 0?{...s,visible:!1}:s)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(s=>s.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let r=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+r}))}}},$o=[],Nt={toasts:[],pausedAt:void 0},St=e=>{Nt=Bt(Nt,e),$o.forEach(t=>{t(Nt)})};var zo=(e,t="blank",n)=>({createdAt:Date.now(),visible:!0,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:n?.id||Go()}),Je=e=>(t,n)=>{let o=zo(t,e,n);return St({type:2,toast:o}),o.id},ee=(e,t)=>Je("blank")(e,t);ee.error=Je("error");ee.success=Je("success");ee.loading=Je("loading");ee.custom=Je("custom");ee.dismiss=e=>{St({type:3,toastId:e})};ee.remove=e=>St({type:4,toastId:e});ee.promise=(e,t,n)=>{let o=ee.loading(t.loading,{...n,...n?.loading});return e.then(r=>(ee.success(mo(t.success,r),{id:o,...n,...n?.success}),r)).catch(r=>{ee.error(mo(t.error,r),{id:o,...n,...n?.error})}),e};i();a();var fo=v(I()),go=({networkID:e,transactionUnitAmount:t,onTransactionSpeedChange:n})=>{let{status:o,data:r}=it({networkID:e}),{transactionSpeed:s}=f(p=>p.sendFormValues),m=(0,fo.useMemo)(()=>{if(o!=="error"&&r&&s)return()=>n({transactionSpeed:s,transactionUnitAmount:t})},[n,s,t,r,o]);return{transactionSpeed:s,openTransactionSettings:m}};var Xo=({networkID:e,formattedRecipient:t,networkName:n,networkFee:o,networkFeeErrorMsg:r,networkFeeRow:s,displayFeeTooltip:m,transferFeePercent:p,solanaMetadata:l,ValueLoader:c,openTransactionSettings:u,onNetworkFeeDescriptionPress:C,onTransferFeePress:T})=>(0,te.useMemo)(()=>[E.isSolanaNetworkID(e)&&l.label?{label:d.t("sendConfirmationLabel"),value:l.label}:void 0,E.isSolanaNetworkID(e)&&l.message?{label:d.t("sendConfirmationMessage"),value:l.message}:void 0,{label:d.t("transactionsTo"),value:t},{label:d.t("sendFungibleSummaryNetwork"),value:n},{label:d.t("sendFungibleSummaryNetworkFee"),value:o.length>0?o:r?null:c,color:r?mt.colors.legacy.accentAlert:mt.colors.legacy.white,leftSubtext:r||void 0,leftSubtextColor:mt.colors.legacy.accentAlert,rightSubtext:s?.rightSubtext,tooltipContent:m?d.t("networkFeesTooltipDescription",{chainName:n})||"":void 0,onClick:m?u:void 0,onPress:m?u:void 0,handleTooltip:m?C:void 0},p?{label:d.t("sendFungibleTransferFee"),value:`${p}%`,tooltipContent:d.t("sendFungibleTransferFeeToolTip")||"",handleTooltip:T}:void 0,l.memo?{label:d.t("sendMemo"),value:l.memo.replace(/(\r\n|\n|\r)/gm," ")}:void 0].filter(Kt),[m,o,r,s?.rightSubtext,e,n,C,T,u,t,l.label,l.memo,l.message,p,c]),Yo=({hasSufficientFunds:e,isTransactionUnitError:t,isTransactionCreationError:n,hasGasEstimationFailed:o,nativeTokenSymbol:r})=>t?d.t("transactionGasLimitError"):o?d.t("transactionGasEstimationError"):e==="insufficient"?d.t("transactionNotEnoughNative",{nativeTokenSymbol:r}):n?d.t("transactionCreationError"):"",qo=({onNext:e,onClose:t,ValueLoader:n,onTransactionSpeedChange:o,onNetworkFeeDescriptionPress:r,onTransferFeePress:s,onSubmissionCheckFail:m,copyToClipboard:p})=>{let l=Ge(),{senderAddress:c,networkID:u,symbol:C,formattedRecipient:T,uiAmount:P,key:O,type:U,transferFeePercent:M}=re(),S=f(),x=f(j=>j.sendFormValues),k=f(j=>j.setSendFormValues),{amountAsset:H,solana:W}=x,y=E.getNetworkName(u);On(c,"SEND_FUNGIBLE");let{data:R,isError:N}=xe(S),{data:F,isError:B}=ln(R),w=(0,te.useCallback)(({transactionSpeed:j,transactionUnitAmount:ie})=>{o({transactionSpeed:j,transactionUnitAmount:ie,sendFormValues:x,setSendFormValues:k,networkID:u})},[k,x,u,o]),{transactionSpeed:G,openTransactionSettings:_}=go({networkID:u,transactionUnitAmount:F,onTransactionSpeedChange:w}),{data:ne,isFetched:Se,isSuccess:ve}=Ke({networkID:u,multichainTransaction:R,transactionSpeed:G,queryOptions:{refetchInterval:!1}}),{data:be}=pn(u,ne),z=gn(c),$=Tn(U)?H:new ge(0),{hasSufficientFunds:ye,isLoading:me,nativeTokenSymbol:q}=En(u,c?.addressType,ne,$,x.recipient),Ue=bn({networkID:u,gasEstimation:ne,gasEstimationPrice:be}),X=Nn(ne,d.t),{data:le}=it({networkID:u}),Q=(0,te.useMemo)(()=>Pe.get(u).supportsNetworkSettings&&Object.keys(le??{}).length>1,[le,u]);(0,te.useEffect)(()=>{l.capture("sendAssetSummary",{data:{type:"fungible",symbol:C,networkId:u,chainId:E.getChainID(u)}})},[u,C,l]);let{data:Ae=[]}=Fe(),{sendAddressVariant:oe}=Qe({senderAddress:c?.address,senderAccounts:Ae,networkID:u,recipient:x.recipient}),Y=Se&&!ve,se=!!ne&&!me&&ye!=="insufficient"&&!!Ue&&oe!=="danger",ue=Yo({hasSufficientFunds:ye,isTransactionUnitError:B,isTransactionCreationError:N,hasGasEstimationFailed:Y,nativeTokenSymbol:q}),Me=(0,te.useCallback)(()=>R?z?(l.capture("showFungibleTxSubmissionFailureModal"),m(z),!1):(k({...x,multichainTransaction:R}),!0):!1,[R,z,k,x,l,m]),Ve=_t((0,te.useCallback)(()=>{if(!Me())return;let ie={chainID:u,amount:P.toString(),symbol:C,address:O};Be.addBreadcrumb("fungibles","approved","info",ie),e()},[Me,C,P,u,e,O]),1e3),pe=Xo({networkID:u,formattedRecipient:T,networkName:y,networkFee:Ue,networkFeeErrorMsg:ue,networkFeeRow:X,transferFeePercent:M,solanaMetadata:W,displayFeeTooltip:Q,ValueLoader:n,openTransactionSettings:_,onNetworkFeeDescriptionPress:r,onTransferFeePress:s}),Ie=(0,te.useMemo)(()=>{let j=R&&sn(R)?R.transaction.map(ie=>{let Oe=Buffer.from(ie.serialize({verifySignatures:!1,requireAllSignatures:!1})).toString("base64");return{label:d.t("notificationCopyTransactionText"),value:Oe.slice(0,8),onClick:()=>{p(Oe),ee.success(d.t("notificationTransactionCopied"))}}}):[];return[...pe,...j]},[pe,R,p]),Le=(0,te.useCallback)(()=>{t(),S.resetSendSlice()},[t,S]),nt=zn(d.language,E.isSolanaNetworkID(u)),je=(0,te.useMemo)(()=>({title:d.t("sendConfirmationPrimaryText"),send:d.t("commandSend"),cancel:d.t("commandCancel")}),[]);return{senderAddress:c?.address,networkID:u,handleNext:Ve,handleClose:Le,canSend:se,txSubmissionCheckFailureModal:z,summaryRows:Ht()?Ie:pe,i18nStrings:je,networkHealth:nt}};i();a();i();a();i();a();i();a();var De=v(I());var et=De.default.memo(e=>{let{children:t,i18nKey:n,...o}=e,{t:r}=ae(),s=(0,De.useMemo)(()=>{let p=(n?`${r(n,{...o,...o.values})}`:"").replace(/<\/?[^>]+(>|$)/g,"");return De.default.createElement(D,null,p)},[n,o,r]);return De.default.createElement(ut,{fallback:s},De.default.createElement(qt,{i18nKey:n,...o},t))});var g=v(I()),bo=v(wo());i();a();var So=jt(Ge,e=>new Pt(e)),Pt=class{#e;constructor(t){this.#e=t}onSendFlowStart({assetType:t,context:n}){this.#e.capture("sendFlowStart",{data:{assetType:t,context:n}})}onSendAssetAttempt(t){this.#e.capture("sendAssetAttempt",{data:{chainId:E.getChainID(t.networkId),...t}})}onSendAssetSuccess(t){this.#e.capture("sendAssetSuccess",{data:{chainId:E.getChainID(t.networkId),...t}})}onSendAssetFailure(t){this.#e.capture("sendAssetFailure",{data:{chainId:E.getChainID(t.networkId),...t}})}};i();a();i();a();var tt=v(I()),Qo=[/Unknown instruction error/i,/Unknown error/i];function Dt({programId:e,customErrorCode:t,customErrorReason:n,errorReason:o}){let{t:r}=ae(),s=Ge(),m=n||o,p=r(m);return(0,tt.useEffect)(()=>{s.capture("transactionErrorDetails",{data:{programId:e,customErrorCode:t,customErrorReason:n,errorReason:o,hasTranslatedErrorMessage:m!==p}})},[]),tt.default.createElement(Z,null,tt.default.createElement(D,{align:"center",color:"textSecondary"},p,t&&Qo.some(l=>l.test(m))?` (${r("transactionsError")}: ${t})`:""))}var Jo=({sendSequenceAnalytics:e,onTransactionLinkPress:t,onClose:n,onCancel:o,onBack:r,mobileSignWithLedger:s,ledgerSupported:m})=>{let{data:[p]}=rt(["kill-base-history"]),{senderAddress:l,networkID:c,symbol:u,formattedRecipient:C,uiAmount:T,logoUri:P,tokenPrice:O,key:U}=re(),{data:M,status:S}=rn(),x=(0,g.useMemo)(()=>M?.addresses??[],[M]),k=So(),H=Rt(),W=f(),y=(0,g.useMemo)(()=>Tt(c),[c]),{transactionSpeed:R,recipient:N}=W.sendFormValues,{data:F}=xe(W),B=Pn(c,R,l,u,P??"",C,T.toNumber(),O,d.t),[w,G]=(0,g.useState)(!1),[_,ne]=(0,g.useState)(null),[Se,ve]=(0,g.useState)(null),{addRecentAddress:be}=ke(),z=M?.type==="ledger",[$,ye]=(0,g.useState)(void 0),me=fn("send:fungible",c,!!s);Cn(U,T,$?$.id:"");let q=Rn(x),Ue=(0,g.useCallback)(K=>{me(K.id,"confirmed"),k.onSendAssetSuccess({...H,txId:K.id}),q()},[k,me,q,H]),{isSuccess:X,isError:le,error:Q}=An(Ue,$??void 0),Ae=!!$,oe=ct.get(c).sendSuccessCondition,Y=(0,g.useMemo)(()=>{switch(oe){case"SUBMISSION":return w?"ERROR":Ae?"SUCCESS":"LOADING";case"CONFIRMATION":return w||le?"ERROR":X?"SUCCESS":"LOADING"}},[le,X,w,Ae,oe]),{isError:se,isSuccess:ue}=(0,g.useMemo)(()=>({isError:Y==="ERROR",isSuccess:Y==="SUCCESS"}),[Y]),Me=(0,g.useMemo)(()=>{let K=Pe.get(c).transactionSpeedDescription(R??"standard");return K?d.t(K):""},[c,R]),Ve=oe==="CONFIRMATION"?"sendStatusConfirmedSuccessTitle":"sendStatusSubmittedSuccessTitle",pe=(0,g.useMemo)(()=>{switch(Y){case"LOADING":return d.t("sendStatusLoadingTitle");case"ERROR":return d.t("sendStatusErrorTitle");case"SUCCESS":return d.t(Ve)}},[Y,Ve]),Ie=(0,g.useMemo)(()=>({titleText:pe,retryText:d.t("commandRetry"),cancelText:d.t("commandCancel"),closeText:d.t("commandClose"),viewTransactionText:d.t("sendStatusViewTransaction")}),[pe]);(0,g.useEffect)(()=>{y.chainName!=="bitcoin"&&(X?(Be.addBreadcrumb("fungibles","transactionStatus","info",{...y,status:"confirmed"}),$?.id&&e&&e.transactionStatus($.id,{...y,status:{type:"confirmed"}})):se&&(Be.addBreadcrumb("fungibles","transactionStatus","error",{...y,status:"error"}),$?.id&&e&&e.transactionStatus($.id,{...y,status:{type:"error"}})))},[X,se,$,y,e]);let{mutateAsync:Le}=hn(),je=se?g.default.createElement(g.default.Fragment,null,(K=>{switch(K){case"InsufficientFunds":return g.default.createElement(D,{color:"textSecondary",align:"center"},d.t("sendStatusErrorMessageInsufficientBalance"));case"UnknownError":default:return g.default.createElement(g.default.Fragment,null,g.default.createElement(D,{font:"bodySemibold",color:"textSecondary",align:"center"},g.default.createElement(et,{i18nKey:"sendFungibleErrorMessageInterpolated",values:{uiAmount:T.toString(),assetSymbol:u,uiRecipient:C},components:{2:g.default.createElement(D,{font:"bodySemibold",color:"textPrimary"})}})),_?g.default.createElement(Z,{marginTop:16,justifyContent:"center"},g.default.createElement(D,{font:"body",color:"textSecondary"},d.t("sendFungibleSolanaErrorCode",{code:_}))):null)}})(Se??"InsufficientFunds"),Q&&"data"in Q?g.default.createElement(Z,{marginY:16,justifyContent:"center",color:"textSecondary"},g.default.createElement(Dt,{errorReason:Q.data.errorReason,programId:Q.data.programId,customErrorReason:Q.data.customErrorReason,customErrorCode:Q.data.customErrorCode})):null):ue&&oe==="CONFIRMATION"?g.default.createElement(D,{font:"bodySemibold",color:"textSecondary",align:"center"},g.default.createElement(et,{i18nKey:"sendFungibleConfirmedSuccessMessageInterpolated",values:{uiAmount:T.toString(),assetSymbol:u,uiRecipient:C},components:{2:g.default.createElement(D,{font:"bodySemibold",color:"textPrimary"})}})):ue&&oe==="SUBMISSION"?g.default.createElement(D,{font:"bodySemibold",align:"center"},d.t("sendStatusEstimatedTransactionTime",{time:Me})):g.default.createElement(D,{font:"bodySemibold",color:"textSecondary",align:"center"},g.default.createElement(et,{i18nKey:"sendFungibleLoadingMessageInterpolated",values:{uiAmount:T.toString(),assetSymbol:u,uiRecipient:C},components:{2:g.default.createElement(D,{font:"bodySemibold",color:"textPrimary"})}})),{data:j}=Ke({networkID:c,multichainTransaction:F,transactionSpeed:R,queryOptions:{refetchInterval:!1}}),ie=(0,g.useCallback)(async()=>{try{if(!F)throw new Error("multichainTransaction is undefined on send status");if(!j)throw new Error("gasEstimation is undefined on send status");be({address:N,chainID:c,timestamp:Date.now()});let K=Date.now();k.onSendAssetAttempt(H);let fe=await Le({multichainTransaction:F,pendingTransactionInput:B,senderAddress:l,gasEstimation:j}),He=fe.id;me(He,"initiated",K),me(He,"received");let Ee=Tt(c),Re;Ee.chainType==="solana"&&e?(Re="signAndSendTransaction",e.submittedTransaction(fe.id,{...Ee,method:Re})):Ee.chainType==="eip155"&&e?(Re="eth_sendRawTransaction",e.submittedTransaction(fe.id,{...Ee,method:Re})):Ee.chainType==="sui"&&e&&(Re="signAndExecuteTransaction",e.submittedTransaction(fe.id,{...Ee,method:Re})),Be.addBreadcrumb("fungibles","submittedTransaction","info",{...Ee,txReceipt:fe.id,method:Re??"UNKNOWN"}),ye(fe)}catch(K){let fe=Dn(K,y.chainType==="solana"?"solana":void 0);if(ve(fe),fe==="UnknownError"&&K instanceof Error&&y.chainType==="solana"){let[He]=K.message.match(/0x\d+/)||[];typeof He=="string"&&He&&ne(He)}G(!0),k.onSendAssetFailure(H),Be.captureError(K,"fungibles")}},[F,N,j,be,y,Le,B,me,c,k,e,l,H,G]),Oe=f(K=>K.retryArgs),h=(0,g.useCallback)(()=>{Oe?(ye(void 0),G(!1),ie()):r()},[ie,r,Oe]),{data:V}=on($),he=(0,g.useCallback)(()=>{V&&t(V)},[t,V]),yt=(0,g.useCallback)(()=>{o()},[o]),At=(0,g.useCallback)(()=>{let{sendSuccessRedirect:K}=Pe.get(c);n(K(p))},[n,p,c]),Lt=nn(c),ko=S==="pending",xo=(0,g.useCallback)(()=>{m&&!ue&&!se&&W.resetSendSlice()},[ue,se,W,m]);return(0,bo.default)(xo),{handleClose:At,handleCancel:yt,handleRetry:h,handleTransactionLinkPress:he,isSuccess:ue,isError:se,MessageElement:je,title:pe,txReceipt:$,handleTokenTransfer:ie,i18nStrings:Ie,isLoadingSelectedAccountStatus:ko,isLedger:z,ledgerApp:Lt}};i();a();var A=v(I());i();a();var ce=v(I());var er=J(Zn)`
  width: 100%;
  border-style: none;
  padding: 0;
`,yo=J(Wn).attrs({width:"28px",borderRadius:"50px",theme:"primary"})`
  height: 28px;
`,Ao=ce.default.memo(({isExpanded:e,addressBookRecipient:t,clearRecipient:n})=>{let{t:o}=ae(),[r,s]=(0,ce.useState)(!1),m={onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1)},p=r&&!t&&!e;return ce.default.createElement($n,{color:"#000000",label:o("sendAddressBookButtonLabel"),ariaLabel:o("sendAddressBookButtonLabel"),alignment:"bottomRight",isVisible:p,triggerParams:m},t?ce.default.createElement(yo,{paddingY:9,onClick:n},ce.default.createElement(Hn,{fill:"#222",width:10})):ce.default.createElement(er,null,ce.default.createElement(yo,{paddingY:6},ce.default.createElement(Gn,{fill:"#222"}))))});i();a();var Ut=v(I());var ho=Ut.default.memo(({symbol:e,chainName:t,recipient:n,recipientError:o,handleRecipientChange:r,onBlur:s})=>{let{t:m}=ae();return Ut.default.createElement(_n,{type:"text",name:"recipient",value:n,autoComplete:"off",spellCheck:"false",placeholder:m("sendRecipientTextAreaPlaceholder2",{symbol:t||e}),warning:!!o,onChange:r,onBlur:s,paddingRight:"80px"})});var To=J(Ye).attrs({size:16,weight:500,color:"#666666"})`
  font-style: italic;
`,tr=J(jn)`
  width: 100%;
  position: relative;
`,nr=J(kt).attrs({align:"center"})`
  position: relative;
  border-radius: 6px;
  border: 1px solid #2f2f2f;
  padding: 14px;
  background: #181818;
  height: 50px;
  margin-bottom: 2px;
`,or=J(Xn)`
  z-index: 2;
  width: 100%;
`,Mt=J(qn)`
  padding: 8px 12px;
  min-height: 41px;
`,rr=J(kt).attrs({justify:"center"})`
  height: 85px;
`,Fo=J(Ye).attrs({size:16,color:"#666666"})``,sr=J.div`
  position: absolute;
  right: 12px;
  top: calc(50% - 28px / 2);
  width: auto;
  display: flex;
  gap: 12px;
  align-items: center;
`,ir="__none",ar=50,bt=10,dr=e=>{let{addressBookRecipient:t,networkID:n,senderAddress:o,symbol:r,sendFormValues:s,sendFormErrors:m,recipientError:p,handleAddressSelection:l,setSendFormValues:c,setSendFormErrors:u,isLoading:C}=e,{t:T}=ae(),P=(0,A.useMemo)(()=>({sendAddressBookRecentlyUsed:T("sendAddressBookRecentlyUsed"),sendAddressBookNoAddressesSaved:T("sendAddressBookNoAddressesSaved")}),[T]),{data:O=[]}=Fe(),U=(0,A.useMemo)(()=>o?O.reduce((B,w)=>{let G=w.addresses.filter(_=>_.networkID===n&&_.address!==o);if(n)for(let _ of G)B.push({label:w.name,address:_.address,chainID:n});return B},[]):[],[o,O,n]),{recentAddresses:M,savedAddresses:S}=ke(),x=(0,A.useMemo)(()=>S.addresses.reduce((B,w)=>(n&&Ft(E.getAddressTypes(w.chainID),E.getAddressTypes(n))&&B.push({...w}),B),[]),[S,n]),k=(0,A.useMemo)(()=>M.addresses.reduce((B,w)=>(n&&Ft(E.getAddressTypes(w.chainID),E.getAddressTypes(n))&&B.push(w.address),B),[]),[M,n]),H=U.length===0&&x.length===0&&k.length===0,W=(0,A.useMemo)(()=>{for(let{address:B,label:w}of U)if(B===t)return w;for(let{address:B,label:w}of x)if(B===t)return w},[t,U,x]),{recipient:y}=s,R=(0,A.useCallback)(B=>{let w=B.currentTarget,G=self.getComputedStyle(w),_=parseInt(G.getPropertyValue("border-top-width"),bt)+parseInt(G.getPropertyValue("padding-top"),bt)+w.scrollHeight+parseInt(G.getPropertyValue("padding-bottom"),bt)+parseInt(G.getPropertyValue("border-bottom-width"),bt);_=w.value?Math.min(68,_-28):ar,w.style.height=`${_}px`,c({...s,recipient:w.value}),u({...m,recipientError:void 0})},[s,m,u,c]),N=(0,A.useCallback)(()=>{c({...s,recipient:"",addressBookRecipient:void 0})},[s,c]),F=(0,A.useMemo)(()=>{if(n)return E.getNetworkName(n)},[n]);return{i18nStrings:P,recipient:y,addressBookRecipient:t,addresses:U,savedAddresses:x,recentAddresses:k,isEmpty:H,selectedName:W,recipientError:p,symbol:r,chainName:F,handleAddressSelection:l,handleRecipientChange:R,clearRecipient:N,isLoading:C}},Ic=A.default.memo(e=>{let t=dr(e);return A.default.createElement(cr,{...t})}),cr=A.default.memo(e=>{let{i18nStrings:t,recipient:n,addressBookRecipient:o,addresses:r,savedAddresses:s,recentAddresses:m,isEmpty:p,selectedName:l,recipientError:c,symbol:u,chainName:C,handleAddressSelection:T,handleRecipientChange:P,clearRecipient:O,isLoading:U=!1}=e;return A.default.createElement(tr,{onChange:T,value:o??ir},({isExpanded:M})=>A.default.createElement(A.default.Fragment,null,o?A.default.createElement(nr,null,l?A.default.createElement(Ye,{size:16,weight:500},l):A.default.createElement(To,null,t.sendAddressBookRecentlyUsed),A.default.createElement(Ye,{opacity:.5,size:16,weight:400,margin:"0 0 0 6px"},"(",o.includes(".")?o:Te(o,4),")")):A.default.createElement(ho,{symbol:u??"",chainName:C,recipient:n,recipientError:c,handleRecipientChange:P}),A.default.createElement(sr,null,U?A.default.createElement(Kn,{diameter:20}):null,A.default.createElement(Ao,{isExpanded:M,addressBookRecipient:o,clearRecipient:O})),A.default.createElement(or,{portal:!1},A.default.createElement(Yn,{maxHeight:"150px"},r.map(({address:S,label:x,chainID:k},H)=>A.default.createElement(Mt,{key:`${S}-${H}`,value:S},A.default.createElement(xt,{name:x,publicKey:S,publicKeyLabel:en(k,S)}))),s.map(({address:S,label:x},k)=>A.default.createElement(Mt,{key:`${S}-${k}`,value:S},A.default.createElement(xt,{name:x,publicKey:S}))),m.map((S,x)=>A.default.createElement(Mt,{key:`${S}-${x}`,value:S},A.default.createElement(To,null,t.sendAddressBookRecentlyUsed),A.default.createElement(Fo,{opacity:.5},Te(S,4)))),p&&A.default.createElement(rr,null,A.default.createElement(Fo,null,t.sendAddressBookNoAddressesSaved))))))});i();a();var ze=v(I());var mr=()=>{let{uiAmount:e,symbol:t,formattedCurrencyAmount:n}=re(),o=_e(e);return ze.default.createElement(Z,{direction:"column",alignItems:"center",marginTop:8,marginBottom:32},ze.default.createElement(Z,{marginBottom:16},ze.default.createElement(lt,{icon:"Send2",size:64,color:"accentPrimary",backgroundColor:"bgTabBar",shape:"circle"})),ze.default.createElement(D,{font:"heading1Semibold",align:"center"},o," ",t),n?ze.default.createElement(D,{color:"textSecondary",font:"title2",align:"center"},n):null)};i();a();var Vt=v(I());var lr=({networkId:e,senderAddress:t})=>{let{data:n=[]}=Fe(),{recipient:o}=pt(),{sendAddressWarning:r,sendAddressVariant:s}=Qe({senderAddress:t,senderAccounts:n,networkID:e,recipient:o});return r?Vt.default.createElement(Z,{marginBottom:12},Vt.default.createElement(Vn,{level:s==="danger"?"1-critical-alert":"2-alert"},r)):null};i();a();i();a();var fr=v(I());i();a();var ur=v(I());i();a();var gr=v(I());i();a();export{Rr as a,re as b,Qe as c,qo as d,Mo as e,Vo as f,Dt as g,Jo as h,Ic as i,mr as j,lr as k};
//# sourceMappingURL=chunk-GI2PSXDM.js.map
